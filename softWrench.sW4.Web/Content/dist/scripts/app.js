function getDateFormat(){return"MM/dd/yyyy HH:mm"}function instantiateIfUndefined(a,b){var c=void 0===b||1==b;return(void 0===a||c&&null===a)&&(a={}),a}function FillRelationship(a,b,c){return b=b.replace(/_/g,"_."),b=b.replace(/\.\./g,"."),JsonProperty(a,b,c,!0)}function GetRelationshipName(a){return a=a.replace(/_/g,"_."),a=a.replace(/\.\./g,".")}function RemoveSpecialChars(a){return a.replace(/[^\w\s]/gi,"")}function JsonProperty(a,b,c,d){for(var e=b.split("."),f=a,g=0;g<e.length;g++)if(f.hasOwnProperty(e[g]))f=f[e[g]];else{if(void 0==c&&!d)return null;g==e.length-1?f[e[g]]=c:f[e[g]]={},f=f[e[g]]}return f}function nullOrUndef(a){return void 0===a||null==a}function lockCommandBars(){var a=$("[data-class=commandbar]");a.each(function(a,b){for(var c=$(b).children("button"),d=0;d<c.length;d++){var e=$(c[d]);1!=e.prop("disabled")&&(e.attr("disabled","disabled"),e.attr("forceddisable","disabled"))}})}function unLockCommandBars(){var a=$("[data-class=commandbar]");a.each(function(a,b){for(var c=$(b).children("button"),d=0;d<c.length;d++){var e=$(c[d]);"disabled"==e.attr("forceddisable")&&e.removeAttr("disabled")}})}function lockTabs(){var a=$("[data-toggle=tab]");a.each(function(a,b){var c=$(b);c.removeAttr("data-toggle"),c.attr("data-toggle","tab_inactive")})}function unLockTabs(){var a=$("[data-toggle=tab_inactive]");a.each(function(a,b){var c=$(b);c.removeAttr("data-toggle"),c.attr("data-toggle","tab")})}function capitaliseFirstLetter(a){for(var b=a.split(/[ ]+/),c="",d=0;d<b.length;d++)c+=b[d].charAt(0).toUpperCase()+b[d].slice(1),c+=d+1==b.length?"":" ";return c}function isIe9(){return"true"==sessionStorage.mockie9||"Explorer"==BrowserDetect.browser&&("9"==BrowserDetect.version||"8"==BrowserDetect.version||"7"==BrowserDetect.version)}function isIe(){return"true"==sessionStorage.mockie9||"Explorer"==BrowserDetect.browser}function isChrome(){return"Chrome"==BrowserDetect.browser}function isFirefox(){return"Firefox"==BrowserDetect.browser}function loadScript(a,b){var c=document.getElementsByTagName("head")[0],d=document.createElement("script");d.type="text/javascript",d.src=url(a),d.onreadystatechange=b,d.onload=b,c.appendChild(d)}function url(a){if(null==a)return null;var b=location.protocol+"//"+location.hostname+(location.port?":"+location.port:"");b.search("localhost:")==-1&&(b+="/softWrench"),a&&"/"!=a[0]&&(a="/"+a);var c=$(routes_basecontext)[0].value;return"/"==c?a:c+a}function GetBootstrapFormClass(a){var b=GetPopUpMode();return"browser"==b||"nomenu"==b?"col-xs-"+a:"col-md-"+a}function GetPopUpMode(){var a=$(hddn_popupmode)[0].value;return void 0!==a&&"null"!=a&&""!=a||(a="none"),a}function IsPopup(){var a=GetPopUpMode();return"browser"==a||"nomenu"==a}function BuildDataObject(){var a={},b=$(crud_InitialData)[0].value;return void 0===b||null==b||""==b?a:(a.data=b,a)}function isString(a){return"string"==typeof a||"object"==typeof a&&a.constructor===String}function platformQS(){return"platform="+platform()}function platform(){return"web"}function detailSchema(){return"detail"}function listSchema(){return"list"}function executeFunctionByName(a,b){for(var c=Array.prototype.slice.call(arguments).splice(2),d=a.split("."),e=d.pop(),f=0;f<d.length;f++)b=b[d[f]];return b[e].apply(this,c)}function addCurrentSchemaDataToJson(a,b){return a["%%currentschema"]={},a["%%currentschema"].schemaId=b.schemaId,a["%%currentschema"].mode=b.mode,a["%%currentschema"].platform=platform(),a}function addSchemaDataToJson(a,b,c){if(a=addCurrentSchemaDataToJson(a,b),c)a["%%nextschema"]={},a["%%nextschema"].schemaId=c.schemaId,null!=c.nextSchemaMode&&(a["%%nextschema"].mode=c.schemaMode),a["%%nextschema"].platform=platform();else if(null!=b.properties&&null!=b.properties["nextschema.schemaid"]){var d=b.properties["nextschema.schemaid"];a["%%nextschema"]={},a["%%nextschema"].schemaId=d,null!=b.properties["nextschema.schemamode"]&&(a["%%nextschema"].mode=b.properties["nextschema.schemamode"]),a["%%nextschema"].platform=platform()}return a}function addSchemaDataToParameters(a,b,c){return a.currentSchemaKey=b.schemaId+"."+b.mode+"."+platform(),null!=c&&null!=c.schemaId&&(a.nextSchemaKey=c.schemaId+".",null!=c.mode&&(a.nextSchemaKey+=c.mode),a.nextSchemaKey+="."+platform()),null!=b.properties&&null!=b.properties["nextschema.schemaid"]&&(a.nextSchemaKey=b.properties["nextschema.schemaid"]),a}function removeEncoding(a){return a=replaceAll(a,"%5B%5D",""),a=replaceAll(a,"%5B","."),a=replaceAll(a,"%5D","")}function getCurrentDate(){var a=new Date,b=a.getDate(),c=a.getMonth()+1,d=a.getFullYear(),e=a.getHours(),f=a.getMinutes();return b<10&&(b="0"+b),c<10&&(c="0"+c),a=c+"/"+b+"/"+d+" "+e+":"+f}function replaceAll(a,b,c){return a.replace(new RegExp(b,"g"),c)}function imgToBase64(a){var b=document.createElement("canvas");b.width=a.width,b.height=a.height;var c=b.getContext("2d");c.drawImage(a,0,0);var d=b.toDataURL("image/png");return d}function printWindow(){window.print()}function isEmpty(a){if(null==a)return!0;if(a.length>0)return!1;if(0===a.length)return!0;for(var b in a)if(hasOwnProperty.call(a,b))return!1;return!0}function isNumber(a){return!isNaN(parseFloat(a))&&isFinite(a)}function LayoutController(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(){var c=$(hddn_configs)[0].value,f=$(hiddn_user)[0].value;if(nullOrEmpty(c)||nullOrEmpty(f))return void n.logout();var g=JSON.parse(c),h=JSON.parse(f);k.loadUserContext(h),k.loadConfigs(g),k.insertIntoContext("isLocal",g.isLocal),k.insertIntoContext("allowedfiles",g.allowedFileTypes),e.clientName=g.clientName,e.environment=g.environment,e.isLocal=g.isLocal,e.i18NRequired=g.i18NRequired,a.mainlogo=g.logo,a.myprofileenabled=g.myProfileEnabled;var j=GetPopUpMode();a.popupmode=j,"none"==j&&b({method:"GET",url:url("/api/menu?"+platformQS()),cache:d}).success(function(b){e.menu=b.menu,a.menu=b.menu,a.isSysAdmin=b.isSysAdmin,a.isClientAdmin=b.isClientAdmin,$(".hapag-body").addClass("hapag-body-loaded")}).error(function(b){a.title=b||i.get18nValue("general.requestfailed","Request failed")})}a.$name="LayoutController",p.wipeSchemaCacheIfNeeded(),e.$on("sw_ajaxinit",function(a){var b=!0===e.savingMain;o.start({savingDetail:b})}),e.$on("sw_ajaxend",function(a){o.stop(),e.savingMain=void 0}),e.$on("sw_ajaxerror",function(a){o.stop(),e.savingMain=void 0}),a.$on("sw_titlechanged",function(b,c){a.title=c}),a.$on("ngLoadFinished",function(a){$("[rel=tooltip]").tooltip({container:"body"}),j.adjustHeight()}),a.$on("ngRepeatFinished",function(a){$("[rel=tooltip]").tooltip({container:"body"});var b=$(".col-side-bar").width();null!=b&&$(".col-main-content").css("margin-left",b)}),a.contextPath=function(a){return url(a)},a.goToApplicationView=function(a,b,c,d,e,f){j.setActiveLeaf(f),h.goToApplicationView(a,b,c,d,e)},a.doAction=function(a,b,c,d,e){j.setActiveLeaf(e),h.redirectToAction(a,b,c,d)},e.$on("sw_redirectactionsuccess",function(b,d){var e=c.getInstance("layoutcontroller#onsw_redirectactionsuccess");e.debug("received event"),a.AjaxResult(d)}),e.$on("sw_redirectapplicationsuccess",function(b,d,f,g){var h=c.getInstance("layoutcontroller#onsw_redirectapplicationsuccess");a.applicationname=g,a.requestmode=f,void 0!=e.popupmode?(a.popupmode=e.popupmode,$(hddn_popupmode)[0].value=e.popupmode):e.popupmode=a.popupmode,h.debug("received event"),a.AjaxResult(d)}),a.AjaxResult=function(b){if(!(a.resultObject.requestTimeStamp>b.requestTimeStamp)){var d=c.getInstance("layoutcontroller#AjaxResult"),e=url(b.redirectURL);a.includeURL!=e&&(d.debug("redirection detected new:{0} old:{1}".format(e,a.includeURL)),a.includeURL=e),null!=b.title&&(d.debug("dispatching title changed event. Title: {0}".format(b.title)),a.$emit("sw_titlechanged",b.title)),a.resultData=b.resultObject,a.resultObject=b,f(function(){window.scrollTo(0,0)},100,!1)}},a.logout=function(){n.logout("manual")},a.$on("sw_goToApplicationView",function(b,c){null!=c&&a.goToApplicationView(c.applicationName,c.schemaId,c.mode,c.title,c.parameters)}),a.$on("sw_indexPageLoaded",function(a,b){null!=b&&e.menu&&j.setActiveLeafByUrl(e.menu,b)}),a.i18N=function(a,b,c){return i.get18nValue(a,b,c)},q()}function AboutController(a,b,c,d){var e=a.resultData;null!=e&&(a.aboutData=e),a.i18N=function(a,b,c){return d.get18nValue(a,b,c)}}function ApplicationController(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(b,c){null==c&&(c=a),c.isDetail=b,c.isList=!b}function p(a){o(!0,a)}function q(a){var b=a.schema.properties["popup.window.titlestrategy"],c=a.datamap.fields[a.schema.idFieldName],d=a.schema.properties["popup.window.titleattribute"];if(null!=d){var e=a.datamap.fields[d];return void(window.document.title=String.format(e,c))}nullOrEmpty(b)?window.document.title=a.title:"idonly"==b?(window.document.title=c,null==c&&(window.document.title=a.title)):"nameandid"==b?window.document.title=a.schema.applicationName+" "+c:"schematitle"==b&&(window.document.title=a.schema.title)}function r(){a.$on("sw_renderview",function(b,c,d,e,f,g){a.renderView(c,d,e,f,g)}),a.$on("sw_applicationredirected",function(b,c){"browser"!=c.popupmode&&"modal"!=c.popupmode&&(a.multipleSchema=!1,a.schemas=null,a.isDetail=!1,j.setActiveTab(null))}),a.$on("sw_applicationrenderviewwithdata",function(b,c){var d=c.schema;a.renderViewWithData(d.applicationName,d.schemaId,d.mode,d.title,c)}),window.onbeforeunload=function(){l.stop()},s(),a.$watch("resultObject.timeStamp",function(a,b){b!=a&&(e.getInstance("applicationcontroller#initAplication").info("redirect detected"),s())})}function s(){if(a.resultObject.redirectURL.indexOf("Application.html")!=-1){var b=a.resultObject,c=a.title,d=b.mode,e=b.applicationName,f=b.schema,g=null==f?null:f.schemaId;return a.searchData={},a.searchOperator={},a.searchSort={},null==b.schemas?null==b.resultObject?void i.alert("You donÂ´t have enough permissions to see that register. contact your administrator"):void a.renderViewWithData(e,g,d,c,b):void a.multipleSchemaHandling(b)}}a.$name="applicationController",a.toList=function(b,c){$("#saveBTN").removeAttr("disabled"),null!=b&&g.printRequested!==!0&&(c.paginationData={},c.searchValues=b.searchValues,c.paginationData.pagesToShow=b.pagesToShow,c.paginationData.pageNumber=b.pageNumber,a.paginationData.selectedPage=b.pageNumber,c.paginationData.pageCount=b.pageCount,c.paginationData.pageSize=b.pageSize,c.paginationData.paginationOptions=b.paginationOptions,c.paginationData.totalCount=b.totalCount,c.paginationData.hasPrevious=b.hasPrevious,c.paginationData.hasNext=b.hasNext,c.paginationData.filterFixedWhereClause=b.filterFixedWhereClause,c.paginationData.unionFilterFixedWhereClause=b.unionFilterFixedWhereClause),o(!1,c)},a.showList=function(){a.searchData={},a.searchOperator={},a.searchSort={},a.selectPage(1)},a.renderViewWithData=function(b,c,d,e,f){a.applicationname=b,a.requestmode=d,f.mode=d,a.renderData(f)},a.renderView=function(c,d,f,h,i){void 0!==i&&null!=i||(i={}),null==h&&(h=a.title),a.requestpopup=i.popupmode?i.popupmode:"none";var j=e.getInstance("applicationController#renderView");if("browser"==a.requestpopup||"report"==a.requestpopup)return j.debug("calling goToApplicationView for application {0}".format(c)),void a.$parent.goToApplicationView(c,d,f,h,i);var k=i.printMode;i.printMode=null,i.key={},i.key.schemaId=d,i.key.mode=f,i.key.platform=platform(),i.customParameters={},i.title=h,a.applicationname=c,a.requestmode=f;var l=url("/api/data/"+c+"?"+$.param(i));void 0==k&&(sessionStorage.swGlobalRedirectURL=l),j.info("calling url".format(l)),b.get(l).success(function(b){void 0!=k&&(g.printRequested=!0),a.renderData(b,k)})},a.renderSelectedSchema=function(){var b=a.selectedSchema.value;null!=b&&null!=b.schemaId&&(a.isDetail=!1,a.renderView(a.applicationname,b.schemaId,a.selectedModeRequest,a.title,null))},a.renderData=function(b){a.isList=a.isDetail=!1,a.crudsubtemplate=null,a.multipleSchema=!1,a.schemas=null;var c=a.requestpopup&&("modal"==a.requestpopup||"multiplemodal"==a.requestpopup);c?($("#crudmodal").modal("show"),$("#crudmodal").draggable(),a.modal={},a.showingModal=!0):(a.previousschema=a.schema,a.previousdata=a.datamap);var g=c?a.modal:a;g.schema=m.getSchemaFromResult(b),g.datamap=instantiateIfUndefined(b.resultObject),g.timeStamp=b.timeStamp,g.mode=b.mode,null!=g.schema&&(g.schema.mode=g.mode,n.updateCrudContext(g.schema)),null!=b.title&&(a.$emit("sw_titlechanged",b.title),IsPopup()&&q(g));var h=e.getInstance("applicationcontroller#renderData");"ApplicationDetailResult"==b.type?(h.debug("Application Detail Result handled"),k.fetchRelationshipData(g,b),p(g)):"ApplicationListResult"==b.type?(h.debug("Application List Result handled"),a.toList(b,g),f.FixHeader(),a.$broadcast("sw_griddatachanged",g.datamap,g.schema)):null!=b.crudSubTemplate&&(h.debug("Crud Sub Template handled"),a.crudsubtemplate=url(b.crudSubTemplate)),d(function(){$(".menu-primary").height($(window).height()),$(".menu-primary").jScrollPane({maintainPosition:!0})},1e3),a.requestpopup=null},a.multipleSchemaHandling=function(b){a.crudsubtemplate=null;var c=b.title,d=b.applicationName,e=b.mode;a.isDetail=!1,a.isList=!1,a.multipleSchema=!0,a.selectedSchema={},null!=b.placeHolder&&b.schemas[0].title!=b.placeHolder&&b.schemas.unshift({title:b.placeHolder,schemaid:null}),a.selectedSchema.value=b.schemas[0];var f=[];$.each(b.schemas,function(a,b){b.cached?f.push(m.getCachedSchema(b.applicationName,b.schemaId)):(f.push(b),m.addSchemaToCache(b))}),a.schemas=f,a.$emit("sw_titlechanged",c),"browser"===GetPopUpMode()&&(window.document.title=c),a.applicationname=d,a.selectedModeRequest=e,a.schemaSelectionLabel=b.schemaSelectionLabel},r()}function ConfigController(a,b,c,d){function e(a,b){var c=null;return $.each(a,function(a,d){d.fullKey==b?c=d:b.startsWith(d.fullKey)&&(c=e(d.children,b))}),c}function f(a,b,c){return null==a?{mode:null==b[c]||null}:{mode:a.isEqual(b[c],!0)}}function g(a,b,c){return null==a?{mode:null==b[c]||null}:{mode:a==b[c]}}function h(a,b,c){return null==a?null==b[c]:a.isEqual(b[c],!0)}var i={name:"-- Any --",id:null},j={alias:"-- No Specific --",id:null},k={alias:"-- Any --",name:null,id:null};a.$name="ConfigController",a.doInit=function(){a.currentCategory={},a.showSave=!1,a.categoryData=a.resultData.categories,a.type=a.resultData.type,a.currentmodule=k,a.currentprofile=i,a.currentcondition=j,a.currentValues={},a.currentDefaultValues={},void 0!=a.resultData.profiles&&a.resultData.profiles.unshift(i),void 0!=a.resultData.modules&&a.resultData.modules.unshift(k),void 0!=a.resultData.conditions&&a.resultData.conditions.unshift(j),a.profiles=a.resultData.profiles,a.modules=a.resultData.modules,a.allConditions=a.resultData.conditions},a.restoreDefault=function(b){d.confirm("","",function(c){a.currentValues[b.fullKey]=null},"Are you sure you want to restore the default value?")},a.getCurrentCondition=function(){return null==a.currentCondition||null==a.currentCondition.id?null:a.currentcondition},a.removeCondition=function(c){return null==c.id?void d.alert("This condition cannot be deleted"):void d.confirm("condition",c.alias,function(d){var e=angular.toJson(c);b.put(url("/api/generic/Configuration/DeleteCondition?currentKey="+a.currentCategory.fullKey),e).success(function(b){b.conditions=b.resultObject,void 0!=b.conditions&&b.conditions.unshift(j),a.allConditions=b.conditions,a.currentCategory.conditionsToShow=null,a.getConditions(a.currentCategory),a.currentcondition=j})})},a.createCondition=function(){var b=$(CONDITIONMODAL_$_KEY);a.modalcondition=a.getCurrentCondition(),a.fullkey=a.currentCategory.fullKey,b.draggable(),b.modal("show")},a.editCondition=function(b){if(null==b.id)return void d.alert("This condition cannot be edited");var c=$(CONDITIONMODAL_$_KEY);a.modalcondition=b,a.fullkey=a.currentCategory.fullKey,c.draggable(),c.modal("show")},a.getConditions=function(b){var c=!1;if(null!=b.conditionsToShow)return b.conditionsToShow;var d=[];return $.each(a.allConditions,function(a,c){(null==c.id||c.global||c.fullKey==b.fullKey)&&d.push(c)}),$.each(b.definitions,function(a,b){b.contextualized&&(c=!0),null!=b.values&&$.each(b.values,function(a,b){null!=b.condition&&d.push(b.condition)})}),b.conditionsToShow={},b.conditionsToShow.values=d,b.conditionsToShow.shouldShow=c,b.conditionsToShow},a.doInit(),a.showDefinitionsOfCondition=function(b,c){a.currentcondition=b,a.showDefinitions(c)},a.showDefinitions=function(b){if(a.currentCategory=b,null==b.definitions||0==b.definitions.length)return void(a.showSave=!1);a.showSave=!0;for(var c=0;c<b.definitions.length;c++){var d=b.definitions[c];a.currentValues[d.fullKey]=null,a.currentDefaultValues[d.fullKey]=d.stringValue;var e=d.values;if(null==e)return;var i=!1;$.each(e,function(b,c){var e=f(c.module,a.currentmodule,"id"),j=g(c.userProfile,a.currentprofile,"id"),k=1==e.mode&&1==j.mode;null!=e.mode&&1!=e.mode||null!=j.mode&&1!=j.mode||!h(c.condition,a.currentcondition,"id")||(k&&(i=!0),!k&&i||(a.currentValues[d.fullKey]=c.stringValue),null!=c.systemStringValue&&(a.currentDefaultValues[d.fullKey]=c.systemStringValue))})}},a.i18N=function(a,b,d){return c.get18nValue(a,b,d)},a.Alias=function(a){return null!=a.alias?a.alias:a.key},a.$watch("resultObject.timeStamp",function(b,c){c!=b&&a.resultObject.redirectURL.indexOf("Configuration.html")!=-1&&a.doInit()}),a.save=function(){var c=a.currentCategory;c.valuesToSave=a.currentValues,c.module=a.currentmodule,c.userProfile=a.currentprofile.id,c.condition=null==a.currentcondition.id?null:a.currentcondition;var d=angular.toJson(a.currentCategory);b.put(url("/api/generic/Configuration/Put"),d).success(function(b){a.categoryData=b.resultObject,a.currentCategory=e(a.categoryData,c.fullKey)})},a.$on("sw_bodyrenderedevent",function(a){$("input[type=file]").filestyle({image:url("/Content/Images/update_24.png"),imageheight:32,imagewidth:25,width:250})})}function BaseController(a,b,c,d){a.i18NLabelTooltip=function(c){return b.getI18nLabelTooltip(c,a.schema)},a.i18NLabel=a.i18NLabel||function(c){return b.getI18nLabel(c,a.schema)},a.i18NOptionField=function(a,c,d){return b.getI18nOptionField(a,c,d)},a.i18N=function(a,c,d,e){return b.get18nValue(a,c,d,e)},a.i18NCommandLabel=function(c){return b.getI18nCommandLabel(c,a.schema)},a.i18NTabLabel=function(c){return b.getTabLabel(c,a.schema)},a.isIE9=function(){return isIe9()},a.isIe9=function(){return isIe9()},a.i18nSectionLabel=function(c){var d=b.getI18nSectionHeaderLabel(c,c.header,a.schema);return void 0!=d&&""!=d&&(d=d.replace(":","")),d},a.nonTabFields=function(a){return c.nonTabFields(a)},a.contextPath=function(a){return url(a)},a.isFieldHidden=function(b,d){return c.isFieldHidden(a.datamap,b,d)},a.shouldDisplayCommand=function(a,b){return d.shouldDisplayCommand(a,b)},a.commandLabel=function(a,b,c){return d.commandLabel(a,b,c)},a.isCommandHidden=function(b,c){return d.isCommandHidden(a.datamap,b,c)},a.isCommandEnabled=function(b,c){return d.isCommandEnabled(a.datamap,b,c)},a.doCommand=function(b){d.doCommand(a,b)},a.hasSameLineLabel=function(b){return!!a.isVerticalOrientation()&&("TABLE"!=b.rendererType&&(("label"!=b.rendererType||"true"!=b.rendererParameters.overflow)&&(null!=b.label||null!=b.header&&"ontop"!=b.header.displacement)))},a.isVerticalOrientation=function(){return"vertical"==a.orientation},a.getSectionClass=function(b){return"TABLE"==b.rendererType?null:a.hasSameLineLabel(b)?null:"col-horizontal-orientation"}}function griditemclick(a,b,c){var d=angular.element(c).scope();d.showDetail||(d=d.$parent),d.showDetail&&d.showDetail(d.datamap[a],d.schema.displayables[b])}function buildStyle(a,b,c,d){if(void 0==a&&void 0==b&&void 0==c)return"";var e='style="';return void 0!=a&&(e+="min-width:"+a+";"),d&&void 0!=b&&(e+="max-width:"+b+";"),void 0!=c&&(e+="width:"+c+";"),e+' "'}function DashboardController(a,b,c,d,e,f,g,h,i){function j(){a.dashboards=a.resultData,a.renderDashboard(0,!1),a.$watch("resultObject.timeStamp",function(b,c){c!=b&&null!=a.resultObject.crudSubTemplate&&a.resultObject.crudSubTemplate.indexOf("HapagHome.html")!=-1&&(a.dashboards=a.resultData,a.renderDashboard(0,!1))})}a.i18N=function(a,b,c){return f.get18nValue(a,b,c)},a.i18NLabel=function(b){return f.getI18nLabel(b,a.schema)},a.renderDashboard=function(c,d){if(a.schema=null,a.datamap=null,a.totalCount=null,a.currentDashboardIndex=c,c<0&&c>=a.dashboards.length)return void a.$emit("sw_titlechanged",a.i18N("general.error","Error"));var e=a.dashboards[c],f={};f.key={},f.key.schemaId=e.schemaId,f.key.mode=e.mode,f.key.platform=platform(),f.SearchDTO={},f.SearchDTO.pageSize=e.pageSize,f.SearchDTO.searchParams=e.searchParams,f.SearchDTO.searchValues=e.searchValues,f.SearchDTO.Context={},f.SearchDTO.Context.MetadataId=e.id,f.currentmetadata=e.id,b.get(url("/api/data/"+e.applicationName+"?"+$.param(f))).success(function(b){a.schema=b.schema,a.datamap=b.resultObject,a.totalCount=b.totalCount,a.pageSize=b.pageSize,a.loaded=!0,a.dashboards[c].totalCount=b.totalCount})},a.format=function(a,b){return e.format(a,b)},a.viewAll=function(b){var c;if(b<0&&b>=a.dashboards.length)return void a.$emit("sw_titlechanged",a.i18N("general.error","Error"));c=a.dashboards[b];var d={searchParams:c.searchParams,searchValues:c.searchValues,pageSize:100};g.insertIntoContext("currentmetadata",c.id);var e=h.parseAppAndSchema(c.viewAllSchema),f=null==e.app?c.applicationName:e.app,i=e.schemaId;a.goToApplicationView(f,i,c.mode,c.title,{SearchDTO:d})},a.showDetail=function(c){var d=a.dashboards[a.currentDashboardIndex],e=h.parseAppAndSchema(d.detailSchema),f=null==e.app?d.applicationName:e.app,i=""!=d.idFieldName?c[d.idFieldName]:c[a.schema.idFieldName];g.insertIntoContext("currentmodulenewwindow",g.retrieveFromContext("currentmodule"));var j={id:i,popupmode:a.schema.properties["list.click.popupmode"],key:{schemaId:e.schemaId,mode:a.schema.properties["list.click.mode"],platform:"web"}};return"browser"==j.popupmode?void a.$parent.goToApplicationView(f,j.key.schemaId,j.key.mode,a.schema.title,j):(a.applicationname=f,void b.get(url("/api/data/"+f+"?"+$.param(j))).success(function(b){$("#crudmodal").modal("show"),$("#crudmodal").draggable(),a.modal={},a.modal.schema=b.schema,a.modal.datamap=b.resultObject,null!=b.schema.title&&null==a.modal.title&&(a.modal.title=b.schema.title),a.modal.associationOptions=b.associationOptions,a.modal.associationSchemas=b.associationSchemas,a.modal.compositions=b.Compositions,a.modal.isDetail=!0,a.modal.isList=!1}))},j()}function DownloadController(a,b,c,d,e){a.getFormattedValue=function(a,b){var c={};return b&&(c.rendererType="datetime",c.rendererParameters={format:b}),e.format(a,c)},a.download=function(a,e,f,g){var h=void 0==a?"Attachment":a,i=void 0==a?"Download":e,j={};j.id=f,j.mode=void 0==g?"http":g,j.parentId=c.getId(this.parentdata.fields,this.parentschema),j.parentApplication=this.parentschema.applicationName,j.parentSchemaId=this.parentschema.schemaId;var k=url("/"+h+"/"+i+"?"+$.param(j));$.fileDownload(k,{failCallback:function(a,c){d.alert(String.format(b.get18nValue("download.error","Error downloading file with id {0}. Please, Contact your Administrator"),f))}})}}function each(a,b,c){var d,e,f,g=0;if(arguments.length>2&&(f=exports.util.array.toArray(arguments),f.splice(0,2)),a&&a.length)for(d=a.length;g<d;){if(e=b.apply(null,[a[g],g,a].concat(f)),void 0!==e)return e;g+=1}else if(a&&Object.prototype.hasOwnProperty.apply(a,["0"]))for(;Object.prototype.hasOwnProperty.apply(a,[g]);){if(e=b.apply(null,[a[g],g,a].concat(f)),void 0!==e)return e;g+=1}else if(!(a instanceof Array))for(g in a)if(Object.prototype.hasOwnProperty.apply(a,[g])&&(e=b.apply(null,[a[g],g,a].concat(f)),void 0!==e))return e;return a}function ErrorController(a,b){a.i18N=function(a,c,d){return b.get18nValue(a,c,d)}}function FaqController(a,b,c,d){a.showDefinitions=function(a){null!=a&&null!=a.solutionId&&c.goToApplicationView("solution","detail","output","FAQ",{id:a.solutionId,faqid:a.faqId,lang:a.lang,popupmode:"browser"})},a.i18N=function(a,c,d){return b.get18nValue(a,c,d)},a.doInit=function(){var b=a.resultData,c=b.lang;a.faqLanguageFilter=null==c?"en":c,a.faqTextFilter=b.search;var d=JSON.parse(b.faqModelResponseJson);null!=d&&(a.isFaqOk=!0,a.roleList=d,a.isSearchOk=!jQuery.isEmptyObject(a.roleList))},a.$watch("resultObject.timeStamp",function(b,c){c!=b&&a.resultObject.redirectURL.indexOf("Faq.html")!=-1&&a.doInit()}),a.filterFaq=function(){null==a.faqTextFilter&&(a.faqTextFilter="");var b={};b.lang=a.faqLanguageFilter,b.search=a.faqTextFilter,a.$parent.doAction(null,"FaqApi","Index",b)},a.doInit()}function HomeController(a,b,c,d,e,f,g,h,i,j,k){function l(){var d=f.getInstance("home.js#initController"),e=url(homeModel.Url);j.load(homeModel.I18NJsons,userLanguage);var g=sessionStorage.swGlobalRedirectURL;null!=g&&e.indexOf("popupmode=browser")==-1&&e.indexOf("MakeSWAdmin")==-1&&(e=g);var i=h.currentModule();void 0!=i&&"null"!=i||(d.info("switching to home module {0}".format(homeModel.InitialModule)),h.insertIntoContext("currentmodule",homeModel.InitialModule,!1)),b({method:"GET",url:e,cache:c}).success(function(b){a.$parent.includeURL=h.getResourceUrl(b.redirectURL),a.$parent.resultData=b.resultObject,a.$parent.resultObject=b,a.$emit("sw_indexPageLoaded",e),a.$emit("sw_titlechanged",b.title),void 0!=homeModel.Message&&(k.success(homeModel.Message,!1),homeModel.Message=null)})}a.$name="HomeController",a.onTemplateLoad=function(b){e(function(){a.$emit("ngLoadFinished");var b=homeModel.WindowTitle;nullOrUndef(b)||(window.document.title=b);var c=angular.element("#headerline");g(c.contents())(a)})},l()}function LogAdminController(a,b,c,d){function e(b){var c=b.logs,d=b.appenders;a.logs=c,a.appenders=d,a.initiallogs=c,a.logname="",a.chooselog="changeviewlog",a.$watch("resultObject.timeStamp",function(b,c){c!=b&&a.resultObject.redirectURL.indexOf("LogAdmin.html")!=-1&&e(a.resultData)})}a.filter=function(b){var c=b.logname;a.logs=$.grep(a.initiallogs,function(a){return a.name.toLowerCase().indexOf(c.toLocaleLowerCase())!=-1})},a.i18N=function(a,b,d){return c.get18nValue(a,b,d)},a.changeLevel=function(a,c){var f={logName:a,newLevel:c,pattern:""},g=d.getActionUrl("LogAdmin","ChangeLevel",f);b.post(g).success(function(a){e(a.resultObject)})},a.changeAll=function(c){var f={pattern:a.logname,newLevel:c,logName:""},g=d.getActionUrl("LogAdmin","ChangeLevel",f);b.post(g).success(function(a){e(a.resultObject)})},a.viewAppenderContent=function(c){a.selectedappender=c;var e={value:c.value},f=d.getActionUrl("LogAdmin","GetAppenderTxtContent",e);b.get(f).success(function(b,c,d,e){a.appendercontent=b.resultObject}).error(function(b,c,d,e){a.appendercontent="Error "+c})},a.downloadFile=function(a){var b={};b.fileName=a.name+".txt",b.contentType="text/plain",b.path=a.value,b.setFileNameWithDate=!0,window.location=removeEncoding(url("/Application/DownloadFile?"+$.param(b)))},a.setDefaultAppender=function(){if(nullOrUndef(a.selectedappender))for(var b=0;b<a.appenders.length;b++)if("MaximoAppender"==a.appenders[b].name){a.selectedappender=a.appenders[b],a.viewAppenderContent(a.selectedappender);break}},e(a.resultData)}function MakeSWAdminController(a,b,c,d){function e(){a.password="",a.msg="",a.msgsuccess="",a.$watch("resultObject.timeStamp",function(b,c){c!=b&&a.resultObject.redirectURL.indexOf("MakeSWAdmin.html")!=-1&&e(a.resultData)})}a.submit=function(){var e={password:a.password},f=d.getActionUrl("MakeSWAdmin","Submit",e);b.get(f).success(function(b,d,e,f){1==b.resultObject?(a.msg="",a.msgsuccess="Successfully Authorized",c(function(){location.reload()},1500)):a.msg="Unauthorized"}).error(function(b,c,d,e){a.msg="Error"})},e()}function MyProfileController(a,b,c,d,e,f){function g(b){null!=b&&(a.currentUser=b.user,d.changeCurrentLanguage(a.currentUser.language),a.$emit("sw_titlechanged",d.get18nValue("general.profiledetails","Profile Details")),a.isMyProfile=!0,a.isHapag="hapag"==e.clientName,a.canChangeLanguage="true"==sessionStorage.mocklanguagechange||a.isHapag&&b.canChangeLanguage,a._rolesandfunctions=b.rolesAndFunctions,h(b),i())}function h(b){a.restrictions={},a.restrictions=b.restrictions,a.canViewRestrictions="hapag"==e.clientName&&b.canViewRestrictions}function i(){a.languages=[{value:"EN",text:a.i18N("language.english","English")},{value:"DE",text:a.i18N("language.german","German")},{value:"ES",text:a.i18N("language.spanish","Spanish")}],a.language={selected:null};for(var b=0;b<a.languages.length;b++)if(a.languages[b].value==a.currentUser.language){a.language={selected:a.languages[b]};break}}function j(){var a={},c=f.getActionUrl("User","MyProfile",a);b.get(c).success(function(a,b,c,d){g(a.resultObject)}).error(function(a,b,c,d){})}function k(b){var c=a.currentUser.password;nullOrUndef(c)?b.password=null:b.password=c,b.firstName=a.currentUser.firstName,b.lastName=a.currentUser.lastName,b.siteId=a.currentUser.siteId,b.email=a.currentUser.email,b.department=a.currentUser.department,b.phone=a.currentUser.phone,nullOrUndef(a.language.selected)||(a.currentUser.language=a.language.selected.value),b.language=a.currentUser.language}g(a.resultData),a.rolesAndFunctions=function(){return a._rolesandfunctions},a.fixselecttext=function(){angular.forEach($("#userLanguage"),function(a){a.options[a.selectedIndex].text+=" "})},a.$watch("languages",function(b,c){b!==c&&(a.languages=b,angular.forEach($("#userLanguage"),function(a){a.options[a.selectedIndex].text=b[a.selectedIndex].text}))}),a.i18N=function(a,b,c){return d.get18nValue(a,b,c)},a.saveMyProfile=function(){b({method:"GET",url:url("api/security/User/"+a.currentUser.dbId)}).success(function(c){k(c),$("#saveMyProfileBTN").prop("disabled","disabled"),b.post(url("api/security/User"),c).success(function(){$("#saveMyProfileBTN").removeAttr("disabled"),j(),$("html, body").animate({scrollTop:0},"fast")}).error(function(b){$("#saveMyProfileBTN").removeAttr("disabled"),a.title=b||d.get18nValue("general.requestfailed","Request failed")})})}}function RoleController(a,b,c,d){function e(){g(!0)}function f(b){null!=b&&(a.roles=b),g(!1)}function g(b){a.isDetail=b,a.isList=!b}function h(){a.roles=a.resultData,f(null)}a.editRole=function(b,c,d){a.role={},a.role.id=b,a.role.name=c,a.role.active=d,e()},a.i18N=function(a,b,c){return d.get18nValue(a,b,c)},a.showList=function(){a.searchData={},a.selectPage(1)},a.cancel=function(){f(null)},a["delete"]=function(){$("#saveBTN").prop("disabled","disabled"),b.put(url("api/security/Role"),JSON.stringify(a.role)).success(function(a){$("#saveBTN").removeAttr("disabled"),f(a.resultObject)}).error(function(b){$("#saveBTN").removeAttr("disabled"),a.title=b||d.get18nValue("general.requestfailed","Request failed")})},a.save=function(){$("#saveBTN").prop("disabled","disabled"),b.post(url("api/security/Role"),JSON.stringify(a.role)).success(function(a){$("#saveBTN").removeAttr("disabled"),f(a.resultObject)}).error(function(b){$("#saveBTN").removeAttr("disabled"),a.title=b||d.get18nValue("general.requestfailed","Request failed")})},a["new"]=function(){e(!0)},h()}function SamelinePickersController(a,b,c){function d(){var b=a.fieldMetadata,c=b.parameters["default"];void 0==b.parameters.timeformat&&(b.parameters.timeformat="HH:mm"),void 0==b.parameters.dateformat&&(b.parameters.dateformat="MM/dd/yyyy");var d=a.datamap[b.parameters.joinattribute],e=void 0==d?c:d;a.date1=e,a.date2=e,a.$on("sw_beforeSave",function(a,b){f(b)})}var e=function(){var a=new Date;return a.mmddyyyy()};a.formClass=function(){return GetBootstrapFormClass(6)};var f=function(b){if(void 0!=a.date1||void 0!=a.date2){var c=void 0==a.date1?e():a.date1,d=void 0==a.date2?"":" "+a.date2;b[a.fieldMetadata.parameters.joinattribute]=c+d}};d()}function SchedulerSetupController(a,b,c,d){function e(b){null!=b&&(a.listObjects=b),h(!1)}function f(){h(!0)}function g(c,f){if(null!=c){var g="api/scheduler?name="+c.name+"&jobCommand="+f;"ChangeCron"==f&&null!=c.cron&&(g+="&cron="+c.cron),b({method:"GET",url:url(g)}).success(function(a){e(a.resultObject)}).error(function(b){a.title=b||d.get18nValue("general.requestfailed","Request failed")})}}function h(b){a.isDetail=b,a.isList=!b}function i(){var b=a.resultData;null!=b&&(a.listObjects=b,e(null))}a.contextPath=function(a){return url(a)},a.edit=function(b){
a.scheduler=b,f()},a.cancel=function(){e(null)},a.pause=function(a){g(a,"Pause")},a.schedule=function(a){g(a,"Schedule")},a.execute=function(a){g(a,"Execute")},a.changeCron=function(a){g(a,"ChangeCron")},a.i18N=function(a,b,c){return d.get18nValue(a,b,c)},i()}function AceController(a,b,c,d,e){function f(){var b=ace.edit("editor");b.getSession().setMode("ace/mode/xml");var c=a.resultData;a.type=c.type,b.setValue(c.content),b.gotoLine(0)}a.save=function(){var c="menu"==a.type?"/api/generic/EntityMetadata/SaveMenu":"/api/generic/EntityMetadata/SaveMetadata";b({method:"PUT",url:url(c),headers:{"Content-Type":"application/xml"},data:ace.edit("editor").getValue()}).success(function(){d.location.href=url("/stub/reset")})},a.contextPath=function(a){return url(a)},a.i18N=function(a,b,c){return e.get18nValue(a,b,c)},loadScript("/Content/Scripts/ace/ace.js",f),a.$watch("resultObject.timeStamp",function(b,c){c!=b&&a.resultObject.redirectURL.indexOf("EntityMetadataEditor.html")!=-1&&f()})}function UserController(a,b,c,d){function e(){g(!0)}function f(b){a.availableroles=a.availablerolesOriginal,a.availableprofiles=a.availableprofilesOriginal,null!=b&&(a.listObjects=b),g(!1)}function g(b){a.isDetail=b,a.isList=!b}function h(c){$("#saveBTN").prop("disabled","disabled"),b[c](url("api/security/User"),JSON.stringify(a.user)).success(function(a){$("#saveBTN").removeAttr("disabled"),f(a)}).error(function(a){$("#saveBTN").removeAttr("disabled")})}function i(){var b=a.resultData;a.listObjects=b.users,a.$emit("sw_titlechanged",d.get18nValue("general.usersetup","User Setup")),a.availableprofiles=b.profiles,a.availableprofilesselected={},a.selectedProfiles={},a.availableprofilesOriginal=b.profiles,a.availableroles=b.roles,a.availablerolesOriginal=b.roles,a.selectedroles={},a.availablerolesselected={},f(null)}angular.module("plunker",["ui.multiselect"]);a.addSelectedProfiles=function(b){a.user.profiles=a.user.profiles.concat(b);var c=a.availableprofiles;a.availableprofiles=c.filter(function(a){return b.indexOf(a)===-1})},a.removeSelectedProfiles=function(b){a.availableprofiles=a.availableprofiles.concat(b);var c=a.user.profiles;a.user.profiles=c.filter(function(a){return b.indexOf(a)===-1})},a.addConstraint=function(){a.profile.dataConstraints.push({id:null,Entity:"",whereClause:"",isactive:!0})},a.removeConstraint=function(b){var c=a.profile.dataConstraints,d=c.indexOf(b);d>-1&&c.splice(d,1)},a.edit=function(c){b({method:"GET",url:url("api/security/User/"+c)}).success(function(b){a.user=b,a.user.password=null,a.availableprofilesselected={},a.selectedProfiles={},a.selectedroles={},a.availablerolesselected={};var c=a.availableprofiles;a.availableprofiles=c.filter(function(a){for(var c=b.profiles,d=0;d<c.length;d++)if(a.id==c[d].id)return!1;return!0}),e()})},a.i18N=function(a,b,c){return d.get18nValue(a,b,c)},a.showList=function(){a.searchData={},a.selectPage(1)},a.cancel=function(){f(null)},a["delete"]=function(){h("put")},a.save=function(){$("#saveBTN").prop("disabled","disabled"),b.post(url("api/security/User"),JSON.stringify(a.user)).success(function(a){$("#saveBTN").removeAttr("disabled"),f(a.resultObject),$("html, body").animate({scrollTop:0},"fast")}).error(function(a){$("#saveBTN").removeAttr("disabled")})},a["new"]=function(){a.user={},a.user.profiles=[],a.user.customRoles=[],a.user.customConstraints=[],e(!0)},i()}function UserProfileController(a,b,c,d){function e(){g(!0)}function f(b){a.availableroles=a.availablerolesOriginal,null!=b&&(a.listObjects=b),g(!1)}function g(b){a.errorMessage=null,a.isDetail=b,a.isList=!b}function h(){var b=a.resultData;a.listObjects=b.profiles,a.availableroles=b.roles,a.availablerolesOriginal=b.roles,a.selectedroles={},a.availablerolesselected={},f(null)}angular.module("plunker",["ui.multiselect"]);a.addSelectedRoles=function(b){a.profile.roles=a.profile.roles.concat(b);var c=a.availableroles;a.availableroles=c.filter(function(a){return b.indexOf(a)===-1})},a.i18N=function(a,b,c){return d.get18nValue(a,b,c)},a.removeSelectedRoles=function(b){a.availableroles=a.availableroles.concat(b);var c=a.profile.roles;a.profile.roles=c.filter(function(a){return b.indexOf(a)===-1})},a.addConstraint=function(){a.profile.dataConstraints.push({id:null,Entity:"",whereClause:"",isactive:!0})},a.removeConstraint=function(b){var c=a.profile.dataConstraints,d=c.indexOf(b);d>-1&&c.splice(d,1)},a.editProfile=function(b){a.profile=b;var c=a.availableroles;a.availableroles=c.filter(function(a){for(var c=b.roles,d=0;d<c.length;d++)if(a.id==c[d].id)return!1;return!0}),e()},a.showList=function(){a.searchData={},a.selectPage(1)},a.cancel=function(){f(null)},a["delete"]=function(){$("#saveBTN").prop("disabled","disabled"),b.put(url("api/security/UserProfile"),JSON.stringify(a.profile)).success(function(a){$("#saveBTN").removeAttr("disabled"),f(a)}).error(function(b){$("#saveBTN").removeAttr("disabled"),a.errorMessage=b||d.get18nValue("general.requestfailed","Request failed")})},a.save=function(){$("#saveBTN").prop("disabled","disabled"),b.post(url("api/security/UserProfile"),JSON.stringify(a.profile)).success(function(a){$("#saveBTN").removeAttr("disabled"),f(a)}).error(function(b){$("#saveBTN").removeAttr("disabled"),a.errorMessage=b||d.get18nValue("general.requestfailed","Request failed")})},a["new"]=function(){a.profile={},a.profile.roles=[],a.profile.dataConstraints=[],e(!0)},h()}function openPopup(a){var b=1024,c=768,d=screen.width/2-b/2,e=screen.height/2-c/2,f=window.open(a,"_blank","height="+c+"px,width="+b+"px,left="+d+",top="+e+",resizable=yes,scrollbars=yes",!1);return f.focus(),f}function ltEnabledLevel(a,b){return"none"==b||"trace"!=b&&("debug"==b?a.equalsAny("trace"):"debug"==b?a.equalsAny("trace"):"info"==b?a.equalsAny("trace","debug"):"warn"==b?a.equalsAny("trace","debug","info"):"error"!=b||a.equalsAny("trace","debug","info","error"))}function getContextLevel(a){var b=sessionStorage["log_"+a];if(void 0!==b)return b;var c=a.indexOf("#");if(c!=-1){var d=a.substr(0,c),e=sessionStorage["log_"+d];if(void 0!==e)return e}return null}function getMinLevel(a,b){return null==b?a:"trace"==b?b:"debug"==b?"trace"==a?a:b:"info"==b?a.equalsAny("trace","debug")?a:b:"warn"==b?a.equalsAny("trace","debug","info")?a:b:a}function enhanceAngularLog(a,b){function c(a,c){var d=sessionStorage.loglevel;void 0==d&&(d=b.retrieveFromContext("defaultlevel"));var e=getContextLevel(c);return d=getMinLevel(d,e),!ltEnabledLevel(a,d)}function d(a,b,c){return function(){var d=this.isLevelEnabled(b,c);if(d){var e=[].slice.call(arguments);e[0]=[moment().format("dddd hh:mm:ss:SSS a")+"::["+c+"]> "]+e[0],a.apply(null,e),void 0==localStorage.logs&&(localStorage.logs=""),localStorage.logs.length>1e4&&(localStorage.logs=""),localStorage.logs+=e[0]+"\n"}}}a.enabledContexts=[],a.get=function(a){return this.getInstance(a)},a.getInstance=function(e){return{log:d(a.log,"log",e,b),info:d(a.info,"info",e,b),warn:d(a.warn,"warn",e,b),debug:d(a.debug,"debug",e,b),trace:d(a.debug,"trace",e,b),error:d(a.error,"error",e,b),enableLogging:function(b){a.enabledContexts[e]=b},isLevelEnabled:function(a){return c(a,e)}}}}$(window).load(function(){$("#userTimezoneOffset").val((new Date).getTimezoneOffset()),delete sessionStorage.schemaCache,$("#btnLogin").click(function(){var a=$("#userName"),b=$("#password"),c=$("#userNameMessage"),d=$("#passwordMessage");return""==a.val()?(d.hide(),c.hide()&&c.toggle(),!1):""!=b.val()||(c.hide(),d.hide()&&d.toggle(),!1)})}),Date.CultureInfo={name:"en-US",englishName:"English (United States)",nativeName:"English (United States)",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],firstLetterDayNames:["S","M","T","W","T","F","S"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"mdy",formatPatterns:{shortDate:"M/d/yyyy",longDate:"dddd, MMMM dd, yyyy",shortTime:"h:mm tt",longTime:"h:mm:ss tt",fullDateTime:"dddd, MMMM dd, yyyy h:mm:ss tt",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"MMMM dd",yearMonth:"MMMM, yyyy"},regexPatterns:{jan:/^jan(uary)?/i,feb:/^feb(ruary)?/i,mar:/^mar(ch)?/i,apr:/^apr(il)?/i,may:/^may/i,jun:/^jun(e)?/i,jul:/^jul(y)?/i,aug:/^aug(ust)?/i,sep:/^sep(t(ember)?)?/i,oct:/^oct(ober)?/i,nov:/^nov(ember)?/i,dec:/^dec(ember)?/i,sun:/^su(n(day)?)?/i,mon:/^mo(n(day)?)?/i,tue:/^tu(e(s(day)?)?)?/i,wed:/^we(d(nesday)?)?/i,thu:/^th(u(r(s(day)?)?)?)?/i,fri:/^fr(i(day)?)?/i,sat:/^sa(t(urday)?)?/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|after|from)/i,subtract:/^(\-|before|ago)/i,yesterday:/^yesterday/i,today:/^t(oday)?/i,tomorrow:/^tomorrow/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,second:/^sec(ond)?s?/i,minute:/^min(ute)?s?/i,hour:/^h(ou)?rs?/i,week:/^w(ee)?k/i,month:/^m(o(nth)?s?)?/i,day:/^d(ays?)?/i,year:/^y((ea)?rs?)?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a|p)/i},abbreviatedTimeZoneStandard:{GMT:"-000",EST:"-0400",CST:"-0500",MST:"-0600",PST:"-0700"},abbreviatedTimeZoneDST:{GMT:"-000",EDT:"-0500",CDT:"-0600",MDT:"-0700",PDT:"-0800"}},Date.getMonthNumberFromName=function(a){for(var b=Date.CultureInfo.monthNames,c=Date.CultureInfo.abbreviatedMonthNames,d=a.toLowerCase(),e=0;e<b.length;e++)if(b[e].toLowerCase()==d||c[e].toLowerCase()==d)return e;return-1},Date.getDayNumberFromName=function(a){for(var b=Date.CultureInfo.dayNames,c=Date.CultureInfo.abbreviatedDayNames,d=(Date.CultureInfo.shortestDayNames,a.toLowerCase()),e=0;e<b.length;e++)if(b[e].toLowerCase()==d||c[e].toLowerCase()==d)return e;return-1},Date.isLeapYear=function(a){return a%4===0&&a%100!==0||a%400===0},Date.getDaysInMonth=function(a,b){return[31,Date.isLeapYear(a)?29:28,31,30,31,30,31,31,30,31,30,31][b]},Date.getTimezoneOffset=function(a,b){return b?Date.CultureInfo.abbreviatedTimeZoneDST[a.toUpperCase()]:Date.CultureInfo.abbreviatedTimeZoneStandard[a.toUpperCase()]},Date.getTimezoneAbbreviation=function(a,b){var c,d=b?Date.CultureInfo.abbreviatedTimeZoneDST:Date.CultureInfo.abbreviatedTimeZoneStandard;for(c in d)if(d[c]===a)return c;return null},Date.prototype.clone=function(){return new Date(this.getTime())},Date.prototype.compareTo=function(a){if(isNaN(this))throw new Error(this);if(a instanceof Date&&!isNaN(a))return this>a?1:this<a?-1:0;throw new TypeError(a)},Date.prototype.equals=function(a){return 0===this.compareTo(a)},Date.prototype.between=function(a,b){var c=this.getTime();return c>=a.getTime()&&c<=b.getTime()},Date.prototype.addMilliseconds=function(a){return this.setMilliseconds(this.getMilliseconds()+a),this},Date.prototype.addSeconds=function(a){return this.addMilliseconds(1e3*a)},Date.prototype.addMinutes=function(a){return this.addMilliseconds(6e4*a)},Date.prototype.addHours=function(a){return this.addMilliseconds(36e5*a)},Date.prototype.addDays=function(a){return this.addMilliseconds(864e5*a)},Date.prototype.addWeeks=function(a){return this.addMilliseconds(6048e5*a)},Date.prototype.addMonths=function(a){var b=this.getDate();return this.setDate(1),this.setMonth(this.getMonth()+a),this.setDate(Math.min(b,this.getDaysInMonth())),this},Date.prototype.addYears=function(a){return this.addMonths(12*a)},Date.prototype.add=function(a){if("number"==typeof a)return this._orient=a,this;var b=a;return(b.millisecond||b.milliseconds)&&this.addMilliseconds(b.millisecond||b.milliseconds),(b.second||b.seconds)&&this.addSeconds(b.second||b.seconds),(b.minute||b.minutes)&&this.addMinutes(b.minute||b.minutes),(b.hour||b.hours)&&this.addHours(b.hour||b.hours),(b.month||b.months)&&this.addMonths(b.month||b.months),(b.year||b.years)&&this.addYears(b.year||b.years),(b.day||b.days)&&this.addDays(b.day||b.days),this},Date._validate=function(a,b,c,d){if("number"!=typeof a)throw new TypeError(a+" is not a Number.");if(a<b||a>c)throw new RangeError(a+" is not a valid value for "+d+".");return!0},Date.validateMillisecond=function(a){return Date._validate(a,0,999,"milliseconds")},Date.validateSecond=function(a){return Date._validate(a,0,59,"seconds")},Date.validateMinute=function(a){return Date._validate(a,0,59,"minutes")},Date.validateHour=function(a){return Date._validate(a,0,23,"hours")},Date.validateDay=function(a,b,c){return Date._validate(a,1,Date.getDaysInMonth(b,c),"days")},Date.validateMonth=function(a){return Date._validate(a,0,11,"months")},Date.validateYear=function(a){return Date._validate(a,1,9999,"seconds")},Date.prototype.set=function(a){var b=a;return b.millisecond||0===b.millisecond||(b.millisecond=-1),b.second||0===b.second||(b.second=-1),b.minute||0===b.minute||(b.minute=-1),b.hour||0===b.hour||(b.hour=-1),b.day||0===b.day||(b.day=-1),b.month||0===b.month||(b.month=-1),b.year||0===b.year||(b.year=-1),b.millisecond!=-1&&Date.validateMillisecond(b.millisecond)&&this.addMilliseconds(b.millisecond-this.getMilliseconds()),b.second!=-1&&Date.validateSecond(b.second)&&this.addSeconds(b.second-this.getSeconds()),b.minute!=-1&&Date.validateMinute(b.minute)&&this.addMinutes(b.minute-this.getMinutes()),b.hour!=-1&&Date.validateHour(b.hour)&&this.addHours(b.hour-this.getHours()),b.month!==-1&&Date.validateMonth(b.month)&&this.addMonths(b.month-this.getMonth()),b.year!=-1&&Date.validateYear(b.year)&&this.addYears(b.year-this.getFullYear()),b.day!=-1&&Date.validateDay(b.day,this.getFullYear(),this.getMonth())&&this.addDays(b.day-this.getDate()),b.timezone&&this.setTimezone(b.timezone),b.timezoneOffset&&this.setTimezoneOffset(b.timezoneOffset),this},Date.prototype.clearTime=function(){return this.setHours(0),this.setMinutes(0),this.setSeconds(0),this.setMilliseconds(0),this},Date.prototype.isLeapYear=function(){var a=this.getFullYear();return a%4===0&&a%100!==0||a%400===0},Date.prototype.isWeekday=function(){return!(this.is().sat()||this.is().sun())},Date.prototype.getDaysInMonth=function(){return Date.getDaysInMonth(this.getFullYear(),this.getMonth())},Date.prototype.moveToFirstDayOfMonth=function(){return this.set({day:1})},Date.prototype.moveToLastDayOfMonth=function(){return this.set({day:this.getDaysInMonth()})},Date.prototype.moveToDayOfWeek=function(a,b){var c=(a-this.getDay()+7*(b||1))%7;return this.addDays(0===c?c+=7*(b||1):c)},Date.prototype.moveToMonth=function(a,b){var c=(a-this.getMonth()+12*(b||1))%12;return this.addMonths(0===c?c+=12*(b||1):c)},Date.prototype.getDayOfYear=function(){return Math.floor((this-new Date(this.getFullYear(),0,1))/864e5)},Date.prototype.getWeekOfYear=function(a){var b=this.getFullYear(),c=this.getMonth(),d=this.getDate(),e=a||Date.CultureInfo.firstDayOfWeek,f=8-new Date(b,0,1).getDay();8==f&&(f=1);var g=(Date.UTC(b,c,d,0,0,0)-Date.UTC(b,0,1,0,0,0))/864e5+1,h=Math.floor((g-f+7)/7);if(h===e){b--;var i=8-new Date(b,0,1).getDay();h=2==i||8==i?53:52}return h},Date.prototype.isDST=function(){return console.log("isDST"),"D"==this.toString().match(/(E|C|M|P)(S|D)T/)[2]},Date.prototype.getTimezone=function(){return Date.getTimezoneAbbreviation(this.getUTCOffset,this.isDST())},Date.prototype.setTimezoneOffset=function(a){var b=this.getTimezoneOffset(),c=Number(a)*-6/10;return this.addMinutes(c-b),this},Date.prototype.setTimezone=function(a){return this.setTimezoneOffset(Date.getTimezoneOffset(a))},Date.prototype.getUTCOffset=function(){var a,b=this.getTimezoneOffset()*-10/6;return b<0?(a=(b-1e4).toString(),a[0]+a.substr(2)):(a=(b+1e4).toString(),"+"+a.substr(1))},Date.prototype.getDayName=function(a){return a?Date.CultureInfo.abbreviatedDayNames[this.getDay()]:Date.CultureInfo.dayNames[this.getDay()]},Date.prototype.getMonthName=function(a){return a?Date.CultureInfo.abbreviatedMonthNames[this.getMonth()]:Date.CultureInfo.monthNames[this.getMonth()]},Date.prototype._toString=Date.prototype.toString,Date.prototype.toString=function(a){var b=this,c=function(a){return 1==a.toString().length?"0"+a:a};return a?a.replace(/dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?/g,function(a){switch(a){case"hh":return c(b.getHours()<13?b.getHours():b.getHours()-12);case"h":return b.getHours()<13?b.getHours():b.getHours()-12;case"HH":return c(b.getHours());case"H":return b.getHours();case"mm":return c(b.getMinutes());case"m":return b.getMinutes();case"ss":return c(b.getSeconds());case"s":return b.getSeconds();case"yyyy":return b.getFullYear();case"yy":return b.getFullYear().toString().substring(2,4);case"dddd":return b.getDayName();case"ddd":return b.getDayName(!0);case"dd":return c(b.getDate());case"d":return b.getDate().toString();case"MMMM":return b.getMonthName();case"MMM":return b.getMonthName(!0);case"MM":return c(b.getMonth()+1);case"M":return b.getMonth()+1;case"t":return b.getHours()<12?Date.CultureInfo.amDesignator.substring(0,1):Date.CultureInfo.pmDesignator.substring(0,1);case"tt":return b.getHours()<12?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator;case"zzz":case"zz":case"z":return""}}):this._toString()},Date.now=function(){return new Date},Date.today=function(){return Date.now().clearTime()},Date.prototype._orient=1,Date.prototype.next=function(){return this._orient=1,this},Date.prototype.last=Date.prototype.prev=Date.prototype.previous=function(){return this._orient=-1,this},Date.prototype._is=!1,Date.prototype.is=function(){return this._is=!0,this},Number.prototype._dateElement="day",Number.prototype.fromNow=function(){var a={};return a[this._dateElement]=this,Date.now().add(a)},Number.prototype.ago=function(){var a={};return a[this._dateElement]=this*-1,Date.now().add(a)},function(){for(var a,b=Date.prototype,c=Number.prototype,d="sunday monday tuesday wednesday thursday friday saturday".split(/\s/),e="january february march april may june july august september october november december".split(/\s/),f="Millisecond Second Minute Hour Day Week Month Year".split(/\s/),g=function(a){return function(){return this._is?(this._is=!1,this.getDay()==a):this.moveToDayOfWeek(a,this._orient)}},h=0;h<d.length;h++)b[d[h]]=b[d[h].substring(0,3)]=g(h);for(var i=function(a){return function(){return this._is?(this._is=!1,this.getMonth()===a):this.moveToMonth(a,this._orient)}},j=0;j<e.length;j++)b[e[j]]=b[e[j].substring(0,3)]=i(j);for(var k=function(a){return function(){return"s"!=a.substring(a.length-1)&&(a+="s"),this["add"+a](this._orient)}},l=function(a){return function(){return this._dateElement=a,this}},m=0;m<f.length;m++)a=f[m].toLowerCase(),b[a]=b[a+"s"]=k(f[m]),c[a]=c[a+"s"]=l(a)}(),Date.prototype.toJSONString=function(){return this.toString("yyyy-MM-ddThh:mm:ssZ")},Date.prototype.toShortDateString=function(){return this.toString(Date.CultureInfo.formatPatterns.shortDatePattern)},Date.prototype.toLongDateString=function(){return this.toString(Date.CultureInfo.formatPatterns.longDatePattern)},Date.prototype.toShortTimeString=function(){return this.toString(Date.CultureInfo.formatPatterns.shortTimePattern)},Date.prototype.toLongTimeString=function(){return this.toString(Date.CultureInfo.formatPatterns.longTimePattern)},Date.prototype.getOrdinal=function(){switch(this.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}},function(){Date.Parsing={Exception:function(a){this.message="Parse error at '"+a.substring(0,10)+" ...'"}};for(var a=Date.Parsing,b=a.Operators={rtoken:function(b){return function(c){var d=c.match(b);if(d)return[d[0],c.substring(d[0].length)];throw new a.Exception(c)}},token:function(a){return function(a){return b.rtoken(new RegExp("^s*"+a+"s*"))(a)}},stoken:function(a){return b.rtoken(new RegExp("^"+a))},until:function(a){return function(b){for(var c=[],d=null;b.length;){try{d=a.call(this,b)}catch(e){c.push(d[0]),b=d[1];continue}break}return[c,b]}},many:function(a){return function(b){for(var c=[],d=null;b.length;){try{d=a.call(this,b)}catch(e){return[c,b]}c.push(d[0]),b=d[1]}return[c,b]}},optional:function(a){return function(b){var c=null;try{c=a.call(this,b)}catch(d){return[null,b]}return[c[0],c[1]]}},not:function(b){return function(c){try{b.call(this,c)}catch(d){return[null,c]}throw new a.Exception(c)}},ignore:function(a){return a?function(b){var c=null;return c=a.call(this,b),[null,c[1]]}:null},product:function(){for(var a=arguments[0],c=Array.prototype.slice.call(arguments,1),d=[],e=0;e<a.length;e++)d.push(b.each(a[e],c));return d},cache:function(b){var c={},d=null;return function(e){try{d=c[e]=c[e]||b.call(this,e)}catch(f){d=c[e]=f}if(d instanceof a.Exception)throw d;return d}},any:function(){var b=arguments;return function(c){for(var d=null,e=0;e<b.length;e++)if(null!=b[e]){try{d=b[e].call(this,c)}catch(f){d=null}if(d)return d}throw new a.Exception(c)}},each:function(){var b=arguments;return function(c){for(var d=[],e=null,f=0;f<b.length;f++)if(null!=b[f]){try{e=b[f].call(this,c)}catch(g){throw new a.Exception(c)}d.push(e[0]),c=e[1]}return[d,c]}},all:function(){var a=arguments,b=b;return b.each(b.optional(a))},sequence:function(c,d,e){return d=d||b.rtoken(/^\s*/),e=e||null,1==c.length?c[0]:function(b){for(var f=null,g=null,h=[],i=0;i<c.length;i++){try{f=c[i].call(this,b)}catch(j){break}h.push(f[0]);try{g=d.call(this,f[1])}catch(k){g=null;break}b=g[1]}if(!f)throw new a.Exception(b);if(g)throw new a.Exception(g[1]);if(e)try{f=e.call(this,f[1])}catch(l){throw new a.Exception(f[1])}return[h,f?f[1]:b]}},between:function(a,c,d){d=d||a;var e=b.each(b.ignore(a),c,b.ignore(d));return function(a){var b=e.call(this,a);return[[b[0][0],r[0][2]],b[1]]}},list:function(a,c,d){return c=c||b.rtoken(/^\s*/),d=d||null,a instanceof Array?b.each(b.product(a.slice(0,-1),b.ignore(c)),a.slice(-1),b.ignore(d)):b.each(b.many(b.each(a,b.ignore(c))),px,b.ignore(d))},set:function(c,d,e){return d=d||b.rtoken(/^\s*/),e=e||null,function(f){for(var g=null,h=null,i=null,j=null,k=[[],f],l=!1,m=0;m<c.length;m++){i=null,h=null,g=null,l=1==c.length;try{g=c[m].call(this,f)}catch(n){continue}if(j=[[g[0]],g[1]],g[1].length>0&&!l)try{i=d.call(this,g[1])}catch(o){l=!0}else l=!0;if(l||0!==i[1].length||(l=!0),!l){for(var p=[],q=0;q<c.length;q++)m!=q&&p.push(c[q]);h=b.set(p,d).call(this,i[1]),h[0].length>0&&(j[0]=j[0].concat(h[0]),j[1]=h[1])}if(j[1].length<k[1].length&&(k=j),0===k[1].length)break}if(0===k[0].length)return k;if(e){try{i=e.call(this,k[1])}catch(r){throw new a.Exception(k[1])}k[1]=i[1]}return k}},forward:function(a,b){return function(c){return a[b].call(this,c)}},replace:function(a,b){return function(c){var d=a.call(this,c);return[b,d[1]]}},process:function(a,b){return function(c){var d=a.call(this,c);return[b.call(this,d[0]),d[1]]}},min:function(b,c){return function(d){var e=c.call(this,d);if(e[0].length<b)throw new a.Exception(d);return e}}},c=function(a){return function(){var b=null,c=[];if(arguments.length>1?b=Array.prototype.slice.call(arguments):arguments[0]instanceof Array&&(b=arguments[0]),!b)return a.apply(null,arguments);for(var d=0,e=b.shift();d<e.length;d++)return b.unshift(e[d]),c.push(a.apply(null,b)),b.shift(),c}},d="optional not ignore cache".split(/\s/),e=0;e<d.length;e++)b[d[e]]=c(b[d[e]]);for(var f=function(a){return function(){return arguments[0]instanceof Array?a.apply(null,arguments[0]):a.apply(null,arguments)}},g="each any all".split(/\s/),h=0;h<g.length;h++)b[g[h]]=f(b[g[h]])}(),function(){var a=function(b){for(var c=[],d=0;d<b.length;d++)b[d]instanceof Array?c=c.concat(a(b[d])):b[d]&&c.push(b[d]);return c};Date.Grammar={},Date.Translator={hour:function(a){return function(){this.hour=Number(a)}},minute:function(a){return function(){this.minute=Number(a)}},second:function(a){return function(){this.second=Number(a)}},meridian:function(a){return function(){this.meridian=a.slice(0,1).toLowerCase()}},timezone:function(a){return function(){var b=a.replace(/[^\d\+\-]/g,"");b.length?this.timezoneOffset=Number(b):this.timezone=a.toLowerCase()}},day:function(a){var b=a[0];return function(){this.day=Number(b.match(/\d+/)[0])}},month:function(a){return function(){this.month=3==a.length?Date.getMonthNumberFromName(a):Number(a)-1}},year:function(a){return function(){var b=Number(a);this.year=a.length>2?b:b+(b+2e3<Date.CultureInfo.twoDigitYearMax?2e3:1900)}},rday:function(a){return function(){switch(a){case"yesterday":this.days=-1;break;case"tomorrow":this.days=1;break;case"today":this.days=0;break;case"now":this.days=0,this.now=!0}}},finishExact:function(a){a=a instanceof Array?a:[a];var b=new Date;this.year=b.getFullYear(),this.month=b.getMonth(),this.day=1,this.hour=0,this.minute=0,this.second=0;for(var c=0;c<a.length;c++)a[c]&&a[c].call(this);if(this.hour="p"==this.meridian&&this.hour<13?this.hour+12:this.hour,this.day>Date.getDaysInMonth(this.year,this.month))throw new RangeError(this.day+" is not a valid value for days.");var d=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second);return this.timezone?d.set({timezone:this.timezone}):this.timezoneOffset&&d.set({timezoneOffset:this.timezoneOffset}),d},finish:function(b){if(b=b instanceof Array?a(b):[b],0===b.length)return null;for(var c=0;c<b.length;c++)"function"==typeof b[c]&&b[c].call(this);if(this.now)return new Date;var d=Date.today(),e=!(null==this.days&&!this.orient&&!this.operator);if(e){var f,g,h;return h="past"==this.orient||"subtract"==this.operator?-1:1,this.weekday&&(this.unit="day",f=Date.getDayNumberFromName(this.weekday)-d.getDay(),g=7,this.days=f?(f+h*g)%g:h*g),this.month&&(this.unit="month",f=this.month-d.getMonth(),g=12,this.months=f?(f+h*g)%g:h*g,this.month=null),this.unit||(this.unit="day"),null!=this[this.unit+"s"]&&null==this.operator||(this.value||(this.value=1),"week"==this.unit&&(this.unit="day",this.value=7*this.value),this[this.unit+"s"]=this.value*h),d.add(this)}return this.meridian&&this.hour&&(this.hour=this.hour<13&&"p"==this.meridian?this.hour+12:this.hour),this.weekday&&!this.day&&(this.day=d.addDays(Date.getDayNumberFromName(this.weekday)-d.getDay()).getDate()),this.month&&!this.day&&(this.day=1),d.set(this)}};var b,c=Date.Parsing.Operators,d=Date.Grammar,e=Date.Translator;d.datePartDelimiter=c.rtoken(/^([\s\-\.\,\/\x27]+)/),d.timePartDelimiter=c.stoken(":"),d.whiteSpace=c.rtoken(/^\s*/),d.generalDelimiter=c.rtoken(/^(([\s\,]|at|on)+)/);var f={};d.ctoken=function(a){var b=f[a];if(!b){for(var d=Date.CultureInfo.regexPatterns,e=a.split(/\s+/),g=[],h=0;h<e.length;h++)g.push(c.replace(c.rtoken(d[e[h]]),e[h]));b=f[a]=c.any.apply(null,g)}return b},d.ctoken2=function(a){return c.rtoken(Date.CultureInfo.regexPatterns[a])},d.h=c.cache(c.process(c.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),e.hour)),d.hh=c.cache(c.process(c.rtoken(/^(0[0-9]|1[0-2])/),e.hour)),d.H=c.cache(c.process(c.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),e.hour)),d.HH=c.cache(c.process(c.rtoken(/^([0-1][0-9]|2[0-3])/),e.hour)),d.m=c.cache(c.process(c.rtoken(/^([0-5][0-9]|[0-9])/),e.minute)),d.mm=c.cache(c.process(c.rtoken(/^[0-5][0-9]/),e.minute)),d.s=c.cache(c.process(c.rtoken(/^([0-5][0-9]|[0-9])/),e.second)),d.ss=c.cache(c.process(c.rtoken(/^[0-5][0-9]/),e.second)),d.hms=c.cache(c.sequence([d.H,d.mm,d.ss],d.timePartDelimiter)),d.t=c.cache(c.process(d.ctoken2("shortMeridian"),e.meridian)),d.tt=c.cache(c.process(d.ctoken2("longMeridian"),e.meridian)),d.z=c.cache(c.process(c.rtoken(/^(\+|\-)?\s*\d\d\d\d?/),e.timezone)),d.zz=c.cache(c.process(c.rtoken(/^(\+|\-)\s*\d\d\d\d/),e.timezone)),d.zzz=c.cache(c.process(d.ctoken2("timezone"),e.timezone)),d.timeSuffix=c.each(c.ignore(d.whiteSpace),c.set([d.tt,d.zzz])),d.time=c.each(c.optional(c.ignore(c.stoken("T"))),d.hms,d.timeSuffix),d.d=c.cache(c.process(c.each(c.rtoken(/^([0-2]\d|3[0-1]|\d)/),c.optional(d.ctoken2("ordinalSuffix"))),e.day)),d.dd=c.cache(c.process(c.each(c.rtoken(/^([0-2]\d|3[0-1])/),c.optional(d.ctoken2("ordinalSuffix"))),e.day)),d.ddd=d.dddd=c.cache(c.process(d.ctoken("sun mon tue wed thu fri sat"),function(a){return function(){this.weekday=a}})),d.M=c.cache(c.process(c.rtoken(/^(1[0-2]|0\d|\d)/),e.month)),d.MM=c.cache(c.process(c.rtoken(/^(1[0-2]|0\d)/),e.month)),d.MMM=d.MMMM=c.cache(c.process(d.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),e.month)),d.y=c.cache(c.process(c.rtoken(/^(\d\d?)/),e.year)),d.yy=c.cache(c.process(c.rtoken(/^(\d\d)/),e.year)),d.yyy=c.cache(c.process(c.rtoken(/^(\d\d?\d?\d?)/),e.year)),d.yyyy=c.cache(c.process(c.rtoken(/^(\d\d\d\d)/),e.year)),b=function(){return c.each(c.any.apply(null,arguments),c.not(d.ctoken2("timeContext")))},d.day=b(d.d,d.dd),d.month=b(d.M,d.MMM),d.year=b(d.yyyy,d.yy),d.orientation=c.process(d.ctoken("past future"),function(a){return function(){this.orient=a}}),d.operator=c.process(d.ctoken("add subtract"),function(a){return function(){this.operator=a}}),d.rday=c.process(d.ctoken("yesterday tomorrow today now"),e.rday),d.unit=c.process(d.ctoken("minute hour day week month year"),function(a){return function(){this.unit=a}}),d.value=c.process(c.rtoken(/^\d\d?(st|nd|rd|th)?/),function(a){return function(){this.value=a.replace(/\D/g,"")}}),d.expression=c.set([d.rday,d.operator,d.value,d.unit,d.orientation,d.ddd,d.MMM]),b=function(){return c.set(arguments,d.datePartDelimiter)},d.mdy=b(d.ddd,d.month,d.day,d.year),d.ymd=b(d.ddd,d.year,d.month,d.day),d.dmy=b(d.ddd,d.day,d.month,d.year),d.date=function(a){return(d[Date.CultureInfo.dateElementOrder]||d.mdy).call(this,a)},d.format=c.process(c.many(c.any(c.process(c.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(a){if(d[a])return d[a];throw Date.Parsing.Exception(a)}),c.process(c.rtoken(/^[^dMyhHmstz]+/),function(a){return c.ignore(c.stoken(a))}))),function(a){return c.process(c.each.apply(null,a),e.finishExact)});var g={},h=function(a){return g[a]=g[a]||d.format(a)[0]};d.formats=function(a){if(a instanceof Array){for(var b=[],d=0;d<a.length;d++)b.push(h(a[d]));return c.any.apply(null,b)}return h(a)},d._formats=d.formats(["yyyy-MM-ddTHH:mm:ss","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","d"]),d._start=c.process(c.set([d.date,d.time,d.expression],d.generalDelimiter,d.whiteSpace),e.finish),d.start=function(a){try{var b=d._formats.call({},a);if(0===b[1].length)return b}catch(c){}return d._start.call({},a)}}(),Date._parse=Date.parse,Date.parse=function(a){var b=null;if(!a)return null;try{b=Date.Grammar.start.call({},a)}catch(c){return null}return 0===b[1].length?b[0]:null},Date.getParseFunction=function(a){var b=Date.Grammar.formats(a);return function(a){var c=null;try{c=b.call({},a)}catch(d){return null}return 0===c[1].length?c[0]:null}},Date.parseExact=function(a,b){return Date.getParseFunction(b)(a)},"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(a){return this.indexOf(a,this.length-a.length)!==-1}),"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(a){return void 0!=a&&this.slice(0,a.length)==a}),String.prototype.format=String.prototype.f=function(){for(var a=this,b=arguments.length;b--;)a=a.replace(new RegExp("\\{"+b+"\\}","gm"),arguments[b]);return a},String.prototype.equalsAny=String.prototype.f=function(){for(var a=this,b=arguments.length;b--;)if(arguments[b].isEqual(a,!0))return!0;return!1},String.prototype.nullOrEmpty=String.prototype.f=function(){var a=this;return 0==a.trim().length},String.prototype.isEqual=String.prototype.f=function(a,b){var c=this;return b?null!=a&&c.toLowerCase()==a.toLowerCase():c==a},String.prototype.equalIc=String.prototype.f=function(a){var b=this;return null!=a&&b.toLowerCase()==a.toLowerCase()},String.prototype.equalsIc=String.prototype.f=function(){return arguments[0].isEqual(this,!0)};var nullOrEmpty=function(a){return nullOrUndef(a)||0==String(a).trim().length},isArrayNullOrEmpty=function(a){return nullOrUndef(a)||0==a.length};String.format=function(){for(var a=arguments[0],b=0;b<arguments.length-1;b++){var c=new RegExp("\\{"+b+"\\}","gm");
a=a.replace(c,arguments[b+1])}return a},"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(a){return this.indexOf(a,this.length-a.length)!==-1}),"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(a){return void 0!=a&&this.slice(0,a.length)==a});var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"Other",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"Unknown"},searchString:function(a){for(var b=0;b<a.length;b++){var c=a[b].string;if(this.versionSearchString=a[b].subString,c.indexOf(a[b].subString)!=-1)return a[b].identity}},searchVersion:function(a){var b=a.indexOf(this.versionSearchString);if(b!=-1)return parseFloat(a.substring(b+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.userAgent,subString:"Safari",identity:"Safari"},{string:navigator.userAgent,subString:"Opera",identity:"Opera"}]};BrowserDetect.init(),Date.prototype.mmddyyyy=Date.prototype.f=function(){var a=this.getFullYear().toString(),b=(this.getMonth()+1).toString(),c=this.getDate().toString();return(b[1]?b:"0"+b[0])+"/"+(c[1]?c:"0"+c[0])+"/"+a},String.prototype.format=String.prototype.f=function(){for(var a=this,b=arguments.length;b--;)a=a.replace(new RegExp("\\{"+b+"\\}","gm"),arguments[b]);return a},String.prototype.nullOrEmpty=String.prototype.f=function(){var a=this;return 0==a.trim().length},String.prototype.isEqual=String.prototype.f=function(a,b){var c=this;return b?null!=a&&c.toLowerCase()==a.toLowerCase():c==a};var nullOrEmpty=function(a){return nullOrUndef(a)||0==String(a).trim().length},isArrayNullOrEmpty=function(a){return nullOrUndef(a)||0==a.length},isObjectEmpty=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0};String.format=function(){for(var a=arguments[0],b=0;b<arguments.length-1;b++){var c=new RegExp("\\{"+b+"\\}","gm");a=a.replace(c,arguments[b+1])}return a},$.extend({findFirst:function(a,b){var c;for(c=0;c<a.length;++c)if(b(a[c],c))return a[c]}}),$.extend({keys:function(a){var b=[];return $.each(a,function(a){b.push(a)}),b}});var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(a){for(var b,c,d,e,f,g,h,i="",j=0;j<a.length;)b=a.charCodeAt(j++),c=a.charCodeAt(j++),d=a.charCodeAt(j++),e=b>>2,f=(3&b)<<4|c>>4,g=(15&c)<<2|d>>6,h=63&d,isNaN(c)?g=h=64:isNaN(d)&&(h=64),i=i+this._keyStr.charAt(e)+this._keyStr.charAt(f)+this._keyStr.charAt(g)+this._keyStr.charAt(h);return i},decode:function(a){var b,c,d,e,f,g,h,i="",j=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");j<a.length;)e=this._keyStr.indexOf(a.charAt(j++)),f=this._keyStr.indexOf(a.charAt(j++)),g=this._keyStr.indexOf(a.charAt(j++)),h=this._keyStr.indexOf(a.charAt(j++)),b=e<<2|f>>4,c=(15&f)<<4|g>>2,d=(3&g)<<6|h,i+=String.fromCharCode(b),64!=g&&(i+=String.fromCharCode(c)),64!=h&&(i+=String.fromCharCode(d));return i},_utf8_encode:function(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);d<128?b+=String.fromCharCode(d):d>127&&d<2048?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(63&d|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(63&d|128))}return b},_utf8_decode:function(a){for(var b="",c=0,d=c1=c2=0;c<a.length;)d=a.charCodeAt(c),d<128?(b+=String.fromCharCode(d),c++):d>191&&d<224?(c2=a.charCodeAt(c+1),b+=String.fromCharCode((31&d)<<6|63&c2),c+=2):(c2=a.charCodeAt(c+1),c3=a.charCodeAt(c+2),b+=String.fromCharCode((15&d)<<12|(63&c2)<<6|63&c3),c+=3);return b}},app=angular.module("sw_layout",["pasvaz.bindonce","angularTreeview","ngSanitize"]).config(function(a){});app.filter("linebreak",function(){return function(a){return null!=a?(a=a.toString(),a.replace(/\n/g,"<br/>")):a}}),app.filter("html",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}]),app.directive("onFinishRender",function(a){return{restrict:"A",link:function(b,c,d){b.$last===!0&&a(function(){b.$emit("ngRepeatFinished")})}}}),app.directive("ngEnter",function(){return function(a,b,c){b.bind("keypress",function(b){13===b.which&&(a.$apply(function(){a.$eval(c.ngEnter)}),b.preventDefault())})}}),app.directive("ngEnabled",function(){return{restrict:"A",link:function(a,b,c){a.$watch(c.ngEnabled,function(a){a?b.removeAttr("disabled"):b.attr("disabled","disabled")})}}}),function(angular,a){"use strict";angular.module("sw_layout").config(["$httpProvider",function(b){b.interceptors.push(function(b,c,d,e,f,g,h){function i(a){var b=e.retrieveFromContext("successMessageTimeOut");if(null!=a.successMessage){var f=e.fetchFromContext("refreshscreen",!1,!0);f?(e.insertIntoContext("onloadMessage",a.successMessage),e.deleteFromContext("refreshscreen")):(c.$broadcast("sw_successmessage",a),d(function(){c.$broadcast("sw_successmessagetimeout",{successMessage:null})},b))}}var j=0,k=function(a){lockCommandBars(),lockTabs(),a.headers.currentmodule=e.retrieveFromContext("currentmodule"),a.headers.currentmetadata=e.retrieveFromContext("currentmetadata"),a.headers.mockerror=sessionStorage.mockerror,a.headers.requesttime=(new Date).getTime(),a.headers.cachedschemas=h.getSchemaCacheKeys(),a.headers.printmode=a.printMode;var b=f.getInstance("sw4.ajaxint#started"),d=!1;(j<=0||a.url.indexOf("/Content/")<0)&&(b.isLevelEnabled("trace")||b.info("started request {0}".format(a.url)),d=a.avoidspin,d||(j++,c.$broadcast("sw_ajaxinit"))),b.trace("url: {0} | current module:{1} | current metadata:{2} ".format(a.url,a.headers.currentmodule,a.headers.currentmetadata)),j++},l=function(b){a("[rel=tooltip]").tooltip("hide"),j--;var d=f.getInstance("sw4.ajaxint#endedok");d.trace("status :{0}, url: {1} ".format(b.status,b.config.url));var e=!1;e=b.config.avoidspin,e||j--,j<=0&&(unLockCommandBars(),unLockTabs(),d.info("Requests ended"),c.$broadcast("sw_ajaxend",b.data),i(b.data))},m=function(b){return a("[rel=tooltip]").tooltip("hide"),401===b.status?void(window.location=url("")):(j--,unLockCommandBars(),unLockTabs(),void(j<=0&&c.$broadcast("sw_ajaxerror",b.data,b.status)))};return{request:function(a){return k(a),a||b.when(a)},response:function(a){return l(a),a||b.when(a)},responseError:function(a){return m(a),b.reject(a)}}}),b.defaults.transformRequest.push(function(a,b){if(void 0==a)return a;if(sessionStorage.mockerror||sessionStorage.mockmaximo){var c=JSON.parse(a);return c["%%mockerror"]="true"===sessionStorage.mockerror,c["%%mockmaximo"]="true"===sessionStorage.mockmaximo,JSON.stringify(c)}return a})}]),window.onpopstate=function(a){a.state&&(document.getElementById("content").innerHTML=a.state.html,document.title=a.state.pageTitle)}}(angular,jQuery);var app=angular.module("sw_layout");app.directive("bodyrendered",function(a,b,c){return{restrict:"A",link:function(d,e,f){"output"!==d.schema.mode&&d.isSelectEnabled&&e.data("selectenabled",d.isSelectEnabled(d.fieldMetadata)),d.$last===!0&&a(function(){var a=d.elementid;b.getInstance("application_dir#bodyrendered").debug("sw_body_rendered will get dispatched"),c.adjustHeight(),d.$emit("sw_bodyrenderedevent",a)})}}}),app.directive("listtablerendered",function(a,b,c){return{restrict:"A",link:function(c,d,e){var f=b.getInstance("application_dir#bodyrendered");c.$first?f.debug("init list table rendered"):f.trace("list table rendered"),c.$last!==!0&&0!=c.datamap.length||a(function(){f.debug("list table rendered will get dispatched"),c.$emit("listTableRenderedEvent")})}}}),app.directive("filterrowrendered",function(a){return{restrict:"A",link:function(b,c,d){b.$last===!0&&a(function(){b.$emit("filterRowRenderedEvent")})}}}),function(app,angular,a){"use strict";app.directive("expandedItemOutput",function(a){return{restrict:"E",replace:!0,scope:{displayables:"=",schema:"=",datamap:"=",cancelfn:"&"},template:"<div></div>",link:function(b,c,d){angular.isArray(b.displayables)&&(c.append("<crud-output schema='schema'datamap='datamap'displayables='displayables'cancelfn='cancelfn()'></crud-output>"),a(c.contents())(b))}}}),app.directive("expandedItemInput",function(a){return{restrict:"E",replace:!0,scope:{displayables:"=",schema:"=",datamap:"=",associationOptions:"=",savefn:"&",cancelfn:"&"},template:"<div></div>",link:function(b,c,d){angular.isArray(b.displayables)&&(c.append("<crud-input schema='schema'datamap='datamap'displayables='displayables'associationOptions='associationOptions'savefn='savefn()'cancelfn='cancelfn()'></crud-input>"),a(c.contents())(b))}}}),app.directive("newItemInput",function(b){return{restrict:"E",replace:!0,scope:{displayables:"=",elementid:"=",schema:"=",datamap:"=",associationOptions:"=",cancelfn:"&",savefn:"&"},template:"<div></div>",link:function(c,d,e){angular.isArray(c.displayables)&&(a.each(c.displayables,function(a,b){var d=b.attribute;void 0!=b.defaultValue&&void 0!=d&&null==c.datamap[d]&&(c.datamap[d]=b.defaultValue)}),d.append("<crud-input schema='schema'datamap='datamap'displayables='displayables'elementid='elementid'associationOptions='associationOptions'savefn='savefn()'cancelfn='cancelfn()'></crud-input>"),b(d.contents())(c))}}}),app.directive("compositionListWrapper",function(a,b,c,d,e,f){return{restrict:"E",replace:!0,template:"<div></div>",scope:{metadata:"=",parentschema:"=",parentdata:"=",cancelfn:"&",previousschema:"=",previousdata:"=",inline:"@",tabid:"@"},link:function(d,g,h){var i=function(){c.getInstance("compositionlistwrapper#doLoad").debug("loading composition {0}".format(d.tabid));var e=d.metadata;d.tabLabel=b.get18nValue(e.schema.schemas.list.applicationName+"._title",e.label),d.parentdata.fields?d.compositiondata=d.parentdata.fields[d.metadata.relationship]:d.compositiondata=d.parentdata[d.metadata.relationship],d.compositionschemadefinition=e.schema,d.relationship=e.relationship,g.append("<composition-list title='{{tabLabel}}'compositionschemadefinition='compositionschemadefinition'relationship='{{relationship}}'compositiondata='compositiondata'parentschema='parentschema'parentdata='parentdata'cancelfn='toListSchema(data,schema)'previousschema='previousschema' previousdata='previousdata'/>"),a(g.contents())(d),d.loaded=!0},j="custom"==d.metadata.schema.renderer.rendererType,k=d.metadata.inline;"ApplicationCompositionDefinition"==d.metadata.type&&k&&!j&&i(),d.$on("sw_lazyloadtab",function(a,b){d.tabid==b&&(f.isCompositionLodaded(d.tabid)||e.start({compositionSpin:!0}),d.tabid!=b||d.loaded||i())})}}}),app.directive("compositionList",function(b,c){return{restrict:"E",replace:!0,templateUrl:b.getResourceUrl("/Content/Templates/crud/composition_list.html"),scope:{compositionschemadefinition:"=",compositiondata:"=",parentdata:"=",relationship:"@",title:"@",cancelfn:"&",previousschema:"=",previousdata:"=",parentschema:"="},controller:["$scope","$log","$filter","$injector","$http","$element","$rootScope","i18NService","tabsService","formatService","fieldService","commandService","compositionService","validationService","expressionService","$timeout",function(d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){function t(){d.compositionlistschema=d.compositionschemadefinition.schemas.list,d.compositiondetailschema=d.compositionschemadefinition.schemas.detail,d.fetchfromserver=d.compositionschemadefinition.fetchFromServer,d.collectionproperties=d.compositionschemadefinition.collectionProperties,d.inline=d.compositionschemadefinition.inline,d.clonedCompositionData=[],jQuery.extend(d.clonedCompositionData,d.compositiondata),d.isNoRecords=!(d.clonedCompositionData.length>0),d.detailData={},d.noupdateallowed=!r.evaluate(d.collectionproperties.allowUpdate,d.parentdata),d.expanded=!1,d.wasExpandedBefore=!1,d.isReadonly=!r.evaluate(d.collectionproperties.allowUpdate,d.parentdata),g.invoke(BaseController,this,{$scope:d,i18NService:k,fieldService:n,commandService:o}),d.paginationData||(d.paginationData=b.get("compositionpagination_{0}".format(d.relationship),!0,!0),d.paginationData&&(d.paginationData.selectedPage=d.paginationData.pageNumber)),d.showPagination=!d.isNoRecords&&!!d.paginationData&&d.paginationData.paginationOptions.some(function(a){return d.paginationData.totalCount>a}),d.$on("sw_ajaxerror",function(){a(document.body).animate({scrollTop:0})})}function u(){var a={};a.key={},a.options={},a.application=d.parentschema.applicationName,a.detailRequest={};var b={};a.detailRequest.key=b;var c=d.parentschema;a.detailRequest.id=n.getId(d.parentdata,c),b.schemaId=c.schemaId,b.mode=c.mode,b.platform=platform();var e={};return e[d.relationship]={schema:d.compositionlistschema,value:!0},a.options.compositionsToExpand=l.buildCompositionsToExpand(e,c,d.parentdata,d.compositiondetailschema.schemaId,[],!1),a.options.printMode=!0,a}t(),d.compositionProvider=function(){var a={},b=[];a.toAdd=b;var c=e.getInstance("composition_service#compositionProvider");if(a.toKeep=p.getListCommandsToKeep(d.compositionschemadefinition),!r.evaluate(d.collectionproperties.allowInsertion,d.parentdata)||d.inline)return c.debug("local commands without add. {0} ".format(JSON.stringify(a))),a;var f={};return f.label=d.i18N(d.relationship+".add","Add "+d.title),f.method=d.newDetailFn,f.defaultPosition="left",b.push(f),c.debug("local commands: {0} ".format(JSON.stringify(a))),a},d.newDetailFn=function(b){d.newDetail=!0,d.selecteditem={},d.collapseAll(),s(function(){var c=a(".js_compositionnewitem");c[0]||(c=a(b.delegateTarget)),a(document.body).animate({scrollTop:c.offset().top})},500,!1)};var v=function(a,b,c){void 0==d.detailData[a]&&(d.detailData[a]={},d.detailData[a].expanded=!1),d.detailData[a].data=b;var e=void 0!=c?c:!d.detailData[a].expanded;d.detailData[a].expanded=e};d.toggleDetails=function(c,e){b.insertIntoContext("sw:crudbody:scrolltop",!1);var f=d.compositionlistschema.properties["list.click.service"];if(null!=f)return void o.executeClickCustomCommand(f,c,d.compositionlistschema.displayables);d.isReadOnly=!e;var g=c[d.compositionlistschema.idFieldName];if(!d.fetchfromserver)return void v(g,c);if(void 0!=d.detailData[g])return void v(g,d.detailData[g].data);var k=d.compositiondetailschema,l=k.applicationName,m={},n={},p={};m.request=n,n.id=g,n.key=p,p.schemaId=k.schemaId,p.mode=k.mode,p.platform="web";var q=url("/api/data/"+l+"?"+a.param(m));h.get(q).then(function(a){var b=a.data;v(g,b.resultObject.fields),j.$broadcast("sw_bodyrenderedevent",i.parents(".tab-pane").attr("id"))}).then(function(){})},d.getGridColumnStyle=function(b,c){var d=b.rendererParameters[c];if(null!=d)return d;if("maxwidth"===c){var e=a(window).width()>1199;return e?"135px":"100px"}return null},d.$on("sw_compositiondataresolved",function(a,b){b[d.relationship]&&(c.stop({compositionSpin:!0}),d.paginationData=b[d.relationship].paginationData,d.paginationData&&(d.paginationData.selectedPage=d.paginationData.pageNumber),d.compositiondata=b[d.relationship].list,t(),d.$$phase||d.$root.$$phase||d.$digest())}),d.cancelComposition=function(){d.newDetail=!1},d.cancel=function(b,c){a("#crudmodal").modal("hide"),"browser"==GetPopUpMode()&&close(),d.cancelfn({data:d.previousdata,schema:d.previousschema}),d.$emit("sw_cancelclicked")},d.refresh=function(){window.location.href=window.location.href},d.allowButton=function(a){return r.evaluate(a,d.parentdata)&&d.inline},d.save=function(){var a=d.selecteditem;null==d.compositiondata&&(d.compositiondata=[]);var c=q.validate(d.compositionschemadefinition.schemas.detail,d.compositionschemadefinition.schemas.detail.displayables,a);if(!(c.length>0)&&(d.compositiondata.push(a),d.collectionproperties.autoCommit)){var e=d.compositiondetailschema.properties&&"true"==d.compositiondetailschema.properties["compositions.alwaysrefresh"];e&&b.insertIntoContext("refreshscreen",!0,!0),d.$parent.$parent.save(null,{successCbk:function(a){if(e)return void(window.location.href=window.location.href);var b=a.resultObject.fields[d.relationship];if(null==b||0==b.length)return void(window.location.href=window.location.href);d.clonedCompositionData=b,d.compositiondata=b,d.newDetail=!1,d.isReadonly=!d.collectionproperties.allowUpdate,d.selecteditem={},d.collapseAll();var c=d.relationship,f={};f[c]={list:a.resultObject.fields[c],relationship:c},d.$emit("sw_compositiondataresolved",f)},failureCbk:function(b){var c=d.compositiondata.indexOf(a);c!=-1&&d.compositiondata.splice(c,1),d.isReadonly=!d.collectionproperties.allowUpdate},isComposition:!0,nextSchemaObj:{schemaId:d.$parent.$parent.schema.schemaId},refresh:e})}},d.collapseAll=function(){a.each(d.detailData,function(a,b){d.detailData[a].expanded=!1})},d.showListCommands=function(){return!d.detail||d.expanded},d.expandAll=function(){if(d.wasExpandedBefore)return void a.each(d.detailData,function(a,b){d.detailData[a].expanded=!0});var b=removeEncoding(url("/api/generic/ExtendedData/ExpandCompositions?"+a.param(u())));h.get(b).success(function(b){a.each(b.resultObject[d.relationship],function(a,b){v(b[d.compositiondetailschema.idFieldName],b,!0)}),d.wasExpandedBefore=!0})},d.getFormattedValue=function(a,b){return m.format(a,b)},d.shouldDisplayCommand=function(a,b){return o.shouldDisplayCommand(a,b)},d.commandLabel=function(a,b,c){return o.commandLabel(a,b,c)},d.isEnabledToExpand=function(){return d.isReadonly&&null!=d.compositiondetailschema&&(void 0==d.compositionlistschema.properties.expansible||"true"==d.compositionlistschema.properties.expansible)},d.i18NLabel=function(a){return k.getI18nLabel(a,d.compositionlistschema)},d.selectPage=function(a,b,c){return void 0===a||a<=0||a>d.paginationData.pageCount?void(d.paginationData.pageNumber=a):void p.getCompositionList(d.relationship,d.parentschema,d.parentdata.fields,a,d.paginationData.pageSize).then(function(a){d.clonedCompositionData=[],d.compositiondata=a[d.relationship].list,d.paginationData=a[d.relationship].paginationData,d.paginationData.selectedPage=d.paginationData.pageNumber,t()})}}]}})}(app,angular,jQuery);var app=angular.module("sw_layout"),CONDITIONMODAL_$_KEY='[data-class="conditionModal"]';app.directive("configrendered",function(a){return{restrict:"A",link:function(b,c,d){b.$last===!0&&a(function(){$("[rel=tooltip]").tooltip({container:"body"}),b.$emit("sw_bodyrenderedevent")})}}}),app.directive("conditionmodal",function(a){return{restrict:"E",replace:!0,templateUrl:a.getResourceUrl("/Content/Templates/configConditionModal.html"),scope:{profile:"=",module:"=",type:"=",condition:"=",fullkey:"="},controller:function(a,b,c){a.i18N=function(a,b,d){return c.get18nValue(a,b,d)},a.init=function(){null==a.condition&&(a.condition={},a.condition.appContext={})},a.saveCondition=function(){a.condition.fullKey=a.fullkey;var c=angular.toJson(a.condition);b.put(url("/api/generic/Configuration/CreateCondition"),c).success(function(a){var b=$(CONDITIONMODAL_$_KEY);b.modal("hide")})},a.init()}}});var app=angular.module("sw_layout");app.directive("tabsrendered",function(a,b,c,d,e){return{restrict:"A",link:function(d,f,g){if(d.$last!==!1){var h=b.getInstance("tabsrendered");h.debug("finished rendering tabs of detail screen"),a(function(){var a=null;$(".compositiondetailtab li>a").each(function(){var b=$(this);null==a&&(a=$(this).data("tabid")),b.click(function(a){a.preventDefault(),b.tab("show");var d=$(this).data("tabid");h.trace("lazy loading tab {0}".format(d)),e.stop({compositionSpin:!0}),c.$broadcast("sw_lazyloadtab",d)})}),c.$broadcast("sw_alltabsloaded",a)},0,!1)}}}}),app.directive("crudBody",function(contextService){return{restrict:"E",replace:!0,templateUrl:contextService.getResourceUrl("/Content/Templates/crud/crud_body.html"),scope:{isList:"=",isDetail:"=",blockedassociations:"=",associationOptions:"=",associationSchemas:"=",schema:"=",datamap:"=",cancelfn:"&",previousschema:"=",previousdata:"=",paginationdata:"=",searchData:"=",searchOperator:"=",searchSort:"=",ismodal:"@",timestamp:"=",checked:"="},controller:function($scope,$http,$rootScope,$filter,$injector,formatService,fixHeaderService,searchService,tabsService,fieldService,commandService,i18NService,validationService,submitService,redirectService,associationService,$timeout,dispatcherService){function defaultSuccessFunction(a){if($scope.$parent.multipleSchema=!1,$scope.$parent.schemas=null,null!=a)if("ActionRedirectResponse"==a.type)redirectService.redirectToAction(null,a.controller,a.action,a.parameters);else{var b=a.schema;$scope.$parent.renderViewWithData(b.applicationName,b.schemaId,b.mode,b.title,a)}}$scope.$name="crudbody"+("false"==$scope.ismodal?"modal":""),contextService.insertIntoContext("sw:crudbody:scrolltop",!0),$scope.getFormattedValue=function(a,b){var c=formatService.format(a,b);return"-666"==c?null:c},$scope.setActiveTab=function(a){contextService.setActiveTab(a)},$scope.hasTabs=function(a){return tabsService.hasTabs(a)},$scope.isCommand=function(a){if("true"==$scope.schema.properties["command.select"])return!0},$scope.isNotHapagTest=function(){return"hapag"!==$rootScope.clientName},$scope.tabsDisplayables=function(a){return tabsService.tabsDisplayables(a)},$scope.$on("sw_bodyrenderedevent",function(a){var b=contextService.getActiveTab();null!=b&&redirectService.redirectToTab(b);var c=contextService.fetchFromContext("sw:crudbody:scrolltop",!1,!1);c&&"false"!==c?window.scrollTo(0,0):contextService.insertIntoContext("sw:crudbody:scrolltop",!0);var d=contextService.fetchFromContext("onloadMessage",!1,!1,!0);if(d){var e={successMessage:d};$rootScope.$broadcast("sw_successmessage",e),$timeout(function(){$rootScope.$broadcast("sw_successmessagetimeout",{successMessage:null})},contextService.retrieveFromContext("successMessageTimeOut"))}}),$scope.$on("sw_successmessagetimeout",function(a,b){$rootScope.showSuccessMessage||fixHeaderService.resetTableConfig($scope.schema)}),$scope.$on("sw_errormessage",function(a,b){fixHeaderService.topErrorMessageHandler(b,$scope.$parent.isDetail,$scope.schema)}),$scope.$on("sw_compositiondataresolved",function(a,b){for(var c in b)b.hasOwnProperty(c)&&($scope.datamap.fields[c]=b[c].list)}),$scope.isEditing=function(a){var b=a.idFieldName,c=$scope.datamap.fields[b];return null!=c},$scope.shouldShowField=function(expression){if("true"==expression)return!0;var stringExpression="$scope.datamap."+expression,ret=eval(stringExpression);return ret},$scope.isHapag=function(){return"hapag"==$rootScope.clientName},$scope.renderListView=function(a){$scope.$parent.multipleSchema=!1,$scope.$parent.schemas=null;var b="list";null!=$scope.schema&&$scope.schema.stereotype.isEqual("list",!0)&&(b=$scope.schema.schemaId),$scope.$parent.renderView($scope.$parent.applicationname,b,"none",$scope.title,a)},$scope.toListSchema=function(a,b){return $scope.$parent.multipleSchema=!1,$scope.$parent.schemas=null,$("#crudmodal").modal("hide"),$scope.showingModal=!1,"browser"==GetPopUpMode()&&open(location,"_self").close(),$scope.schema=b,$scope.datamap=a,null==$scope.schema||null==$scope.datamap||"Detail"==$scope.schema.stereotype?void $scope.renderListView(null):($scope.$emit("sw_titlechanged",b.title),void $scope.$parent.toList(null))},$scope["delete"]=function(){var a=$scope.schema,b=a.idFieldName,c=a.applicationName,d=$scope.datamap.fields[b],e={};"true"==sessionStorage.mockmaximo&&(e.mockmaximo=!0),e.platform=platform(),e=addSchemaDataToParameters(e,$scope.schema);var f=$.param(e),g=removeEncoding(url("/api/data/"+c+"/"+d+"?"+f));$http["delete"](g).success(function(a){defaultSuccessFunction(a)})},$scope.save=function(a,b){void 0==b&&(b={});var c=b.successCbk,d=b.failureCbk,e=b.nextSchemaObj,f=b.applyDefaultSuccess,g=(b.applyDefaultFailure,b.isComposition),h=null==a,i=h?$scope.datamap:a,j=h?i.fields:i,k=$scope.schema.applicationName,l=$scope.schema.idFieldName,m=j[l];if($rootScope.$broadcast("sw_beforeSave",j),void 0==sessionStorage.mockclientvalidation){var n=validationService.validate($scope.schema,$scope.schema.displayables,j);if(n.length>0)return}if(submitService.removeNullInvisibleFields($scope.schema.displayables,j),j=submitService.removeExtraFields(j,!0,$scope.schema),submitService.translateFields($scope.schema.displayables,j),associationService.insertAssocationLabelsIfNeeded($scope.schema,j,$scope.associationOptions),$scope.schema.properties["oncrudsaveevent.transformservice"]){var o=$scope.schema.properties["oncrudsaveevent.transformservice"],p=dispatcherService.loadService(o.split(".")[0],o.split(".")[1]);p({datamap:j,schema:$scope.schema,associationOptions:$scope.associationOptions})}var q=angular.toJson(j);if(b={},"true"==sessionStorage.mockmaximo&&(b.mockmaximo=!0),b=addSchemaDataToParameters(b,$scope.schema,e),b.platform=platform(),$rootScope.savingMain=!g,isIe9()){var r=submitService.getFormToSubmitIfHasAttachement($scope.schema.displayables,j);if(null!=r){var s=$(r);return void submitService.submitForm(s,b,q,k)}}var t=$.param(b),u=url("/api/data/"+k+"/"+m+"?"+t),v=null==m?$http.post:$http.put;v(u,q).success(function(a){(null==c||f)&&defaultSuccessFunction(a),null!=c&&c(a)}).error(function(a){null!=d&&d(a)})},$injector.invoke(BaseController,this,{$scope:$scope,i18NService:i18NService,fieldService:fieldService,commandService:commandService})}}}),app.directive("crudInputWrapper",function(a,b,c){return{restrict:"E",replace:!0,template:"<div></div>",scope:{schema:"=",displayables:"=",datamap:"=",associationOptions:"=",associationSchemas:"=",blockedassociations:"=",cancelfn:"&",savefn:"&",previousschema:"=",previousdata:"=",title:"=",elementid:"@",isMainTab:"@",tabid:"@"},link:function(a,c,d){var e=function(){c.append("<crud-input elementid='crudInputMain' schema='schema' datamap='datamap' association-options='associationOptions' blockedassociations='blockedassociations'association-schemas='associationSchemas'cancelfn='toListSchema(data,schema)' displayables='displayables'savefn='save(selecteditem, parameters)' previousschema='previousschema' previousdata='previousdata' />"),b(c.contents())(a),a.loaded=!0};"input"==a.schema.mode&&"true"==a.isMainTab&&e(),a.$on("sw_lazyloadtab",function(b,c){a.tabid!=c||a.loaded||e()}),a.save=function(){a.savefn()}}}}),app.directive("crudInput",function(a){return{restrict:"E",replace:!0,templateUrl:a.getResourceUrl("/Content/Templates/crud/crud_input.html"),scope:{schema:"=",displayables:"=",datamap:"=",associationOptions:"=",associationSchemas:"=",blockedassociations:"=",cancelfn:"&",savefn:"&",previousschema:"=",previousdata:"=",title:"=",elementid:"@"},controller:function(a,b,c,d,e,f,g,h,i){a.$name="crudinput",a.cancel=function(){a.cancelfn({data:a.previousdata,schema:a.previousschema}),a.$emit("sw_cancelclicked")},a.save=function(){a.savefn()},a.isEditing=function(a,b){var c=b[a.idFieldName];return null!=c},a.printDetail=function(){var b=a.schema;e.printDetail(b,a.datamap[b.idFieldName])},c.invoke(BaseController,this,{$scope:a,i18NService:i,fieldService:h,commandService:g})}}}),app.directive("configAssociationListInputDatamap",function(a){return{restrict:"A",link:function(a,b,c){a.$first&&(a.datamap[a.fieldMetadata.attribute]=[]);var d={},e=a.associationSchemas[a.fieldMetadata.associationKey].displayables;for(i=0;i<e.length;i++){var f=e[i].attribute;a.option.extrafields=a.option.extrafields||{},d[f]=a.option.extrafields[f]}a.datamap[a.fieldMetadata.attribute].push(d)}}}),app.directive("configUpdateSectionDatamap",function(a){return{restrict:"A",link:function(a,b,c){a.$first&&(a.datamap[a.fieldMetadata.id]=[]);var d={};d.label=a.i18NLabel(a.field),d.value=a.datamap[a.field.attribute],a.$watch('datamap["'+a.field.attribute+'"]',function(b,c){c!=b&&(a.datamap[a.fieldMetadata.id][a.$index].value=b)}),d["#newvalue"]="",a.datamap[a.fieldMetadata.id].push(d)}}}),app.directive("sectionElementInput",function(a){return{restrict:"E",replace:!0,scope:{schema:"=",datamap:"=",displayables:"=",associationOptions:"=",associationSchemas:"=",blockedassociations:"=",elementid:"@",orientation:"@",islabelless:"@"},template:"<div></div>",link:function(b,c,d){angular.isArray(b.displayables)&&(c.append("<crud-input-fields displayables='displayables'schema='schema'datamap='datamap'displayables='displayables'association-options='associationOptions'association-schemas='associationSchemas'blockedassociations='blockedassociations'elementid='{{elementid}}'orientation='{{orientation}}' insidelabellesssection={{islabelless}}></crud-input-fields>"),a(c.contents())(b))}}}),app.directive("crudInputFields",function(a){return{restrict:"E",replace:!0,templateUrl:a.getResourceUrl("/Content/Templates/crud/crud_input_fields.html"),scope:{schema:"=",datamap:"=",displayables:"=",associationOptions:"=",associationSchemas:"=",blockedassociations:"=",elementid:"@",orientation:"@",insidelabellesssection:"@"},controller:function(b,c,d,e,f,g,h,j,k,l,m,n,o,p,q,r,s){function t(){if(e.invoke(BaseController,this,{$scope:b,i18NService:l,fieldService:k}),!b.isVerticalOrientation()){var a=k.countVisibleDisplayables(b.datamap,b.schema,b.displayables);a>0&&(b.horizontalWidth={width:100/a+"%"})}}b.$name="crud_input_fields",b.handlerTitleInputFile=function(a){var c=b.i18N("attachment."+a,"No file selected"),d=$("."+a);return $().ready(function(){d.change(function(){var a=c;void 0!=d&&""!=d.val()&&(c=d.val()),d.attr("title",c),c=a})}),c},b.$on("sw_block_association",function(a,c){b.blockedassociations[c]=!0}),b.$on("sw_unblock_association",function(a,c){b.blockedassociations[c]=!1}),b.$on("sw_associationsupdated",function(a,c){b.associationOptions=c}),b.$on("sw_bodyrenderedevent",function(c,d){$("#uploadBtn").on("change",function(b){var c=this.value.match(/[^\/\\]+$/),d=a.fetchFromContext("allowedfiles",!0),e=this.value.lastIndexOf("."),f=this.value.substring(e+1).toLowerCase();return $.inArray(f,d)==-1?($("#uploadFile").attr("value",""),void(isIe9()?$(this).replaceWith($(this).clone(!0)):$("#uploadFile").val(""))):void $("#uploadFile").attr("value",c)});var e=$("#"+d);if(!(e.length<=0)){if($("[rel=tooltip]",e).tooltip({container:"body"}),b.configureLookupModals(e),p.init(e,b),angular.forEach($("select"),function(a){a.selectedIndex>=0&&(a.options[a.selectedIndex].text+=" "),$(a).change(function(){this.selectedIndex>=0&&(this.options[this.selectedIndex].text+=" ")})}),d.equalsAny("crudInputMainCompositionFields","crudInputMainFields")&&(b.configureNumericInput(),b.configureOptionFields(),b.configureAssociationChangeEvents(),b.schema.properties["oncrudloadevent.detail"])){var f=b.schema.properties["oncrudloadevent.detail"],g=s.loadService(f.split(".")[0],f.split(".")[1]);g(b.datamap,b.schema)}$(".datetimereadonly").datepicker("remove")}}),b.configureAssociationChangeEvents=function(){var a=k.getDisplayablesOfTypes(b.displayables,["OptionField","ApplicationAssociationDefinition"]);null!=a&&(a=a.reverse(),$.each(a,function(a,c){var d=c.multiValued;b.$watch('datamap["'+c.attribute+'"]',function(a,e){var g=null!=e&&e.indexOf("$ignorewatch")!=-1,h=null==a?-1:a.indexOf("$ignorewatch");if(e!=a&&!g||g&&h!=-1){if(null!=a&&h!=-1)return a=a.substring(0,h),"$null"==a&&(a=null),b.datamap[c.attribute]=a,p.digestAndrefresh(c,b),void f(function(){},0,!1);var i={oldValue:e,newValue:a,fields:b.datamap,displayables:b.displayables,scope:b,"continue":function(){d&&"lookup"!=c.rendererType&&m.updateUnderlyingAssociationObject(c,null,b);var a=m.updateAssociations(c,b);void 0!=a&&0==a&&m.postAssociationHook(c,b,{phase:"configured",dispatchedbytheuser:!0});try{b.$digest()}catch(e){}},interrupt:function(){b.datamap[c.attribute]=e,shouldDoWatch=!1,p.digestAndrefresh(c,b),shouldDoWatch=!0}};h==-1&&(m.onAssociationChange(c,d,i),p.digestAndrefresh(c,b))}}),b.$watchCollection("associationOptions."+c.associationKey,function(a,d){f(function(){p.digestAndrefresh(c,b)},0,!1)}),b.$watch("blockedassociations."+c.associationKey,function(a,d){p.blockOrUnblockAssociations(b,a,d,c)})}))},b.isSelectEnabled=function(a){var c=a.associationKey;if(b.enabledassociations=instantiateIfUndefined(b.enabledassociations),b.blockunblockparameters||(b.blockunblockparameters=[]),void 0==c)return!0;var d=null==b.blockedassociations||!b.blockedassociations[c];if("true"==a.enableExpression)return d;
var e=d&&n.evaluate(a.enableExpression,b.datamap),g=b.enabledassociations[c];return void 0==g?b.enabledassociations[c]=e:e!=g&&(b.blockunblockparameters.unshift({result:!e,currentState:!g,fieldMetadata:a}),b.enabledassociations[c]=e),1==b.blockunblockparameters.length&&f(function(){for(var a=0;a<b.blockunblockparameters.length;a++){var c=b.blockunblockparameters[a];p.blockOrUnblockAssociations(b,c.result,c.currentState,c.fieldMetadata),p.digestAndrefresh(c.fieldMetadata,b)}b.blockunblockparameters=[]},0,!1),e},b.getCalendarTooltip=function(a){this.i18N("calendar.date_tooltip","Open the calendar popup")},b.haslookupModal=function(a){return k.getDisplayablesOfRendererTypes(a.displayables,["lookup"]).length>0},b.isModifiableEnabled=function(a){var c=n.evaluate(a.enableExpression,b.datamap);return c},b.isCheckboxSelected=function(a,c){var d=b.datamap[c];return void 0!=d&&d.indexOf(a.value)>-1},b.toogleCheckboxSelection=function(a,c){var d=b.datamap[c];void 0==d&&(d=[]),"selectallHLAG"==c&&$("option",".multiselect").each(function(a){$(".multiselect").multiselect("select","ADL")});var e=d.indexOf(a.value);e>-1?d.splice(e,1):d.push(a.value),b.datamap[c]=d},b.lookupAssociationsCode={},b.lookupAssociationsDescription={},b.showLookupModal=function(a){if(b.isSelectEnabled(a)){b.lookupModalSearch={},b.lookupModalSearch.descripton="",b.lookupModalSearch.fieldMetadata=a;var c=b.datamap[a.target];null==c||" "==c?b.lookupModalSearch.code=b.lookupAssociationsCode[a.attribute]:b.lookupModalSearch.code="";var e=$('[data-class="lookupModal"]',d);e.draggable(),e.modal("show")}},b.lookupCodeChange=function(a){null!=b.datamap[a.target]&&(b.datamap[a.target]=" ",b.lookupAssociationsDescription[a.attribute]=null,m.updateUnderlyingAssociationObject(a,null,b))},b.lookupCodeBlur=function(a){var c=b.lookupAssociationsCode[a.attribute],d=b.datamap[a.target];null==c||""==c||null!=d&&" "!=d||b.showLookupModal(a)},b.configureLookupModals=function(a){var c=k.getDisplayablesOfRendererTypes(b.schema.displayables,["lookup"]);$.each(c,function(a,c){var d=c;if(null==b.associationOptions)b.lookupAssociationsDescription[d.attribute]=null,b.lookupAssociationsCode[d.attribute]=null;else{var e=b.associationOptions[d.associationKey],f=function(a){if(b.lookupAssociationsCode[d.attribute]=a,!(null==e||e.length<=0)){var c=$.grep(e,function(b){return b.value==a}),f=null!=c&&c.length>0?c[0].label:null;b.lookupAssociationsDescription[d.attribute]=f}};f(b.datamap[d.target])}})},b.bindEvalExpression=function(a){if(null!=a.evalExpression){var c=n.getVariablesForWatch(a.evalExpression);b.$watchCollection(c,function(c,d){c!=d&&(b.datamap[a.attribute]=n.evaluate(a.evalExpression,b.datamap))})}},b.configureNumericInput=function(){for(i in b.schema.displayables){var a=b.schema.displayables[i];if("numericinput"==a.rendererType&&null!=b.datamap){var c=b.datamap[a.attribute];null==c?b.datamap[a.attribute]=1:"string"==typeof c&&(b.datamap[a.attribute]=parseInt(c))}}},b.configureOptionFields=function(){if("true"!=b.schema.properties["optionfield.donotusefirstoptionasdefault"]&&null!=b.displayables&&null!=b.datamap)for(var a=k.getDisplayablesOfTypes(b.displayables,["OptionField"]),c=0;c<a.length;c++){var d=a[c];if("false"!=d.rendererParameters.setdefaultvalue&&null==b.datamap[d.target]&&null==d.providerAttribute&&"checkbox"!=d.rendererType){var e=b.GetOptionFieldOptions(d);null!=e&&(b.datamap[d.target]=e[0].value)}}},b.getSelectedTexts=function(a){return q.getSelectedTexts(a)},b.opendetails=function(a){if(b.enabletoopendetails(a)){var c={id:b.paramstopendetails.idtopendetails,popupmode:"browser"};r.goToApplicationView(b.paramstopendetails.application,"detail","output",null,c)}},b.fillparamstoopendetails=function(a){if(b.paramstopendetails=null,!nullOrUndef(a.rendererParameters)){var c=a.rendererParameters.idtopendetails;if(!nullOrUndef(a.applicationTo)){var d=a.applicationTo.replace("_","");isNumber(d.charAt(0))&&(d=d.substring(1));var e=b.datamap[c];nullOrUndef(e)||nullOrUndef(d)||(b.paramstopendetails={idtopendetails:e,application:d})}}},b.enabletoopendetails=function(a){return b.fillparamstoopendetails(a),null!=b.paramstopendetails},b.getLengthParam=function(a){var b=null;if(!nullOrUndef(a.rendererParameters)){var c=a.rendererParameters.length;if(!nullOrUndef(c))switch(c){case"full":b=GetBootstrapFormClass(10);break;case"half":b=GetBootstrapFormClass(5);break;case"quarter":b=GetBootstrapFormClass(2)}}return b},b.GetAssociationOptions=function(a){return"OptionField"==a.type?b.GetOptionFieldOptions(a):b.associationOptions[a.associationKey]},b.GetOptionFieldOptions=function(a){return null==a.providerAttribute?a.options:(b.associationOptions=instantiateIfUndefined(b.associationOptions),b.associationOptions[a.providerAttribute])},b.contextPath=function(a){return url(a)},b.isIE=function(){return isIe9()},b.isFieldRequired=function(a){return k.isFieldRequired(a,b.datamap)},b.getLabelStyle=function(a){var b=o.getLabelStyle(a,"color"),c=o.getLabelStyle(a,"font-weight"),d={color:b,"font-weight":c};return d},b.getLabelClass=function(a){return void 0!=a.resourcepath&&null==a.header?null:GetBootstrapFormClass(b.hasSameLineLabel(a)?2:12)},b.getFieldClass=function(a){return GetBootstrapFormClass(void 0!=a.resourcepath&&null==a.header?12:b.hasSameLineLabel(a)?10:12)},b.isLabelVisible=function(a,c){if(!b.isVerticalOrientation())return!1;var d=a.header;if(!d)return!c;var e=n.evaluate(d.showExpression,b.datamap),f=null!=d.parameters&&"true"==d.parameters.fieldset;return e&&f==c},b.isFieldSet=function(a){if(!b.isVerticalOrientation())return!1;var c=a.header;if(!c)return!1;var d=n.evaluate(c.showExpression,b.datamap),e=null!=c.parameters&&"true"==c.parameters.fieldset;return d&&e},b.isSectionWithoutLabel=function(a){return"ApplicationSection"==a.type&&null==a.resourcepath&&null==a.header},b.sectionHasSameLineLabel=function(a){return b.hasSameLineLabel(a)&&"ApplicationSection"==a.type&&null==a.resourcepath},b.getValueColumnClass=function(a){var c="";if(b.sectionHasSameLineLabel(a)&&(c+="col-sectionsamelineheader "),void 0!=a.resourcepath&&null==a.header)return GetBootstrapFormClass(12);if(b.isSectionWithoutLabel(a));else if(b.hasSameLineLabel(a)){if(b.isVerticalOrientation()){var d=b.getLengthParam(a);c+=null!=d?d:GetBootstrapFormClass(10)}}else c+=GetBootstrapFormClass(12);return c},b.formatId=function(a){return RemoveSpecialChars(a)},b.nonTabFields=function(a){return k.nonTabFields(a)},t()}}});var app=angular.module("sw_layout");app.directive("advancedFilterToogle",function(a){return{restrict:"E",replace:!0,templateUrl:a.getResourceUrl("/Content/Templates/crud/advanced_filter_toogle.html")}}),app.directive("crudListWrapper",function(a,b){return{restrict:"E",replace:!0,template:"<div></div>",scope:{schema:"=",datamap:"=",previousschema:"=",previousdata:"=",paginationData:"=",searchData:"=",searchOperator:"=",searchSort:"=",ismodal:"@",checked:"=",isList:"=",timestamp:"="},link:function(a,c,d){a.isList&&(c.append("<crud-list datamap='datamap' schema='schema' pagination-data='paginationData' search-data='searchData' search-operator='searchOperator' search-sort='searchSort'timestamp='{{timestamp}}' />"),b(c.contents())(a))}}}),app.directive("crudList",function(contextService){return{restrict:"E",replace:!0,templateUrl:contextService.getResourceUrl("/Content/Templates/crud/crud_list.html"),scope:{schema:"=",datamap:"=",previousschema:"=",previousdata:"=",paginationData:"=",searchData:"=",searchOperator:"=",searchSort:"=",ismodal:"@",checked:"=",timestamp:"@"},controller:function($scope,$http,$rootScope,$filter,$injector,$log,$timeout,formatService,fixHeaderService,searchService,tabsService,fieldService,commandService,i18NService,validationService,submitService,redirectService,associationService,contextService,schemaCacheService){$scope.$name="crudlist",fixHeaderService.activateResizeHandler(),$scope.getFormattedValue=function(a,b){var c=formatService.format(a,b);return"-666"==c?"":null==c?"":c},$scope.hasTabs=function(a){return tabsService.hasTabs(a)},$scope.isCommand=function(a){if($scope.schema&&"true"==$scope.schema.properties["command.select"])return!0},$scope.getOpenCalendarTooltip=function(a){var b=$scope.searchData[a];return b?b:this.i18N("calendar.date_tooltip","Open the calendar popup")},$scope.isNotHapagTest=function(){return"hapag"!=$rootScope.clientName},$scope.tabsDisplayables=function(a){return tabsService.tabsDisplayables(a)},$scope.shouldShowSort=function(a,b){return null!=a.attribute&&($scope.searchSort.field==a.attribute||$scope.searchSort.field==a.rendererParameters.sortattribute)&&$scope.searchSort.order==b},$scope.getGridHeaderStyle=function(a,b){if(!isIe9())return null;var c=a.rendererParameters[b];if(null!=c)return c;if("maxwidth"==b){var d=$(window).width()>1199;return d?"135px":"100px"}return null},$scope.$on("filterRowRenderedEvent",function(a){0==$scope.datamap.length&&fixHeaderService.updateFilterZeroOrOneEntries()}),$scope.$on("listTableRenderedEvent",function(a){var b=$log.getInstance("sw4.crud_list_dir#on#listTableRenderedEvent");if(b.debug("init table rendered listener"),"true"!=$scope.ismodal||!0===$scope.$parent.showingModal){var c={};$rootScope.printRequested||(fixHeaderService.fixThead($scope.schema,c),$rootScope.showSuccessMessage&&fixHeaderService.fixSuccessMessageTop(!0),$(".statuscolumncolor").each(function(a,b){$(b).height($(b).parent().parent().height())}),$("[rel=tooltip]").tooltip({container:"body"}),b.debug("finish table rendered listener"),window.scrollTo(0,0),$("#listgrid .filter-row").find("th").filter(":visible:last").addClass("last"))}}),$scope.$on("sw_successmessagetimeout",function(a,b){$rootScope.showSuccessMessage||fixHeaderService.resetTableConfig($scope.schema)}),$scope.$on("sw_errormessage",function(a,b){fixHeaderService.topErrorMessageHandler(b,$scope.$parent.isDetail,$scope.schema)}),$scope.isEditing=function(a){var b=a.idFieldName,c=$scope.datamap.fields[b];return null!=c},$scope.shouldShowField=function(expression){if("true"==expression)return!0;var stringExpression="$scope.datamap."+expression,ret=eval(stringExpression);return ret},$scope.isHapag=function(){return"hapag"==$rootScope.clientName},$scope.showDetail=function(a,b){var c=$scope.schema.properties["list.click.mode"],d=$scope.schema.properties["list.click.popupmode"],e=$scope.schema.properties["list.click.schema"],f=$scope.schema.properties["list.click.service"];if("checkbox"!=b.rendererType&&"report"!=d){if(null!=f)return void commandService.executeClickCustomCommand(f,a.fields,b);var g=a.fields[$scope.schema.idFieldName];if(null==g||"-666"==g)return void window.alert("error id is null");var h=$scope.schema.applicationName;""!=e&&(null==e&&(e=detailSchema()),contextService.insertIntoContext("currentmodulenewwindow",contextService.retrieveFromContext("currentmodule")),$scope.$emit("sw_renderview",h,e,c,$scope.title,{id:g,popupmode:d}))}},$scope.renderListView=function(a){$scope.$parent.multipleSchema=!1,$scope.$parent.schemas=null;var b="list";null!=$scope.schema&&$scope.schema.stereotype.isEqual("list",!0)&&(b=$scope.schema.schemaId),$scope.$emit("sw_renderview",$scope.schema.applicationName,b,"none",$scope.title,a)},$scope.selectPage=function(a,b,c){if(void 0===a||a<=0||a>$scope.paginationData.pageCount)return void($scope.paginationData.pageNumber=a);var d=0,e=null,f=null;null!=$scope.paginationData&&(d=$scope.paginationData.totalCount,void 0==b&&(b=$scope.paginationData.pageSize),e=$scope.paginationData.filterFixedWhereClause,f=$scope.paginationData.unionFilterFixedWhereClause),void 0===b&&(b=100);var g,h=contextService.retrieveReportSearchDTO($scope.schema.schemaId);null!=h?(h=$.parseJSON(h),g=searchService.buildReportSearchDTO(h,$scope.searchData,$scope.searchSort,$scope.searchOperator,e)):g=searchService.buildSearchDTO($scope.searchData,$scope.searchSort,$scope.searchOperator,e,f),g.pageNumber=a,g.totalCount=d,g.pageSize=b,g.paginationOptions=$scope.paginationData.paginationOptions,fixHeaderService.unfix(),$scope.renderListView({SearchDTO:g,printMode:c})},$scope.getSearchIcon=function(a){var b="true"==$scope.schema.properties["list.advancedfilter.showsearchicon"],c=$scope.getOperator(a);return b&&""!=c.symbol?c.symbol:""},$scope.searchOperations=function(){return searchService.searchOperations()},$scope.getDefaultOperator=function(){return searchService.defaultSearchOperation()},$scope.selectOperator=function(a,b){var c=$scope.searchOperator,d=$scope.searchData;c[a]=b,""==b.id?(d[a]="",$scope.selectPage(1)):null!=d[a]&&""!=d[a]?$scope.selectPage(1):"BLANK"==b.id&&(d[a]="",$scope.selectPage(1))},$scope.getOperator=function(a){var b=$scope.searchOperator;return null!=b&&null!=b[a]?b[a]:searchService.getSearchOperation(0)},$scope.filterSearch=function(a,b){var c=$scope.searchOperator[a];c&&c.id||($scope.searchOperator[a]=searchService.defaultSearchOperation());var d=$scope.searchData[a];d?$scope.selectPage(1):($scope.searchOperator[a]=searchService.noFilter(),$scope.selectPage(1)),$("#listgrid").focus(),window.scrollTo(0,0)},$scope.shouldShowFilter=function(a){return"ApplicationFieldDefinition"===a.type&&"color"!==a.rendererType},$scope.sort=function(a){if($scope.shouldShowFilter(a)){var b=a.attribute;a.rendererParameters&&a.rendererParameters.sortattribute&&(b=a.rendererParameters.sortattribute);var c=$scope.searchSort;null!=c.field&&c.field==b?c.order="desc"==c.order?"asc":"desc":(c.field=b,c.order="asc"),$scope.selectPage(1)}},$scope.collapse=function(a){$(a).is(":visible")?$(a).hide():$(a).show(),fixHeaderService.fixTableTop($(".fixedtable"))},$injector.invoke(BaseController,this,{$scope:$scope,i18NService:i18NService,fieldService:fieldService,commandService:commandService})}}}),app.directive("crudOutputWrapper",function(a,b,c){return{restrict:"E",replace:!0,template:"<div></div>",scope:{schema:"=",displayables:"=",datamap:"=",cancelfn:"&",previousschema:"=",previousdata:"=",hasError:"=",tabid:"@",isMainTab:"@"},link:function(a,c,d){var e=function(){c.append("<crud-output schema='schema'datamap='datamap'displayables='displayables'orientation='{{orientation}}'></crud-output-fields>"),b(c.contents())(a),a.loaded=!0};"output"==a.schema.mode&&"true"==a.isMainTab&&e(),a.$on("sw_lazyloadtab",function(b,c){a.tabid!=c||a.loaded||e()})}}}),app.directive("crudOutput",function(a){return{restrict:"E",replace:!0,templateUrl:a.getResourceUrl("/Content/Templates/crud/crud_output.html"),scope:{schema:"=",displayables:"=",datamap:"=",cancelfn:"&",previousschema:"=",previousdata:"=",hasError:"="},controller:function(a,b,c,d,e,f,g,h,i){a.$name="crudoutput",a.cancel=function(b,c){$("#crudmodal").modal("hide"),"browser"==GetPopUpMode()&&close(),a.cancelfn({data:b,schema:c}),a.$emit("sw_cancelclicked")},a.redirectToHapagHome=function(){h.redirectToAction(null,"HapagHome",null,null)},a.redirectToAction=function(a,b,c,d){h.redirectToAction(a,b,c,d)},a.printDetail=function(){d.printDetail(a.schema,a.datamap[a.schema.idFieldName])},a.nonTabFields=function(a){return f.nonTabFields(a)},b.invoke(BaseController,this,{$scope:a,i18NService:i,fieldService:f,commandService:g})}}}),app.directive("sectionElementOutput",function(a){return{restrict:"E",replace:!0,scope:{schema:"=",datamap:"=",displayables:"=",orientation:"@"},template:"<div></div>",link:function(b,c,d){angular.isArray(b.displayables)&&(c.append("<crud-output-fields schema='schema'datamap='datamap'displayables='displayables'orientation='{{orientation}}'></crud-output-fields>"),a(c.contents())(b))}}}),app.directive("crudOutputFields",function(a){return{restrict:"E",replace:!0,templateUrl:a.getResourceUrl("/Content/Templates/crud/crud_output_fields.html"),scope:{schema:"=",datamap:"=",displayables:"=",orientation:"@"},controller:function(a,b,c,d,e,f,g,h,j,k){function l(){a.countVisibleDisplayables=f.countVisibleDisplayables(a.datamap,a.schema,a.displayables),b.invoke(BaseController,this,{$scope:a,i18NService:j,fieldService:f})}a.$name="crud_output_fields",a.contextPath=function(a){return url(a)},a.i18NLabel=a.i18NLabel||function(b){var c=j.getI18nLabel(b,a.schema);return void 0!=c&&""!=c&&(c=c.replace(":","")),c},a.getFormattedValue=function(a,b){return c.format(a,b)},a.getChildrenExpanded=function(a){var b=datamap[a],c=[];if(!b.children)return c;for(var d=0;d<b.children.length;d++);},a.getSectionStyle=function(b){var c={};if(null!=b.parameters)for(i in b.parameters)c[i]=b.parameters[i];if(null!=b.rendererParameters)for(i in b.rendererParameters)c[i]=b.rendererParameters[i];return null==c.width&&!a.isVerticalOrientation()&&a.countVisibleDisplayables>0&&(c.width=100/a.countVisibleDisplayables+"%"),c},a.getFieldClass=function(b){return a.hasSameLineLabel(b)?"col-xs-9":"TABLE"==b.rendererType?null:"col-xs-12"},a.bindEvalExpression=function(b){if(null!=b.evalExpression){var c=k.getVariablesForWatch(b.evalExpression);a.$watchCollection(c,function(c,d){c!==d&&(a.datamap[b.attribute]=k.evaluate(b.evalExpression,a.datamap))})}},a.getHeaderStyle=function(a){var b={};if(null!=a.header&&null!=a.header.parameters)for(i in a.header.parameters)b[i]=a.header.parameters[i];return b},a.hasLabelOrHeader=function(a){return a.header||a.label},l(),a.selectNodeLabel=function(){}}}});var app=angular.module("sw_layout");app.directive("crudtbody",function(a,b,c,d,e,f,g,h,i,j){return{restrict:"A",replace:!1,scope:{datamap:"=",schema:"="},template:"",link:function(a,c,k){a.getFormattedValue=function(a,b){var c=d.format(a,b);return"-666"==c?"":null==c?"":c},a.getGridColumnStyle=function(a,b,c){if(null!=a.rendererParameters){var d=a.rendererParameters[b];if(null!=d)return d}return null},a.statusColor=function(a,b){return null!=b&&"change"==b&&a.equalsAny("INPRG")?"blue":a.equalsAny("NEW","WAPPR","WSCH")?"orange":a.equalsAny("QUEUED","INPROG","INPRG","PENDING","null")?"yellow":a.equalsAny("CANCELLED","FAIL","FAILED","CAN","FAILPIR","REJECTED","NOTREQ")?"red":a.equalsAny("RESOLVED","SLAHOLD","SCHED","APPR","AUTHORIZED","AUTH","HOLDINPRG","PLANNED","ACC_CAT","ASSESSES","PENDAPPR","RCACOMP","WMATL","INFOPEND","ASSESS")?"blue":a.equalsAny("CLOSED","RESOLVCONF","IMPL","IMPLEMENTED","REVIEW","CLOSE","HISTEDIT","COMP")?"green":a.equalsAny("DRAFT")?"white":"transparent"},a.refreshGrid=function(d,e){a.datamap=d,a.schema=e;for(var f=(new Date).getTime(),g=a.columnarray=[],h=[],k=0;k<e.displayables.length;k++){var l=e.displayables[k];g.push(l),h.push(a.isFieldHidden(e,l))}for(var m=!1,n="",o=$(window).width()>1199,p=0;p<d.length;p++){var q="datamap[{0}]".format(p);n+="<tr style='cursor: pointer' listtablerendered rel='hideRow'>";var r=d[p];for(k=0;k<e.displayables.length;k++){var s="columnarray[{0}]".format(k);l=e.displayables[k];var t=a.getFormattedValue(d[p].fields[l.attribute],l);l.rendererParameters||(l.rendererParameters={});var u=a.getGridColumnStyle(l,"minwidth",o),v=a.getGridColumnStyle(l,"maxwidth",o),w=a.getGridColumnStyle(l,"width",o),x=l.rendererParameters.minwidth,y=l.rendererParameters.maxwidth,z=l.rendererParameters.width,A=h[k];if(n+="<td {2} onclick='griditemclick({0},{1},this)'".format(p,k,A?'style="display:none"':""),A||(n+=buildStyle(x,y,z,!1)),n+=">","color"==l.rendererType){var B=a.statusColor(r.fields[l.rendererParameters.column]||"null",e.applicationName);n+="<div class='statuscolumncolor' style='background-color:{0}'>".format(B)}else if("checkbox"==l.rendererType){var C=l.attribute;n+="<div>",n+="<input type='checkbox' class='check' name='{0}' ".format(C),n+="ng-model=\"{0}.fields['checked']\"".format(q),n+="ng-init=\"{0}.fields['checked']=false\" >".format(q),n+="</div>",m=!0}else"ApplicationFieldDefinition"==l.type&&(n+="<div class='gridcolumnvalue'".format(s),A||(n+=buildStyle(u,v,w,!0)),n+=">",n+=t);n+="</div>",n+="</td>"}n+="</tr>"}c.html(n),m&&b(c.contents())(a);var D=(new Date).getTime();j.getInstance("crudtbody#link").debug("grid compilation took {0} ms".format(D-f)),i(function(b,c){a.$emit("listTableRenderedEvent"),m||(a.$$watchers=null)})},a.$on("sw_griddatachanged",function(b,c,d){a.refreshGrid(c,d)}),h.invoke(BaseController,this,{$scope:a,i18NService:e,fieldService:f,commandService:g}),a.refreshGrid(a.datamap,a.schema)}}}),app.directive("dashboardsdone",function(a){return{restrict:"A",link:function(b,c,d){b.$last===!0&&a(function(){$("[rel=tooltip]").tooltip({container:"body"})})}}}),function(angular,a){var app=angular.module("sw_layout");app.directive("dateTime",["$timeout","formatService","expressionService","$q",function(b,c,d,e){function f(a){return!a||"true"===a.toLowerCase()}function g(b){var c=a(".datetime-class").last(),d="glyphicon glyphicon-calendar",e="glyphicon glyphicon-time";c.removeClass(d),c.removeClass(e);var f=b?e:d;c.addClass(f)}var h=new Date(1970,0,1,0,0,0);return{restrict:"A",require:"?ngModel",link:function(i,j,k,l){function m(a){var b=d.evaluate(I,C);b=c.formatDate(b,y);var e=d.getVariablesForWatch(I);return i.$watchCollection(e,function(e,f){if(e!==f){b=d.evaluate(I,C),b=c.formatDate(b,y);var g=j.data(a);G=Date.parse(b),g.startDate=G,g.initialDate=g.startDate}}),Date.parse(b)}function n(a){return angular.isDate(G)&&a.getTime()<G.getTime()}function o(a){var b=e.defer();return i.$apply(function(){l.$setViewValue(a),l.$render(),b.resolve(a)}),b.promise}function p(a){var b=a.date;b&&n(b)&&o(c.formatDate(G,y))}function q(b){try{var d=a.fn.datetimepicker.DPGlobal.parseDate(b,a.fn.datepicker.DPGlobal.parseFormat(x),k.language);n(d)&&(d=Date.parse(b));var e=n(d)?G:d;return c.formatDate(e,y)}catch(f){return angular.isDate(G)?c.formatDate(G,y):""}}function r(b){var c=a(this).val();if(c){var d=q(c);o(d)}}function s(b){if(13===b.which){var c=a(this).val();if(c){var d=q(c),e=o(d);k.dateEnter&&e.then(function(){i.$eval(k.dateEnter)}),b.preventDefault(),b.stopPropagation(),b.stopImmediatePropagation()}}}if(l){if(k.ngEnter)throw new Error("ng-enter directive is not supported. Use date-enter instead.");var t=f(k.showTime),u="true"===k.showIgnoretime,v=k.originalAttribute,w=f(k.showDate),x=c.adjustDateFormatForPicker(k.dateFormat,t),y=k.dateFormat;k.language||(k.language=userLanguage||"en-US");var z=void 0==k.showAmpm?void 0:"true"===k.showAmpm.toLowerCase(),A=t&&!w,B=void 0!=k.readonly&&k.readonly,C=i.datamap;if(g(A),b(function(){if(i.fieldMetadata){var a=c.formatDate(l.$modelValue,k.dateFormat);l.$setViewValue(a),j.val(a),v?C[v]=a:C&&i.fieldMetadata&&(C[i.fieldMetadata.attribute]=a),l.$render()}}),x){var D,E=f(k.allowFuture),F=f(k.allowPast),G=F?h:"+0d",H=E?1/0:"+0d",I=k.minDateexpression;t?(z||(z=x.startsWith("MM")),k.minDateexpression&&(G=m("datetimepicker")),D=G===h?null:G,j.datetimepicker({format:x,autoclose:!0,language:k.language,todayBtn:!1,showMeridian:z,startDate:G,initialDate:D,formatViewType:"time",startView:A?1:2,maxView:A?1:3,readonly:B,ignoretimeBtn:u,forceParse:!u}).on("blur",r).on("changeDate",p).keypress(s)):(k.minDateexpression&&(G=m("datepicker")),D=G===h?null:G,j.datepicker({initialDate:D,startDate:G,endDate:H,format:x,autoclose:!0,language:k.language,maxView:3,showMeridian:!1,readonly:B}).on("blur",r).on("changeDate",p).keypress(s))}}}}}])}(angular,jQuery);var app=angular.module("sw_layout");app.directive("inlineCompositionListWrapper",function(a){return{restrict:"E",replace:!0,template:"<div></div>",scope:{parentdata:"=",metadata:"=",iscollection:"="},link:function(b,c,d){var e=function(){b.compositionschemadefinition=b.metadata.schema,b.compositiondata=b.parentdata[b.metadata.relationship],c.append("<inline-composition-list parentdata='parentdata'metadata='metadata' iscollection='iscollection' compositionschemadefinition='compositionschemadefinition' compositiondata='compositiondata'/>"),a(c.contents())(b),b.loaded=!0};e(),b.$on("sw_lazyloadtab",function(a,c){b.tabid!=c||b.loaded||e()})}}}),app.directive("inlineCompositionList",function(a,b){return{restrict:"E",replace:!0,templateUrl:a.getResourceUrl("/Content/Templates/crud/inline_composition_list.html"),scope:{parentdata:"=",metadata:"=",iscollection:"=",compositionschemadefinition:"=",compositiondata:"="},controller:function(a,c,d,e,f,g){a.contextPath=function(a){return url(a)},a.handleItemClick=function(a,c){nullOrUndef(c.rendererParameters)||nullOrEmpty(c.rendererParameters.onClickService)||b.executeClickCustomCommand(c.rendererParameters.onClickService,a,c)}}}});var app=angular.module("sw_layout");app.directive("lookupModalWrapper",function(a){return{restrict:"E",replace:!0,scope:{lookupAssociationsCode:"=",lookupAssociationsDescription:"=",lookupObj:"=",schema:"=",datamap:"="},template:"<div></div>",link:function(b,c,d){c.append("<lookup-modal lookup-obj='lookupObj'lookup-associations-code='lookupAssociationsCode'lookup-associations-description='lookupAssociationsDescription'schema='schema' datamap='datamap'></lookup-modal>"),a(c.contents())(b)}}}),app.directive("lookupModal",function(a){return{restrict:"E",replace:!0,templateUrl:a.getResourceUrl("/Content/Templates/lookupModal.html"),scope:{lookupAssociationsCode:"=",lookupAssociationsDescription:"=",lookupObj:"=",schema:"=",datamap:"="},controller:function(a,b,c,d,e,f){a.lookupModalSearch=function(c){var e=a.schema,f=a.datamap,g=a.lookupObj,h={};h.application=e.applicationName,h.key={},h.key.schemaId=e.schemaId,h.key.mode=e.mode,h.key.platform=platform(),h.associationFieldName=g.fieldMetadata.associationKey;var i=g.fieldMetadata.schema.rendererParameters.application,j=g.fieldMetadata.schema.rendererParameters.schemaId;null!=i&&null!=j&&(h.associationApplication=i,h.associationKey={},h.associationKey.schemaId=j,h.associationKey.platform=platform());var k=0,l=30;if(null!=a.modalPaginationData&&(k=a.modalPaginationData.totalCount,l=a.modalPaginationData.pageSize),void 0===c&&(c=1),null!=g.schema){var m=d.getSearchOperationById("CONTAINS"),n=a.searchObj,o={};for(var p in n)o[p]=m;h.SearchDTO=d.buildSearchDTO(n,{},o),h.SearchDTO.pageNumber=c,h.SearchDTO.totalCount=k,h.SearchDTO.pageSize=l}else h.valueSearchString=g.code,h.labelSearchString=g.description,h.SearchDTO={pageNumber:c,totalCount:k,pageSize:l};var q=url("/api/generic/Data/UpdateAssociation?"+$.param(h)),r=angular.toJson(f);b.post(q,r).success(function(b){var c=b.resultObject;for(association in c)g.fieldMetadata.associationKey==association&&(g.options=c[association].associationData,g.schema=c[association].associationSchemaDefinition,a.modalPaginationData={},a.modalPaginationData.pageCount=c[association].pageCount,a.modalPaginationData.pageNumber=c[association].pageNumber,a.modalPaginationData.pageSize=c[association].pageSize,a.modalPaginationData.totalCount=c[association].totalCount,a.modalPaginationData.selectedPage=c[association].pageNumber)}).error(function(){})},a.i18N=function(a,b,c){return e.get18nValue(a,b,c)},a.i18NLabel=function(b){return e.getI18nLabel(b,a.lookupObj.schema)},a.lookupModalSelect=function(b){var d=a.lookupObj.fieldMetadata;a.datamap[d.target]=b.value,a.lookupAssociationsCode[d.attribute]=b.value,a.lookupAssociationsDescription[d.attribute]=b.label,f.updateUnderlyingAssociationObject(d,b,a),c.modal("hide")},c.on("hide.bs.modal",function(b){if($("body").removeClass("modal-open"),$(".modal-backdrop").remove(),null!=a.lookupObj){var c=a.lookupObj.fieldMetadata;null==a.datamap||null!=a.datamap[c.target]&&" "!=a.datamap[c.target]||a.$apply(function(){a.lookupAssociationsCode[c.attribute]=null,a.lookupAssociationsDescription[c.attribute]=null})}}),c.on("shown.bs.modal",function(b){a.searchObj={},void 0!=a.lookupObj&&a.lookupModalSearch()})}}});var app=angular.module("sw_layout");app.directive("messagesection",function(a,b,c){return{restrict:"E",templateUrl:a.getResourceUrl("Content/Templates/message_section.html"),controller:function(a,b,d,e){function f(a){var b=!0;return nullOrUndef(a.schema)||a.schema.schemaId.indexOf("Summary")>-1&&(b=!1),b}function g(){a.hasSuccessList=!1,a.hasSuccessDetail=!1,a.successMsg=null,d.showSuccessMessage=!1}a.contextPath=function(a){return url(a)},a.$on("sw_checksuccessmessage",function(b,c){if(!nullOrUndef(c.schema)){var e=c.schema;"list"==e&&d.showSuccessMessage&&null!=a.successMsg&&(a.hasSuccessList=!0,a.hasSuccessDetail=!1)}}),a.$on("sw_successmessage",function(b,c){!nullOrUndef(c.successMessage)&&f(c)?(nullOrUndef(c.schema)?a.hasSuccessDetail=!0:"List"==c.schema.stereotype?a.hasSuccessList=!0:a.hasSuccessDetail=!0,a.successMsg=c.successMessage,d.showSuccessMessage=!0):g()}),a.$on("sw_successmessagetimeout",function(a,b){g()}),a.$on("sw_ajaxerror",function(b,e,f){return 403==f?void c.logout():void(a.errorMsg||(a.errorMsg=e.errorMessage,a.errorStack=e.errorStack,a.$broadcast("sw_errormessage",!0),nullOrUndef(d.hasErrorDetail)&&nullOrUndef(d.hasErrorList)&&(d.hasErrorDetail=!0)))}),a.$on("sw_validationerrors",function(b,c){a.hasValidationError=!0,a.validationArray=c,$("html, body").animate({scrollTop:0},"fast")}),a.$on("sw_ajaxinit",function(b,c){a.removeAlert(),a.removeValidationAlert()}),a.$on("sw_cancelclicked",function(b,c){a.removeAlert(),a.removeValidationAlert()}),a.removeAlert=function(){d.hasErrorDetail=!1,d.hasErrorList=!1,a.errorMsg=null,a.errorStack=null,a.$broadcast("sw_errormessage",!1)},a.removeValidationAlert=function(){a.hasValidationError=!1,a.validationArray=null},a.openModal=function(){$("#errorModal").modal("show"),$("#errorModal").draggable()},a.hideModal=function(){$("#errorModal").modal("hide")},a.i18N=function(a,c,d){return b.get18nValue(a,c,d)},a.closeSuccessMessage=function(){g()}}}}),app.directive("pagination",function(a){return{restrict:"E",replace:!0,templateUrl:a.getResourceUrl("/Content/Templates/pagination.html"),scope:{renderfn:"&",paginationData:"=",showactions:"@",schemaId:"@",applicationName:"@",mode:"@",disablePrint:"@",disableExport:"@"},controller:function(a,b,c,d,e,f,g,h,i,j){a.contextPath=function(a){return url(a)},a.isHapag=function(){return"hapag"==c.clientName},a.i18N=function(a,b,c){return g.get18nValue(a,b,c)},a.previousPage=function(){var b=a.paginationData.pageNumber;b>1&&a.selectPage(b-1)},a.nextPage=function(){var b=a.paginationData.pageNumber;b<a.paginationData.pageCount&&a.selectPage(b+1)},a.exportToExcel=function(b){j.exporttoexcel(a.$parent.schema,a.$parent.searchData,a.$parent.searchSort,a.$parent.searchOperator,a.paginationData)};var k;a.exportToPrint=function(){e.printList(a.paginationData.totalCount,a.paginationData.pageSize,a.renderfn,a.$parent.schema)},a.selectPage=function(b){k=null,a.renderfn({pageNumber:b})},void 0===a.disablePrint&&(a.disablePrint=!1),void 0===a.disableExport&&(a.disableExport=!1),a.adjustMargin=function(b){if(a.isHapag()){var c="30px";"en"==b.toLowerCase()&&(c="60px"),$(".pagination-pager").css({"margin-left":c})}},a.adjustMargin(g.getCurrentLanguage())}}}),$(function(){if("undefined"!=typeof jScrollPane){var a,b=$(".menu-primary").jScrollPane({maintainPosition:!0}).data("jsp");$(window).bind("resize",function(){"undefined"!=typeof b&&(a||(a=setTimeout(function(){$(".menu-primary").height($(window).height()),b.reinitialise(),a=null},50)))}),$(document).on("mousewheel",".menu-primary",function(a){var b=a.originalEvent.wheelDelta;this.scrollTop+=30*(b<0?1:-1),a.preventDefault()})}});var app=angular.module("sw_layout"),app=angular.module("sw_layout");app.factory("alertService",function(a,b,c){return{confirm:function(a,b,d,e,f){var g="Are you sure you want to delete {0} {1}?".format(a,b);bootbox.setDefaults({locale:c.getCurrentLanguage()});var h=c.get18nValue("general.defaultcommands.delete.confirmmsg",g,[a,b]);bootbox.confirm({message:null==e?h:e,title:c.get18nValue("general.defaultcommands._confirmationtitle","Confirmation"),className:"smallmodal",callback:function(a){if(0!=a)d();else if(void 0!=f)return void f()}})},confirmCancel:function(a,b,d,e,f,g,h,i){var j="Are you sure you want to cancel {0} {1}?".format(e,f);bootbox.setDefaults({locale:c.getCurrentLanguage()});var k=c.get18nValue("general.defaultcommands.delete.confirmmsg",j,[e,f]);bootbox.confirm({message:null==h?k:h,title:c.get18nValue("general.defaultcommands._confirmationtitle","Confirmation"),className:"smallmodal",callback:function(b){if(0!=b)a.cancelfn({data:a.previousdata,schema:a.previousschema}),a.$emit("sw_cancelclicked");else if(void 0!=i)return void i();
}})},alert:function(a){bootbox.setDefaults({locale:c.getCurrentLanguage()}),bootbox.alert({message:a,title:c.get18nValue("general.defaultcommands._alert","Alert"),className:"smallmodal"})},success:function(c,d){var e={successMessage:c};a.$broadcast("sw_successmessage",e),d&&b(function(){e.successMessage=null,a.$broadcast("sw_successmessage",e)},5e3)},error:function(c,d){var e={errorMessage:c};a.$broadcast("sw_errormessage",e),d&&b(function(){e.errorMessage=null,a.$broadcast("sw_errormessage",e)},5e3)}}});var app=angular.module("sw_layout");app.factory("applicationFacade",function(a,b,c,d){return{tabsService:function(){return d},compositionService:function(){return b},printService:function(){return c}}});var app=angular.module("sw_layout");app.factory("associationService",function(a,b,c,d,e,f,g){var h=function(a,b,c){var e=d.getInstance("associationService#doUpdateExtraFields"),f=a.associationKey;if(c[f]={},c.extrafields=instantiateIfUndefined(c.extrafields),null!=a.extraProjectionFields)for(var g=0;g<a.extraProjectionFields.length;g++){var h=a.extraProjectionFields[g],i=null;if(null!=b&&(b.extrafields=b.extrafields||{},i=b.extrafields[h]),e.debug("updating extra field {0}.{1} | value={2}".format(f,h,i)),h.indexOf(f)>-1)c[h]=i;else{var j=h.indexOf(".")==-1,k=f;j&&(k+="."),k+=h,FillRelationship(c,k,i),c[GetRelationshipName(k)]=i,c[f][h]=i,FillRelationship(c.extrafields,k,i),c.extrafields[GetRelationshipName(k)]=i,c.extrafields[f][h]=i}}},i=function(a,b,c){if(null==c)return null;if(Array.isArray(c)){for(var d=[],e=0;e<c.length;e++){var f=i(a,b,c[e]);d=d.concat(f)}return d}var g=a.associationKey,h=b[g];if(null==h){if(void 0!=a.options){var j=$.grep(a.options,function(a){return c.equalIc(a.value)});return null==j?null:j[0]}return null}for(var e=0;e<h.length;e++){var k=h[e];if("string"==typeof c&&c.equalIc(k.value))return k}return null};return{cleanupDependantAssociationChain:function(a,b){var c=b.schema,e=b.datamap,f=b.associationOptions,h=c.dependantFields,i=h[a];if(null!=i)for(var j=0;j<i.length;j++){var k=i[j],l=g.getDisplayablesByAssociationKey(c,k),m=l[0].target;if(d.getInstance("associationService#cleanupDependantAssociationChain").debug("cleaning up dependant association of {0} {1}".format(a,m)),f[k]=[],isIe9()){var n=$("select[data-comboassociationkey='"+k+"']");n.hide(),n.show()}e[m]="$null$ignorewatch",this.cleanupDependantAssociationChain(m,b)}},getFullObjectByAttribute:function(a,b,c,d){var e=g.getDisplayableByKey(b,a);return this.getFullObject(e,c,d)},getFullObject:function(a,b,c){var e=a.target,f=b[e];if(null==f)return null;"string"==typeof f&&(f=f.replace("$ignorewatch",""));var g=i(a,c,f);return null==g&&d.getInstance("associationService#getFullObject").warn("value not found in association options for {0} ".format(a.associationKey)),g},updateUnderlyingAssociationObject:function(a,b,c){if(0!=a.extraProjectionFields.length){var d=a.associationKey;null==b&&(b=this.getFullObject(a,c.datamap,c.associationOptions)),null==b&&null==c.associationOptions[d]||h(a,b,c.datamap)}},postAssociationHook:function(b,c,e){if(void 0!=b.events){var f=b.events.afterchange;if(void 0!=f){var g=a.get(f.service);if(void 0!=g){var h=g[f.method];if(void 0!=h){var i=c.datamap;void 0!=c.datamap.fields&&(i=c.datamap.fields);var j={fields:i,scope:c,triggerparams:instantiateIfUndefined(e)};d.getInstance("associationService#postAssociationHook").debug("invoking post hook service {0} method {1}".format(f.service,f.method)),h(j)}}}}},updateAssociationOptionsRetrievedFromServer:function(a,b,c){var e=d.getInstance("associationService#updateAssociationOptionsRetrievedFromServer");a.associationOptions=instantiateIfUndefined(a.associationOptions),a.blockedassociations=instantiateIfUndefined(a.blockedassociations),a.associationSchemas=instantiateIfUndefined(a.associationSchemas),a.disabledassociations=instantiateIfUndefined(a.disabledassociations);for(var f in b){var g=instantiateIfUndefined(b[f]);e.debug("updating association from server {0} length {1}".format(f,null==g.associationData?0:g.associationData.length)),a.associationOptions[f]=g.associationData,a.blockedassociations[f]=null==g.associationData||0==g.associationData.length,a.associationSchemas[f]=g.associationSchemaDefinition}},restorePreviousValues:function(a,b,e){var f=d.getInstance("associationService#restorePrevious");for(var i in b){var j=instantiateIfUndefined(b[i]);f.debug("restoring previous values for {0}".format(i));var k=g.getDisplayablesByAssociationKey(a.schema,i);if(null!=k){var l=this;$.each(k,function(b,d){if(null!=d.target){if(isIe9()){var g=$("select[data-comboassociationkey='"+d.associationKey+"']");g.hide(),g.show(),g.css("width",0),g.css("width","")}var i=e[d.target];if(null!=j.associationData){if(null!=i){e[d.target]="$null$ignorewatch",i=i.replace("$ignorewatch","");for(var k=0;k<j.associationData.length;k++)if(j.associationData[k].value==i){var m=j.associationData[k];c(function(){f.debug("restoring {0} to previous value {1}. ".format(d.target,i)),e[d.target]=i+"$ignorewatch",h(d,m,e),l.postAssociationHook&&l.postAssociationHook(d,a,{phase:"initial",dispatchedbytheuser:!1})},0,!1);break}}var n=$.grep(j.associationData,function(a){if(null!=a.extrafields&&null!=a.extrafields.isSelected)return a});if(n.length>0){var o="checkbox"==d.rendererType?d.associationKey:d.target;e[o]=[];for(var p=0;p<n.length;p++)1==n[p].extrafields.isSelected&&e[o].push(n[p].value)}}}})}}},getEagerAssociations:function(a,b){var c=g.getDisplayablesOfTypes(a.schema.displayables,["OptionField","ApplicationAssociationDefinition"]);if(void 0!=c&&0!=c.length)return a.associationOptions=instantiateIfUndefined(a.associationOptions),a.blockedassociations=instantiateIfUndefined(a.blockedassociations),a.associationSchemas=instantiateIfUndefined(a.associationSchemas),this.updateAssociations({attribute:"#eagerassociations"},a,b)},updateAssociations:function(a,c,g){g=g||{};var h=a.attribute,i=c.schema;if("#eagerassociations"!=h&&$.inArray(h,i.fieldWhichHaveDeps)==-1)return!1;this.cleanupDependantAssociationChain(h,c);var j=this.updateAssociationOptionsRetrievedFromServer,k=this.restorePreviousValues,l=this.postAssociationHook,m=i.applicationName,n=c.datamap;c.datamap.fields&&(n=c.datamap.fields);var o={key:{schemaId:i.schemaId,mode:i.mode,platform:platform()},triggerFieldName:h,id:n[i.idFieldName]},p=f.removeExtraFields(n,!0,c.schema),q=url("/api/data/"+m+"?"+$.param(o)),r=angular.toJson(p),s=d.getInstance("associationService#updateAssociations");s.info("going to server for dependat associations of {0}".format(h)),s.debug("Content: \n {0}".format(r));var t={};g.avoidspin&&(t.avoidspin=!0),b.post(q,r,t).success(function(b){var d=b.resultObject;s.info("associations returned {0}".format($.keys(d))),j(c,d,n),"#eagerassociations"!=a.attribute?l(a,c,{dispatchedbytheuser:!0,phase:"configured"}):e.$broadcast("sw_associationsupdated",c.associationOptions),k(c,d,n)}).error(function(){})},onAssociationChange:function(b,c,d){if(void 0==b.events)return void d["continue"]();var e=b.events.beforechange;if(void 0==e)d["continue"]();else{var f=a.get(e.service);if(void 0==f)return void d["continue"]();var g=f[e.method];if(void 0==g)return void d["continue"]();var h=g(d);void 0!=h&&0==h&&d.interrupt(),d["continue"]()}},insertAssocationLabelsIfNeeded:function(a,b,c){if("true"==a.properties.addassociationlabels){var d=g.getDisplayablesOfTypes(a.displayables,["OptionField","ApplicationAssociationDefinition"]),e=this;$.each(d,function(a,d){var f=d.target,g="#"+f+"_label";if(!b[g]||""==b[g]){var h=e.getFullObject(d,b,c);if(null!=h&&Array.isArray(h)){b[g]="";for(var i=0;i<h.length;i++)null!=h[i]&&(b[g]+="\\n"+h[i].label)}else null!=h&&(b[g]=h.label)}})}},lookupAssociation:function(a,b){for(var c=0;c<a.length;c++){var d=a[c];if(void 0!=d.target&&d.target==b)return d}return null}}});var app=angular.module("sw_layout");app.factory("commandService",function(i18NService,$injector,expressionService){return{commandLabel:function(a,b,c){var d=a.commandSchema;if(null!=a.properties&&"cancel"==b&&null!=a.properties["detail.cancel.lbl"]){var e=a.properties["detail.cancel.lbl"];return i18NService.get18nValue("general."+e.toLowerCase(),e)}if(!d.hasDeclaration)return c;var f=$.inArray(b,d.toInclude);return f==-1?c:d.toInclude[f].label},shouldDisplayCommand:function(a,b){return!a.ignoreUndeclaredCommands&&($.inArray(b,a.toExclude)==-1&&$.inArray(b,a.toInclude)==-1)},isCommandHidden:function(datamap,schema,command,tabId){if(command.remove)return!0;var expression=command.showExpression;if(void 0==expression||""==expression)return!1;var expressionToEval=expressionService.getExpression(expression,datamap);return!eval(expressionToEval)},isCommandEnabled:function(datamap,schema,command,tabId){var expression=command.enableExpression;if(void 0==expression||""==expression)return!0;var expressionToEval=expressionService.getExpression(expression,datamap),returnValue=eval(expressionToEval);return returnValue},doCommand:function(a,b){var c=b.method;if("function"==typeof c)return void c();if(nullOrUndef(c)&&(c=b.id),void 0!=b.service){var d=$injector.get(b.service);if(void 0!=d){var e=d[c],f=[];null!=b.scopeParameters&&$.each(b.scopeParameters,function(b,c){f.push(a[c])}),e.apply(this,f)}}},executeClickCustomCommand:function(a,b,c){var d=a.indexOf("."),e=a.substring(0,d),f=a.substring(d+1),g=$injector.get(e);if(void 0==g){var h="missing clicking service".format(e);throw new Error(h)}var i=g[f],j=[];j.push(b),j.push(c),i.apply(this,j)}}}),function(angular){"use strict";var app=angular.module("sw_layout");app.factory("compositionService",["$log","$http","$rootScope","$timeout","contextService","submitService","schemaService","searchService","$q","fieldService","compositionCommons",function(a,b,c,d,e,f,g,h,i,j,k){function l(a){if(void 0!=a.nonInlineCompositionsDict)return a.nonInlineCompositionsDict;for(var b={},c=0;c<a.nonInlineCompositionIdxs.length;c++){var d=a.nonInlineCompositionIdxs[c],e=a.displayables[d];b[e.relationship]=e}return a.nonInlineCompositionsDict=b,b}function m(a,b){var c=h.buildSearchDTO();return c.pageNumber=a||1,c.pageSize="all"===b?0:b||z.defaultPageSize,c.totalCount=0,c.paginationOptions=z.defaultRequestOptions,c}function n(a,b){if(!a||!a.cachedCompositions)return null;var c=[],d=a.cachedCompositions;for(var e in d)d.hasOwnProperty(e)&&("lazy".equalsIc(d[e].fetchType)?c.push(e):"eager".equalsIc(d[e].fetchType)&&(A[e]=b[e]));return c}function o(c,d,f){var g=a.getInstance("compositionservice#fetchCompositions"),h=url("/api/generic/ExtendedData/GetCompositionData");return b.post(h,c,{avoidspin:!f}).then(function(a){var b=a.data,c=b.parentModifiedFields;if(c)for(var f in c)c.hasOwnProperty(f)&&(d[f]=c[f]);var h=b.resultObject,i={};for(var j in h)if(h.hasOwnProperty(j)){var k=h[j].resultList;g.info("composition {0} returned with {1} entries".format(j,k.length)),d[j]=k;var l=h[j].paginationData;l&&(l.paginationOptions=z.defaultOptions),e.insertIntoContext("compositionpagination_{0}".format(j),l,!0),A[j]=h[j],i[j]={relationship:j,list:k,paginationData:l}}return i})}function p(a,b){return o(a,b).then(function(a){return d(function(){c.$broadcast("sw_compositiondataresolved",a)}),a})}function q(a,b,c,d){var e=a.applicationName,h=f.removeExtraFields(b,!0,a),i=n(a,b);angular.forEach(i,function(a){h[a]&&h.hasOwnProperty(a)&&delete h[a]});var j={key:{schemaId:a.schemaId,mode:a.mode,platform:platform()},id:g.getId(b,a),paginatedSearch:d||m()};return j.compositionList=i,c&&c.length>0&&(j.compositionList=c),{application:e,request:j,data:h}}function r(a){return null!=A[a]}function s(a,b){var c=l(a),d=c[b];return null!=d.schema.schemas.print?d.schema.schemas.print:null!=d.schema.schemas.list?d.schema.schemas.list:d.schema.schemas.detail}function t(a,b){var c=l(a),d=c[b];return d.label}function u(a){var b=a.schemas.list;if(null==b)return null;var c=b.properties["composition.mainbuttonstoshow"];return nullOrEmpty(c)?[]:c.split(";")}function v(a){return g.hasEditableProperty(a)}function w(a,b){return k.buildMergedDatamap(a,b)}function x(b,c){var d=b.applicationName,e=a.getInstance("compositionservice#populateWithCompositionData");e.info("going to server fetching composition data of {0}, schema {1}.".format(d,b.schemaId)),A={};var f=q(b,c);return p(f,c)}function y(a,b,c,d,e){var f=m(d,e),g=q(b,c,[a],f);return o(g,c,!0)}var z={defaultPageSize:10,defaultOptions:[10,30,"all"],defaultRequestOptions:[0,10,30]},A={},B={locatePrintSchema:s,getTitle:t,getListCommandsToKeep:u,hasEditableProperty:v,buildMergedDatamap:w,populateWithCompositionData:x,getCompositionList:y,isCompositionLodaded:r};return B}])}(angular),function(angular){"use strict";var a=function(){var a=function(a,b){var c=b;b.fields&&(c=b.fields);var d=angular.copy(c);if(a){var e=a;for(var f in e)e.hasOwnProperty(f)&&(d[f]=e[f])}return d},b={buildMergedDatamap:a};return b};angular.module("sw_layout").factory("compositionCommons",a)}(angular);var app=angular.module("sw_layout");app.factory("contextService",function(a){return{insertIntoContext:function(b,c,d){d?a["ctx_"+b]=c:(null==c||isString(c)||(c=JSON.stringify(c)),sessionStorage["ctx_"+b]=c)},get:function(a,b,c){return this.fetchFromContext(a,b,c)},fetchFromContext:function(a,b,c,d){var e=this.retrieveFromContext(a,c,d);if("undefined"!=e)return null!=e&&1==b&&isString(e)?JSON.parse(e):e},getFromContext:function(a,b,c){return this.fetchFromContext(a,b,c)},retrieveFromContext:function(b,c,d){if(c){var e=a["ctx_"+b];return d&&delete a["ctx_"+b],e}var f=sessionStorage["ctx_"+b];return d&&delete sessionStorage["ctx_"+b],"null"==f?null:f},isLocal:function(){return this.retrieveFromContext("isLocal")},getUserData:function(){if(null!=a.user)return a.user;var b=this.retrieveFromContext("user");if(null==b)return null;var c=JSON.parse(b);return a.user=c,c},InModule:function(a){if(null==a)return!1;var b=!1,c=this.currentModule();return!nullOrUndef(c)&&($.each(a,function(a,d){if(d.equalIc(c))return void(b=!0)}),b)},HasRole:function(a){if(null==a)return!0;var b=this.getUserData(),c=b.roles,d=!1;return $.each(a,function(a,b){$.each(c,function(a,c){if(c.name==b)return void(d=!0)})}),d},loadUserContext:function(b){a.user=null,this.insertIntoContext("user",JSON.stringify(b))},loadConfigs:function(a){this.insertIntoContext("clientName",a.clientName),this.insertIntoContext("environment",a.environment),this.insertIntoContext("isLocal",a.isLocal),this.insertIntoContext("i18NRequired",a.i18NRequired),this.insertIntoContext("systeminittime",a.initTimeMillis),this.insertIntoContext("successMessageTimeOut",a.successMessageTimeOut),a.clientSideLogLevel.equalsAny("warn","debug","info","error","none")||(a.clientSideLogLevel="warn"),this.insertIntoContext("defaultlevel",a.clientSideLogLevel.toLowerCase())},getResourceUrl:function(a){var b=url(a);if(!this.isLocal()){var c=this.getFromContext("systeminittime");return b.indexOf("?")==-1?b+"?"+c:b+"&"+c}return b},currentModule:function(){return this.retrieveFromContext("currentmodule")},clearContext:function(){$.each(sessionStorage,function(a,b){a.startsWith("ctx_")&&delete sessionStorage[a]}),$(hiddn_user)[0].value=null,$(hddn_configs)[0].value=null},deleteFromContext:function(b){delete sessionStorage["ctx_"+b],delete a["ctx_"+b]},insertReportSearchDTO:function(a,b){this.insertIntoContext("repSearchDTO_"+a,b)},retrieveReportSearchDTO:function(a){return this.retrieveFromContext("repSearchDTO_"+a)},client:function(){return this.retrieveFromContext("clientName")},isClient:function(a){if(null==a)return $log.getInstance("contextService#isClient").warn("asked for null client name"),!1;var b=this.client();return a==b||"array"==typeof a&&jQuery.inArray(b,a)!=-1},setActiveTab:function(a){this.insertIntoContext("currenttab",a)},getActiveTab:function(){return this.fetchFromContext("currenttab")}}});var app=angular.module("sw_layout");app.factory("crudextraService",function(a,b,c,d){return{deletefn:function(c,e){var f=c.idFieldName,g=c.applicationName,h=e[f];d.confirm(g,h,function(){var d={};"true"==sessionStorage.mockmaximo&&(d.mockmaximo=!0),d.platform=platform(),d=addSchemaDataToParameters(d,c);var e=$.param(d),f=removeEncoding(url("/api/data/"+g+"/"+h+"?"+e));a["delete"](f).success(function(a){b.$broadcast("sw_applicationrenderviewwithdata",a)})})},printDetail:function(a,b){c.printDetail(a,b[a.idFieldName])}}}),function(){"use strict";function a(a,b){function c(){return a.getActiveTab()}function d(b){a.setActiveTab(b)}function e(){return h.currentApplicationName}function f(){return h.currentSchema}function g(a){h={},h.currentSchema=a,h.currentApplicationName=a.applicationName,b.addSchemaToCache(a)}var h={currentSchema:null,currentApplicationName:null,detail_previous:"0",detail_next:"0",list_elements:[],previousData:null,paginationData:null},i={getActiveTab:c,setActiveTab:d,currentSchema:f,currentApplicationName:e,updateCrudContext:g};return i}angular.module("sw_layout").factory("crudContextHolderService",["contextService","schemaCacheService",a])}(),function(angular){"use strict";function a(a,b,c,d,e,f,g,h,i){function j(c,d){var e=l(c,d),f=m(c,d);b.all([e,f]).then(function(b){a.get("detailService#fetchRelationshipData").info("associations and compositions fetched"),c.$broadcast("sw_configuredirtywatcher")})}function k(a,b){return void 0!=g.getId(b,a)}function l(d,f){var g=!f.allassociationsFetched;return e.updateAssociationOptionsRetrievedFromServer(d,f.associationOptions,d.datamap.fields),e.restorePreviousValues(d,f.associationOptions,d.datamap.fields),g?c(function(){a.get("#detailService#fetchRelationshipData").info("fetching eager associations of {0}".format(d.schema.applicationName)),e.getEagerAssociations(d,{avoidspin:!0})}):(i.insertIntoContext("associationsresolved",!0,!0),b.when())}function m(d,e){var g=d.datamap.fields,i=d.schema,j=k(i,g);if(!j)return b.when();var l=!h.isPropertyTrue(e.schema,"detail.prefetchcompositions");return l||(d.compositions=e.compositions),c(function(){return l?(a.get("#detailService#fetchRelationshipData").info("fetching compositions of {0}".format(d.schema.applicationName)),f.populateWithCompositionData(d.schema,d.datamap.fields)):b.when()})}var n={fetchRelationshipData:j,isEditDetail:k};return n}a.$inject=["$log","$q","$timeout","$rootScope","associationService","compositionService","fieldService","schemaService","contextService"],angular.module("sw_layout").factory("detailService",a)}(angular);var app=angular.module("sw_layout");app.factory("dispatcherService",function(a,b){var c=function(c,d){var e=b.getInstance("dispatcherService#loadService");if(void 0===c||void 0===d)return null;var f=a.get(c);if(!f)return e.warn("Service {0} missing ".format(c)),null;var g=f[d];return g?g:(e.warn("Method {0} not found on service {1}".format(d,c)),null)};return{loadService:function(a,b){return c(a,b)}}});var app=angular.module("sw_layout");app.factory("excelService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(a){if("assetlistreport"!=a)return!1;var b=k.InModule(["tom","itom","purchase","assetcontrol"]);if(b)return!0;var c=k.InModule(["xitc"]);return c&&h.InGroup("C-HLC-WW-AR-WW")}function p(a,b){var c=sessionStorage.swGlobalRedirectURL&&sessionStorage.swGlobalRedirectURL.indexOf("searchValues")!=-1;return isObjectEmpty(a)&&!b&&!c}return{showModalExportToExcel:function(a,b,c,d,e,f){function h(a){bootbox.dialog({message:"<form id='region' action=''><label class='control-label'>"+j+":</label><br><label class='control-label' for='gridonlyid'><input type='radio' name='region' id='gridonlyid' value='C-HLC-WW-RG-NAMERICA'  /> Region North America</label><br><label class='control-label' for='gridonlyid'><input type='radio' name='region' id='gridonlyid' value='C-HLC-WW-RG-SAMERICA' /> Region South America</label><br><label class='control-label' for='gridonlyid'><input type='radio' name='region' id='gridonlyid' value='C-HLC-WW-RG-EUROPE'  /> Region Europe</label><br><input type='radio' name='region' id='gridonlyid' value='C-HLC-WW-RG-ASIA'  /> Region Asia</label><br><input type='radio' name='region' id='gridonlyid' value='C-HLC-WW-RG-GSC'  /> Region GSC</label><br><input type='radio' name='region' id='gridonlyid' value='C-HLC-WW-RG-HQ'  /> Region HeadQuarters</label><br></form>",title:j,buttons:{main:{label:g.get18nValue("_exportotoexcel.export","Export"),className:"btn-primary",callback:function(g){if(g){var h=$("input[name=region]:checked","#region").val();if(p(c,h))return void m.alert("Please select either a Region or a filter on the grid");var i=h?"region={0}".format(h):null;a(b,c,d,e,f,"assetlistreport",i)}}},cancel:{label:g.get18nValue("_exportotoexcel.cancel","Cancel"),className:"btn btn-default",callback:function(){return null}}},className:"hapag-modal-exporttoexcel"})}var i=g.get18nValue("_exportotoexcel.export","Export")+" "+b.applicationName+" "+g.get18nValue("_exportotoexcel.toexcel","to excel"),j=g.get18nValue("_exportotoexcel.selectregion","Select Region"),k=g.get18nValue("_exportotoexcel.selectexportmode","Select export mode"),l=g.get18nValue("_exportotoexcel.gridonly","Grid only"),n=g.get18nValue("_exportotoexcel.allthecolumns","Asset List");g.get18nValue("_exportotoexcel.categories","Categories");bootbox.dialog({message:"<form id='infos' action=''><label class='control-label'>"+k+":</label><br><label class='control-label' for='gridonlyid'><input type='radio' name='exportMode' id='gridonlyid' value='list' checked='checked' /> "+l+"</label><br><label class='control-label' for='allthecolumnsid'><input type='radio' name='exportMode' id='allthecolumnsid' value='assetlistreport' /> "+n+"</label></form>",title:i,buttons:{main:{label:g.get18nValue("_exportotoexcel.export","Export"),className:"btn-primary",callback:function(g){if(g){var i=$("input[name=exportMode]:checked","#infos").val();if(o(i))return void h(a);a(b,c,d,e,f,i)}}},cancel:{label:g.get18nValue("_exportotoexcel.cancel","Cancel"),className:"btn btn-default",callback:function(){return null}}},className:"hapag-modal-exporttoexcel"})},exporttoexcel:function(a,b,c,d,e,f,g){var h=a.applicationName;if(k.isClient("hapag")&&"asset"==h&&!f){var i=this.exporttoexcel;return this.showModalExportToExcel(i,a,b,c,d,e),null}var o=f?f:a.schemaId,p={};p.key={},p.key.schemaId=o,p.key.mode=a.mode,p.key.platform="web",p.application=h,p.currentmodule=k.retrieveFromContext("currentmodule"),p.currentmetadata=k.retrieveFromContext("currentmetadata"),p.currentmetadataparameter=g;var q,r=k.retrieveReportSearchDTO(a.schemaId);null!=r?(r=$.parseJSON(r),q=j.buildReportSearchDTO(r,b,c,d,e.filterFixedWhereClause,e.unionFilterFixedWhereClause)):q=j.buildSearchDTO(b,c,d,e.filterFixedWhereClause,e.unionFilterFixedWhereClause);var s=k.currentModule();null!=s&&(p.module=s),q.pageNumber=1,q.totalCount=e.totalCount,q.pageSize=e.pageSize,p.searchDTO=q,n.getPromise("ExtendedData","PingServer").then(function(){l.download(url("/Excel/Export?"+$.param(p)),function(a,b){},function(a,b){m.alert("Error generating the {0}.{1} report. Please contact your administrator".format(h,o))})})}}});var app=angular.module("sw_layout");app.factory("expressionService",function($rootScope,contextService){var preCompiledReplaceRegex=/(?:^|\W)@(\#*)(\w+)(?!\w)/g;return{getExpression:function(a,b){return a=void 0!=b.fields?a.replace(/\@/g,"datamap.fields."):a.replace(/\@/g,"datamap."),a=a.replace(/ctx:/g,"contextService.")},getVariables:function(a){var b=a.match(preCompiledReplaceRegex);if(null!=b)for(var c=0;c<b.length;c++)b[c]=b[c].replace(/[\@\(\)]/g,"").trim();return b},getVariablesForWatch:function(a){for(var b=this.getVariables(a),c="[",d=0;d<b.length;d++)c+="datamap."+b[d],d!=b.length-1&&(c+=",");return c+="]"},evaluate:function(expression,datamap){if("true"==expression)return!0;if("false"==expression)return!1;var expressionToEval=this.getExpression(expression,datamap);try{return eval(expressionToEval)}catch(e){return $rootScope.isLocal&&console.log(e),!0}}}});var app=angular.module("sw_layout");app.factory("fieldService",function(a,b){var c=function(b,d,e){if(e.jscache=instantiateIfUndefined(e.jscache),void 0!=e.jscache.isHidden)return e.jscache.isHidden;var f=e.isHidden||"ApplicationSection"!=e.type&&e.attribute==d.idFieldName&&"Detail"==d.stereotype&&"input"==d.mode&&!e.isReadOnly,g="ApplicationCompositionDefinition"==e.type&&!e.inline;if(f||g)return e.jscache.isHidden=!0,!0;if("ApplicationSection"==e.type&&null==e.resourcepath&&(0==e.displayables.length||0==$.grep(e.displayables,function(a){return!c(b,d,a)}).length))return!0;var h=!a.evaluate(e.showExpression,b);return"List"==d.stereotype&&(e.jscache.isHidden=h),!a.evaluate(e.showExpression,b)};return{isFieldHidden:function(a,b,d){return c(a,b,d)},isFieldRequired:function(b,c){if("ApplicationSection"===b.type&&b.parameters)return"true"===b.parameters.required;var d=b.requiredExpression;return void 0!=d?a.evaluate(d,c):d},nonTabFields:function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c],e=d.type,f=this.isTabComposition(d);f||"ApplicationTabDefinition"==e||b.push(d)}return b},isTabComposition:function(a){var b=a.type;return"ApplicationCompositionDefinition"==b&&!a.inline},isTab:function(a){if(null!=a){var b=a.type;return"ApplicationTabDefinition"==b}},getDisplayableByKey:function(a,b){if(a.jscache=instantiateIfUndefined(a.jscache),a.jscache.fieldsByKey=instantiateIfUndefined(a.jscache.fieldsByKey),void 0!=a.jscache.fieldsByKey[b])return a.jscache.fieldsByKey[b];for(var c=a.displayables,d=0;d<c.length;d++){var e=c[d];if(e.attribute&&e.attribute==b||e.tabId&&e.tabId==b)return a.jscache.fieldsByKey[b]=e,e;if(void 0!=e.displayables){var f=this.getDisplayableByKey(e,b);if(void 0!=f&&(f.attribute&&f.attribute==b||f.tabId&&f.tabId==b))return a.jscache.fieldsByKey[b]=f,f}}return null},getDisplayablesByAssociationKey:function(a,b){a.jscache=instantiateIfUndefined(a.jscache);var c=a.jscache.displayablesByAssociation=instantiateIfUndefined(a.jscache.displayablesByAssociation);if(void 0!=c[b])return c[b];var d=[],e=this;return $.each(a.displayables,function(a,c){if(c.associationKey==b)d.push(c);else if(void 0!=c.displayables){var f=e.getDisplayablesByAssociationKey(c,b);null!=f&&(d=d.concat(f))}}),c[b]=d,d},countVisibleDisplayables:function(a,b,c){for(var d=0,e=0;e<c.length;e++)this.isFieldHidden(a,b,c[e])||d++;return d},getId:function(a,b){return a[b.idFieldName]},getDisplayablesOfTypes:function(a,b){var c=[],d=this;return $.each(a,function(a,e){var f=e.type;if($.inArray(f,b)!=-1&&c.push(e),void 0!=e.displayables){var g=d.getDisplayablesOfTypes(e.displayables,b);c=c.concat(g)}}),c},getDisplayablesOfRendererTypes:function(a,b){var c=[],d=this;return $.each(a,function(a,e){var f=e.rendererType;$.inArray(f,b)!=-1&&c.push(e),void 0!=e.displayables&&(c=c.concat(d.getDisplayablesOfRendererTypes(e.displayables,b)))}),c},getFilterDisplayables:function(a){var b=[],c=this;return $.each(a,function(a,d){null!=d.filter&&null!=d.filter.operation&&b.push(d),void 0!=d.displayables&&(b=b.concat(c.getFilterDisplayables(d.displayables)))}),b},isNullInvisible:function(b,c){return void 0!=b.showExpression&&"true"!=b.showExpression&&!b.isHidden&&!a.evaluate(b.showExpression,c)}}});var app=angular.module("sw_layout");app.factory("fileService",function(a,b){return{download:function(c,d,e){c=removeEncoding(c),a.$broadcast("sw_ajaxinit"),$.fileDownload(c,{successCallback:function(b,c){a.$broadcast("sw_ajaxend"),d&&d(b,c)},failCallback:function(c,d,f){a.$broadcast("sw_ajaxend"),e&&(f.indexOf("SignIn")!=-1?(sessionStorage.removeItem("swGlobalRedirectURL"),b.clearContext(),window.location.reload()):e(c,d))}})}}});var app=angular.module("sw_layout");app.factory("fixHeaderService",function(a,b,c,d,e){var f=function(a){var b=$("#affixpagination"),c=$("#listgridthread"),d=$("#listgrid"),e="pagination-errormessage",f="listgrid-thead-errormessage",g="listgrid-table-errormessage";a?(b.addClass(e),c.addClass(f),d.addClass(g)):(b.removeClass(e),c.removeClass(f),d.removeClass(g))},g=function(b){var c=$("#affixpagination"),d=$("#listgridthread"),e=$("#listgrid"),f="pagination-successmessage",g="listgrid-thead-successmessage",h="listgrid-table-successmessage",i="listgrid-thead-reset",j="listgrid-table-reset",k="listgrid-thead-successmessage-ie",l="listgrid-table-successmessage-ie";b?(c.addClass(f),isIe9()&&"hapag"==a.clientName?(d.addClass(k),e.addClass(l)):(d.removeClass(i),d.addClass(g),e.removeClass(j),e.addClass(h))):(c.removeClass(f),isIe9()&&"hapag"==a.clientName?(d.removeClass(k),e.removeClass(l)):(d.removeClass(g),d.addClass(i),e.removeClass(h),e.addClass(j)))},h=function(a,b,c){var d=[],e=c?"thead tr:eq(0) th":"tbody tr:eq(0) td";$(e,b).each(function(a,b){var c=$(b);if("none"!=c.css("display")){var e=c.width();d.push(e)}else d.push(0)}),a.trace("thead array: "+d);for(var f=0,g=0;g<d.length;g++)f+=d[g]<<0;return a.trace("total "+f),d};return{updateFilterZeroOrOneEntries:function(){this.fixThead(null,{empty:!0})},updateFilterVisibility:function(a,c){var d=$(".listgrid-table"),e=!1;if(null!=a){var f=150*a.displayables.length,g="true"==a.properties["list.advancedfilter.allowtoggle"];e=g&&f>d.width()}return e?($(".hidden-too-much-columns",d).hide(),void $(".hidden-few-columns",d).show()):void(isIe9()&&c&&$("thead tr:eq(1) th",d).each(function(a,d){var e=c[a];if(0!=e){for(var f=$(".input-group",d).children(),g=0,h=1;h<f.length;h++)g+=f.eq(h).outerWidth();if(0!=g){var i=f.eq(0),j=i.width(),k=i.outerWidth()-j,l=e-g-k;b.getInstance("fixheaderService#updateFilterVisibility").debug("result:{0} | Previous:{1} | tr:{2} | addon:{3} | Padding{4}".format(l,j,e,g,k)),i.width(l)}}}))},fixTableTop:function(a,c){var d=$("thead",a);c=instantiateIfUndefined(c),$(".listgrid-table").addClass("affixed"),$(".listgrid-table").removeClass("unfixed");var e=d.height();b.getInstance("fixheaderService#fixTableTop").debug("head height: "+e),isIe9()&&"true"!=sessionStorage.mockie9?(a.css("margin-top",e+19),d.css("top",111-(e+19))):(a.css("margin-top",e+23),d.css("top",114))},fixThead:function(a,c){var e=b.getInstance("fixheaderService#fixThead");e.debug("starting fix Thead"),c&&c.resizing||this.unfix();var f=$(".listgrid-table"),g=h(e,f,c.empty);$("thead tr:eq(0) th",f).each(function(a,b){$(b).width(g[a])}),$("thead tr:eq(1) th",f).each(function(a,b){$(b).width(g[a])}),$("tbody tr:eq(0) td",f).each(function(a,b){$(b).width(g[a])}),e.debug("updating filter visibility"),this.updateFilterVisibility(a,g),d.insertIntoContext("currentgridarray",g),e.debug("updated filter visibility"),this.fixTableTop(f,c),$("#pagesize").width($("#pagesize").width()),e.debug("finishing fix Thead")},activateResizeHandler:function(){var a=($(window).width(),this);$(window).resize(function(){$(this).width();b.getInstance("fixheaderService#resize").debug("switching resolutions"),a.fixThead(null,{resizing:!0})})},FixHeader:function(){var a,b;$(window).scroll(function(){null==a&&(a=$("#listgrid"),b=$("thead",a).top);var c=$(window).scrollTop();$("thead",a).css("top",c+b)})},unfix:function(){var a=b.getInstance("fixheaderService#unfix");a.debug("unfix started");var c=$(".listgrid-table");c.removeClass("affixed"),c.addClass("unfixed"),$("[rel=tooltip]").tooltip("hide"),a.debug("unfix finished")},fixSuccessMessageTop:function(a){a&&g(!0)},topErrorMessageHandler:function(b,c,d){b?c?a.hasErrorDetail=!0:(f(!0),a.hasErrorList=!0):f(!1)},resetTableConfig:function(a){if(void 0!=$(".listgrid-table").position()){if(g(!1),!nullOrUndef(a)){var b={};this.fixThead(a,b)}$(window).trigger("resize")}}}});var app=angular.module("sw_layout");app.factory("formatService",function(a,b){var c=function(b,c,d){if(null==b)return null;if("@currentdatetime"===b||"@currentdate"===b)return a("date")(new Date,c);if(d){var e=Date.parse(b);return null==e||isNaN(e)?a("date")(b,c):a("date")(e,c)}try{return a("date")(b,c)}catch(f){return b=new Date(b),a("date")(b,c)}},d=function(a,b){if(null==a)return"";try{var d=a.split("Logged Date:")[1];if(!nullOrUndef(d)){var e=d.replace(/ /g,""),f=b.rendererParameters.format,g=c(e,f,!1);a=a.replace(e,g)}}catch(h){return a}return a};return{format:function(a,e){if(void 0==e)return a;var f;if("datetime"==e.rendererType){if(null!=e.rendererParameters.format&&null!=a)return f=e.rendererParameters.format,
c(a,f,!1)}else if("ApplicationSection"==e.type&&e.parameters.format){if(null!=e.parameters.format&&null!=a)return f=e.parameters.format,c(a,f,!1)}else if(void 0!=e.rendererParameters&&null!=e.rendererParameters.formatter)if("numberToBoolean"==e.rendererParameters.formatter)a=1==a?b.get18nValue("general.yes","Yes"):b.get18nValue("general.no","No");else{if("doubleToTime"==e.rendererParameters.formatter){if(null==a)return"";var g=a.toString();if(g.length>0&&g.indexOf(".")==-1)return a+" : 00";var h=g.split(".")[0],i=g.split(".")[1];h=parseInt(h);var j=Math.round(Math.round(60*parseFloat("0."+i)*100)/100);return(h<10?"0"+h:h)+" : "+(j<10?"0"+j:""+j)}if("descriptionDataHandler"==e.rendererParameters.formatter)return d(a,e)}return a},formatDate:function(a,b){return c(a,b,!0)},adjustDateFormatForPicker:function(a,b){return void 0==a||""==a?b?"yyyy-MM-dd hh:ii":"yyyy-MM-dd":(a=a.replace("mm","ii"),a=a.replace("MM","mm"),a=a.replace("HH","hh"),b||(a=a.replace("hh:ii","")),a.trim())}}});var app=angular.module("sw_layout");app.factory("i18NService",function(a,b){function c(a){var b;return b=null==a.attribute&&void 0!=a.label?a.label.replace(":",""):a.attribute}var d=function(b){var c=a.sw_i18ncatalogs,d=!0;return $.each(c,function(a,c){"en"!=a&&(d=d&&e(b,c))}),d},e=function(a,b){var c=null;return null!=b&&(c=JsonProperty(b,a)),null!=c},f=function(c,e,f,g){if(!g&&!nullOrUndef(b.retrieveFromContext("currentmodule"))&&!f)return e;var h=a.sw_currentcatalog;g&&""!=g&&(h=a.sw_i18ncatalogs[g]);var i=null;if(null!=h&&(i=JsonProperty(h,c)),null!=i)return i;if(a.isLocal&&1==a.i18NRequired){if(null==e)return null;if(void 0==sessionStorage.ignorei18n&&!d(c))return"??"+e+"??"}return e},g=function(a,b){return void 0==a?null:"string"==typeof a?a:a.hasOwnProperty(b.schemaId)?a[b.schemaId]:a._};return{getI18nLabel:function(a,b){if("ApplicationCompositionDefinition"==a.type||"ApplicationSection"==a.type){var d=this.getI18nSectionHeaderLabel(a,a.header,b);if(null!=d&&""!=d)return d}var e=b.applicationName,h=c(a),i=e+"."+h;"OptionField"==a.type&&(i+="._label");var j=f(i,a.label);return g(j,b)},getI18nLabelTooltip:function(b,d){var h=d.applicationName,i=c(b),j=h+"."+i+"._tooltip";e(j,a.sw_currentcatalog)||(j=h+"."+i,"OptionField"==b.type&&(j+="._label"));var k=b.toolTip;void 0==k&&(k=b.label);var l=f(j,k);return g(l,d)},getI18nOptionField:function(a,b,c){if("OptionField"!=b.type||null!=b.providerAttribute)return a.label;var d=c.applicationName,e=b.attribute,h=""==a.value?a.label:a.value,i=d+"."+e+"."+h,j=f(i,a.label);return g(j,c)},getI18nCommandLabel:function(a,b){var c=b.applicationName,d=c+"._commands."+a.id,e=f(d,a.label);return g(e,b)},getI18nMenuLabel:function(a,b){if(nullOrUndef(a.id))return b?a.tooltip:a.title;var c=a.title,d="_menu."+a.id;return b&&(d+="_tooltip",c=a.tooltip),f(d,c,!0)},getI18nTitle:function(a){var b=a.applicationName,c=b+"._title."+a.schemaId;return f(c,a.title)},get18nValue:function(a,b,c,d){var e=a.indexOf("_headermenu")>-1,g=f(a,b,e,d);if(void 0==c)return g;var h=g.format;return h.apply(g,c)},getI18nSectionHeaderLabel:function(a,b,c){if(void 0==b)return"";var d=c.applicationName;a=nullOrUndef(a.id)?a.relationship:a.id;var e=d+"."+a+"._header",h=f(e,b.label);return g(h,c)},getTabLabel:function(a,b){var c=a.applicationName,d=c+"."+a.id+"._title",e=f(d,a.label);return g(e,b)},load:function(b,c){var d=JSON.parse(b),e={};$.each(d,function(a,b){e[a]=b}),a.sw_i18ncatalogs=e,this.changeCurrentLanguage(c)},getCurrentLanguage:function(){return a.sw_userlanguage},changeCurrentLanguage:function(b){null==b&&(b="en"),a.sw_userlanguage=b,a.sw_currentcatalog=a.sw_i18ncatalogs[b.toLowerCase()],a.$broadcast("sw_languageChanged",b.toLowerCase())}}}),function(){"use strict";var app=angular.module("sw_layout");app.provider("localStorageService",function(){this.prefix="ls",this.storageType="localStorage",this.cookie={expiry:30,path:"/"},this.notify={setItem:!0,removeItem:!1},this.setPrefix=function(a){this.prefix=a},this.setStorageType=function(a){this.storageType=a},this.setStorageCookie=function(a,b){this.cookie={expiry:a,path:b}},this.setStorageCookieDomain=function(a){this.cookie.domain=a},this.setNotify=function(a,b){this.notify={setItem:a,removeItem:b}},this.$get=["$rootScope","$window","$document",function(a,b,c){var d,e=this.prefix,f=this.cookie,g=this.notify,h=this.storageType;c?c[0]&&(c=c[0]):c=document,"."!==e.substr(-1)&&(e=e?e+".":"");var i=function(a){return e+a},j=function(){try{var c=h in b&&null!==b[h],e=i("__"+Math.round(1e7*Math.random()));return c&&(d=b[h],d.setItem(e,""),d.removeItem(e)),c}catch(f){return h="cookie",a.$broadcast("LocalStorageModule.notification.error",f.message),!1}}(),k=function(b,c){if(!j||"cookie"===this.storageType)return a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),g.setItem&&a.$broadcast("LocalStorageModule.notification.setitem",{key:b,newvalue:c,storageType:"cookie"}),q(b,c);"undefined"==typeof c&&(c=null);try{(angular.isObject(c)||angular.isArray(c))&&(c=angular.toJson(c)),d&&d.setItem(i(b),c),g.setItem&&a.$broadcast("LocalStorageModule.notification.setitem",{key:b,newvalue:c,storageType:this.storageType})}catch(e){return a.$broadcast("LocalStorageModule.notification.error",e.message),q(b,c)}return!0},l=function(b){if(!j||"cookie"===this.storageType)return a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),r(b);var c=d?d.getItem(i(b)):null;return c&&"null"!==c?"{"===c.charAt(0)||"["===c.charAt(0)?angular.fromJson(c):c:null},m=function(b){if(!j)return a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),g.removeItem&&a.$broadcast("LocalStorageModule.notification.removeitem",{key:b,storageType:"cookie"}),s(b);try{d.removeItem(i(b)),g.removeItem&&a.$broadcast("LocalStorageModule.notification.removeitem",{key:b,storageType:this.storageType})}catch(c){return a.$broadcast("LocalStorageModule.notification.error",c.message),s(b)}return!0},n=function(){if(!j)return a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),!1;var b=e.length,c=[];for(var f in d)if(f.substr(0,b)===e)try{c.push(f.substr(b))}catch(g){return a.$broadcast("LocalStorageModule.notification.error",g.Description),[]}return c},o=function(b){b=b||"";var c=e.slice(0,-1),f=new RegExp(c+"."+b);if(!j)return a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),t();var g=e.length;for(var h in d)if(f.test(h))try{m(h.substr(g))}catch(i){return a.$broadcast("LocalStorageModule.notification.error",i.message),t()}return!0},p=function(){try{return navigator.cookieEnabled||"cookie"in c&&(c.cookie.length>0||(c.cookie="test").indexOf.call(c.cookie,"test")>-1)}catch(b){return a.$broadcast("LocalStorageModule.notification.error",b.message),!1}},q=function(b,d){if("undefined"==typeof d)return!1;if(!p())return a.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;try{var e="",g=new Date,h="";if(null===d?(g.setTime(g.getTime()+-864e5),e="; expires="+g.toGMTString(),d=""):0!==f.expiry&&(g.setTime(g.getTime()+24*f.expiry*60*60*1e3),e="; expires="+g.toGMTString()),b){var j="; path="+f.path;f.domain&&(h="; domain="+f.domain),c.cookie=i(b)+"="+encodeURIComponent(d)+e+j+h}}catch(k){return a.$broadcast("LocalStorageModule.notification.error",k.message),!1}return!0},r=function(b){if(!p())return a.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;for(var d=c.cookie&&c.cookie.split(";")||[],f=0;f<d.length;f++){for(var g=d[f];" "===g.charAt(0);)g=g.substring(1,g.length);if(0===g.indexOf(i(b)+"="))return decodeURIComponent(g.substring(e.length+b.length+1,g.length))}return null},s=function(a){q(a,null)},t=function(){for(var a=null,b=e.length,d=c.cookie.split(";"),f=0;f<d.length;f++){for(a=d[f];" "===a.charAt(0);)a=a.substring(1,a.length);var g=a.substring(b,a.indexOf("="));s(g)}},u=function(){return h},v=function(a,b,c){var d=l(b);null===d&&angular.isDefined(c)?d=c:angular.isObject(d)&&angular.isObject(c)&&(d=angular.extend(c,d)),a[b]=d,a.$watchCollection(b,function(a){k(b,a)})};return{isSupported:j,getStorageType:u,set:k,add:k,get:l,keys:n,remove:m,clearAll:o,bind:v,deriveKey:i,cookie:{set:q,add:q,get:r,remove:s,clearAll:t}}}]})}.call(this);var app=angular.module("sw_layout");app.factory("logoutService",function(a,b,c){return{logout:function(b){if(null==a.getUserData())return void(c.location.href=url("/SignOut/SignOut"));var d="manual"==b?"Logout!":"Automatic Logout!",e="manual"==b?"You have successfully logged out of ServiceIT.</br>To completely logout, please close your browser. To log back into ServiceIT, click the button provided below.":" Auf Grund zu langer InaktivitÃ¤t wurden Sie aus SicherheitsgrÃ¼nden automatisch ausgeloggt <br> You have been automatically logged out due to inactivity. <br> Usted ha sido cerrada automÃ¡ticamente debido a la inactividad.";bootbox.dialog({message:e,title:d,className:"logoutmodal",closeButton:!1,buttons:{success:{label:"Close Browser",className:"commandButton btn loginbutton",callback:function(){sessionStorage.removeItem("swGlobalRedirectURL"),a.clearContext(),c.location.href=url(isIe()?"/SignOut/SignOut":"/SignOut/SignOutClosePage"),window.open("","_self",""),window.close()}},danger:{label:"Login to ServiceIT",className:"commandButton btn loginbutton",callback:function(){sessionStorage.removeItem("swGlobalRedirectURL"),a.clearContext(),c.location.href=url("/SignOut/SignOut")}}}})}}});var app=angular.module("sw_layout");app.factory("menuService",function(a,b,c,d,e){var f=function(){var a=$("#applicationmenu");$("button",a).removeClass("selected"),$("a",a).removeClass("selected")},g=function(a){var b=$(a).parents(".dropdown-container").last(),c=$("button",b).first();0==c.length?$(a).addClass("selected"):c.addClass("selected")},h=function(a,b){if(null==b)throw new Error("id cannot be null");if(null==a)return null;for(var c=0;c<a.length;c++){var d=a[c];if(b==d.id)return d;if("MenuContainerDefinition"==d.type){var e=h(d.leafs,b);if(null!=e)return e}}return null},i=function(a,c){var e;if(null!=a)for(var f=0;f<a.length;f++){if("ApplicationMenuItemDefinition"==a[f].type)e=b.getApplicationUrl(a[f].application,a[f].schema,a[f].mode,d.getI18nMenuLabel(a[f].title,!1));else if("ActionMenuItemDefinition"==a[f].type)e=b.getActionUrl(a[f].title,a[f].controller,a[f].action,a[f].parameters);else if("MenuContainerDefinition"==a[f].type){var g=i(a[f].leafs,c);if(null!=g)return g}if(null!=e&&decodeURI(e)==decodeURI(c))return a[f]}};return{executeById:function(b){var c=a.menu.leafs,d=h(c,b);"ApplicationMenuItemDefinition"==d.type?this.goToApplication(d,null):"ActionMenuItemDefinition"==d.type&&this.doAction(d,null)},doAction:function(a,d){void 0!=d&&this.setActiveLeaf(d),c.insertIntoContext("currentgridarray",null),a.parameters&&"browser"==a.parameters.popupmode?c.insertIntoContext("currentmodulenewwindow",a.module):(c.insertIntoContext("currentmodule",a.module),c.insertIntoContext("currentmetadata",null)),e.getInstance("sw4.menu").info("current module: "+a.module);var f="";b.redirectToAction(f,a.controller,a.action,a.parameters,a.target)},goToApplication:function(d,f){a.$broadcast("sw_checksuccessmessage",d),void 0!=f&&this.setActiveLeaf(f),e.getInstance("sw4.menu").info("current module: "+d.module),c.insertIntoContext("currentgridarray",null),d.parameters&&"browser"==d.parameters.popupmode?c.insertIntoContext("currentmodulenewwindow",d.module):(c.insertIntoContext("currentmodule",d.module),c.insertIntoContext("currentmetadata",null));var g={};null!=d.parameters&&(g.popupmode=d.parameters.popupmode),b.goToApplicationView(d.application,d.schema,d.mode,this.getI18nMenuLabel(d,null),g)},adjustHeight:function(b){var c=$("#applicationmenu");if((void 0==a.clientName||"hapag"!=a.clientName)&&"vertical"==c.data("displacement")){var d=$(".hapag-body").height();c.children().first().css("min-height",d+4)}},setActiveLeaf:function(a){var b=$("#applicationmenu");"horizontal"==b.data("displacement")&&(f(),$(a).parents("#applicationmenu").length>0&&g(a))},getI18nMenuLabel:function(a,b){return null!=a.module?a.title:d.getI18nMenuLabel(a,b)},setActiveLeafByUrl:function(a,b){if("horizontal"==a.displacement){var c=i(a.leafs,b);if(null!=c){var d=c.type+"_"+c.id,e=$("#"+d);e.length>0&&(f(),g(e))}}}}});var app=angular.module("sw_layout");app.factory("mockService",function(a){return{isMockedContainerDashBoard:function(){return a.isLocal()&&"true"==sessionStorage.mockdash},isMockMaximo:function(){return a.isLocal()&&"true"==sessionStorage.mockmaximo}}});var app=angular.module("sw_layout");app.factory("printService",function(a,b,c,d,e,f,g,h){var i=function(a,b,c){var d={};if(null!=c&&(d=c),void 0==b)return d;for(var e=0;e<b.length;e++){var f=b[e];void 0!=f.tabObject?d[f.key]=f.tabObject:d[f.key]=a.fields[f.key]}return d},j=function(a){f.unfix(),k(),f.fixThead(a,{empty:!1})},k=function(){window.print()};return{doPrint:function(){k()},printList:function(b,c,e,f){var g=d.getInstance("printService#printList");a.printRequested=!1,void 0!=a.$$listeners.listTableRenderedEvent&&(a.$$listeners.listTableRenderedEvent=null);var h=$("#listgrid");if(h.removeClass("hiddenonprint"),a.$on("listTableRenderedEvent",function(){if(a.printRequested){a.printRequested=!1;var b,d=$("[rel=hideRow]");if(!(d.length<=c)){for(b=1;b<d.length;++b)b>c&&(d[b].className+=" hideRows");navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&h.addClass("listgrid-firefox"),j(f)}}}),b<=c)return void j(f);var i={pageNumber:1,pageSize:b,printMode:!0};g.info("fetching print data on server"),e(i)},printDetail:function(c,f,g){var h=d.getInstance("print_service#printDetail");if(c.hasNonInlineComposition&&void 0===g)return void a.$broadcast("sw_showprintmodal",c);var j={};j.key={},j.options={},j.application=c.applicationName,j.key.schemaId=c.schemaId,j.key.mode=c.mode,j.key.platform=platform();var k=[];null!=g&&(j.options.compositionsToExpand=e.buildCompositionsToExpand(g.compositionsToExpand,c,f,"print",k,!0)),j.options.printMode=!0;var l=void 0==g||g.shouldPageBreak,m=void 0==g||g.shouldPrintMain,n={};if(null!=g&&$.each(g.compositionsToExpand,function(a,b){if(1==b.value){var c=f.fields[a];void 0!=c&&0!=c.length||(n[a]=[])}}),void 0==j.options.compositionsToExpand||""==j.options.compositionsToExpand)return h.debug("sw_readytoprintevent dispatched"),void a.$broadcast("sw_readytoprintevent",i(f,k,n),l,m);h.info("calling expanding compositions on service; params: {0}".format(j));var o=removeEncoding(url("/api/generic/ExtendedData/ExpandCompositions?"+$.param(j)));b.get(o,{printMode:!0}).success(function(b){var c=b.resultObject;$.each(n,function(a,b){c[a]=b}),h.debug("sw_readytoprintevent dispatched after server return");var d=i(f,k,c);a.$broadcast("sw_readytoprintevent",d,l,m)})},printDetailedList:function(c,d,e,f){e=e||{};var i=null!=c.printSchema?c.printSchema:c;if(i.hasNonInlineComposition&&void 0===f)return void a.$broadcast("sw_showprintmodal",i,e);var j=[];$.grep(d,function(a){1==a.fields.checked&&j.push(a.fields[i.idFieldName])});var k=i.name,l=i.schemaId,m={},n={},o={};n[i.idFieldName]=j.join(","),o[i.idFieldName]=h.getSearchOperationById("EQ"),m.searchDTO=h.buildSearchDTO(n,e,o,{}),m.searchDTO.pageSize=j.length,m.searchDTO.compositionsToFetch=[];var p={};$.each(f.compositionsToExpand,function(a,b){1==b.value&&(m.searchDTO.compositionsToFetch.push(a),p[a]=b)}),m.printmode=!0;var q=g.getApplicationUrl(k,l,"","",m),r=void 0==f||f.shouldPageBreak,s=void 0==f||f.shouldPrintMain;b.get(q).success(function(b){a.$broadcast("sw_readytoprintdetailedlistevent",b.resultObject,p,r,s)}),$("#listgrid").addClass("hiddenonprint")},hidePrintModal:function(){a.$broadcast("sw_hideprintmodal")}}});var app=angular.module("sw_layout");app.factory("redirectService",function(a,b,c,d,e,f){var g=function(a){var b=d.retrieveFromContext("currentmodulenewwindow");return"null"!=b&&""!=b&&(a=b,null==a&&(a="null"),d.deleteFromContext("currentmodulenewwindow")),a},h=function(a,b){var c=$(routes_homeurl)[0].value,e=d.retrieveFromContext("currentmodule");e=g(e);var f=b.currentmetadata="null";b.currentmodule=e;var h=$.param(b);return h=replaceAll(h,"=","$"),h=replaceAll(h,"&","@"),c=c+"?application="+a+"&popupmode=browser",nullOrUndef(e)||(c+="&currentModule="+e),nullOrUndef(f)||(c+="&currentMetadata="+f),c=c+"&querystring="+h,removeEncoding(c)},i=function(a,b,c){var e=$(routes_homeurl)[0].value,f=d.retrieveFromContext("currentmodule"),h=c.currentmetadata="null";f=g(f),c.currentmodule=f,c.currentmetadata=h;var i=$.param(c);return i=replaceAll(i,"=","$"),i=replaceAll(i,"&","@"),e=e+"?controllerToRedirect="+a+"&actionToRedirect="+b+"&popupmode=browser",nullOrUndef(f)||(e+="&currentModule="+f),nullOrUndef(h)||(e+="&currentMetadata="+h),e=e+"&querystring="+i,removeEncoding(e)};return{getActionUrl:function(a,b,c){if("browser"==c.popupmode)return i(a,b,c);b=void 0===b||null==b?"get":b;var d=null==c?{}:c;return url("/api/generic/"+a+"/"+b+"?"+$.param(d))},redirectToAction:function(c,d,e,f,g){if(void 0!==f&&null!=f||(f={}),null!=c&&(f.title=c),"new"==g){var h=url(d+"/"+e+"?"+$.param(f)),i=window.open(h);i.moveTo(0,0)}else{var h=this.getActionUrl(d,e,f);if("browser"==f.popupmode){if(b.isLocal&&"true"!=sessionStorage.defaultpopupsize)var i=window.open(h);else openPopup(h);return}sessionStorage.swGlobalRedirectURL=h,a.get(h).success(function(a){b.$broadcast("sw_redirectactionsuccess",a)}).error(function(a){var c={errorMessage:"error opening action {0} of controller {1} ".format(e,d),errorStack:a.message};b.$broadcast("sw_ajaxerror",c)})}},getApplicationUrl:function(a,b,c,d,e,f){return void 0!==e&&null!=e||(e={}),e.key={schemaId:b,mode:c,platform:platform()},"browser"==e.popupmode?h(a,e):(null!=d&&""!=d.trim()&&(e.title=d),void 0==f?url("/api/data/"+a+"?"+$.param(e)):(e.application=a,null!=d&&""!=d.trim()&&(e.title=d),url("/api/generic/ExtendedData/OpenDetailWithInitialData?"+$.param(e))))},goToApplicationView:function(d,g,h,i,j,k){var l=c.getInstance("redirectService#goToApplication");void 0!==j&&null!=j||(j={}),b.$broadcast("sw_applicationredirected",j);var m=this.getApplicationUrl(d,g,h,i,j,k),n=j.popupmode;if("report"!=n){if("browser"==n)return void f.getPromise("ExtendedData","PingServer").then(function(){if(b.isLocal&&"true"!=sessionStorage.defaultpopupsize){window.open(m)}else openPopup(m)});if(b.popupmode=n,e.unfix(),void 0==k)sessionStorage.swGlobalRedirectURL=m,l.info("invoking get on datacontroller for {0}".format(d)),a.get(m).success(function(a){b.$broadcast("sw_redirectapplicationsuccess",a,h,d)});else{var o=angular.toJson(k);l.info("invoking post on datacontroller for {0} | content: ".format(d,o)),a.post(m,o).success(function(a){b.$broadcast("sw_redirectapplicationsuccess",a,h,d)})}}},redirectToTab:function(a){var b=$('a[href="#'+a+'"]');b.trigger("click")},redirectNewWindow:function(c,d,e){f.getPromise("ExtendedData","PingServer").then(function(){if(b.isLocal){var f=window.open(c);return void f.moveTo(0,0)}var g=function(a){var c=openPopup("");c.document.open(),c.document.write(a),c.document.close(),1==d&&c.location.reload(),c.focus(),b.isLocal&&c.moveTo(0,0)};if(void 0==e)a.post(c).success(g);else{var h=angular.toJson(e);a.post(c,h).success(g)}})}}}),angular.module("sw_layout").factory("restService",function(a,b,c){return{getActionUrl:function(a,b,d){b=void 0===b||null==b?"get":b;var e=null==d?{}:d,f=c.getFromContext("serverurl");return f?f+"/api/generic/"+a+"/"+b+"?"+$.param(e,!0):url("/api/generic/"+a+"/"+b+"?"+$.param(e,!0))},invokePost:function(a,b,c,d,e,f){this.postPromise(a,b,c,d).success(function(a){null!=e&&e(a)}).error(function(a){null!=f&&f(a)})},postPromise:function(c,d,e,f){var g=this.getActionUrl(c,d,e),h=b.getInstance("restService#invokePost");return h.info("invoking post on url {0}".format(g)),a.post(g,f)},getPromise:function(c,d,e){var f=this.getActionUrl(c,d,e),g=b.getInstance("restService#invokeGet");return g.info("invoking get on url {0}".format(f)),a.get(f)},invokeGet:function(a,c,d,e,f){var g=this.getActionUrl(a,c,d),h=b.getInstance("restService#invokeGet");h.info("invoking get on url {0}".format(g));var i=this.getPromise(a,c,d);i.success(function(a){null!=e&&e(a)}).error(function(a){null!=f&&f(a)})}}}),function(){"use strict";function a(a,b){function c(){var a=url(""),b=sessionStorage[a+":schemaCache"];b&&(i=JSON.parse(b))}function d(){var b=";";for(var c in i)i.hasOwnProperty(c)&&(b+=c+";");return a.get("schemaCacheService#getSchemaCacheKeys").debug("schema keys in cache {0}".format(b)),b}function e(b){return b.cachedSchemaId?(a.get("schemaCacheService#getSchemaFromResult").info("schema {0}.{1} retrieved from cache".format(b.applicationName,b.cachedSchemaId)),this.getCachedSchema(b.applicationName,b.cachedSchemaId)):b.schema}function f(a,b){return i[a+"."+b]}function g(c){if(null!=c){i=i||{};var d=c.applicationName+"."+c.schemaId;if(!i[d]){var e=b.getFromContext("systeminittime");a.get("schemaCacheService#addSchemaToCache").info("adding schema {0} retrieved to cache".format(d)),i[d]=c,i.systeminitMillis=e;var f=url("");sessionStorage[f+":schemaCache"]=JSON.stringify(i)}}}function h(c){var d=b.getFromContext("systeminittime");(c||i&&i.systeminitMillis!==d)&&(a.get("schemaCacheService#wipeSchemaCacheIfNeeded").info("wiping out schema cache"),delete sessionStorage.schemaCache,i={systeminitMillis:d})}var i={};c();var j={getSchemaCacheKeys:d,addSchemaToCache:g,getCachedSchema:f,getSchemaFromResult:e,wipeSchemaCacheIfNeeded:h};return j}angular.module("sw_layout").factory("schemaCacheService",["$log","contextService",a])}();var app=angular.module("sw_layout");app.factory("schemaService",function(){return{parseAppAndSchema:function(a){var b=a.split(".");if(1==b.length)return{app:null,schemaId:a,mode:null};var c=null,d=b[0],e=b[1];return 3==b.length&&(c=b[2]),{app:d,schemaId:e,mode:c}},getProperty:function(a,b){return!!a&&(a.properties=a.properties||{},a.properties[b])},isPropertyTrue:function(a,b){return!!a&&(a.properties&&"true"==a.properties[b])},getId:function(a,b){return a.fields?a.fields[b.idFieldName]:a[b.idFieldName]},nonTabFields:function(a){return fieldService.nonTabFields(a.displayables,!0)}}});var app=angular.module("sw_layout");app.factory("screenshotService",function(a,b,c,d){return{init:function(a,b){d.getInstance("screenshotservice#init").debug("init screenshot service");var c=this;$(".image-holder",a).bind("paste",function(a){c.handleImgHolderPaste(this,a.originalEvent)}),$(".image-holder",a).bind("blur",function(a){c.handleImgHolderBlur(this,b)}),$(".richtextbox",a).parents("form:first").bind("submit",function(a){c.handleRichTextBoxSubmit($(this),a.originalEvent)})},hasScreenshotData:function(){$(".richtextbox",form).each(function(){return null!=this.contentWindow.asciiData()&&""!=this.contentWindow.asciiData()})},handleRichTextBoxSubmit:function(a,b){$(".richtextbox",a).each(function(){if(null!=this.contentWindow.asciiData()&&""!=this.contentWindow.asciiData()){var b=this.id.substring("richTextBox_".length),c=d.getInstance("screenshotservice#ie9conversion"),e=performance.now(),f=this.contentWindow.binaryData(),g=performance.now();c.debug("get binary data took {0} ms".format(g-e)),a.append("<input type='hidden' name='"+b+"' value='"+f+"' />");var h=new Date,i=""+h.getFullYear()+(h.getMonth()+1)+h.getDate();a.append("<input type='hidden' name='"+b+"_path' value='Screen"+i+".rtf' />")}})},handleImgHolderBlur:function(a,b){var c=performance.now(),e=a.id.substring("imgHolder_".length);b[e]=Base64.encode(a.innerHTML);var f=performance.now();d.getInstance("screenshotservice#handleImgHolderBlur").debug("base64 converstion took {0}".format(f-c));var g=new Date,h=""+g.getFullYear()+(g.getMonth()+1)+g.getDate();b[e+"_path"]="Screen"+h+".html"},handleImgHolderPaste:function(a,b){var c=a.id.substring("imgHolder_".length);if(void 0!=b.clipboardData&&void 0!=b.clipboardData.items){for(var d=b.clipboardData.items,e=0;e<d.length;e++)if(d[e].type.indexOf("image")!==-1){var f=d[e].getAsFile(),g=window.URL||window.webkitURL,h=g.createObjectURL(f);return void this.createImage(c,a,h)}a.innerHTML="",b.preventDefault()}},createImage:function(a,b,c){var d=new Image;d.onload=function(){var a=new Image;a.src=imgToBase64(this),b.appendChild(a)},d.src=c}}});var app=angular.module("sw_layout");app.factory("searchService",function(a,b,c){function d(){var b={},c="_grid.filter.filtertype.";b.nofilter=a.get18nValue(c+"nofilter","No Filter"),b.filter=a.get18nValue(c+"filter","Filter"),b.contains=a.get18nValue(c+"contains","Contains"),b.ncontains=a.get18nValue(c+"ncontains","Does Not Contain"),b.startwith=a.get18nValue(c+"startwith","Starts With"),b.endwith=a.get18nValue(c+"endwith","Ends With"),b.eq=a.get18nValue(c+"eq","Equal To"),b.noteq=a.get18nValue(c+"noteq","Not Equal To"),b.blank=a.get18nValue(c+"blank","Blank"),b.gt=a.get18nValue(c+"gt","Greater Than"),b.lt=a.get18nValue(c+"lt","Less Than"),b.gte=a.get18nValue(c+"gte","Greater Than Or Equal To"),b.lte=a.get18nValue(c+"lte","Less Than Or Equal To");var d=[{id:"",symbol:"",title:b.nofilter,tooltip:b.filter,begin:"",end:"",renderType:["default","datetime"]},{id:"CONTAINS",symbol:"C",title:b.contains,tooltip:b.contains,begin:"%",end:"%",renderType:["default"]},{id:"NCONTAINS",symbol:"!C",title:b.ncontains,tooltip:b.ncontains,begin:"!%",end:"%",renderType:["default"]},{id:"STARTWITH",symbol:"ST",title:b.startwith,tooltip:b.startwith,begin:"",end:"%",renderType:["default"]},{id:"ENDWITH",symbol:"END",title:b.endwith,tooltip:b.endwith,begin:"%",end:"",renderType:["default"]},{id:"EQ",symbol:"=",title:b.eq,tooltip:b.eq,begin:"=",end:"",renderType:["default","datetime"]},{id:"BTW",symbol:"-",title:b.btw,tooltip:b.btw,begin:">=",end:"<=",renderType:[]},{id:"NOTEQ",symbol:"!=",title:b.noteq,tooltip:b.noteq,begin:"!=",end:"",renderType:["default","datetime"]},{id:"BLANK",symbol:"BLANK",title:b.blank,tooltip:b.blank,begin:"",end:"",renderType:["default","datetime"]},{id:"GT",symbol:">",title:b.gt,tooltip:b.gt,begin:">",end:"",renderType:["default","datetime"]},{id:"LT",symbol:"<",title:b.lt,lt:b.lt,begin:"<",end:"",renderType:["default","datetime"]},{id:"GTE",symbol:">=",title:b.gte,tooltip:b.gte,begin:">=",end:"",renderType:["default","datetime"]},{id:"LTE",symbol:"<=",title:b.lte,tooltip:b.lte,begin:"<=",end:"",renderType:["default","datetime"]}];return d}var e={},f=function(a,b){var c="";for(var d in a)if("lastSearchedValues"!=d&&(null!=a[d]&&""!=a[d]||null!=b[d]&&"BLANK"==b[d].id)){if(d.indexOf("___")!=-1){d=d.substring(0,d.indexOf("___")),c+=c.indexOf(d)!=-1?d+"&&":d+"___";continue}c+=d+"&&"}return c.substring(0,c.lastIndexOf("&&"))},g=function(a){var b="";return null!=a.field&&""!=a.field&&(b=a.field),b};return{buildSearchValuesString:function(a,b){var c="",d="",e=!1;for(var f in a)(null!=a[f]&&""!=a[f]&&"lastSearchedValues"!=f||null!=b[f]&&"BLANK"==b[f].id)&&(d=a[f],f.indexOf("___")!=-1&&(f=f.substring(0,f.indexOf("___"))),null==b[f]&&(b[f]=this.defaultSearchOperation()),""==b[f].begin||e||(d=b[f].begin+d,"BTW"!=b[f].id)?(""!=b[f].end&&("BTW"==b[f].id?(d=b[f].end+d,e=!1):d+=b[f].end),null!=b[f]&&"BLANK"==b[f].id&&(d="IS NULL"),c+=d+",,,"):(e=!0,c+=d+"___"));return c=c.substring(0,c.lastIndexOf(",,,"))},buildSearchDTO:function(a,b,c,d,e){var h={};return a=a||{},b=b||{},c=c||{},h.searchParams=f(a,c),h.searchValues=this.buildSearchValuesString(a,c),h.searchSort=g(b),h.SearchAscending="asc"==b.order,h.filterFixedWhereClause=d,h.unionFilterFixedWhereClause=e,h.needsCountUpdate=!0,a.lastSearchedValues=h.searchValues,h},buildReportSearchDTO:function(a,b,c,d,e,h){if(null==a||void 0==a){var a={};a.searchParams=f(b,d),a.searchValues=this.buildSearchValuesString(b,d)}else{var i=f(b,d),j=this.buildSearchValuesString(b,d);null!=i&&""!=i&&null!=j&&""!=j&&(a.searchParams+="&&"+i,a.searchValues+=",,,"+j)}return a.searchSort=g(c),a.SearchAscending="asc"==c.order,a.filterFixedWhereClause=e,a.unionFilterFixedWhereClause=h,a.needsCountUpdate=a.searchValues!=b.lastSearchedValues,b.lastSearchedValues=a.searchValues,a},getSearchOperation:function(a){return this.searchOperations()[a]},getSearchOperationById:function(a){var b=$.grep(this.searchOperations(),function(b){return b.id.toUpperCase()==a.toUpperCase()});if(b.length>0)return b[0]},searchOperations:function(){var b=a.getCurrentLanguage(),f=c.retrieveFromContext("currentmodule");return nullOrUndef(f)||(b="EN"),void 0!=e[b]?e[b]:(e[b]=d(),e[b])},defaultSearchOperation:function(){return this.searchOperations()[1]},noFilter:function(){return this.searchOperations()[0]}}}),function(angular){"use strict";function a(a){function d(d){if(!a.showingspin){d=d||{};var e=d.savingDetail||!1,h=d.compositionSpin||!1,i=e?"detailspinner":"mainspinner",j=e?c:b,k=document.getElementById(i);a.showingspin=!0,h?g=new Spinner(j).spin(k):f=new Spinner(j).spin(k)}}function e(b){b=b||{};var c=b.compositionSpin||!1,d=c?g:f;d&&(a.showingspin=!1,d.stop())}var f,g,h={start:d,stop:e};return h}var b={lines:13,length:20,width:10,radius:30,corners:1,rotate:0,direction:1,color:"#000",speed:1,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"auto",left:"auto",opacity:.25},c={lines:13,length:10,width:5,radius:15,corners:1,rotate:0,direction:1,color:"#000",speed:1,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"auto",left:"auto",opacity:.25};angular.module("sw_layout").factory("spinService",["$rootScope",a])}(angular);var app=angular.module("sw_layout");app.factory("styleService",function(a,b,c){return{getLabelStyle:function(a,b){var c=a.rendererParameters;return null!=a.header&&(c=a.header.parameters),null==c?null:c[b]}}});var app=angular.module("sw_layout");app.factory("submitService",function(a,b,c,d,e){return{submitForm:function(b,f,g,h){d.getPromise("ExtendedData","PingServer").then(function(){sessionStorage.removeItem("swGlobalRedirectURL");for(var d in f)b.append("<input type='hidden' name='"+d+"' value='"+f[d]+"' />");"true"==sessionStorage.mockmaximo&&b.append("<input type='hidden' name='%%mockmaximo' value='true'/>"),b.append("<input type='hidden' name='currentmodule' value='"+c.retrieveFromContext("currentmodule")+"' />"),b.append("<input type='hidden' name='application' value='"+h+"' />"),b.append("<input type='hidden' name='json' value='"+replaceAll(g,"'","&apos;")+"' />");var i=!0===a.savingMain;e.start(i),b.attr("action",url("/Application/Input")),b.submit()})},removeNullInvisibleFields:function(a,c){var d=this;$.each(a,function(a,e){b.isNullInvisible(e,c)&&delete c[e.attribute],void 0!=e.displayables&&d.removeNullInvisibleFields(e.displayables,c)})},getFormToSubmitIfHasAttachement:function(a,b){var c=$("#crudbodyform"),d=null;$(".richtextbox",c).each(function(){null!=this.contentWindow.asciiData&&void 0!=this.contentWindow.asciiData()&&""!=this.contentWindow.asciiData()&&(d=$(this).closest("form"))});var e=this.isValidAttachment;return $('input[type="file"]',c).each(function(){null!=this.value&&""!=this.value&&e(this.value)&&(d=$(this).closest("form"))}),d},isValidAttachment:function(a){var b=(a.match(/[^\/\\]+$/),c.fetchFromContext("allowedfiles",!0)),d=a.lastIndexOf("."),e=a.substring(d+1).toLowerCase();return $.inArray(e,b)!=-1},removeExtraFields:function(a,c,d){if(!a.extrafields)return c?jQuery.extend(!0,{},a):a;var e;return e=c?jQuery.extend(!0,{},a):a,$.each(e,function(a,c){var f=(a.indexOf(".")===-1,"asset_.primaryuser_.personid"===a);void 0!=e.extrafields[a]&&(void 0!=b.getDisplayableByKey(d,a)||f||delete e[a])}),delete e.extrafields,e},translateFields:function(a,b){for(var c=$.grep(a,function(a){return null!=a.attributeToServer}),d=0;d<c.length;d++){var e=c[d];b[e.attributeToServer]=b[e.attribute],delete b[e.attribute]}}}});var app=angular.module("sw_layout");app.factory("tabsService",function(a,b){var c=function(a){if(void 0!=a.nonInlineCompositionsDict)return a.nonInlineCompositionsDict;for(var b={},c=0;c<a.nonInlineCompositionIdxs.length;c++){var d=a.nonInlineCompositionIdxs[c],e=a.displayables[d];b[e.relationship]=e}return a.nonInlineCompositionsDict=b,b},d=function(a,b,d){var e=c(a),f=e[b];
return e=f.schema.schemas,"print"==d?e.print:e.list},e=function(a,b,c){return d(a,b,c).idFieldName},f=function(a,c,d){var e={};return e.items=[],e.items.push(a),e.schema=c,e.title=b.getTabLabel(c,d),e};return{hasTabs:function(a){if(void 0!=a.hasTabs)return a.hasTabs;var b=this.tabsDisplayables(a).length;return a.hasTabs=b>0,b},tabsDisplayablesForPrinting:function(a,b){if(void 0!=a.tabsDisplayablesForPrinting)return a.tabsDisplayablesForPrinting;var c=[],d=this.tabsDisplayables(a);return $.each(d,function(a,d){var e=b.fields[d.relationship];void 0!=e&&e.length>0&&c.push(d)}),a.tabsDisplayablesForPrinting=c,c},tabsDisplayables:function(a){if(void 0!=a.tabsDisplayables)return a.tabsDisplayables;var b=[],c=[];c=c.concat(a.nonInlineCompositionIdxs),c=c.concat(a.tabsIdxs),c.sort(function(a,b){return a-b});for(var d=0;d<c.length;d++){var e=c[d],f=a.displayables[e];f.isHidden||b.push(f)}return a.tabsDisplayables=b,b},nonInlineCompositionsDict:function(a){return c(a)},buildCompositionsToExpand:function(b,c,g,h,i,j){var k="";return null==b?"":($.each(b,function(b,l){if(0!=l.value){var m=a.getDisplayableByKey(c,b);if(a.isTab(m))return void i.push({key:b,tabObject:f(g,m,c)});var n=g.fields[b];if(void 0==n)return void(k+=b+"=lazy,,,");var o=d(c,b,l.schema);if(void 0!=o.properties.expansible&&"false"==o.properties.expansible)return void(void 0!=i&&n.length>0&&i.push({key:b,schema:o}));var p=d(c,b,h);if(j&&p.schemaId==o.schemaId)return void i.push({key:b,schema:o});for(var q=e(c,b,h),r=[],s=0;s<n.length;s++){var t=n[s];r.push(t[q])}r.length>0&&(k+=b+"="+r.join(",")+",,,")}}),""!=k&&(k=k.substring(0,k.length-3)),k)},locatePrintSchema:function(a,b){var d=c(a),e=d[b];return e.schema.schemas.print},getTitle:function(a,b){var d=c(a),e=d[b];return e.label}}});var app=angular.module("sw_layout");app.factory("userService",function(a){return{HasRole:function(b){if(null==b)return!0;var c=a.getUserData(),d=c.roles,e=!1;return $.each(b,function(a,b){$.each(d,function(a,c){if(c.name==b)return void(e=!0)})}),e},InGroup:function(b){if(null==b)return!0;for(var c=a.getUserData(),d=c.personGroups,e=0;e<d.length;e++){var f=d[e];if(f.personGroup.name==b)return!0}return!1}}});var app=angular.module("sw_layout");if(app.factory("validationService",function(a,b,c,d,e){return{validate:function(f,g,h,i){for(var j=[],k=0;k<g.length;k++){var l=g[k],m=l.label;if(!b.isNullInvisible(l,h)){var n=!!l.requiredExpression&&e.evaluate(l.requiredExpression,h);if(n&&nullOrEmpty(h[l.attribute])){var o=a.get18nValue(l.applicationName+".name",l.applicationName);m.endsWith("s")||m.endsWith("S")?j.push(a.get18nValue("messagesection.validation.isrequired","Field {0} for {1} are required",[m,o])):j.push(a.get18nValue("messagesection.validation.isrequired","Field {0} for {1} is required",[m,o]))}if(void 0!=l.displayables){var p=this.validate(f,l.displayables,h,!0);j=j.concat(p)}}}if(!i){var q=f.properties["oncrudsaveevent.validationservice"];if(null!=q){var r=q.split(".")[0],s=q.split(".")[1],t=d.loadService(r,s),u=t(f,h);null!=u&&Array.isArray(u)&&(j=j.concat(u))}j.length>0&&c.$broadcast("sw_validationerrors",j)}return j}}}),app.directive("commandbar",function(a){return{restrict:"E",replace:!0,templateUrl:a.getResourceUrl("/Content/Templates/directives/commandBar.html"),scope:{applicationschema:"=",schema:"=",mode:"=",localcommandprovider:"&",localschema:"=",cancelfn:"&",savefn:"&",datamap:"=",searchSort:"="},controller:function(a,b,c,d,e,f,g,h,i,j){function k(b){if(null==a.schema.commandSchema)return b;var c=a.schema.commandSchema.commands,d=a.schema.commandSchema.ignoreUndeclaredCommands;return d||$.each(a.defaultCommands(),function(a,d){var e=$.findFirst(c,function(a){return a.id==d.id});nullOrUndef(e)?b.push(d):(void 0==e.icon&&(e.icon=d.icon),b.push(e))}),$.each(c,function(c,e){var f=a.defaultCommands()[e.id];(d||void 0==f)&&("left"==e.defaultPosition?b.unshift(e):b.push(e))}),a.cachedCommands=b,b}a.defaultCommands=function(){return{save:{id:"save",method:a.save,showExpressionFn:a.shouldDisplaySave,icon:"glyphicon-ok",label:"Submit","default":!0},print:{id:"print",method:a.printDetail,showExpressionFn:a.shouldDisplayPrint,icon:"glyphicon-print",label:"Print","default":!0},cancel:{id:"cancel",method:a.cancel,showExpressionFn:a.shouldDisplayCancel,icon:"glyphicon-backward",label:GetPopUpMode().equalsAny("browser","nomenu")?"Close Window":"Cancel","default":!0}}},a.redirectToHapagHome=function(){i.redirectToAction(null,"HapagHome",null,null)},a.shouldDisplaySave=function(){return a.shouldDisplayCommand(a.schema.commandSchema,"save")&&"input"==a.mode},a.shouldDisplayCancel=function(){return a.shouldDisplayCommand(a.schema.commandSchema,"cancel")},a.shouldDisplayPrint=function(){return a.shouldDisplayCommand(a.schema.commandSchema,"print")&&a.isEditing(a.schema,a.datamap)},a.save=function(){a.savefn()},a.cancel=function(){return"browser"==GetPopUpMode()||"nomenu"==GetPopUpMode()?void window.close():(a.cancelfn({data:a.previousdata,schema:a.previousschema}),void a.$emit("sw_cancelclicked"))},a.printDetail=function(){var b=a.schema;f.printDetail(b,a.datamap[b.idFieldName])},a.getCommands=function(){var b=d.getInstance("commandbar#getCommands");if(a.cachedCommands)return b.trace("returning from cache ".format(JSON.stringify(a.cachedCommands))),a.cachedCommands;var c=[];if(void 0==a.localcommandprovider)return b.debug("adding default commands only"),k(c);var e=a.localcommandprovider();return void 0==e?(b.debug("provider returned null: adding default commands only"),k(c)):(void 0!=e.toAdd&&(c=c.concat(e.toAdd)),k(c),isArrayNullOrEmpty(e.toKeep)||"all"==e.toKeep[0]?(c=c.concat(a.schema.commandSchema.commands),a.cachedCommands=c,c):($.each(a.schema.commandSchema.commands,function(b,d){$.inArray(d.id,e.toKeep)!=-1?c.push(d):void 0!=a.localschema&&a.localschema.commandSchema.toExclude.push(d.id)}),isArrayNullOrEmpty(e.toKeep)||$.each(a.defaultCommands(),function(c,d){b.debug("checking command {0}".format(d.id)),$.inArray(d.id,e.toKeep)==-1&&void 0!=a.localschema&&(a.localschema.commandSchema.toExclude.push(d.id),b.debug("excluding command {0}".format(d.id)))}),a.cachedCommands=c,c))},a.i18N=function(a,b,c){return g.get18nValue(a,b,c)},a.i18NCommandLabel=function(b){if(void 0!=b["default"]&&1==b["default"]){var c,d=GetPopUpMode();return c="browser"!=d&&"nomenu"!=d||"cancel"!=b.id?a.i18N("general."+b.id,b.label):a.i18N("general.close",b.label),a.commandLabel(a.schema,b.id,c)}return g.getI18nCommandLabel(b,a.schema)},a.commandLabel=function(a,b,c){return h.commandLabel(a,b,c)},a.doCommand=function(b){h.doCommand(a,b)},a.shouldDisplayCommand=function(b,c){return a.cachedCommands||a.getCommands(),void 0!=a.localschema?h.shouldDisplayCommand(a.localschema.commandSchema,c):h.shouldDisplayCommand(b,c)},a.isCommandHidden=function(b,d){var e=c.parents(".tab-pane").attr("id");return void 0!=d.showExpressionFn&&"function"==typeof d.showExpressionFn?!d.showExpressionFn():h.isCommandHidden(a.datamap,b,d,e)},a.isCommandEnabled=function(b,d){var e=c.parents(".tab-pane").attr("id"),f=d.enableExpression;if(f&&f.startsWith("$scope:")){var g=a.invokeFn(f);return null==g||g}return h.isCommandEnabled(a.datamap,b,d,e)},a.isEditing=function(a,b){return null!=b[a.idFieldName]},a.invokeFn=function(a,b){var c=a.substr(7),d=this[c];if(null!=d)return d();if(b)throw new Error("parameterless method {0} not found on scope".format(c));return null},a.shouldCommandBeEnabled=function(){var b=a.datamap;for(var c in b)if(void 0!=b[c]&&null!=b[c]&&void 0!=b[c].fields&&b[c].fields.checked)return!0;return!1}}}}),app.directive("fileread",function(a,b,c,d){return{scope:{fileread:"=",path:"="},link:function(a,c,e){c.bind("change",function(c){var e=b.getInstance("fileread#change");if(e.debug("file change detected"),!d.isValidAttachment(this.value))return isIe9()||(c.currentTarget.value="",a.$apply(function(){a.fileread=void 0,a.path=void 0})),void alert("Invalid file. Please choose another one.");if(isIe9())a.fileread="xxx";else{var f,g=c.target.files.length>0;if(!g)return;var h=c.target.files[0];f=h.name,c.currentTarget.parentNode.parentNode.children[0].value=f,a.path=f;var i=new FileReader;i.onload=function(b){a.$apply(function(){a.fileread=b.target.result})},i.readAsDataURL(h)}a.$digest()})}}}),app.directive("menuWrapper",function(a){return{restrict:"E",replace:!0,template:"<div></div>",scope:{menu:"=",popupmode:"@"},link:function(b,c,d){"none"==b.popupmode&&(c.append("<menu menu='menu'/>"),a(c.contents())(b))}}}),app.directive("menu",function(a){return{restrict:"E",replace:!0,templateUrl:a.getResourceUrl("/Content/Templates/menu.html"),scope:{menu:"="},controller:function(a,b,c){a.level=-1,a.$on("ngRepeatFinished",function(d){"vertical"==a.menu.displacement&&($(".dropdown-container").on({"shown.bs.dropdown":function(a){$(this)[0]===a.target&&$(this).data("closable",!1)},click:function(a){$(this).children()[0]===a.target&&$(this).data("closable",!0),c(function(){var a=$(".menu-primary").jScrollPane({maintainPosition:!0}).data("jsp");a.reinitialise()},250)},"hide.bs.dropdown":function(a){if($(this)[0]===a.target)return $(this).data("closable")}}),"gric"!=b.clientName&&"scottsdale"!=b.clientName&&"manchester"!=b.clientName||($(".dropdown-container").find("span").toggleClass("right-caret bottom-caret"),$(".dropdown-container").addClass("open"),$(".dropdown-container").data("closable",!1)))})}}}),app.directive("subMenu",function(a){return{restrict:"E",replace:!0,template:"<ul class='dropdown-menu submenu'></ul>",scope:{leaf:"=",displacement:"=",level:"="},link:function(b,c,d){angular.isArray(b.leaf.leafs)&&(c.append("<menu-item leaf='leaf' displacement='displacement' level='level' ng-repeat='leaf in leaf.leafs'></menu-item>"),a(c.contents())(b))}}}),app.directive("menuItem",function(a){return{restrict:"E",replace:!0,templateUrl:a.getResourceUrl("Content/Templates/menuitem.html"),scope:{leaf:"=",displacement:"=",level:"="},controller:function(b,c,d,e,f,g){b.level=b.level+1,b.i18N=function(a,b,c){return f.get18nValue(a,b,c)},b.isButtonStyleContainer=function(a,b){return null==b.module&&0==a},b.i18NMenuLabel=function(a,b){return e.getI18nMenuLabel(a,b)},b.isMenuItemTitle=function(a,b){return a.icon},b.goToApplication=function(a,b){e.goToApplication(a,b)},b.doAction=function(a,b){e.doAction(a,b)},b.contextPath=function(a){return url(a)},b.search=function(b,e,f,g,h){var i=$("#"+g).val();if(nullOrUndef(h)&&(h="list"),a.insertIntoContext("currentmodule",b),a.deleteFromContext("currentmetadata"),null!=i&&""!=i){i="%"+i.trim()+"%";var j=$.param({application:e,searchFields:f,searchText:i,schema:h});c.get(url("/api/generic/Data/Search?"+j)).success(function(a){d.$broadcast("sw_redirectactionsuccess",a)})}},b.handleContainerClick=function(a,c){null==a.controller||$(c).find("span").hasClass("bottom-caret")||g.isMockedContainerDashBoard()||e.doAction(a,c),"vertical"==b.displacement&&$(c).find("span").toggleClass("right-caret bottom-caret")}}}}),!performance)var performance={};performance.now||(performance.now=function(){return(new Date).getTime()}),app.directive("ngrepeatinspector",function(a,b){return{restrict:"A",scope:{name:"@"},link:function(a,c,d){var e=null==a.name?"":a.name,f=b.getInstance("inspector#ngrepeat");a.$first?f.debug("init ngrepeat for {0}".format(e)):f.trace("ngrepeat processed for {0}".format(e)),(a.$last===!0||a.datamap&&0==a.datamap.length)&&f.debug("finish ngrepeat for {0}").format(e)}}}),app.directive("localClick",["$parse","$rootScope","$exceptionHandler",function(a,b,c){var d="localClick",e="click";return{restrict:"A",compile:function(f,g){b.$localApply=function(a){try{return this.$$phase="$apply",this.$eval(a)}catch(b){c(b)}finally{this.$$phase=null;try{this.$digest()}catch(b){throw c(b),b}}};var h=a(g[d]);return function(a,c){c.on(e,function(c){var d=function(){h(a,{$event:c})};b.$localApply(d)})}}}}]);var PRINTMODAL_$_KEY='[data-class="printModal"]';app.directive("printModal",function(a,b){return{restrict:"E",replace:!0,templateUrl:b.getResourceUrl("/Content/Templates/printModal.html"),scope:{schema:"=",datamap:"="},controller:function(b,c,d,e){function f(){b.printSchema=null!=b.schema.printSchema?b.schema.printSchema:b.schema,b.compositionstoprint={},b.shouldPageBreak=!1,b.shouldPrintMain=!0}b.i18N=function(a,b,c){return e.get18nValue(a,b,c)},b.print=function(){Array.isArray(b.datamap)?c.printDetailedList(b.printSchema,b.datamap,b.searchSort,b.buildPrintOptions()):c.printDetail(b.printSchema,b.datamap,b.buildPrintOptions())},b.buildPrintOptions=function(){var a={};return a.shouldPageBreak=b.shouldPageBreak,a.shouldPrintMain=b.shouldPrintMain,a.compositionsToExpand=b.compositionstoprint,a},b.nonInlineCompositions=function(a){return d.tabsDisplayables(a)},b.$on("sw_hideprintmodal",function(a){var b=$(PRINTMODAL_$_KEY);b.modal("hide")}),b.$on("sw_showprintmodal",function(c,e,f){a.getInstance("printmodal").info("starting printing modal"),b.compositionstoprint={},b.printSchema=e,b.searchSort=f;for(var g=d.tabsDisplayables(b.printSchema),h=0;h<g.length;h++){var i=g[h];if("ApplicationCompositionDefinition"==i.type){var j=i.schema.schemas.print?i.schema.schemas.print:i.schema.schemas.list;b.compositionstoprint[i.relationship]={value:!1,schema:j}}else b.compositionstoprint[i.id]={value:!1,schema:i}}var k=$(PRINTMODAL_$_KEY);k.draggable(),k.modal("show")}),f()}}});var app=angular.module("sw_layout");app.directive("printsectionrendered",function(a,b){return{restrict:"A",link:function(c,d,e){if(c.$last===!0){var f=!1;b.getInstance("printrendered#event").debug("Print Rendered event call"),c.$on("sw_bodyrenderedevent",function(b,d){a(function(){f||(c.$emit("sw_printsectionrendered"),f=!0),c.$$listeners.sw_bodyrenderedevent=null},2e3,!1)})}}}}),app.directive("printSection",function(a){return{restrict:"E",replace:!0,templateUrl:a.getResourceUrl("/Content/Templates/directives/printSection.html"),scope:{schema:"=",datamap:"="},controller:function(a,b,c,d,e,f,g,h){a.compositionstoprint=[],a.shouldPageBreak=!0,a.showPrintSection=!1,a.showPrintSectionCompostions=!1,a.shouldPageBreakComposition=function(b){return b?a.shouldPageBreak&&a.shouldPrintMain:a.shouldPageBreak},a.$on("sw_readytoprintevent",function(b,c,d,e){var f=[];a.shouldPageBreak=d,a.shouldPrintMain=e,a.printSchema=null!=a.schema.printSchema?a.schema.printSchema:a.schema,$.each(c,function(b,c){var d={};void 0!=c.schema?(d.schema=c.schema,a.datamap.fields[b]=c.items,d.title=c.title):(d.schema=g.locatePrintSchema(a.printSchema,b),a.datamap.fields[b]=c,d.title=g.getTitle(a.printSchema,b)),d.key=b,f.push(d)}),a.compositionstoprint=f,a.printDatamap=Array.isArray(a.datamap)?a.datamap:new Array(a.datamap),a.showPrintSection=!0,a.showPrintSectionCompostions=f.length>0,a.shouldPageBreakMain=a.shouldPageBreak&&a.datamap.length>1}),a.$on("sw_readytoprintdetailedlistevent",function(b,c,d,e,f){var h=[];a.shouldPageBreak=e,a.shouldPrintMain=f,a.printSchema=null!=a.schema.printSchema?a.schema.printSchema:a.schema,$.each(d,function(b,c){var d={};d.schema=c.schema,d.key=b,"ApplicationTabDefinition"==c.schema.type?d.title=c.schema.label:d.title=g.getTitle(a.printSchema,b),h.push(d)}),a.compositionstoprint=h,a.printDatamap=c,a.showPrintSection=!0,a.showPrintSectionCompostions=h.length>0,a.shouldPageBreakMain=a.shouldPageBreak&&a.datamap.length>1}),a.i18nValue=function(a,b,c){return f.get18nValue(a,b,c)},a.$on("sw_printsectionrendered",function(){d.hidePrintModal(),d.doPrint(),a.showPrintSection=!1,a.showPrintSectionCompostions=!1,a.printSchema=null})}}});var app=angular.module("sw_layout");app.factory("cmpAutocompleteClient",function(a,b,c,d){return{unblock:function(a){var b=$("select[data-associationkey='"+a.associationKey+"']"),c=$(b).data("combobox");void 0!=c&&c.enable()},block:function(a){var b=$("select[data-associationkey='"+a.associationKey+"']");$(b).data("combobox").disable()},refreshFromAttribute:function(a){var b=$("#"+RemoveSpecialChars(a)).data("combobox");void 0!=b&&b.refresh()},init:function(a,b,e,f){for(var g=$("select.combobox-dynamic",a),h=0;h<g.length;h++){var i=$(g[h]),j=i.data("associationkey"),k=$(i.parents("div[rel=input-form-repeat]"));if(0!=k.data("selectenabled")&&!i.data("alreadyconfigured")){var l=c.getDisplayablesByAssociationKey(e,j),m=null,n=d.isLocal()?30:300;null!=l&&l.length>0&&null!=l[0].rendererParameters.minLength&&(m=parseInt(l[0].rendererParameters.minLength)),null!=l&&l.length>0&&null!=l[0].rendererParameters.pageSize&&(n=parseInt(l[0].rendererParameters.pageSize)),i.data("alreadyconfigured",!0),i.combobox({minLength:m,pageSize:n})}}}}});var app=angular.module("sw_layout");app.factory("cmpAutocompleteServer",function(a,b){function c(a,b,c){var d=angular.toJson(c);return b.type="POST",b.data=d,b.hasContent=!0,a.setRequestHeader("Content-type","application/json"),!0}return{refreshFromAttribute:function(c,d){var e=b.getFullObject(c,d.datamap,d.associationOptions),f=c.associationKey,g=null==e?null:e.label;a.getInstance("cmpAutocompleteServer#refreshFromAttribute").debug("update autocomplete-server {0} with value {1}".format(f,g)),$("input[data-association-key="+f+"]").typeahead("val",g)},init:function(b,d,e,f){$("input.typeahead",b).each(function(b,g){var h=$(g);if(1!=$(h.parent()).data("initialized")){var i=g.getAttribute("data-association-key"),j=g.getAttribute("data-target");a.getInstance("cmpAutocompleteServer#init").debug("init autocomplete {0}".format(i));var k=e.applicationName,l={};l.key={},l.key.schemaId=e.schemaId,l.key.mode=e.mode,l.key.platform=platform(),l.associationFieldName=i;var m=url("/api/data/"+k+"?labelSearchString=%QUERY&"+$.param(l)),n=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("value"),queryTokenizer:Bloodhound.tokenizers.whitespace,limit:30,remote:{url:m,rateLimitFn:"debounce",rateLimitWait:500,filter:function(a){var b=a.resultObject;return null!=b[i]?b[i].associationData:null},ajax:{beforeSend:function(a,b){c(a,b,d)}}}});n.initialize(),h.typeahead({minLength:3},{displayKey:"label",source:n.ttAdapter()}),h.on("typeahead:selected typeahead:autocompleted",function(a,b){d[j]=b.value,f.associationOptions[i]=[{value:b.value,label:b.label,extrafields:b.extrafields}],f.$digest()}),$(h.parent()).data("initialized",!0)}}),$("span.twitter-typeahead",b).css("width","100%"),$("input.tt-hint",b).addClass("form-control"),$("input.tt-hint",b).css("width","96%"),$("input.tt-query",b).css("width","97%")}}});var app=angular.module("sw_layout");app.factory("cmpCombobox",function(a,b,c){function d(a){var b=$("select[data-comboassociationkey='"+a.associationKey+"']");b.hide(),b.show(),b.css("width",0),b.css("width","")}return{unblock:function(a){isIe9()&&d(a)},block:function(a){isIe9()&&d(a)},refreshFromAttribute:function(a){isIe9()&&d(a)},init:function(a,b,c,d){}}});var app=angular.module("sw_layout");app.factory("cmpComboDropdown",function(a,b,c){return{block:function(a){var b=$("select[data-associationkey='"+a+"']");$(b).multiselect("destroy")},unblock:function(a){var b=$("select[data-associationkey='"+a+"']");$(b).multiselect("refresh")},refresh:function(a){a.find("option").size()>0&&(a.multiselect({nonSelectedText:"Select One",includeSelectAllOption:!0,enableCaseInsensitiveFiltering:!0,disableIfEmpty:!0}),a.multiselect("refresh"))},refreshFromAttribute:function(a){var b=$("#"+RemoveSpecialChars(a));this.refresh(b)},getSelectedTexts:function(a){var b=$("#"+RemoveSpecialChars(a.attribute)),d=a.rendererParameters.custombuttontext,e=new Array;if(b.find(":selected").each(function(){e.push($(this).text())}),e.length>0){var f=c.get18nValue("combodropdown.selected","selected")+": ",g=a.label+" "+f+e.length;nullOrUndef(d)||(g=d+" "+f+e.length),b[0].setAttribute("custombuttontext",g)}return e},init:function(a){var c=this;b(function(){$(".multiselect",a).each(function(a){c.refresh($(this))})},0,!1)}}});var app=angular.module("sw_layout");app.factory("cmpfacade",function(a,b,c,d,e,f,g,h){return{unblock:function(a,e){var f=b.getInstance("cmpfacade#unblock"),g=a.rendererType,h=a.attribute;f.debug("unblocking association {0} of type {1}".format(h,g)),"autocompleteclient"==g?d.unblock(a):"combodropdown"==g&&c.unblock(h),this.digestAndrefresh(a,e)},block:function(a,e){var g=b.getInstance("cmpfacade#block"),h=a.rendererType,i=a.attribute;g.debug("block association {0} of type {1}".format(i,h)),"autocompleteclient"==h?d.block(a):"combodropdown"==h?c.block(a.associationKey):"combo"==h&&f.refreshFromAttribute(a),this.digestAndrefresh(a,e)},digestAndrefresh:function(b,c){b.rendererType;try{c.$digest(),this.refresh(b,c,!0)}catch(d){var e=this;a(function(){e.refresh(b,c,!0)},0,!1)}},refresh:function(a,g,h){var i=a.attribute,j=b.getInstance("cmpfacade#refresh"),k=a.rendererType;h?j.debug("calling digest and refresh for field {0}, component {1}".format(a.attribute,k)):j.debug("calling refresh for field {0}, component {1}".format(a.attribute,k)),"autocompleteclient"==k?d.refreshFromAttribute(i):"autocompleteserver"==k?e.refreshFromAttribute(a,g):"combodropdown"==k?c.refreshFromAttribute(i):"default"!=k&&"combo"!=k||f.refreshFromAttribute(a)},init:function(a,b){var f=b.datamap,h=b.schema;c.init(a),d.init(a,f,h,b),e.init(a,f,h,b),g.init(a,f)},blockOrUnblockAssociations:function(a,b,c,d){if(c!=b){var e=h.getDisplayablesByAssociationKey(a.schema,d.associationKey);if(null!=e){e=e.reverse();var f=this;1==c&&0==b?$.each(e,function(b,c){f.unblock(c,a)}):0!=c&&void 0!=c||1!=b||$.each(e,function(b,c){f.block(c,a)})}}}}});var B64={alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",lookup:null,ie:/MSIE /.test(navigator.userAgent),ieo:/MSIE [67]/.test(navigator.userAgent),encode:function(a){var b,c,d,e=B64.toUtf8(a),f=-1,g=e.length,h=[,,,];if(B64.ie){for(var i=[];++f<g;)b=e[f],c=e[++f],h[0]=b>>2,h[1]=(3&b)<<4|c>>4,isNaN(c)?h[2]=h[3]=64:(d=e[++f],h[2]=(15&c)<<2|d>>6,h[3]=isNaN(d)?64:63&d),i.push(B64.alphabet.charAt(h[0]),B64.alphabet.charAt(h[1]),B64.alphabet.charAt(h[2]),B64.alphabet.charAt(h[3]));return i.join("")}for(var i="";++f<g;)b=e[f],c=e[++f],h[0]=b>>2,h[1]=(3&b)<<4|c>>4,isNaN(c)?h[2]=h[3]=64:(d=e[++f],h[2]=(15&c)<<2|d>>6,h[3]=isNaN(d)?64:63&d),i+=B64.alphabet[h[0]]+B64.alphabet[h[1]]+B64.alphabet[h[2]]+B64.alphabet[h[3]];return i},decode:function(a){if(a.length%4)throw new Error("InvalidCharacterError: 'B64.decode' failed: The string to be decoded is not correctly encoded.");var b=B64.fromUtf8(a),c=0,d=b.length;if(B64.ieo){for(var e=[];c<d;)b[c]<128?e.push(String.fromCharCode(b[c++])):b[c]>191&&b[c]<224?e.push(String.fromCharCode((31&b[c++])<<6|63&b[c++])):e.push(String.fromCharCode((15&b[c++])<<12|(63&b[c++])<<6|63&b[c++]));return e.join("")}for(var e="";c<d;)e+=b[c]<128?String.fromCharCode(b[c++]):b[c]>191&&b[c]<224?String.fromCharCode((31&b[c++])<<6|63&b[c++]):String.fromCharCode((15&b[c++])<<12|(63&b[c++])<<6|63&b[c++]);return e},toUtf8:function(a){var b,c=-1,d=a.length,e=[];if(/^[\x00-\x7f]*$/.test(a))for(;++c<d;)e.push(a.charCodeAt(c));else for(;++c<d;)b=a.charCodeAt(c),b<128?e.push(b):b<2048?e.push(b>>6|192,63&b|128):e.push(b>>12|224,b>>6&63|128,63&b|128);return e},fromUtf8:function(a){var b,c=-1,d=[],e=[,,,];if(!B64.lookup){for(b=B64.alphabet.length,B64.lookup={};++c<b;)B64.lookup[B64.alphabet.charAt(c)]=c;c=-1}for(b=a.length;++c<b&&(e[0]=B64.lookup[a.charAt(c)],e[1]=B64.lookup[a.charAt(++c)],d.push(e[0]<<2|e[1]>>4),e[2]=B64.lookup[a.charAt(++c)],64!=e[2])&&(d.push((15&e[1])<<4|e[2]>>2),e[3]=B64.lookup[a.charAt(++c)],64!=e[3]);)d.push((3&e[2])<<6|e[3]);return d}},app=angular.module("sw_layout");app.run(["$log","contextService",enhanceAngularLog]);