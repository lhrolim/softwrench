
<form>
    <div id="affixpagination" class="affix-pagination hiddenonprint">
        <pagination pagination-data="paginationData" renderfn="selectPage(pageNumber,pageSize,printMode)" />
    </div>

    <div style="width:100%">
        <table class="table table-hover hidden-phone listgrid-table" data-application="{{::schema.applicationName}}" data-schema="{{::schema.schemaId}}" id="listgrid">
            <thead id="listgridthread" class="listgrid-thead">
                <!-- Header row -->
                <tr class="header-row">
                    <th ng-repeat="column in schema.displayables" ng-show="!isFieldHidden(schema,column)"
                        ng-style="{'min-width': column.rendererParameters['minwidth'],
                                           'max-width': column.rendererParameters['maxwidth'],
                                           'width': column.rendererParameters['width'],
                                           'word-wrap': column.rendererParameters['wordwrap']}"
                        ng-click="sort(column)">
                        <div ng-if="shouldShowFilter(column)">
                            <span class="add-on" rel="tooltip" data-original-title="{{i18N('_grid.filter.clicksort','Click here to sort')}}">{{i18NLabel(column)}}</span>
                            <span class="glyphicon glyphicon-sort-by-attributes"
                                  ng-show="column.attribute != null && searchSort.field == column.attribute && searchSort.order == 'asc'"
                                  rel="tooltip" data-original-title="Sorted ascendant"></span>
                            <span class="glyphicon glyphicon-sort-by-attributes-alt" ng-show="column.attribute != null && searchSort.field == column.attribute && searchSort.order == 'desc'"
                                  rel="tooltip" data-original-title="Sorted descendant"></span>
                        </div>
                    </th>
                </tr>

                <!-- Filter row shown when there are few columns to be displayed -->
                <tr class="filter-row hidden-too-much-columns hiddenonprint">
                    <th ng-repeat="column in schema.displayables" ng-show="!isFieldHidden(schema,column)"
                        ng-style="{'min-width': column.rendererParameters['minwidth'],
                                'max-width': column.rendererParameters['maxwidth'],
                                'width': column.rendererParameters['width']}" filterrowrendered>

                        <div ng-if="shouldShowFilter(column)">
                            <ng-switch on="column.rendererType">
                                <div ng-switch-when="datetime" data-datepicker="true" class="input-group input-group-sm">
                                    <input type="text" ng-model="searchData[column.attribute]" class="form-control"
                                           data-date-time
                                           data-show-time="false"
                                           data-show-date="{{::column.rendererParameters['showdate']}}"
                                           data-date-format="{{::column.rendererParameters['format']}}"
                                           data-allow-past="{{::fieldMetadata.rendererParameters['allowpast']}}"
                                           data-allow-future="{{::fieldMetadata.rendererParameters['allowfuture']}}"
                                           placeholder="{{i18N('_grid.filter.placeholder','{0} Search',[column.label])}}" ng-enter="filterSearch(column.attribute,$event)" />
                                    <span class="input-group-addon " data-calendericon="true" rel="tooltip" data-original-title="{{i18N('calendar.date_tooltip','Open the calendar popup')}}"><i class="glyphicon glyphicon-calendar"></i></span>

                                    <!-- Couldn't use directive "advanced-filter-toogle" here, due to fix/unfix header functionality.
                                    The following div cant 'include' later, or else the grid header will break in firefox and ie. -->
                                    <div class="input-group-addon dropdown">
                                        <span class="dropdown-toggle grid-filter-button" ng-class="{'glyphicon glyphicon-filter' : getSearchIcon(column.attribute) == ''}"
                                              data-toggle="dropdown" rel="tooltip"
                                              data-original-title="{{::getOperator(column.attribute).tooltip}}">{{::getSearchIcon(column.attribute)}}</span>

                                        <ul class="dropdown-menu">
                                            <li ng-repeat="operation in searchOperations()" ng-click="selectOperator(column.attribute,operation)"
                                                ng-show="operation.renderType.indexOf(column.rendererType) > -1 || column.rendererType == null"
                                                ng-class="{'active' : searchOperator[column.attribute].id == operation.id}">
                                                <a href="#">{{::operation.title}}</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div ng-switch-default class="input-group input-group-sm">
                                    <input type="search" placeholder="{{i18N('_grid.filter.placeholder','{0} Search',[column.label])}}" class="form-control"
                                           ng-model="searchData[column.attribute]" ng-enter="filterSearch(column.attribute)" />
                                    <!-- Couldn't use directive "advanced-filter-toogle" here, due to fix/unfix header functionality.
                                    The following div cant 'include' later, or else the grid header will break in firefox and ie. -->
                                    <div class="input-group-addon dropdown">
                                        <span class="dropdown-toggle grid-filter-button" ng-class="{'glyphicon glyphicon-filter' : getSearchIcon(column.attribute) == ''}"
                                              data-toggle="dropdown" rel="tooltip"
                                              data-original-title="{{::getOperator(column.attribute).tooltip}}">{{getSearchIcon(column.attribute)}}</span>

                                        <ul class="dropdown-menu">
                                            <li ng-repeat="operation in searchOperations()" ng-click="selectOperator(column.attribute,operation)"
                                                ng-show="operation.renderType.indexOf(column.rendererType) > -1 || column.rendererType == null"
                                                ng-class="{'active' : searchOperator[column.attribute].id == operation.id}">
                                                <a href="#">{{::operation.title}}</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </ng-switch>
                        </div>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="dm in ::datamap track by dm.fields[schema.idFieldName]" style="cursor: pointer" listtablerendered rel="hideRow" bindonce ng-init="firstrow = $first">

                    <!--for the first row we need to set some extra styles-->
                    <td ng-if="firstrow" ng-repeat="column in schema.displayables" bo-show="!isFieldHidden(schema,column)" ng-click="showDetail(dm,column)"
                        bo-style="{'min-width': column.rendererParameters['minwidth'],
                                'max-width': column.rendererParameters['maxwidth'],
                                'width': column.rendererParameters['width']}">

                        <div ng-if="::column.rendererType == 'checkbox'">
                            <input type="checkbox"
                                   class="check"
                                   name="column.attribute"
                                   value="{{option.value}}"
                                   ng-click="toogleCheckboxSelection(option,column.associationKey,dm)"
                                   ng-model="dm.fields['checked']"
                                   ng-init="dm.fields['checked']=false" />
                        </div>
                        <div ng-if="::column.rendererType == 'color'">
                            <div class="statuscolumncolor" bo-style="{'background-color':statusColor(dm.fields[column.rendererParameters['column']] || 'null',null)}" />
                        </div>
                        <div ng-if="column.type == 'ApplicationFieldDefinition'" class="gridcolumnvalue" bo-style="{
                                         'min-width':getGridColumnStyle(column,'minwidth'),
                                         'max-width':getGridColumnStyle(column,'maxwidth'),
                                         'width':getGridColumnStyle(column,'width')
                                         }">
                            {{::getFormattedValue(dm.fields[column.attribute],column)}}
                        </div>
                        <div ng-if="column.type == 'ApplicationSection'" class="gridcolumnvalue">
                            <div ng-include="contextPath(column.resourcepath)" href="#" style="width: 100%"></div>
                        </div>
                    </td>

                    <!--for the other rows, we do not need to evaulate some ng-style operations which improves performance especially in ff and ie... this is basically copy and paste, unfortunately-->
                    <td ng-if="!firstrow" ng-repeat="column in ::schema.displayables" ng-show="::!isFieldHidden(schema,column)" ng-click="showDetail(dm,column)">
                        <div ng-if="::column.rendererType == 'checkbox'">
                            <input type="checkbox"
                                   class="check"
                                   name="column.attribute"
                                   value="{{::option.value}}"
                                   ng-click="toogleCheckboxSelection(option,column.associationKey,dm)"
                                   ng-model="dm.fields['checked']"
                                   ng-init="dm.fields['checked']=false" />
                        </div>
                        <div ng-if="::column.rendererType == 'color'">
                            <div class="statuscolumncolor" bo-style="{'background-color':statusColor(dm.fields[column.rendererParameters['column']] || 'null',null)}" />
                        </div>
                        <div ng-if="::column.type == 'ApplicationFieldDefinition'" class="gridcolumnvalue">
                            {{::getFormattedValue(dm.fields[column.attribute],column)}}
                        </div>

                        <div ng-if="::column.type == 'ApplicationSection'" class="gridcolumnvalue">
                            <div ng-include="::contextPath(column.resourcepath)" href="#" style="width: 100%"></div>
                        </div>
                    </td>
                </tr>
            </tbody>
            <!-- footer line -->
            <tfoot ng-show="datamap.length != 0">
                <tr class="footer-row">
                    <th ng-repeat="column in schema.displayables" ng-show="!isFieldHidden(schema,column)"
                        ng-style="{'min-width': column.rendererParameters['minwidth'],
                                           'max-width': column.rendererParameters['maxwidth'],
                                           'width': column.rendererParameters['width'],
                                           'word-wrap': column.rendererParameters['wordwrap']}">
                        <!--<div ng-if="shouldShowFilter(column)">
                            <span class="add-on">{{i18NLabel(column)}}</span>
                        </div>-->
                    </th>
                </tr>
            </tfoot>
        </table>
    </div>
    <p class="text-center" ng-show="datamap.length == 0">
        {{i18N("_grid.filter.noresult","No results match your search criteria")}}
    </p>
    <!--this is exclusive for IBM Demo to indicate the bottom of the page.-->
    <div ng-if="isNotHapagTest()">
        <br />
        <br />
        <div id="affixpagination1" class="hiddenonprint">
            <pagination pagination-data="paginationData" renderfn="selectPage(pageNumber,pageSize,printMode)" />
        </div>
    </div>

    <div ng-if="isCommand(schema)">
        <commandbar schema="schema" mode="schema.mode" datamap="datamap" />
    </div>
</form>




