<?xml version="1.0" encoding="utf-8" ?>
<metadata xmlns="http://www.controltechnologysolutions.com/metadata">

  <applications>


    <application entity="Role" name="Role" title="Roles">
      <schemas>
        <list>
          <field label="Name" attribute="name" />
          <field label="Description" attribute="description" />
        </list>
      </schemas>

    </application>


    <application entity="UserProfile" name="UserProfile" title="Security Groups">
      <schemas>
        <list>
          <field label="Name" attribute="name" />
          <field label="Description" attribute="description" />
          <commandbars>
            <commandgroup position="gridtop">
              <command id="new" icon="fa-plus"
                       service="redirectService" method="goToApplicationView" parameters="_UserProfile,detail" label="New Security Group" tooltip="New Security Group" position="left"/>
            </commandgroup>
          </commandbars>
        </list>
        <detail>
          <field label="Name" attribute="name" />
          <field label="Description" attribute="description" />
          <tab label="Basic Roles" id="basicroles">
            <composition detailschema="" fetchtype="eager"  relationship="#basicroles"  printschema="" inline="true">
              <collectionproperties allowcreation="false" listschema="rolerepresentation"/>
            </composition>
          </tab>
          <optionfield attribute="application" providerattribute="topLevelApplications" label="Application">
            <event type="afterchange" service="userProfileService" method="onApplicationChange"/>
            <event type="beforechange" service="userProfileService" method="beforeApplicationChange"/>
          </optionfield>
          <section orientation="horizontal" showexpression="@application!=null">
            <section orientation="horizontal">
              <section>
                <header displacement="ontop" label="Basic Setup"/>
                <field attribute="#appallowcreation" label="Allow Creation" showexpression="@hasCreationSchema==true">
                  <renderer type="checkbox"/>
                </field>
                <field attribute="#appallowupdate" label="Allow Update">
                  <renderer type="checkbox"/>
                </field>
                <field attribute="#appallowview" label="Allow Only Visualization">
                  <renderer type="checkbox"/>
                </field>
              </section>
              <section>
                <header displacement="ontop" label="Action Setup"/>
                <section orientation="horizontal">
                  <optionfield label="Mode" attribute="selectedmode" providerattribute="selectableModes" dependantfields="application">
                    <event type="afterchange" service="userProfileService" method="afterModeChanged"/>
                  </optionfield>
                  <optionfield label="Schema" attribute="schema" providerattribute="schemas" dependantfields="application,selectedmode" showexpression="@showschemacombo" >
                    <renderer type="combo" params="donotignoreeventsifhidden=true"/>
                    <event type="providerloaded" service="userProfileService" method="afterSchemaListLoaded"/>
                    <event type="afterchange" service="userProfileService" method="afterSchemaChanged"/>
                  </optionfield>
                </section>

                <optionfield label="Tab/Table" attribute="#selectedtab" providerattribute="selectableTabs" dependantfields="selectedmode,schema" showexpression="@showtabscombo">
                  <renderer type="combo" params="donotignoreeventsifhidden=true"/>
                  <event type="providerloaded" service="userProfileService" method="afterTabsLoaded"/>
                  <event type="afterchange" service="userProfileService" method="tabvaluechanged"/>
                </optionfield>

                <section showexpression="@iscompositiontab">
                  <field attribute="#compallowcreation" label="Allow Creation">
                    <renderer type="checkbox"/>
                  </field>
                  <field attribute="#compallowupdate" label="Allow Update">
                    <renderer type="checkbox"/>
                  </field>
                  <field attribute="#compallowview" label="Allow Visualization">
                    <renderer type="checkbox"/>
                  </field>
                </section>
              </section>
            </section>

            <section showexpression="@#selectedtab !=null &amp;&amp; !@iscompositiontab">
              <header displacement="ontop" label="Field Setup" />

              <composition detailschema="" fetchtype="eager"  relationship="#fieldPermissions"  printschema="" inline="true">
                <collectionproperties allowcreation="false" listschema="fieldRepresentation"/>
              </composition>
              
              

            </section>

          </section>

          <event type="onschemafullyloaded" method="onSchemaLoad" service="userProfileService"/>

        </detail>

        <schema id="rolerepresentation" stereotype="list.selection">
          <field hidden="true" attribute="id"/>
          <field label="Name" attribute="name" />
          <field label="Description" attribute="description" />
          <properties>
            <property key="list.paginationsize" value="10"/>
            <property key="list.paginationoptions" value="10"/>
          </properties>
        </schema>

        <schema id="fieldRepresentation" stereotype="list">

          <event type="onload" service="userProfileService" method="availableFieldsRefreshed"/>
          <field hidden="true" attribute="#attribute"/>
          <field label="Field" attribute="#label" />
          <optionfield attribute="#permission" label="Permission">
            <option label="Full Control" value="fullcontrol"/>
            <option label="None" value="none"/>
            <option label="Read Only" value="readonly"/>
          </optionfield>
          <properties>
            <property key="list.paginationsize" value="10"/>
            <property key="list.paginationoptions" value="10"/>
          </properties>
          
          
          
        </schema>

      </schemas>

    </application>

  </applications>




</metadata>
