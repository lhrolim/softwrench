<?xml version="1.0" encoding="utf-8" ?>
<metadata xmlns="http://www.example.org/metadata" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.example.org/metadata ../../../Schema/Metadata.xsd ">

  <templates>
    <template path="@labor.xml"/>
    <template path="@chartofaccounts.xml"/>
  </templates>
  
  <entities>
    <entity name="labtrans" idAttribute="labtransid">
      <relationships>
        <relationship to="labor">
          <relationshipAttribute from="laborcode" to="laborcode" primary="true"/>
          <relationshipAttribute from="orgid" to="orgid" />
        </relationship>
        <relationship to="laborcraftrate">
          <relationshipAttribute from="craft" to="craft" primary="true"/>
          <relationshipAttribute from="laborcode" to="laborcode"/>
          <relationshipAttribute from="orgid" to="orgid" />
        </relationship>
        <relationship to="chartofaccounts" >
          <relationshipAttribute from="gldebitacct" to="glaccount" primary="true"/>
          <relationshipAttribute from="orgid" to="orgid" />
        </relationship>
      </relationships>
      <connectorParameters>
        <connectorParameter key="dbtable" value="labtrans" />
        <connectorParameter key="integration_interface" value="SWLABTRANS" />
      </connectorParameters>
    </entity>
  </entities>


  <applications>
    <application name="labtrans" entity="labtrans" title="Labor">
      <properties>
        <property key ="icon.composition.tab" value="fa fa-users"/>
      </properties>
      <schemas>
        <schema id="list" stereotype="compositionlist">
          <properties>
            <property key="list.click.popup" value="modal"/>
          </properties>
          <field attribute="labtransid" hidden="true"/>
          <field attribute="laborcode" label="Labor" qualifier="title"/>
          <field attribute="regularhrs" label="Regular Hours" qualifier="subtitle"/>
          <field attribute="gldebitacct" label="GL Debit Account" qualifier="subtitle"/>
          <commandbars>
            <commandgroup position="compositionbottom" removeundeclared="true">
              <command icon="fa fa-users" id ="addnewlabor" label="Add New Labor" service="labtranService" method="displayModal" parameters="parentschema,parentdatamap"/>
            </commandgroup>
          </commandbars>
        </schema>

        <schema id="detail" stereotype="compositiondetail" mode="input">
          <field attribute="labtransid" hidden="true"/>
          <field attribute="orgid" hidden="true"/>
          <field attribute="siteid" hidden="true"/>
          <field attribute="laborcode" hidden="true" />
          <field attribute="transtype" hidden="true" />
          <field attribute="refwo" hidden="true" />
          <field attribute="enterby" hidden="true" />
          <field attribute="payrate" hidden="true" />
          <association label="Labor:" target="laborcode" labelfield="labor_.laborcode" requiredexpression="true" >
            <renderer type="lookup"/>
            <event type="afterchange" service="labtranService" method="afterlaborchange"/>
          </association>
          <association label="Craft:" requiredexpression="true" target="craft" labelfield="laborcraftrate_.craft" dependantfields="laborcode" extraprojectionvalues="defaultcraft, rate">
            <event type="afterchange" service="labtranService" method="aftercraftchange"/>
          </association>
          <field label="Start Date:" attribute="startdate">
            <renderer type="datetime" params="format=MM/dd/yyyy;showtime=false;allowfuture=false" />
          </field>
          <field label="Start Time:" attribute="starttime" >
            <renderer type="datetime" params="format=HH:mm;showdate=false" />
          </field>
          <field label="End Date:" attribute="finishdate">
            <renderer type="datetime" params="format=MM/dd/yyyy;showtime=false" />
          </field>
          <field label="End Time:" attribute="finishtime" >
            <renderer type="datetime" params="format=HH:mm;showdate=false" />
          </field>
          <field attribute="regularhrs" label="Regular Hours:" requiredexpression="true" default="8"/>
          <association label="GL Debit Account:" target="gldebitacct" labelfield="chartofaccounts_.accountname" >
            <renderer type="lookup"/>
          </association>
          <commandbars>
            <commandgroup position="detailform">
              <removecommand id="print"/>
              <removecommand id="save"/>
              <removecommand id="cancel"/>
              <command id="addnewlabor" label="Submit" service="labtranService" method="submitLaborTrans"  parameters="schema,datamap" />
              <command id="cancelnewlabor" label="Cancel" service="labtranService" method="cancelLaborTrans" />
            </commandgroup>
          </commandbars>
        </schema>
      </schemas>
    </application>

  </applications>




</metadata>