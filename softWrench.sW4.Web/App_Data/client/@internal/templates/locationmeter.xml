<?xml version="1.0" encoding="utf-8" ?>
<metadata xmlns="http://www.controltechnologysolutions.com/metadata">

  <templates>
    <template path="@meter.xml"/>
  </templates>
  
  <entities>
    <entity name="locationmeter" idAttribute="locationmeterid">
      <attributes>
        <attribute name="location" type="varchar" required="true" />
        <attribute name="metername" type="varchar" required="true" />
        <attribute name="active" type="smallint" required="true" />
        <attribute name="measureunitid" type="varchar" required="false" />
        <attribute name="rollover" type="decimal" required="false" />
        <attribute name="avgcalcmethod" type="varchar" required="false" />
        <attribute name="slidingwindowsize" type="int" required="false" />
        <attribute name="sincelastrepair" type="decimal" required="true" />
        <attribute name="sincelastoverhaul" type="decimal" required="true" />
        <attribute name="sincelastinspect" type="decimal" required="true" />
        <attribute name="sinceinstall" type="decimal" required="true" />
        <attribute name="lifetodate" type="decimal" required="true" />
        <attribute name="changeby" type="varchar" required="true" />
        <attribute name="changedate" type="datetime" required="true" />
        <attribute name="remarks" type="varchar" required="false" />
        <attribute name="siteid" type="varchar" required="true" />
        <attribute name="orgid" type="varchar" required="true" />
        <attribute name="lastreadingdate" type="datetime" required="false" />
        <attribute name="lastreading" type="varchar" required="false" />
        <attribute name="pointnum" type="varchar" required="false" />
        <attribute name="average" type="decimal" required="false" />
        <attribute name="readingtype" type="varchar" required="false" />
        <attribute name="lastreadinginspctr" type="varchar" required="false" />
        <attribute name="locationmeterid" type="bigint" required="true" />
        <attribute name="langcode" type="varchar" required="true" />
        <attribute name="hasld" type="smallint" required="true" />
        <attribute name="sequence" type="smallint" required="false" />
        <attribute name="rowstamp" type="timestamp" required="true" />
        <attribute name="disabledrollover" type="boolean" query="'false'" />
      </attributes>
      <relationships>
        <relationship to="meter">
          <relationshipAttribute from="metername" to="metername" primary="true"/>
        </relationship>
        <relationship to="person" qualifier="inspector">
          <relationshipAttribute from="inspector" to="personid" primary="true"/>
        </relationship>
        <relationship to="locoper">
          <relationshipAttribute from="location" to="location" primary="true"/>
          <relationshipAttribute from="orgid" to="orgid"/>
        </relationship>
        <relationship to="metergroup" ignoreprimary="true">
          <!--Framework not currently supporting inner level relationships for compositions, this work around is for the meter composition on the locations detail schema-->
          <relationshipAttribute query="locoper_.groupname = metergroup_.groupname"/>
        </relationship>
        <relationship to="synonymdomain" qualifier="averagemethod" ignoreprimary="true">
          <relationshipAttribute literal="averagemethod" to="domainid"/>
        </relationship>
      </relationships>
      <connectorParameters>
        <connectorParameter key="dbtable" value="locationmeter" />
      </connectorParameters>
    </entity>
  </entities>


</metadata>
