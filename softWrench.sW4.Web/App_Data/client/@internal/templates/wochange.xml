<?xml version="1.0" encoding="utf-8" ?>
<metadata xmlns="http://www.controltechnologysolutions.com/metadata">

  <entities>
    <entity name="wochange" idAttribute="workorderid">
      <attributes>
        <attribute name="workorderid" type="integer" required="true" />
      </attributes>
      <relationships>
        <relationship to="longdescription">
          <relationshipAttribute from="workorderid" to="ldkey" primary="true"/>
          <relationshipAttribute to="ldownertable" literal="WORKORDER" quoteLiteral="true" />
          <relationshipAttribute to="ldownercol" literal="DESCRIPTION" quoteLiteral="true" />
        </relationship>
        <relationship to="longdescription" qualifier="reasonforchange">
          <relationshipAttribute from="workorderid"  to="ldkey" primary="true"/>
          <relationshipAttribute to="ldownertable" literal="WORKORDER" quoteLiteral="true" />
          <relationshipAttribute to="ldownercol" literal="REASONFORCHANGE" quoteLiteral="true" />
        </relationship>
        <relationship to="longdescription" qualifier="backoutplan">
          <relationshipAttribute from="workorderid" to="ldkey" primary="true"/>
          <relationshipAttribute to="ldownertable" literal="WORKORDER" quoteLiteral="true" />
          <relationshipAttribute to="ldownercol" literal="BACKOUTPLAN" quoteLiteral="true" />
        </relationship>
        <relationship to="longdescription" qualifier="pretestdetail">
          <relationshipAttribute from="workorderid" to="ldkey" primary="true"/>
          <relationshipAttribute to="ldownertable" literal="WORKORDER" quoteLiteral="true" />
          <relationshipAttribute to="ldownercol" literal="ITDCHGPRETSTDTL" quoteLiteral="true" />
        </relationship>
        <relationship to="longdescription" qualifier="exceptionreason">
          <relationshipAttribute from="workorderid" to="ldkey" primary="true"/>
          <relationshipAttribute to="ldownertable" literal="WORKORDER" quoteLiteral="true" />
          <relationshipAttribute to="ldownercol" literal="EXCEPTIONREASON" quoteLiteral="true" />
        </relationship>
        <relationship to="workorder">
          <relationshipAttribute from="wonum" to="parent" primary="true"/>
          <relationshipAttribute from="siteid" to="siteid" />
        </relationship>
        <relationship to="pmchgotherapprovers" qualifier="approvalsdashboard">
          <relationshipAttribute from="wonum" to="wonum" primary="true" />
          <relationshipAttribute from="siteid" to="siteid" />
        </relationship>
        <relationship to="woactivity" qualifier="woactivitydashboard">
          <relationshipAttribute from="wonum" to="parent" primary="true" />
          <relationshipAttribute from="siteid" to="siteid" />
        </relationship>
        <relationship to="worklog">
          <relationshipAttribute from="wonum" to="recordkey" primary="true" />
          <relationshipAttribute from="siteid" to="siteid" />
          <relationshipAttribute to="class" literal="CHANGE" quoteLiteral="true" />
        </relationship>
      </relationships>
      <connectorParameters>
        <connectorParameter key="integration_interface" value="SWCH" />
        <connectorParameter key="customconnector" value="softWrench.sW4.Data.Persistence.WS.Commons.BaseChangeRequestCrudConnector" />
      </connectorParameters>
    </entity>
  </entities>

  <applications>
    <application entity="wochange" name="change" title="Change">
      <schemas>
        <list title="Change Grid">
          <field attribute="workorderid" hidden="true">
          </field>
          <field attribute="wonum" label="Change#">
            <renderer type="default" params="widthXS=30%;widthSM=20%;widthMD=15%;widthLG=10%" />
          </field>
          <field attribute="description" label="Summary">
            <renderer type="default" params="excelwidth=50" />
          </field>
          <field attribute="status" label="Status" >
            <renderer type="default" params="widthXS=-1%;widthSM=25%;widthMD=20%" />
          </field>
          <field attribute="pmchgtype" label="Type" >
            <renderer type="default" params="widthXS=-1%;widthSM=-1%;widthMD=20%" />
          </field>
          <field attribute="priority" label="Priority" >
            <renderer type="default" params="widthXS=-1%;widthSM=-1%;widthMD=-1%" />
          </field>
          <field attribute="risk" label="Risk" >
            <renderer type="default" params="widthXS=-1%;widthSM=-1%;widthMD=-1%" />
          </field>
          <field attribute="#color" label="">
            <renderer type="color" params="width=4%;grid=change;column=status"/>
          </field>
          <properties>
            <property key="list.click.schema" value="editdetail"/>
          </properties>
        </list>
        
        <schema id="adetail" title="Change Details" abstract="true" stereotype="detail" platform="web">
          <section orientation="horizontal">
            <renderer type="default" params="childinputsize=medium" />
            <section id="statussection"/>
          </section>

          <section orientation="horizontal">
            <header displacement="ontop" label="Change Details" params="fieldset=true" />
            <renderer type="default" params="childinputsize=medium" />
            <field attribute="description" label="Summary:" />
            <field attribute="location" label="Location:"/>
            <field attribute="classstructureid" label="Classification:"/>
            <field attribute="worktype" label="Category:"/>
            <field attribute="reasonforchange" label="Reason:"/>
            <field attribute="reasonforchange_.ldtext" label="Reason Details:"/>
            <field attribute="verification" label="Verification:"/>
            <field attribute="backoutplan" label="Back Out Plan:"/>
            <field attribute="backoutplan_.ldtext" label="Back Out Plan Detail:"/>
            <field attribute="pretestdetail_.ldtext" label="Pretest Details:"/>
            <field attribute="wopriority" label="Priority:"/>
            <field attribute="longdescription_.ldtext" label="Remarks:"/>
          </section>

          <section orientation="horizontal">
            <header displacement="ontop" label="Responsibility" params="fieldset=true" />
            <field attribute="ownergroup" label="Owner Group:"/>
            <field attribute="reportedby" label="Reported By:"/>
          </section>
          
          <section orientation="horizontal">
            <header displacement="ontop" label="Scheduling" params="fieldset=true" />
            <renderer type="default" params="childinputsize=medium" />
            <field attribute="schedstart" label="Scheduled Start Date:">
              <renderer type="datetime" params="format=MM/dd/yyyy"/>
            </field>
            <field attribute="schedfinish" label="Scheduled Finish Date:">
              <renderer type="datetime" params="format=MM/dd/yyyy"/>
            </field>
            <field attribute="targstartdate" label="Target Start Date:">
              <renderer type="datetime" params="format=MM/dd/yyyy"/>
            </field>
            <field attribute="targcompdate" label="Target Finish Date:">
              <renderer type="datetime" params="format=MM/dd/yyyy"/>
            </field>
          </section>

          <section orientation="horizontal">
            <header displacement="ontop" label="Miscellaneous" params="fieldset=true" />
            <renderer type="default" params="childinputsize=medium" />
            <section id="attachmentsection" />
          </section>

          <section id="remainingflieds"/>
        </schema>

        <schema parentschema="adetail" id="editdetail" title="Change Details">

          <section id="statussection">
            <field attribute="wonum" label="Change#" requiredexpression="true"/>
            <field attribute="status" label="Status:" requiredexpression="true"/>
          </section>

          <section id="remainingflieds">
            <field attribute="workorderid" hidden="true" />
            <field attribute="workorder_.wonum" hidden="true" />
            <field attribute="workorder_.status" hidden="true" />

            <section id="compositions"/>
          </section>
        </schema>
        
        <schema parentschema="adetail" id="newdetail" title="New Change">
          <section id="remainingflieds">
            <field attribute="estdur"            default="0" hidden="true"/>
            <field attribute="estlabhrs"         default="0" hidden="true"/>
            <field attribute="estmatcost"        hidden="true" default="0"/>
            <field attribute="estintlabhrs"      hidden="true" default="0"/>
            <field attribute="estintlabcost"     hidden="true" default="0"/>
            <field attribute="estatapprlabhrs"   hidden="true" default="0"/>
            <field attribute="estatapprmatcost"  hidden="true" default="0"/>
            <field attribute="estatapprlabcost"  hidden="true" default="0"/>
            <field attribute="estatapprtoolcost" hidden="true" default="0"/>
            <field attribute="estatapprservcost" hidden="true" default="0"/>
            <field attribute="estapprlabhrs"     hidden="true" default="0"/>
            <field attribute="estapprmatcost"    hidden="true" default="0"/>
            <field attribute="estapprlabcost"    hidden="true" default="0"/>
            <field attribute="estlabcost"        hidden="true" default="0"/>
            <field attribute="esttoolcost"       hidden="true" default="0"/>
            <field attribute="estservcost"       hidden="true" default="0"/>
            <field attribute="actlabhrs"         hidden="true" default="0"/>
            <field attribute="actlabcost"        hidden="true" default="0"/>
            <field attribute="actservcost"       hidden="true" default="0"/>
            <field attribute="actmatcost"        hidden="true" default="0"/>
            <field attribute="acttoolcost"       hidden="true" default="0"/>
            <field attribute="outlabcost"        hidden="true" default="0"/>
            <field attribute="outmatcost"        hidden="true" default="0"/>
            <field attribute="outtoolcost"       hidden="true" default="0"/>
            <field attribute="outservcost"       hidden="true" default="0"/>
            <field attribute="statusdate" hidden="true" default="@currentdatetime"/>
          </section>

          <section id="attachmentsection">
            <field label="Attachment:" attribute="newattachment" >
              <renderer type="upload"/>
            </field>
          </section>
        </schema>
      </schemas>
    </application>
  </applications>
</metadata>
