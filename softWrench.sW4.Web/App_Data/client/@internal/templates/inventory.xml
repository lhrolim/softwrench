<?xml version="1.0" encoding="utf-8" ?>
<metadata xmlns="http://www.controltechnologysolutions.com/metadata">

  <templates>
    <template path="@chartofaccounts.xml"/>
    <template path="@workorder.xml"/>
    <template path="@item.xml"/>
    <template path="@glcomponents.xml"/>
    <template path="@invissue.xml"/>
    <template path="@invtransfer.xml"/>
  </templates>

  <entities>
    <entity name="invissuewo" idAttribute="wonum" parententity="workorder">
      <relationships>
        <relationship to="invissue" collection="true">
          <relationshipAttribute from="wonum" to="refwo" primary="true" />
          <relationshipAttribute from="siteid" to="siteid" />
        </relationship>
        <relationship to ="glcomponents">
          <relationshipAttribute from="orgid" to="orgid" primary="true"/>
        </relationship>
      </relationships>
    </entity>


    <entity name="physicalCount" idAttribute="invbalancesid" parententity="invbalances" whereclause="@physicalCountWhereClauseProvider.PhysicalCountQuery">
      <relationships>
        <relationship to="item" >
          <relationshipAttribute from="itemnum" to="itemnum" primary="true"/>
          <relationshipAttribute from="itemsetid" to="itemsetid"/>
        </relationship>
        <relationship to="inventory">
          <relationshipAttribute from="itemnum" to="itemnum" primary="true"/>
          <relationshipAttribute from="location" to="location" />
          <relationshipAttribute from="siteid" to="siteid" />
          <relationshipAttribute from="itemsetid" to="itemsetid" />
        </relationship>
        <relationship to="invlot">
          <relationshipAttribute from="itemnum" to="itemnum" primary="true"/>
          <relationshipAttribute from="location" to="location"/>
          <relationshipAttribute from="siteid" to="siteid"/>
          <relationshipAttribute from="lotnum" to="lotnum"/>
        </relationship>
        <relationship to ="glcomponents">
          <relationshipAttribute from="orgid" to="orgid" primary="true"/>
        </relationship>
      </relationships>
      <connectorParameters>
        <connectorParameter key="customconnector" value="softWrench.sW4.Data.Persistence.WS.Commons.BasePhysicalCountCrudConnector"/>
      </connectorParameters>
    </entity>

    <entity name="physicalDeviation" idAttribute="invbalancesid" parententity="invbalances" whereclause="RECONCILED = 0 and curbal != physcnt">
      <relationships>
        <relationship to="item" >
          <relationshipAttribute from="itemnum" to="itemnum" primary="true"/>
          <relationshipAttribute from="itemsetid" to="itemsetid"/>
        </relationship>
        <relationship to="inventory">
          <relationshipAttribute from="itemnum" to="itemnum" primary="true"/>
          <relationshipAttribute from="location" to="location" />
          <relationshipAttribute from="siteid" to="siteid" />
          <relationshipAttribute from="itemsetid" to="itemsetid" />
        </relationship>
        <relationship to="invlot">
          <relationshipAttribute from="itemnum" to="itemnum" primary="true"/>
          <relationshipAttribute from="location" to="location"/>
          <relationshipAttribute from="siteid" to="siteid"/>
          <relationshipAttribute from="lotnum" to="lotnum"/>
        </relationship>
        <relationship to ="glcomponents">
          <relationshipAttribute from="orgid" to="orgid" primary="true"/>
        </relationship>
      </relationships>
    </entity>

    <entity name="invreserve" idAttribute="requestnum" whereclause="reservedqty > 0">
      <attributes>
        <attribute name="availablequantity" type="bigint" query="(select CAST(SUM(COALESCE(curbal, 0)) AS INT) from invbalances where itemnum = !@itemnum and siteid = !@siteid and location = !@location)"/>
      </attributes>
      <relationships>
        <relationship to="item">
          <relationshipAttribute from="itemnum" to="itemnum" primary="true"/>
          <relationshipAttribute from="itemsetid" to="itemsetid"/>
        </relationship>
        <relationship to="invissue">
          <relationshipAttribute from="wonum" to="refwo" primary="true"/>
          <relationshipAttribute from="assetnum" to="assetnum"/>
          <relationshipAttribute from="issueto" to="issueto"/>
          <relationshipAttribute from="itemnum" to="itemnum"/>
          <relationshipAttribute from="itemsetid" to="itemsetid"/>
          <relationshipAttribute from="orgid" to="orgid"/>
        </relationship>
        <relationship to="inventory">
          <relationshipAttribute from="itemnum" to="itemnum" primary="true"/>
          <relationshipAttribute from="siteid" to="siteid"/>
          <relationshipAttribute from="orgid" to="orgid"/>
          <relationshipAttribute from="itemsetid" to="itemsetid"/>
          <relationshipAttribute from="location" to="location"/>
        </relationship>
        <relationship to="invbalances">
          <relationshipAttribute from="itemnum" to="itemnum" primary="true"/>
          <relationshipAttribute from="siteid" to="siteid"/>
          <relationshipAttribute from="orgid" to="orgid"/>
          <relationshipAttribute from="location" to="location"/>
        </relationship>
        <relationship to="asset">
          <relationshipAttribute from="itemnum" to="itemnum" primary="true"/>
          <relationshipAttribute from="itemnum" to="itemnum"/>
          <relationshipAttribute from="orgid" to="orgid"/>
          <relationshipAttribute from="siteid" to="siteid"/>
          <relationshipAttribute from="location" to="location"/>
        </relationship>
        <relationship to ="glcomponents">
          <relationshipAttribute from="orgid" to="orgid" primary="true"/>
        </relationship>
      </relationships>
    </entity>

    <!--SwWEB-1032: Only display active items-->
    <entity name="inventory" idAttribute="inventoryid" whereclause="inventory.STATUS = 'ACTIVE' and (select CAST(SUM(COALESCE(curbal, 0)) AS INT) from invbalances where invbalances.itemnum = inventory.itemnum and invbalances.siteid = inventory.siteid and invbalances.location = inventory.location) > 0">
      <attributes>
        <attribute name="itemnum" type="varchar" required="true" />
        <attribute name="location" type="varchar" required="true" />
        <attribute name="binnum" type="varchar" required="false" />
        <attribute name="vendor" type="varchar" required="false" />
        <attribute name="manufacturer" type="varchar" required="false" />
        <attribute name="modelnum" type="varchar" required="false" />
        <attribute name="catalogcode" type="varchar" required="false" />
        <attribute name="minlevel" type="decimal" required="true" />
        <attribute name="maxlevel" type="decimal" required="true" />
        <attribute name="category" type="varchar" required="true" />
        <attribute name="orderunit" type="varchar" required="false" />
        <attribute name="issueunit" type="varchar" required="true" />
        <attribute name="orderqty" type="decimal" required="true" />
        <attribute name="lastissuedate" type="datetime" required="false" />
        <attribute name="issueytd" type="decimal" required="true" />
        <attribute name="issue1yrago" type="decimal" required="true" />
        <attribute name="issue2yrago" type="decimal" required="true" />
        <attribute name="issue3yrago" type="decimal" required="true" />
        <attribute name="abctype" type="varchar" required="false" />
        <attribute name="ccf" type="int" required="true" />
        <attribute name="sstock" type="decimal" required="false" />
        <attribute name="deliverytime" type="int" required="true" />
        <attribute name="il1" type="varchar" required="false" />
        <attribute name="il5" type="decimal" required="false" />
        <attribute name="glaccount" type="varchar" required="false" />
        <attribute name="controlacc" type="varchar" required="true" />
        <attribute name="shrinkageacc" type="varchar" required="false" />
        <attribute name="invcostadjacc" type="varchar" required="false" />
        <attribute name="sourcesysid" type="varchar" required="false" />
        <attribute name="ownersysid" type="varchar" required="false" />
        <attribute name="externalrefid" type="varchar" required="false" />
        <attribute name="sendersysid" type="varchar" required="false" />
        <attribute name="orgid" type="varchar" required="true" />
        <attribute name="siteid" type="varchar" required="true" />
        <attribute name="internal" type="smallint" required="true" />
        <attribute name="inventoryid" type="int" required="true" />
        <attribute name="itemsetid" type="varchar" required="true" />
        <attribute name="storeloc" type="varchar" required="false" />
        <attribute name="storelocsiteid" type="varchar" required="false" />
        <attribute name="rowstamp" type="timestamp" required="false" />
        <attribute name="quantity" type="bigint" query="(select CAST(SUM(COALESCE(curbal, 0)) AS INT) from invbalances where invbalances.itemnum = !@itemnum and invbalances.siteid = !@siteid and invbalances.location = !@location)"/>
      </attributes>
      <relationships>
        <relationship to="invcost" >
          <relationshipAttribute from="itemnum" to="itemnum" primary="true" />
          <relationshipAttribute from="itemsetid" to="itemsetid" />
          <relationshipAttribute from="location" to="location" />
          <relationshipAttribute from="siteid" to="siteid" />
        </relationship>
        <relationship to="item">
          <relationshipAttribute from="itemnum" to="itemnum" primary="true"/>
        </relationship>
        <relationship to="invbalances">
          <relationshipAttribute from="itemnum" to="itemnum" primary="true"/>
          <relationshipAttribute from="location" to="location"/>
          <relationshipAttribute from="siteid" to="siteid"/>
        </relationship>
        <relationship to ="glcomponents">
          <relationshipAttribute from="orgid" to="orgid" primary="true"/>
        </relationship>
      </relationships>
      <connectorParameters>
        <connectorParameter key="dbtable" value="inventory" />
      </connectorParameters>
    </entity>

    <entity name="matrectransTransfers" parententity="matrectrans" idAttribute="matrectransid" useridAttribute="matrectransid" whereclause="issuetype='TRANSFER'"/>
  </entities>

  <applications>
    <application name="invissuewo" title="Batch Issuing" entity="invissuewo">
      <schemas>
        <schema id="newdetail" stereotype="detailnew" mode="input" title="Batch Issue Details">
          <field attribute="wonum" hidden="true"/>
          <field attribute="#issuetype" hidden="true" default="ISSUE"/>
          <field attribute="#refwo" label="Work Order" readonly="true"/>
          <field attribute="#siteid" label="Site" readonly="true"/>
          <field attribute="#assetnum" label="Asset" readonly="true"/>
          <field attribute="#location" label="Location" readonly="true"/>
          <field attribute="#issueto" label="Issue To" readonly="true"/>
          <field attribute="#storeloc" label="Storeroom" readonly="true"/>
          <field attribute="#gldebitacct" label="GL Debit Account" readonly="true"/>
          <composition relationship="invissue" label="Items" detailschema="newitem" inline="true">
            <renderer type="default" params="fieldclass=issue-items" />
            <collectionproperties listschema="itemlist" hideexistingdata="true" allowcreation="false" autocommit="false" />
          </composition>
          <properties>
            <property key="detail.navigationbuttons.disabled" value="true"/>
          </properties>
          <commandbars>
            <commandgroup position="detailform" removeundeclared="true">
              <command id="additemtobatchissue" label="Add Item" service="inventoryService" method="displayNewIssueModal" parameters="schema,datamap"/>
              <command id="submitnewbatchissue" label="Submit" service="inventoryService" method="submitNewBatchIssue" parameters="schema,datamap" />
              <command id="cancelnewbatchissue" label="Cancel" service="inventoryService" method="navToIssueReturnList" />
            </commandgroup>
          </commandbars>
        </schema>
      </schemas>
    </application>

    <application name="inventory" title="Inventory" entity="inventory">
      <schemas>
        <list>
          <field attribute="itemnum"/>
          <field attribute="binnum"/>
          <field attribute="location"/>
          <field attribute="siteid"/>
          <field attribute="orgid"/>
          <field attribute="status"/>
          <field attribute="costtype"/>
          <field attribute="itemtype"/>
          <field attribute="issueunit"/>
          <field attribute="costtype"/>
          <field attribute="binnum"/>
        </list>

        <schema id="inventoryLookupList" stereotype="list" mode="output">
          <field attribute="storeloc" hidden="true"/>
          <field attribute="siteid" hidden="true"/>
          <field label="Item" attribute="itemnum">
            <renderer type="default" params="width=19%"/>
          </field>
          <field label="Description" attribute="item_.description">
            <renderer type="default"/>
          </field>
          <field label="Type" attribute="item_.itemtype">
            <renderer type="default" params="width=15%"/>
          </field>
          <optionfield label="Rotating" attribute="item_.rotating">
            <renderer type="combo" params="width=16%;filteronly=true;formatter=numberToBoolean"/>
            <option label="Yes" value="1"/>
            <option label="No" value="0"/>
          </optionfield>
          <optionfield label="Kit" attribute="item_.iskit">
            <renderer type="combo" params="width=16%;filteronly=true;formatter=numberToBoolean"/>
            <option value="1" label="Yes"/>
            <option value="0" label="No"/>
          </optionfield>
          <field label="Quantity" attribute="quantity"/>
        </schema>
      </schemas>
    </application>


    <application name="physicalcount" entity="physicalCount" title="Physical Count">
      <schemas>
        <schema stereotype="list" id="physicalcountList" title="Physical Count Grid">
          <properties>
            <property key="config.fullKey" value="/Global/Grids/PhysicalCount/ScanBar"/>
          </properties>
          <commandbars>
            <commandgroup position="gridtop">
              <resourcecommand id="scanfilter" path="/Content/Templates/commands/scan/scanfilter.html" position="&lt;filter"/>
            </commandgroup>
          </commandbars>
          <field attribute="invbalancesid" hidden="true"/>
          <field attribute="itemnum" label="Item"/>
          <field attribute="inventory_.siteid" label="Site"/>
          <field attribute="location" label="Storeroom"/>
          <field attribute="binnum" label="Bin"/>
          <event type="onload" service="scannerdetectionService" method="initInventoryGridListener"/>
        </schema>


        <schema id="detail" stereotype="detail" title="Physical Count Details">
          <properties>
            <property key="nextschema.schemaid" value="physicalcountList"/>
            <property key="detail.titleexpression" value="'Physical Count: {0}'.format(@invbalancesid)"/>
          </properties>
          <field attribute="invbalancesid" requiredexpression="true" readonly="true" hidden="true"/>

          <section orientation="horizontal">
            <renderer type="default" params="childinputsize=medium" />
            <field label="Item" attribute="itemnum" readonly="true" />
            <field label="Description" attribute="item_.description" readonly="true" />
            <field label="Lot" attribute="lotnum" readonly="true" />
          </section>

          <section orientation="horizontal">
            <header displacement="ontop" label="Location" params="fieldset=true" />
            <renderer type="default" params="childinputsize=medium" />
              <field label="Site" attribute="siteid" readonly="true" />
              <field label="Storeroom" attribute="location" readonly="true" />
              <field label="Bin" attribute="binnum" readonly="true" />
            </section>

            <section orientation="horizontal">
              <header displacement="ontop" label="Issuing" params="fieldset=true" />
              <renderer type="default" params="childinputsize=medium" />
              <field label="Condition Code" attribute="conditioncode" readonly="true">
                <renderer type="default" params="inputsize=small" />
              </field>
              <field label="Issue Unit" attribute="inventory_.issueunit" readonly="true">
                <renderer type="default" params="inputsize=small" />
              </field>
            <field label="Last Count Date" attribute="#lastCountDate" readonly="true">
              <renderer type="datetime" params="format=MM/dd/yyyy;"/>
            </field>
            <field label="Count Date" attribute="physcntdate">
              <renderer type="datetime" params="format=MM/dd/yyyy;"/>
            </field>
            <field label="New Count" attribute="physcnt">
              <renderer type="numericinput" params="min=0;"/>
            </field>
          </section>
          <field attribute="curbal" hidden="true"/>
          <event type="onload" service="physicalInventoryService" method="newPhysicalCount"/>
        </schema>
      </schemas>
    </application>

    <application name="physicaldeviation" entity="physicalDeviation" title="Physical Deviation">
      <schemas>
        <schema stereotype="list" id="physicaldeviationList" title="Physical Deviation Grid">
          <properties>
            <property key="config.fullKey" value="/Global/Grids/PhysicalDeviation/ScanBar"/>
          </properties>
          <commandbars>
            <commandgroup position="gridtop">
              <resourcecommand id="scanfilter" path="/Content/Templates/commands/scan/scanfilter.html" position="&lt;filter"/>
            </commandgroup>
          </commandbars>
          <field attribute="invbalancesid" hidden="true"/>
          <field attribute="itemnum" label="Item"/>
          <field attribute="inventory_.siteid" label="Site"/>
          <field attribute="location" label="Storeroom"/>
          <field attribute="binnum" label="Bin"/>
          <field attribute="physcnt" label="Physical Count"/>
          <event type="onload" service="scannerdetectionService" method="initInventoryGridListener"/>
        </schema>
        <schema id="detail" stereotype="detail" title="Physical Deviation Details">
          <properties>
            <property key="nextschema.schemaid" value="physicaldeviationList"/>
            <property key="detail.titleexpression" value="'Physical Count: {0}'.format(@invbalancesid)"/>
          </properties>
          <field attribute="invbalancesid" requiredexpression="true" readonly="true" hidden="true"/>


          <section orientation="horizontal">
            <renderer type="default" params="childinputsize=medium" />
            <field label="Item" attribute="itemnum" readonly="true"/>
            <field label="Description" attribute="item_.description" readonly="true"/>
            <field label="Lot" attribute="lotnum" readonly="true"/>
          </section>

          <section orientation="horizontal">
            <header displacement="ontop" label="Location" params="fieldset=true" />
            <renderer type="default" params="childinputsize=medium" />
            <field label="Site" attribute="siteid" readonly="true"/>
            <field label="Storeroom" attribute="location" readonly="true"/>
            <field label="Bin" attribute="binnum" readonly="true"/>
          </section>

          <section orientation="horizontal">
            <header displacement="ontop" label="Issuing" params="fieldset=true" />
            <renderer type="default" params="childinputsize=medium" />
            <field label="Condition Code" attribute="conditioncode" readonly="true"/>
            <field label="Issue Unit" attribute="item_.issueunit" readonly="true"/>
            <field label="Last Count Date" attribute="#lastCountDate" readonly="true">
              <renderer type="datetime" params="format=MM/dd/yyyy;"/>
            </field>
            <field label="Count Date" attribute="physcntdate">
              <renderer type="datetime" params="format=MM/dd/yyyy;"/>
            </field>
            <field label="New Count" attribute="physcnt">
              <renderer type="numericinput" params="min=0;"/>
            </field>
            <field attribute="curbal" hidden="true"/>
          </section>
          <event type="onload" service="physicalInventoryService" method="editPhysicalCount"/>
        </schema>
      </schemas>
    </application>

    <application name="reservedMaterials" entity="invreserve" title="Reserved Materials">
      <schemas>
        <schema stereotype="list" id="reservedMaterialsList" title="Reserved Materials">
          <properties>
            <property key="config.fullKey" value="/Global/Grids/ReservedMaterials/ScanBar"/>
          </properties>
          <commandbars>
            <commandgroup position="gridtop">
              <resourcecommand id="scanfilter" path="/Content/Templates/commands/scan/scanfilter.html" position="&lt;filter"/>
            </commandgroup>
          </commandbars>
          <field attribute="wonum" label="Work Order"/>
          <field attribute="assetnum" label="Asset"/>
          <field attribute="location" label="Storeroom"/>
          <field attribute="itemnum" label="Item"/>
          <field attribute="siteid" label="Site"/>
          <field attribute="reservedqty" label="Reserved">
            <renderer type="default" params="hidefilter=true"/>
          </field>
          <field attribute="actualqty" label="Issued">
            <renderer type="default" params="hidefilter=true"/>
          </field>
          <field attribute="availablequantity" label="Available">
            <renderer type="default" params="hidefilter=true"/>
          </field>
          <!--<field attribute="location" hidden="true"/>-->
          <event type="onload" service="scannerdetectionService" method="initInventoryGridListener"/>
        </schema>

        <schema id="detail" title="Reserved Material Details" mode="input" stereotype="detail">
          <section>
            <field attribute="invreserveid" hidden="true"/>
            <field attribute="requireddate" hidden="true"/>
            <field attribute="requestnum" hidden="true"/>
            <field attribute="itemsetid" hidden="true"/>
            <field attribute="siteid" hidden="true"/>
            <field attribute="orgid" hidden="true"/>
            <field attribute="rowstamp" label="Row Stamp" hidden="true"/>
            <field attribute="actualqty" label="Quantity Issued" readonly="true" hidden="true"/>

            <section orientation="horizontal">
              <renderer type="default" params="childinputsize=medium" />
              <field attribute="requestedby" label="Requested By" readonly="true" />
              <field attribute="enterby" label="Entered By" readonly="true" default="@username" />
              <field attribute="#issuetype" label="Issue Type" readonly="true" />
              <field attribute="issueto" label="Issue To" readonly="true" />
            </section>
          </section>
          <section>
            <header displacement="ontop" label="Inventory Details" params="fieldset=true;font-weight=bold;"/>
            <renderer type="default" params="childinputsize=medium" />
            <field attribute="itemnum" label="Item" readonly="true"/>
            <field attribute="invbalances_.lotnum" label="Lot" readonly="true" />
            <field attribute="item_.itemtype" label="Item Type" readonly="true" />
            <association target="#rotatingAssetNumber" label="Rotating Asset" valuefield="assetnum" labelfield="asset_.description" extraprojectionvalues="binnum" enableexpression="@item_.rotating==1" requiredexpression="@item_.rotating==1">
              <dataprovider prefilterfunction="FilterAssets"/>
              <renderer type="lookup" />
              <event type="afterchange" service="inventoryService" method="afterChangeInvreserveAsset"/>
            </association>
            <field attribute="item_.rotating" label="Rotating" enableexpression="false">
              <renderer type="checkbox" params="formatter=numberToBoolean"/>
            </field>
            <field attribute="item_.iskit" label="Kit" enableexpression="false">
              <renderer type="checkbox" params="formatter=numberToBoolean"/>
            </field>
            <field attribute="invbalances_.curbal" label="Current Balance" readonly="true" />
            <field attribute="reservedqty" label="Reserved Quantity" readonly="true" />
            <field attribute="#issueqty" label="Issue Quantity">
              <renderer type="numericinput" params="min=1;max=@reservedqty"/>
              <event type="afterchange" service="inventoryService" method="afterChangeIssueQuantity"/>
            </field>
          </section>

          <section orientation="horizontal">
            <header displacement="ontop" label="Location" params="fieldset=true"/>
            <renderer type="default" params="childinputsize=medium" />
              <field attribute="siteid" label="Site" readonly="true" />
              <field attribute="location" label="Storeroom" readonly="true" />
              <association label="Bin" target="invbalances_.binnum" labelfield="invbalances_.binnum" valuefield="binnum" hideDescription="true" extraprojectionvalues="curbal,lotnum,binnum" enableexpression="@item_.rotating!=1">
                <renderer type="lookup" params="application=invbalances;schemaId=binLookupList;inputsize=small"/>
                <dataprovider prefilterfunction="FilterBins"/>
              </association>
          </section>
          
          <section orientation="horizontal">
            <header displacement="ontop" label="Cost Details" params="fieldset=true"/>
            <field attribute="item_.issueunit" label="Issue Unit" readonly="true" />
            <field attribute="unitcost" label="Unit Cost" readonly="true" />
            <field attribute="inventory_.costtype" hidden="true"/>
          </section>
          <section orientation="horizontal">
            <header displacement="ontop" label="Charge Details" params="fieldset=true"/>
            <renderer type="default" params="childinputsize=medium" />
            <field attribute="wonum" label="Work Order" readonly="true" />
            <field attribute="tostoreloc" label="Location" readonly="true" />
            <field attribute="assetnum" label="Asset" readonly="true" />
            <field attribute="glaccount" label="GL Account" readonly="true" />
          </section>
          <event type="onload" service="inventoryService" method="onloadReservation"/>
          <commandbars>
            <commandgroup position="detailform">
              <removecommand id="save"/>
              <removecommand id="print"/>
              <command id="saveIssue" icon="fa fa-check" label="Save" service="inventoryService" method="submitReservedInventoryIssue" position="left" parameters="schema,datamap"/>
            </commandgroup>
          </commandbars>
          <properties>
            <property key="detail.titleexpression" value="'Reservation: {0} Requested By: {1}'.format(@requestnum, @requestedby)"/>
          </properties>
        </schema>
      </schemas>
    </application>

    <application name="invbalances" title="Inventory" entity="invbalances">
      <properties>
        <property key="mobile.fetchlimit" value="300"/>
      </properties>
      <schemas>
        <schema stereotype="list" id="invbalancesList" title="Inventory Grid" platform="web">
          <commandbars>
            <commandgroup position="gridtop">
              <resourcecommand id="scanfilter" path="/Content/Templates/commands/scan/scanfilter.html" position="&lt;filter"/>
            </commandgroup>
          </commandbars>
          <field attribute="itemnum" label="Item">
            <renderer type="default" params="width=12%" />
          </field>
          <field attribute="item_.description" label="Description">
            <renderer type="default" params="excelwidth=50" />
          </field>
          <field attribute="location" label="Storeroom">
            <renderer type="default" params="width=15%" />
          </field>
          <field attribute="binnum" label="Bin">
            <renderer type="default" params="width=10%" />
          </field>
          <field attribute="lotnum" label="Lot">
            <renderer type="default" params="width=10%" />
          </field>
          <optionfield attribute="item_.rotating" label="Rotating">
            <renderer type="combo" params="filteronly=true;formatter=numberToBoolean"/>
            <option value="1" label="Yes"/>
            <option value="0" label="No"/>
          </optionfield>
          <optionfield attribute="item_.iskit" label="Kit">
            <renderer type="combo" params="filteronly=true;formatter=numberToBoolean"/>
            <option value="1" label="Yes"/>
            <option value="0" label="No"/>
          </optionfield>
          <field attribute="curbal" label="Balance">
            <renderer type="default" params="width=10%" />
          </field>
          <field attribute="siteid" label="Site">
            <renderer type="default" params="width=15%" />
          </field>
          <field attribute="invbalancesid" hidden="true"/>
          <event type="onload" service="scannerdetectionService" method="initInventoryGridListener"/>
          <properties>
            <property key="list.click.schema" value="invbalancesDetail"/>
            <property key="config.fullKey" value="/Global/Grids/InvBalances/ScanBar"/>
          </properties>
        </schema>

        <schema id="invbalancesDetail" stereotype="detail" title="Inventory Balance Details">
          
          
          <properties>
            <property key="nextschema.schemaid" value="invbalancesList"/>
          </properties>
          <field attribute="invbalancesid" requiredexpression="true" readonly="true" hidden="true"/>

          <section orientation="horizontal">
            <renderer type="default" params="childinputsize=medium" />
            <field label="Item" attribute="itemnum" readonly="true"/>
            <field label="Description" attribute="item_.description" readonly="true"/>
            <field label="Lot" attribute="lotnum" readonly="true"/>
          </section>

          <section orientation="horizontal">
            <header displacement="ontop" label="Location" params="fieldset=true" />
            <renderer type="default" params="childinputsize=medium" />
            <field label="Site" attribute="siteid" readonly="true"/>
            <field label="Storeroom" attribute="location" readonly="true"/>
            <field label="Bin" attribute="binnum" readonly="true"/>
          </section>

          <section orientation="horizontal">
            <header displacement="ontop" label="Issuing" params="fieldset=true" />
            <renderer type="default" params="childinputsize=medium" />
            <field label="Rotating" attribute="item_.rotating" enableexpression="false">
              <renderer type="checkbox" params="formatter=numberToBoolean"/>
            </field>
            <field label="Kit" attribute="item_.iskit" enableexpression="false">
              <renderer type="checkbox" />
            </field>
            <field label="Issue Unit" attribute="item_.issueunit" readonly="true"/>
            <field label="Balance" attribute="curbal"/>
            <field attribute="physcnt" hidden="true"/>
          </section>
        </schema>

        <schema id="binLookupList" stereotype="list">
          <field attribute="siteid" hidden="true"/>
          <field attribute="itemnum" label="Item" hidden="true"/>
          <field attribute="itemsetid" hidden="true"/>
          <field attribute="location" hidden="true"/>
          <field attribute="binnum" label="Bin"/>
          <field attribute="lotnum" label="Lot"/>
          <field attribute="curbal" label="Current Balance"/>
        </schema>

        <schema id="lotLookupList" stereotype="list">
          <field attribute="itemnum" label="Item" hidden="true"/>
          <field attribute="lotnum" label="Lot"/>
          <field attribute="binnum" label="Bin"/>
          <field attribute="location" hidden="true"/>
          <field attribute="siteid" hidden="true"/>
          <field attribute="itemsetid" hidden="true"/>
          <field attribute="curbal" label="Current Balance"/>
        </schema>
      </schemas>
    </application>

    <application entity="matrectransTransfers" name="matrectransTransfers" title="Inventory Transfer">
      <schemas>
        <schema stereotype="list" id="matrectransTransfersList" title="Inventory Transfer Grid">
          <properties>
            <property key="config.fullKey" value="/Global/Grids/InventoryTransfer/ScanBar"/>
          </properties>
          <commandbars>
            <commandgroup position="gridtop">
              <resourcecommand id="scanfilter" path="/Content/Templates/commands/scan/scanfilter.html" position="&lt;filter"/>
              <!--<command id="newTransfer" icon="fa-exchange" label="Transfer" service="inventoryService"
                       method="createTransfer" parameters="schema" position="&lt;filter"/>-->
            </commandgroup>
          </commandbars>
          <field attribute="itemnum" label="Item">
            <renderer type="default" params="width=10%" />
          </field>
          <field attribute="item_.itemtype" label="Item Type"/>
          <field attribute="fromstoreloc" label="From Storeroom">
            <renderer type="default" params="width=15%" />
          </field>
          <field attribute="frombin" label="From Bin">
            <renderer type="default" params="width=12%" />
          </field>
          <field attribute="tostoreloc" label="To Storeroom">
            <renderer type="default" params="width=15%" />
          </field>
          <field attribute="tobin" label="To Bin">
            <renderer type="default" params="width=12%" />
          </field>
          <field attribute="quantity" label="Quantity">
            <renderer type="default" params="width=10%" />
          </field>
          <field attribute="actualdate" label="Transfer Date">
            <renderer type="datetime" params="width=12%;format=MM/dd/yyyy"/>
          </field>
          <properties>
            <property key="list.click.schema" value="detail"/>
          </properties>
          <event type="onload" service="scannerdetectionService" method="initInventoryGridListener"/>
        </schema>

        <schema id="detail" title="Inventory Transfer Details">
          <field attribute="matrectransid" hidden="true"></field>
          
          <field attribute="itemnum" label="Item" readonly="true">
            <renderer type="default" params="inputsize=medium" />
          </field>

          <section orientation="horizontal">
            <header displacement="ontop" label="Location" params="fieldset=true" />
            <renderer type="default" params="childinputsize=medium" />
            <field attribute="fromstoreloc" label="From Storeroom" readonly="true"/>
            <field attribute="frombin" label="From Bin" readonly="true"/>
            <field attribute="tostoreloc" label="To Storeroom" readonly="true"/>
            <field attribute="tobin" label="To Bin" readonly="true"/>
          </section>

          <section orientation="horizontal">
            <header displacement="ontop" label="Issuing" params="fieldset=true" />
            <renderer type="default" params="childinputsize=medium" />
            <field attribute="issueunit" label="Issue Unit" readonly="true"/>
            <field attribute="quantity" label="Quantity" readonly="true"/>
            <field attribute="actualdate" label="Transfer Date" readonly="true">
              <renderer type="datetime" params="format=MM/dd/yyyy;"/>
            </field>
          </section>
        <commandbars>
            <commandgroup position="detailform" removeundeclared="false">
              <removecommand id="save"/>
            </commandgroup>
          </commandbars>
        </schema>
      </schemas>
    </application>



    <application entity="invcost" name="invcost" title="invcost">
      <schemas>
        <schema id="list" title="Invcost List" stereotype="list">
          <field attribute="itemnum" label="Item"/>
          <field attribute="location" label="location"/>
          <field attribute="avgcost" label="Average Cost"/>
          <field attribute="stdcost" label="Standard Cost"/>
          <field attribute="lastcost" label="lastcost"/>
          <field attribute="siteid" label="siteid"/>
          <field attribute="conditioncode" label="conditioncode"/>
          <field attribute="condrate" label="condrate"/>
        </schema>
      </schemas>
    </application>
  </applications>
</metadata>
