<?xml version="1.0" encoding="utf-8" ?>
<metadata xmlns="http://www.example.org/metadata" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.example.org/metadata ../../../Schema/Metadata.xsd ">

  <templates>
    <template path="@chartofaccounts.xml"/>
    <template path="@workorder.xml"/>
    <template path="@item.xml"/>
  </templates>
  
  <entities>
    <entity name="invissuewo" idAttribute="wonum" parententity="workorder">
      <relationships>
        <relationship to="invissue" collection="true">
          <relationshipAttribute from="wonum" to="refwo" primary="true" />
          <relationshipAttribute from="siteid" to="siteid" />
        </relationship>
      </relationships>
    </entity>
    
    <entity name="physicalCount" idAttribute="invbalancesid" parententity="invbalances" whereclause="RECONCILED = 1 and DATEDIFF(day, physcntdate, GETDATE()) > inventory_.ccf and inventory_.ccf != 0">
      <relationships>
        <relationship to="item" >
          <relationshipAttribute from="itemnum" to="itemnum" primary="true"/>
          <relationshipAttribute from="itemsetid" to="itemsetid"/>
        </relationship>
        <relationship to="inventory">
          <relationshipAttribute from="itemnum" to="itemnum" primary="true"/>
          <relationshipAttribute from="location" to="location" />
          <relationshipAttribute from="siteid" to="siteid" />
          <relationshipAttribute from="itemsetid" to="itemsetid" />
        </relationship>
        <relationship to="invlot">
          <relationshipAttribute from="itemnum" to="itemnum" primary="true"/>
          <relationshipAttribute from="location" to="location"/>
          <relationshipAttribute from="siteid" to="siteid"/>
          <relationshipAttribute from="lotnum" to="lotnum"/>
        </relationship>
      </relationships>
      <connectorParameters>
        <connectorParameter key="customconnector" value="softWrench.sW4.Data.Persistence.WS.Commons.BasePhysicalCountCrudConnector"/>
      </connectorParameters>
    </entity>
    
    <entity name="physicalDeviation" idAttribute="invbalancesid" parententity="invbalances" whereclause="RECONCILED = 0 and curbal != physcnt">
      <relationships>
        <relationship to="item" >
          <relationshipAttribute from="itemnum" to="itemnum" primary="true"/>
          <relationshipAttribute from="itemsetid" to="itemsetid"/>
        </relationship>
        <relationship to="inventory">
          <relationshipAttribute from="itemnum" to="itemnum" primary="true"/>
          <relationshipAttribute from="location" to="location" />
          <relationshipAttribute from="siteid" to="siteid" />
          <relationshipAttribute from="itemsetid" to="itemsetid" />
        </relationship>
        <relationship to="invlot">
          <relationshipAttribute from="itemnum" to="itemnum" primary="true"/>
          <relationshipAttribute from="location" to="location"/>
          <relationshipAttribute from="siteid" to="siteid"/>
          <relationshipAttribute from="lotnum" to="lotnum"/>
        </relationship>
      </relationships>
    </entity>
    
    <entity name="invreserve" idAttribute="requestnum" whereclause="reservedqty > 0">
      <relationships>
        <relationship to="item">
          <relationshipAttribute from="itemnum" to="itemnum" primary="true"/>
          <relationshipAttribute from="itemsetid" to="itemsetid"/>
        </relationship>
        <relationship to="invissue">
          <relationshipAttribute from="wonum" to="refwo" primary="true"/>
          <relationshipAttribute from="assetnum" to="assetnum"/>
          <relationshipAttribute from="issueto" to="issueto"/>
          <relationshipAttribute from="itemnum" to="itemnum"/>
          <relationshipAttribute from="itemsetid" to="itemsetid"/>
          <relationshipAttribute from="orgid" to="orgid"/>
        </relationship>
        <relationship to="inventory">
          <relationshipAttribute from="itemnum" to="itemnum" primary="true"/>
          <relationshipAttribute from="siteid" to="siteid"/>
          <relationshipAttribute from="orgid" to="orgid"/>
          <relationshipAttribute from="itemsetid" to="itemsetid"/>
          <relationshipAttribute from="location" to="location"/>
        </relationship>
      <relationship to="invbalances">
        <relationshipAttribute from="itemnum" to="itemnum" primary="true"/>
        <relationshipAttribute from="itemnum" to="itemnum"/>
        <relationshipAttribute from="siteid" to="siteid"/>
        <relationshipAttribute from="orgid" to="orgid"/>
        <relationshipAttribute from="location" to="location"/>
      </relationship>
      </relationships>
    </entity>
  </entities>

  <applications>
    <application name="invissuewo" title="Batch Issuing" entity="invissuewo">
      <schemas>
        <schema id="newdetail" stereotype="detail" mode="input" title="Batch Issue Details">
          <field attribute="wonum" hidden="true"/>
          <field attribute="#issuetype" hidden="true" default="ISSUE"/>
          <field attribute="#refwo" label="Work Order" readonly="true"/>
          <field attribute="#siteid" label="Site" readonly="true"/>
          <field attribute="#assetnum" label="Asset" readonly="true"/>
          <field attribute="#location" label="Location" readonly="true"/>
          <field attribute="#issueto" label="Issue To" readonly="true"/>
          <field attribute="#storeloc" label="Storeroom" readonly="true"/>
          <field attribute="#gldebitacct" label="GL Debit Account" readonly="true"/>
          <composition relationship="invissue" label="Items" detailschema="newitem" inline="true">
            <renderer type="default" params="fieldclass=issue-items" />
            <collectionproperties listschema="itemlist" hideexistingdata="true" allowcreation="false" autocommit="false" />
          </composition>
          <properties>
            <property key="detail.navigationbuttons.disabled" value="true"/>
          </properties>
          <commandbars>
            <commandgroup position="detailform" removeundeclared="true">
              <command id="additemtobatchissue" label="Add Item" service="inventoryService" method="displayNewIssueModal" parameters="schema,datamap"/>
              <command id="submitnewbatchissue" label="Submit" service="inventoryService" method="submitNewBatchIssue" parameters="schema,datamap" />
              <command id="cancelnewbatchissue" label="Cancel" service="inventoryService" method="cancelNewInvIssue" />
            </commandgroup>
          </commandbars>
        </schema>
      </schemas>
    </application>
   
    <application name="inventory" title="Inventory" entity="inventory">
      <schemas>
        <list>
          <field attribute="itemnum"/>
          <field attribute="binnum"/>
          <field attribute="location"/>
          <field attribute="siteid"/>
          <field attribute="orgid"/>
          <field attribute="status"/>
          <field attribute="costtype"/>
          <field attribute="itemtype"/>
          <field attribute="issueunit"/>
          <field attribute="costtype"/>
          <field attribute="binnum"/>
        </list>
        
        <schema id="inventoryLookupList" stereotype="list" mode="output">
          <field attribute="storeloc" hidden="true"/>
          <field attribute="siteid" hidden="true"/>
          <field label="Item" attribute="itemnum">
            <renderer type="default" params="width=19%"/>
          </field>
          <field label="Description" attribute="item_.description">
            <renderer type="default"/>
          </field>
          <field label="Type" attribute="item_.itemtype">
            <renderer type="default" params="width=15%"/>
          </field>
          <optionfield label="Rotating" attribute="item_.rotating">
            <renderer type="combo" params="width=16%;filteronly=true;formatter=numberToBoolean"/>
            <option label="Yes" value="1"/>
            <option label="No" value="0"/>
          </optionfield>
          <optionfield label="Kit" attribute="item_.iskit">
            <renderer type="combo" params="width=16%;filteronly=true;formatter=numberToBoolean"/>
            <option value="1" label="Yes"/>
            <option value="0" label="No"/>
          </optionfield>
        </schema>
      </schemas>
    </application>

    <application name="invissue" title="Issue Inventory" entity="invissue">
      <schemas>
        <list id="invissuelist" title="Issues and Returns">
          <properties>
            <property key="list.click.service" value="inventoryService.invissuelistclick"/>
          </properties>
          <commandbars>
            <commandgroup position="gridtop">
              <command id="create_issue" label="New Issue" service="inventoryService" method="createIssue" parameters="schema,datamap"
                       successmessage="Issue created" position="&lt;filter"/>
              <command id="batch_issue" label="Batch Issuing" service="inventoryService" method="navToBatchFilter" parameters="" successmessage="New issue(s) created" position="&lt;filter"/>
            </commandgroup>
          </commandbars>
          <field attribute="matusetransid" hidden="true"/>
          <field attribute="storeloc" hidden="true"/>
          <field attribute="binnum" hidden="true"/>
          <field attribute="item_.itemnum" hidden="true"/>
          <field attribute="itemnum" label="Item">
            <renderer type="default" params="widthXS=30%;widthSM=20%;widthMD=15%;widthLG=9%" />
          </field>
          <field attribute="item_.itemtype" label="Item Type">
            <renderer type="default" params="widthXS=-1%;widthSM=20%;widthMD=20%;widthLG=8%" />
          </field>
          <field attribute="lotnum" label="Lot">
            <renderer type="default" params="widthLG=8%" />
          </field>
          <field attribute="refwo" label="Work Order">
            <renderer type="default" params="width=8%;"/>
          </field>
          <field attribute="issueto" label="Issued To">
            <renderer type="default" params="widthXS=-1%;widthSM=20%;widthMD=20%;widthLG=8%" />
          </field>
          <field attribute="assetnum" label="Asset">
            <renderer type="default" params="widthXS=-1%;widthSM=-1%;widthMD=20%;widthLG=8%" />
          </field>
          <field attribute="location" label="Location">
            <renderer type="default" params="widthXS=-1%;widthSM=-1%;widthMD=-1%;widthLG=8%" />
          </field>
          <field attribute="siteid" label="Site">
            <renderer type="default" params="widthXS=-1%;widthSM=20%;widthMD=20%;widthLG=8%" />
          </field>
          <field attribute="issuetype" label="Issue Type">
            <renderer type="default" params="widthXS=-1%;widthSM=-1%;widthMD=-1%;widthLG=8%" />
          </field>
          <optionfield attribute="item_.rotating" label="Rotating">
            <renderer type="combo" params="widthLG=8%;filteronly=true;formatter=numberToBoolean"/>
            <option value="1" label="Yes"/>
            <option value="0" label="No"/>
          </optionfield>
          <optionfield attribute="item_.iskit" label="Kit">
            <renderer type="combo" params="widthLG=8%;filteronly=true;formatter=numberToBoolean"/>
            <option value="1" label="Yes"/>
            <option value="0" label="No"/>
          </optionfield>
          <field attribute="quantity" label="Qty">
            <renderer type="default" params="hidefilter=true;width=4%;formatter=@inventoryService.formatQtyList;"/>
          </field>
          <field attribute="qtyreturned" label="Qty Rtn">
            <renderer type="default" params="hidefilter=true;width=4%;formatter=@inventoryService.formatQtyReturnedList;"/>
          </field>
          <section resourcepath="/Content/Templates/otb/invissuereturnaction.html">
            <renderer type="default" params="width=3%"/>
          </section>
        </list>

        <schema id="itemlist" stereotype="compositionlist">
          <properties>
            <property key="list.click.popup" value="modal"/>
            <property key="list.click.service" value="inventoryService.batchissuelistclick"/>
            <property key="list.click.schema" value="updateitem"/>
            <property key="list.disablepagination" value="true"/>
            <property key="nextschema.schemaid" value="newitem"/>
          </properties>
          <event type="onload" service="scannerdetectionService" method="initIssueItemListener"/>
          <field attribute="matusetransid" hidden="true"/>
          <field attribute="refwo" hidden="true"/>
          <field attribute="issueto" hidden="true"/>
          <field attribute="assetnum" hidden="true"/>
          <field attribute="location" hidden="true"/>
          <field attribute="unitcost" hidden="true"/>
          <field attribute="itemtype" hidden="true"/>
          <field attribute="costtype" hidden="true"/>
          <field attribute="itemnum" label="Item"/>
          <field attribute="item_.description" label="Description"/>
          <field attribute="binnum" label="Bin"/>
          <field attribute="lotnum" label="Lot"/>
          <field attribute="gldebitacct" label="GL Debit Account"/>
          <field attribute="quantity" label="Issue Quantity"/>
          <field attribute="issuetype" label="Issue Type" default="ISSUE" hidden="true"/>
          <field attribute="storeloc" hidden="true"/>
          <section resourcepath="/Content/Templates/otb/compositionlistdeleteaction.html">
            <renderer type="default" params="width=4%"/>
          </section>
        </schema>

        <schema id="viewinvreturndetail" stereotype="detail" mode="output">
          <field attribute="matusetransid" hidden="true"/>
          <field attribute="itemnum" label="Item" readonly="true"/>
          <field attribute="item_.description" label="Description" readonly="true"/>
          <field attribute="refwo" label="Work Order" readonly="true"/>
          <field attribute="issueto" label="Issued To" readonly="true"/>
          <field attribute="assetnum" label="Asset" readonly="true"/>
          <field attribute="location" label="Location" readonly="true"/>
          <field attribute="issuetype" label="Issue Type" readonly="true"/>
          <field attribute="storeloc" label="Storeroom" readonly="true"/>
          <field attribute="binnum" label="Bin" readonly="true"/>
          <field attribute="lotnum" label="Lot" readonly="true"/>
          <field attribute="quantity" label="Quantity Returned">
            <renderer type="default" params="formatter=@inventoryService.formatQtyDetail;"/>
          </field>
          <commandbars>
            <commandgroup position="detailform">
              <removecommand id="save"/>
            </commandgroup>
          </commandbars>
        </schema>
        
        <schema id="viewinvissuedetail" stereotype="detail" mode="output">
          <field attribute="matusetransid" hidden="true"/>
          <field attribute="itemnum" label="Item" readonly="true"/>
          <field attribute="item_.description" label="Description" readonly="true"/>
          <field attribute="refwo" label="Work Order" readonly="true"/>
          <field attribute="issueto" label="Issued To" readonly="true"/>
          <field attribute="assetnum" label="Asset" readonly="true"/>
          <field attribute="location" label="Location" readonly="true"/>
          <field attribute="issuetype" label="Issue Type" readonly="true"/>
          <field attribute="storeloc" label="Storeroom" readonly="true"/>
          <field attribute="binnum" label="Bin" readonly="true"/>
          <field attribute="lotnum" label="Lot" readonly="true"/>
          <field attribute="quantity" label="Quantity Issued">
            <renderer type="default" params="formatter=@inventoryService.formatQtyDetail;"/>
          </field>
          <field attribute="qtyreturned" label="Quantity Returned">
            <renderer type="default" params="formatter=@inventoryService.formatQtyReturnedDetail;"/>
          </field>
          <commandbars>
            <commandgroup position="detailform">
              <removecommand id="save"/>
            </commandgroup>
          </commandbars>
        </schema>

        <schema id="editinvissuedetail" stereotype="detail" mode="input" platform="web">
          <field attribute="matusetransid" hidden="true"/>
          <field attribute="itemnum" label="Item" readonly="true"/>
          <field attribute="item_.description" label="Description" readonly="true"/>
          <field attribute="rotassetnum" label="Rotating Asset" readonly="true"/>
          <field attribute="refwo" label="Work Order" readonly="true"/>
          <field attribute="issueto" label="Issued To" readonly="true"/>
          <field attribute="assetnum" label="Asset" readonly="true"/>
          <field attribute="location" label="Location" readonly="true"/>
          <field attribute="issuetype" label="Issue Type" readonly="true"/>
          <field attribute="storeloc" label="Storeroom" readonly="true"/>
          <field attribute="binnum" label="Bin" readonly="true"/>
          <field attribute="lotnum" label="Lot" readonly="true"/>
          <field attribute="unitcost" label="Unit Cost" readonly="true"/>
          <field attribute="actualcost" label="Actual Cost" readonly="true"/>
          <field attribute="gldebitacct" hidden="true"/>
          <field attribute="glcreditacct" hidden="true"/>
          <field attribute="linecost" hidden="true"/>
          <field attribute="issueid" hidden="true"/>
          <field attribute="quantity" label="Quantity Issued" readonly="true">
            <renderer type="default" params="formatter=@inventoryService.formatQtyDetail;"/>
          </field>
          <field attribute="qtyreturned" label="Quantity Returned" readonly="true">
            <renderer type="default" params="formatter=@inventoryService.formatQtyReturnedDetail;"/>
          </field>
          <field attribute="#quantityadj" label="New Return Quantity">
            <renderer type="numericinput" params="min=1;max=(@quantity - @qtyreturned);"/>
          </field>
          <commandbars>
            <commandgroup position="detailform">
              <removecommand id="save"/>
              <removecommand id="cancel"/>
              <command id="return" position="&lt;print" label="Submit" service="inventoryService" method="returnInvIssue" parameters="datamap,$scope" successmessage="Return created"/>
              <command id="cancelinvissue" label="Cancel" service="inventoryService" method="cancelNewInvIssue" parameters="schema,datamap" position=">print"/>
            </commandgroup>
          </commandbars>
        </schema>

        <schema id="newitem" stereotype="compositiondetail" mode="input" title="New Issue">
          <field attribute="matusetransid" hidden="true"/>
          <field attribute="enterby" label="Entered By" readonly="true" default="@username"/>
          <field attribute="siteid" label="Site" readonly="true"/>
          <field attribute="storeloc" label="Storeroom" readonly="true"/>
          <section>
            <header displacement="ontop" label="Inventory Details" params="fieldset=true;font-weight=bold;"/>
            <association label="Item" target="itemnum" labelfield="inventory_.item_.description" extraprojectionvalues="binnum,costtype,issueunit,item_.description,item_.itemtype,item_.iskit,item_.rotating" dependantfields="siteid,storeloc" required="true">
              <renderer type="lookup" params="application=inventory;schemaId=inventoryLookupList;"/>
              <event type="afterchange" service="inventoryService" method="invIssue_afterChangeItem"/>
            </association>
            <field attribute="inventory_.item_.itemtype" label="Item Type" readonly="true"/>
            <association target="rotassetnum" label="Rotating Asset" labelfield="rotatingasset_.description" dependantfields="itemnum,storeloc,siteid" enableexpression="@inventory_!=undefined &amp;&amp; @inventory_.item_.rotating==1">
              <renderer type="lookup"/>
            </association>
            <field attribute="inventory_.item_.rotating" label="Rotating" readonly="true">
              <renderer type="default" params="formatter=numberToBoolean"/>
            </field>
            <field attribute="inventory_.item_.iskit" label="Kit" readonly="true">
              <renderer type="default" params="formatter=numberToBoolean"/>
            </field>
            <association label="Bin" target="binnum" forcedistinctoptions="false" labelfield="binbalances_.binnum" hideDescription="true" extraprojectionvalues="curbal,lotnum,binnum">
              <renderer type="lookup" params="application=invbalances;schemaId=binLookupList;"/>
              <event type="afterchange" service="inventoryService" method="invIssue_afterChangeBin"/>
              <dataprovider prefilterfunction="FilterBins"/>
            </association>
            <field label="Lot" attribute="lotnum" readonly="true"/>
            <field attribute="binbalances_.binnum" hidden="true">
              <event type="afterchange" service="inventoryService" method="invIssue_afterChangeBin"/>
            </field>
            <field attribute="lotbalances_.lotnum" hidden="true">
              <event type="afterchange" service="inventoryService" method="invIssue_afterChangeLot"/>
            </field>
            <field attribute="binbalances_.curbal" hidden="true">
              <event type="afterchange" service="inventoryService" method="invIssue_afterChangeBinBalance"/>
            </field>
            <field attribute="lotbalances_.curbal" hidden="true">
              <event type="afterchange" service="inventoryService" method="invIssue_afterChangeLotBalance"/>
            </field>
            <field attribute="#curbal" label="Current Balance" readonly="true"/>
            <field attribute="quantity" label="Issue Quantity" default="1" required="true">
              <renderer type="numericinput" params="min=1;max=@curbal;"/>
            </field>
            <field attribute="inventory_.location" hidden="true" />
            <field attribute="inventory_.itemnum" hidden="true" />
            <field attribute="inventory_.siteid" hidden="true" />
          </section>
          <section>
            <header displacement="ontop" label="Cost Details" params="fieldset=true;font-weight=bold;"/>
            <field attribute="inventory_.issueunit" label="Issue Unit" readonly="true"/>
            <field attribute="unitcost" label="Unit Cost" readonly="true"/>
            <field attribute="inventory_.costtype" hidden="true"/>
          </section>
          <section>
            <header displacement="ontop" label="Charge Details" params="fieldset=true;font-weight=bold;"/>
            <field attribute="gldebitacct" label="GL Debit Acct" readonly="true"/>
            <association label="Override GL Debit Account" target="#gldebitacct" labelfield="chartofaccounts_.accountname">
              <renderer type="lookup"/>
              <event type="afterchange" service="inventoryService" method="overrideGlAccount"/>
            </association>
          </section>
          <field attribute="issuetype" hidden="true"/>
          <commandbars>
            <commandgroup position="detailform">
              <removecommand id="cancel"/>
              <removecommand id="print"/>
              <removecommand id="save"/>
              <command id="additemtobatch" label="Add" service="inventoryService" method="addItemToBatch" showexpression="@issuetype == null" parameters="datamap,previousdata"/>
              <command id="updateiteminbatch" label="Update" service="inventoryService" method="updateItemInBatch" showexpression="@issuetype != null" parameters="datamap,previousdata"/>
              <command id="cancel" label="Cancel" service="inventoryService" method="hideNewIssueModal"/>
            </commandgroup>
          </commandbars>
        </schema>

        <schema id="batchInvIssueFilter" stereotype="detail" title="Issues and Returns" mode="input" platform="Web">
          <field attribute="matusetransid" hidden="true"/>
          <association label="Site" target="siteid" labelfield="site_.description" extraprojectionvalues="description" required="true">
            <renderer type="lookup"/>
          </association>
          <association label="Work Order" target="refwo" labelfield="workorder_.description" extraprojectionvalues="glaccount" dependantfields="siteid">
            <!--<dataprovider prefilterfunction="FilterWorkorders"/>-->
            <renderer type="lookup"/>
            <!--<event type="afterchange" service="inventoryService" method="invIssue_afterChangeWorkorder"/>-->
          </association>
          <association label="Issued To" target="issueto" labelfield="issuetoperson_.displayname">
            <renderer type="lookup"/>
          </association>
          <association label="Location" target="location" labelfield="location_.location" dependantfields="siteid">
            <renderer type="lookup"/>
            <!--<event type="afterchange" service="inventoryService" method="invIssue_afterChangeLocation"/>-->
          </association>
          <association label="Asset" target="assetnum" labelfield="asset_.description" dependantfields="siteid">
            <renderer type="lookup"/>
            <!--<dataprovider prefilterfunction="FilterAssets" />-->
            <!--<event type="afterchange" service="inventoryService" method="invIssue_afterChangeAsset"/>-->
          </association>
          <association label="Storeroom" target="storeloc" labelfield="storeroom_.description" default="@storeloc" dependantfields="siteid" required="true" >
            <renderer type="lookup"/>
          </association>
          <association label="GL Debit Account" target="gldebitacct" labelfield="chartofaccounts_.accountname">
            <renderer type="lookup"/>
          </association>
          <commandbars>
            <commandgroup position="detailform">
              <command id="start_issuing" label="Next" service="inventoryService" position="&lt;save" method="navToBatchIssueDetail" parameters="schema,datamap"/>
              <removecommand id="save"/>
              <removecommand id="print"/>
            </commandgroup>
          </commandbars>
        </schema>
      
        <schema id="newInvIssueDetail" mode="input" stereotype="detail">
          <field attribute="matusetransid" hidden="true"/>
          <field attribute="issuetype" hidden="true" default="ISSUE"/>
          <field attribute="enterby" label="Entered By" readonly="true" default="@username"/>
          <association label="Issued To" target="issueto" labelfield="issuetoperson_.displayname">
            <renderer type="lookup"/>
          </association>
          <section>
            <header displacement="ontop" label="Inventory Details" params="fieldset=true;font-weight=bold;"/>
            <association label="Site" target="siteid" labelfield="site_.description" extraprojectionvalues="description" required="true">
              <renderer type="lookup"/>
            </association>
            <association label="Storeroom" target="storeloc" labelfield="storeroom_.description" extraprojectionvalues="description" dependantfields="siteid" required="true" >
              <renderer type="lookup"/>
            </association>
            <association label="Item" target="itemnum" labelfield="inventory_.item_.description" extraprojectionvalues="binnum,costtype,issueunit,item_.description,item_.itemtype,item_.iskit,item_.rotating" dependantfields="siteid,storeloc" required="true">
              <renderer type="lookup" params="application=inventory;schemaId=inventoryLookupList;"/>
              <event type="afterchange" service="inventoryService" method="afterchangeinvissueitem"/>
            </association>
            <field attribute="inventory_.item_.itemtype" readonly="true" label="Item Type"/>
            <association target="rotassetnum" label="Rotating Asset" labelfield="rotatingasset_.description" dependantfields="itemnum,storeloc,siteid" enableexpression="@inventory_!=undefined &amp;&amp; @inventory_.item_.rotating==1">
              <dataprovider prefilterfunction="FilterAssets"/>
              <renderer type="lookup"/>
            </association>
            <field attribute="inventory_.item_.rotating" label="Rotating" readonly="true">
              <renderer type="default" params="formatter=numberToBoolean"/>
            </field>
            <field attribute="inventory_.item_.iskit" label="Kit" readonly="true">
              <renderer type="default" params="formatter=numberToBoolean"/>
            </field>
            <association label="Bin" target="binnum" forcedistinctoptions="false" labelfield="binbalances_.binnum" hideDescription="true" extraprojectionvalues="curbal,lotnum,binnum">
              <renderer type="lookup" params="application=invbalances;schemaId=binLookupList;"/>
              <event type="afterchange" service="inventoryService" method="invIssue_afterChangeBin"/>
              <dataprovider prefilterfunction="FilterBins"/>
            </association>
            <field label="Lot" attribute="lotnum" readonly="true"/>
            <field attribute="#curbal" label="Current Balance" readonly="true"/>
            <field attribute="quantity" label="Issue Quantity" default="1" required="true">
              <renderer type="numericinput" params="min=1;"/>
            </field>
          </section>
          <section>
            <header displacement="ontop" label="Cost Details" params="fieldset=true;font-weight=bold;"/>
            <field attribute="inventory_.issueunit" label="Issue Unit" readonly="true"/>
            <field attribute="unitcost" label="Unit Cost" readonly="true"/>
            <field attribute="inventory_.costtype" hidden="true"/>
          </section>
          <section>
            <header displacement="ontop" label="Charge Details" params="fieldset=true;font-weight=bold;"/>
            <association label="Workorder" target="refwo" labelfield="workorder_.description" dependantfields="siteid" extraprojectionvalues="glaccount,location,assetnum">
              <renderer type="lookup"/>
            </association>
            <association label="Location" target="location" labelfield="location_.location" dependantfields="siteid">
              <renderer type="lookup"/>
            </association>
            <association label="Asset" target="assetnum" labelfield="asset_.description" dependantfields="siteid">
              <renderer type="lookup"/>
            </association>
            <association label="GL Debit Account" target="gldebitacct" labelfield="chartofaccounts_.accountname">
              <renderer type="lookup"/>
            </association>
          </section>
          <commandbars>
            <commandgroup position="detailform">
              <removecommand id="save"/>
              <removecommand id="cancel"/>
              <command id="submitinvissue" label="Submit" service="inventoryService" method="submitInvIssue" parameters="schema,datamap" position="&lt;print"/>
              <command id="cancelinvissue" label="Cancel" service="inventoryService" method="cancelNewInvIssue" parameters="schema,datamap" position=">print"/>
            </commandgroup>
          </commandbars>
        </schema>
      </schemas>
    </application>

    <application name="physicalcount" entity="physicalCount" title="Physical Count">
      <schemas>
        <list title="Physical Count">
          <field attribute="invbalancesid" hidden="true"/>
          <field attribute="itemnum" label="Item">
            <renderer type="default" params="widthMD=15%;widthLG=15%" />
          </field>
          <field attribute="inventory_.siteid" label="Site">
            <renderer type="default" params="widthXS=-1%" />
          </field>
          <field attribute="location" label="Storeroom">
            <renderer type="default" params="widthXS=-1%;widthSM=-1%" />
          </field>
          <field attribute="binnum" label="Bin">
            <renderer type="default" params="widthXS=-1%;widthSM=-1%" />
          </field>
        </list>
        
        <schema id="detail" stereotype="detail" title="Physical Count Entry">
          <field label="Inventory Balances ID" attribute="invbalancesid" required="true" readonly="true" hidden="true"/>
          <field label="Item" attribute="itemnum" readonly="true"/>
          <field label="Description" attribute="item_.description" readonly="true"/>
          <field label="Storeroom" attribute="location" readonly="true"/>
          <field label="Bin" attribute="binnum" readonly="true"/>
          <field label="Site" attribute="siteid" readonly="true"/>
          <field label="Condition Code" attribute="conditioncode" readonly="true"/>
          <field label="Lot" attribute="lotnum" readonly="true"/>
          <field label="Issue Unit" attribute="inventory_.issueunit" readonly="true"/>
          <field label="Last Count Date" attribute="#lastCountDate" readonly="true">
            <renderer type="datetime" params="format=MM/dd/yyyy HH:mm;"/>
          </field>
          <field label="Count Date" attribute="physcntdate">
            <renderer type="datetime" params="format=MM/dd/yyyy HH:mm;"/>
          </field>
          <field label="New Count" attribute="physcnt">
            <renderer type="numericinput" params="min=0;"/>
          </field>
          <field attribute="curbal" hidden="true"/>
          <event type="onload" service="physicalInventoryService" method="newPhysicalCount"/>
        </schema>
      </schemas>
    </application>

    <application name="physicaldeviation" entity="physicalDeviation" title="Physical Deviation">
      <schemas>
        <list title="Physical Count">
          <field attribute="invbalancesid" hidden="true"/>
          <field attribute="itemnum" label="Item">
            <renderer type="default" params="widthXS=30%;widthSM=20%;widthMD=15%;widthLG=10%" />
          </field>
          <field attribute="inventory_.siteid" label="Site">
            <renderer type="default"  />
          </field>
          <field attribute="location" label="Storeroom">
            <renderer type="default" params="widthXS=-1%;widthSM=20%" />
          </field>
          <field attribute="binnum" label="Bin">
            <renderer type="default" params="widthXS=-1%;widthSM=-1%" />
          </field>
          <field attribute="physcnt" label="Physical Count">
            <renderer type="default" params="widthXS=30%;widthSM=20%" />
          </field>
        </list>
        <schema id="detail" stereotype="detail" title="Physical Count Entry">
          <field label="Inventory Balances ID" attribute="invbalancesid" required="true" readonly="true" hidden="true"/>
          <field label="Item" attribute="itemnum" readonly="true"/>
          <field label="Description" attribute="item_.description" readonly="true"/>
          <field label="Storeroom" attribute="location" readonly="true"/>
          <field label="Bin" attribute="binnum" readonly="true"/>
          <field label="Site" attribute="siteid" readonly="true"/>
          <field label="Condition Code" attribute="conditioncode" readonly="true"/>
          <field label="Lot" attribute="lotnum" readonly="true"/>
          <field label="Issue Unit" attribute="item_.issueunit" readonly="true"/>
          <field label="Last Count Date" attribute="#lastCountDate" readonly="true">
            <renderer type="datetime" params="format=MM/dd/yyyy HH:mm;"/>
          </field>
          <field label="Count Date" attribute="physcntdate">
            <renderer type="datetime" params="format=MM/dd/yyyy HH:mm;"/>
          </field>
          <field label="New Count" attribute="physcnt">
            <renderer type="numericinput" params="min=0;"/>
          </field>
          <field attribute="curbal" hidden="true"/>
          <event type="onload" service="physicalInventoryService" method="editPhysicalCount"/>
        </schema>
      </schemas>
    </application>

    <application name="reservedMaterials" entity="invreserve" title="Reserved Materials">
      <schemas>
        <list>
          <field attribute="wonum" label="Work Order">
            <renderer type="default" params="widthXS=40%;widthSM=30%;widthMD=20%;widthLG=10%" />
          </field>
          <field attribute="asset" label="Asset">
            <renderer type="default" />
          </field>
          <field attribute="location" label="Location">
            <renderer type="default" params="widthXS=-1%;widthSM=-1%;widthMD=-1%" />
          </field>
          <field attribute="itemnum" label="Item">
            <renderer type="default" params="widthXS=-1%;widthSM=-1%;widthMD=-1%" />
          </field>
          <field attribute="siteid" label="Site">
            <renderer type="default" params="widthXS=-1%;widthSM=-1%;widthMD=-1%" />
          </field>
          <field attribute="reservedqty" label="Reserved">
            <renderer type="default" params="hidefilter=true;widthXS=-1%;widthSM=-1%;widthMD=15%;widthLG=8%"/>
          </field>
          <field attribute="actualqty" label="Issued">
            <renderer type="default" params="hidefilter=true;widthXS=-1%;widthSM=-1%;widthMD=15%;widthLG=8%"/>
          </field>
          <field attribute="availablequantity" label="Available">
            <renderer type="default" params="hidefilter=true;widthXS=-1%;widthSM=20%;widthMD=15%;widthLG=8%;"/>
          </field>
          <field attribute="location" hidden="true"/>
        </list>
        
        <schema id="detail" mode="input">
          <field attribute="invreserveid" hidden="true"/>
          <field attribute="requireddate" hidden="true"/>
          <field attribute="requestnum" hidden="true"/>
          <field attribute="itemsetid" hidden="true"/>
          <field attribute="siteid" hidden="true"/>
          <field attribute="orgid" hidden="true"/>
          <field attribute="rowstamp" label="Row Stamp" hidden="true"/>
          <field attribute="wonum" label="Work Order" readonly="true"/>
          <field attribute="assetnum" label="Asset" readonly="true"/>
          <field attribute="issueto" label="Issued To" readonly="true"/>
          <field attribute="tostoreloc" label="Location" readonly="true"/>
          <field attribute="glaccount" label="GL Account" readonly="true"/>
          <field attribute="itemnum" label="Item" readonly="true"/>
          <field attribute="item_.rotating" label="Rotating" readonly="true">
            <renderer type="default" params="formatter=numberToBoolean;"/>
          </field>
          <field attribute="item_.iskit" label="Kit" readonly="true">
            <renderer type="default" params="formatter=numberToBoolean;"/>
          </field>
          <field attribute="location" label="Storeroom" readonly="true"/>
          <field attribute="reservedqty" label="Reserved Quantity" readonly="true"/>
          <field attribute="actualqty" label="Quantity Issued" readonly="true" hidden="true"/>
          <association label="Bin" target="invbalances_.binnum" labelfield="invbalances_.itemnum" hideDescription="true" extraprojectionvalues="itemnum,curbal,lotnum,binnum">
            <renderer type="lookup" params="application=invbalances;schemaId=binLookupList;"/>
            <dataprovider prefilterfunction="FilterBins"/>
          </association>
          <field attribute="invbalances_.lotnum" label="Lot" readonly="true"/>
          <field attribute="invbalances_.curbal" label="Current Balance" readonly="true"/>
          <field attribute="#issueqty" label="Issue Quantity">
            <renderer type="numericinput" params="min=1;max=@reservedqty;"/>
            <event type="afterchange" service="inventoryService" method="afterChangeIssueQuantity"/>
          </field>
          <event type="onload" service="inventoryService" method="onloadReservation"/>
          <commandbars>
            <commandgroup position="detailform">
              <removecommand id="save"/>
              <removecommand id="print"/>
              <command id="saveIssue" icon="fa fa-save" label="Submit" service="inventoryService" method="submitReservedInventoryIssue" position="left" parameters="schema,datamap"/>
            </commandgroup>
          </commandbars>
        </schema>
      </schemas>
    </application>
  </applications>
</metadata>
