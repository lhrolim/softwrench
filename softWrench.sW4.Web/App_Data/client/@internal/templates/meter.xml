<?xml version="1.0" encoding="utf-8" ?>
<metadata xmlns="http://www.controltechnologysolutions.com/metadata">


  <entities>
    <entity name="METERREADING" idAttribute="METERREADINGID">
      <!--This entity is declared just to use the wsdl out of it, it´s not indeed used for querying-->
      <attributes>
        <attribute name="METERREADINGID" type="int"/>
      </attributes>
      <connectorParameters>
        <connectorParameter key="dbtable" value="METERREADING" />
        <connectorParameter key="integration_interface" value="SWMETERDATA" />
      </connectorParameters>
    </entity>
  </entities>

  <applications>
    
    
    <application name="assetmeter" title="Asset Meter" entity="assetmeter">
      <properties>
        <property key="mobile.fetchlimit" value="300"/>
        <property key="icon.composition.tab" value="fa fa-tachometer"/>
      </properties>
      <schemas>
        <schema id="composition" stereotype="compositionlist" title="Asset Meter Readings">
          <field attribute="assetmeterid" hidden="true"/>
          <field attribute="metername" hidden="true"/>
          <field attribute="meter_.domainid" hidden="true"/>
          <field label="Meter" attribute="meter_.description"/>
          <field label="Meter Type" attribute="meter_.metertype"/>
          <field label="Last Reading" attribute="lastreading"/>
          <field label="Last Reading Date" attribute="lastreadingdate">
            <renderer type="datetime"/>
          </field>
          <field label="New Reading" attribute="newreading" requiredexpression="true" showexpression="@meter_.domainid == null">
            <renderer type="default" params="editable=true"/>
          </field>
          <association label="New Reading" target="newreading" valuefield="meter_.alndomain_.value" labelfield="meter_.alndomain_.description" requiredexpression="true" 
                       showexpression="@meter_.domainid != null">
            <renderer type="lookup" />
            <dataprovider whereClause="metername = !@metername"/>
          </association>
          <field label="New Reading Date" attribute="newreadingdate" requiredexpression="true" default="@now">
            <renderer type="datetime" params="editable=true;format=MM/dd/yyyy HH:mm:ss;width=20%"/>
          </field>
          <field label="Rollover" attribute="disabledrollover" enableexpression="false" hidden="true">
            <renderer type="checkbox" params="editable=true;width=5%"/>
          </field>
          <field attribute="rollover" hidden="true"/>
          <field attribute="inspector" default="@username" hidden="true"></field>
<!--          <association labelfield="inspector_.displayname" valuefield="personid" target="inspector" label="Inspector" requiredexpression="true" default="@username">-->
<!--            <renderer type="lookup" params="editable=true;width=10%"/>-->
<!--          </association>-->
          <commandbars>
            <commandgroup position="detail.primary">
              <removecommand id="additem"/>
              <removecommand id="print"/>
            </commandgroup>
          </commandbars>
        </schema>
        <schema id="assetmeterlist" stereotype="compositionlist">
          <field attribute="sequence" label="Sequence"/>
          <field attribute="metername" label="Meter"/>
          <field attribute="meter_.description" label="Description"/>
          <field attribute="meter_.metertype" label="Meter Type"/>
          <field attribute="measureunitid" label="Unit of Measure"/>
          <field attribute="active" label="Active">
            <renderer type="default" params="formatter=numberToBoolean"/>
          </field>
        </schema>
        <schema id="assetmeterdetail" stereotype="compositiondetail">
          <section id="meterdetails" orientation="vertical">
            <section orientation="horizontal">
              <section orientation="vertical">
                <field attribute="sequence" label="Sequence" readonly="true"/>
                <field attribute="active" label="Active" readonly="true">
                  <renderer type="default" params="formatter=numberToBoolean"/>
                </field>
              </section>
              <section orientation="vertical">
                <field attribute="metername" label="Meter" readonly="true"/>
                <field attribute="pointnum" label="Point" readonly="true"/>
              </section>
              <section orientation="vertical">
                <field attribute="meter_.description" label="Description" readonly="true"/>
              </section>
              <section orientation="vertical">
                <field attribute="meter_.metertype" label="Meter Type" readonly="true"/>
                <field attribute="measureunitid" label="Unit of Measure" readonly="true"/>
              </section>
            </section>
            <section orientation="horizontal">
              <field attribute="lastreading" label="Last Reading" readonly="true"/>
              <field attribute="lastreadingdate" label="Last Reading Date" readonly="true"/>
              <field attribute="lastreadinginspctr" label="Last Reading Inspector" readonly="true"/>
              <field attribute="remarks" label="Remarks" readonly="true"/>
            </section>
          </section>
          <section id="continuousmeterdetails" orientation="vertical">
            <section orientation="horizontal">
              <field attribute="avgcalcmethod" label="Average Calculation Method" readonly="true"/>
              <field attribute="synonymdomain_.description" label="Description" readonly="true"/>
              <field attribute="rollover" label="Rollover" readonly="true"/>
              <field attribute="readingtype" label="Reading Type" readonly="true"/>
            </section>
            <section orientation="horizontal">
              <field attribute="slidingwindowsize" label="Sliding Window Size" readonly="true"/>
              <field attribute="average" label="Average" readonly="true"/>
              <field attribute="lisetodate" label="Life to Date for Location" readonly="true"/>
            </section>
          </section>
        </schema>
      </schemas>
    </application>

    <application name="locationmeter" title="Location Meter" entity="locationmeter">
      <properties>
        <property key="mobile.fetchlimit" value="300"/>
        <property key="icon.composition.tab" value="fa fa-tachometer"/>
      </properties>
      <schemas>
        <schema id="locationcomposition" stereotype="compositionlist" title="Meters">
          <field attribute="sequence" label="Sequence"/>
          <field attribute="metername" label="Meter"/>
          <field attribute="meter_.description" label="Description"/>
          <field attribute="meter_.metertype" label="Meter Type"/>
          <field attribute="measureunitid" label="Unit of Measure"/>
          <field attribute="active" label="Active">
            <renderer type="default" params="formatter=numberToBoolean"/>
          </field>
          <commandbars>
            <commandgroup position="detail.primary">
              <removecommand id="save"/>
            </commandgroup>
          </commandbars>
        </schema>
        <schema id="locationdetail" stereotype="compositiondetail" title="Meter" mode="output">
          <section orientation="horizontal">
            <section orientation="vertical">
              <field attribute="sequence" label="Sequence"/>
              <field attribute="active" label="Active">
                <renderer type="default" params="formatter=numberToBoolean"/>
              </field>
            </section>
            <section orientation="vertical">
              <field attribute="metername" label="Meter"/>
              <field attribute="pointnum" label="Point"/>
            </section>
            <section orientation="vertical">
              <field attribute="meter_.description" label="Description"/>
            </section>
            <section orientation="vertical">
              <field attribute="meter_.metertype" label="Meter Type"/>
              <field attribute="measureunitid" label="Unit of Measure"/>
            </section>
          </section>
          <section orientation="horizontal">
            <field attribute="lastreading" label="Last Reading"/>
            <field attribute="lastreadingdate" label="Last Reading Date"/>
            <field attribute="lastreadinginspctr" label="Last Reading Inspector"/>
            <field attribute="remarks" label="Remarks"/>
          </section>
          <section id="continuousmeterdetails" showexpression="@meter_.metertype == 'CONTINUOUS'">
            <section orientation="horizontal">
              <field attribute="avgcalcmethod" label="Average Calculation Method"/>
              <field attribute="averagemethod_.description" label="Average Method Description"/>
              <field attribute="rollover" label="Rollover"/>
              <field attribute="readingtype" label="Reading Type"/>
            </section>
            <section orientation="horizontal">
              <field attribute="slidingwindowsize" label="Sliding Window Size"/>
              <field attribute="average" label="Average"/>
              <field attribute="lifetodate" label="Life to Date for Location"/>
            </section>
          </section>
        </schema>
        <schema id="composition" stereotype="compositionlist" title="Location Meter Readings">
          <field attribute="locationmeterid" hidden="true"/>
          <field attribute="metername" hidden="true"/>
          <field label="Meter" attribute="meter_.description"/>
          <field label="Meter Type" attribute="meter_.metertype"/>
          <field label="Last Reading" attribute="lastreading"/>
          <field label="Last Reading Date" attribute="lastreadingdate">
            <renderer type="datetime"/>
          </field>
          <field label="New Reading" attribute="newreading" requiredexpression="true">
            <renderer type="default" params="editable=true"/>
          </field>
          <field label="New Reading Date" attribute="newreadingdate" requiredexpression="true">
            <renderer type="datetime" params="editable=true"/>
          </field>
          <field label="Rollover" attribute="disabledrollover" enableexpression="false">
            <renderer type="checkbox" params="editable=true"/>
          </field>
          <field attribute="rollover" hidden="true"/>
            
          <association labelfield="inspector_.displayname" target="inspector" valuefield="personid" label="Inspector" requiredexpression="true">
            <renderer type="lookup"  params="editable=true"/>
          </association>
          <commandbars>
            <commandgroup position="detail.primary">
              <removecommand id="additem"/>
              <removecommand id="print"/>
            </commandgroup>
          </commandbars>
        </schema>
      </schemas>
    </application>


  </applications>




</metadata>
