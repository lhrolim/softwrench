<?xml version="1.0" encoding="utf-8" ?>
<metadata xmlns="http://www.example.org/metadata" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.example.org/metadata ../../../Schema/Metadata.xsd ">

  <entities>
    <entity name="commlog" idAttribute="commloguid">
      <attributes>
        <attribute name="commlogid" type="int" required="true"/>
        <attribute name="sendto" type="varchar" required="false" />
        <attribute name="sendfrom" type="varchar" required="true" />
        <attribute name="subject" type="varchar" required="false" />
        <attribute name="createby" type="varchar" required="true" />
        <attribute name="createdate" type="datetime" required="true" />
        <attribute name="ownerid" type="int" required="true" />
        <attribute name="ownertable" type="varchar" required="true" />
        <attribute name="cc" type="text" required="false" />
        <attribute name="bcc" type="text" required="false" />
        <attribute name="replyto" type="varchar" required="false" />
        <attribute name="inbound" type="smallint" required="true" />
        <attribute name="commloguid" type="bigint" required="true" />
        <attribute name="message" type="text" required="false" />
        <attribute name="orgobject" type="varchar" required="false" />
        <attribute name="uniqueid" type="int" required="false" />
        <attribute name="rowstamp" type="timestamp" required="true" />
        <attribute name="issendfail" type="smallint" required="true" />
        <attribute name="keepfailed" type="smallint" required="true" />
        <attribute name="ccflag" query="CASE WHEN !@cc is not null THEN 'true' ELSE 'false' end " type="bool"/>
      </attributes>
      <relationships>
        <relationship to ="email">
          <!--this to attribute is used for the autocompleteserver, do not remove it -->
          <relationshipAttribute query="commlog.sendto like email_.emailaddress" primary="true" to="emailaddress"/>
        </relationship>
        <relationship to="commlogdocs" >
          <relationshipAttribute from="commlogid" to="commlogid" primary="true"/>
        </relationship>
      </relationships>
      <connectorParameters>
        <connectorParameter key="dbtable" value="commlog" />
      </connectorParameters>
    </entity>

    <entity name="commlogdocs" idAttribute="commlogdocsid">
      <attributes>
        <attribute name="commlogid" type="int" required="true" />
        <attribute name="commlogdocsid" type="bigint" required="true" />
        <attribute name="docinfoid" type="bigint" required="false" />
        <attribute name="urlname" type="varchar" required="false" />
        <attribute name="rowstamp" type="timestamp" required="true" />
      </attributes>
      <relationships>
        <relationship to="DOCINFO" qualifier="docinfo">
          <relationshipAttribute from="docinfoid" to="docinfoid" primary="true"/>
        </relationship>
      </relationships>
      <connectorParameters>
        <connectorParameter key="dbtable" value="commlogdocs" />
      </connectorParameters>
    </entity>
  </entities>

  <applications>
    <application entity="commlog" name="commlog" title="Communications">
      <properties>
        <property key ="icon.composition.tab" value="fa fa-envelope-o"/>
      </properties>

      <schemas>
        <schema id="list" stereotype="compositionlist">
          <properties>

            <property key="list.click.popup" value="modal"/>
          </properties>
          <!--<field attribute="#inboundicon">
            <renderer type="icon" params="iconcss=fa fa-mail-forward"/>
          </field>-->
          <field attribute="inbound">
            <renderer type="icon" params="expression={'1':'fa-long-arrow-left green','0':'fa-long-arrow-right orange'};widthXS=-1%;widthSM=5%;widthMD=5%;widthLG=3%"/>
          </field>
          <field attribute="read">
            <renderer type="icon" params="expression={'#default':'fa-envelope envelopeYellow','true':''};widthXS=-1%;widthSM=5%;widthMD=5%;widthLG=3%"/>
          </field>
          <field attribute="orgobject" label="Origination">
            <renderer type="default" params="widthXS=-1%;widthSM=-1%;widthMD=-1%;widthLG=10%"/>
          </field>
          <field attribute="createdate" label="Created Date/Time">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm;widthXS=45%;widthSM=45%;widthMD=21%;widthLG=15%"/>
          </field>
          <field attribute="sendto" label="To">
            <renderer type="default" params="widthXS=-1%;widthSM=-1%;widthMD=35%;widthLG=25%"/>
          </field>
          <field attribute="cc" hidden="true"/>
          <field attribute="ccflag" label="Cc">
            <renderer type="checkbox"  params="widthXS=-1%;widthSM=-1%;widthMD=-1%;widthLG=5%"/>
          </field>
          <field attribute="message" hidden="true"/>
          <field attribute="sendfrom" label="Send From">
            <renderer type="default" params="widthXS=-1%;widthSM=-1%;widthMD=-1%;widthLG=20%"/>
          </field>
          <field attribute="subject" label="Subject">
            <renderer type="default"/>
          </field>
          <section resourcepath="/Content/Templates/otb/commlogaction.html">
            <renderer type="default" params="widthXS=-1%;widthSM=30%;widthMD=20%;widthLG=13%"/>
          </section>
        </schema>


        <schema id="detail" stereotype="compositiondetail">
          <field attribute="commlogid" hidden="true" />
          <!--field attribute="sendto" label="To:" /-->
          <association label="To:" target="sendto" labelfield="email_.emailaddress">
            <renderer type="autocompleteserver"/>
          </association>
          <field attribute="cc" label="Cc:"/>
          <field attribute="sendfrom" label="From:"  />
          <field attribute="subject" label="Subject:" />
          <field attribute="message" label="Message:" >
            <renderer type="richtext"/>
          </field>
          <field label="Attachment:" attribute="attachment" >
            <renderer type="upload"/>
          </field>
        </schema>
      </schemas>
    </application>

  </applications>


</metadata>
