<?xml version="1.0" encoding="utf-8" ?>
<metadata xmlns="http://www.example.org/metadata" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.example.org/metadata ../../Schema/Metadata.xsd ">

  <entities>

    <queries>
      <query key="pluspcustomer" value="CASE WHEN !@PLUSPCUSTOMER IS NOT NULL AND !@PLUSPCUSTOMER = 'HLC-00' then 'HLAG'  WHEN !@PLUSPCUSTOMER IS NOT NULL AND LENGTH(!@PLUSPCUSTOMER) >= 3 THEN SUBSTR(!@PLUSPCUSTOMER, LENGTH(!@PLUSPCUSTOMER) - 2, 3) ELSE '' END"/>
      <query key="numberofdaysopen" value="#ic(DAYS(current date) - DAYS(incident.affecteddate))"/>
      <query key="affectedpersoncustom" value="CASE WHEN LOCATE('@',!@AFFECTEDPERSON) > 0 THEN SUBSTR(!@AFFECTEDPERSON,1,LOCATE('@',!@AFFECTEDPERSON)-1) ELSE !@AFFECTEDPERSON END"/>
      <query key="createbycustom" value="CASE WHEN LOCATE('@',!@CREATEBY) > 0 THEN SUBSTR(!@CREATEBY,1,LOCATE('@',!@CREATEBY)-1) ELSE !@CREATEBY END"/>
      <query key="reportedbycustom" value="CASE WHEN LOCATE('@',!@REPORTEDBY) > 0 THEN SUBSTR(!@REPORTEDBY,1,LOCATE('@',!@REPORTEDBY)-1) ELSE !@REPORTEDBY END"/>
      <query key="ownercustom" value="CASE WHEN LOCATE('@',!@OWNER) > 0 THEN SUBSTR(!@OWNER,1,LOCATE('@',!@OWNER)-1) ELSE !@OWNER END"/>
      <query key="displaynamecustom" value="CASE WHEN LOCATE('@',!@PERSONID) > 0 THEN '(' || SUBSTR(!@PERSONID,1,LOCATE('@',!@PERSONID)-1) || ') ' || COALESCE(!@DISPLAYNAME,'-- Name Not Set --') ELSE '(' || !@PERSONID || ') ' || COALESCE(!@DISPLAYNAME,'-- Name Not Set --') END"/>
      <query key="personidcustom" value="CASE WHEN LOCATE('@',!@PERSONID) > 0 THEN SUBSTR(!@PERSONID,1,LOCATE('@',!@PERSONID)-1) ELSE !@PERSONID END"/>
      <query key="resppartygroupcustom" value="CASE WHEN LOCATE('@',!@RESPPARTYGROUP) > 0 THEN SUBSTR(!@RESPPARTYGROUP,1,LOCATE('@',!@RESPPARTYGROUP)-1) ELSE !@RESPPARTYGROUP END"/>
    </queries>

    <entity name="pluspcustomer" idAttribute="pluspcustomerid" whereclause="customer like 'HLC-%'">
      <attributes>
        <attribute name="hlagpluspcustomer" type="varchar" required="false" query="CASE WHEN !@CUSTOMER IS NOT NULL AND !@CUSTOMER = 'HLC-00' then 'HLAG'  WHEN !@CUSTOMER IS NOT NULL AND LENGTH(!@CUSTOMER) >= 3 THEN SUBSTR(!@CUSTOMER, LENGTH(!@CUSTOMER) - 2, 3) ELSE '' END"/>
      </attributes>
    </entity>

    <entity name="assetspec" idAttribute="assetspecid">
      <attributes>
        <attribute name="value" type="varchar" required="false" query="CASE WHEN alnvalue IS NOT NULL THEN alnvalue WHEN numvalue IS NOT NULL THEN '' || numvalue ELSE '' END"/>
      </attributes>
    </entity>

    <entity name="offering" idAttribute="ticketid" parententity="sr" whereclause="(offering.classificationid is null or offering.classificationid not like '8151%') and (offering.TEMPLATEID like 'HLCDEO%')">
      <connectorParameters>
        <connectorParameter key="customconnector" value="softWrench.sW4.Data.Persistence.WS.Commons.HapagServiceRequestCrudConnector" />
      </connectorParameters>

    </entity>

    <entity name="SR" idAttribute="ticketid" whereclause="((sr.classificationid is null or sr.classificationid not like '8151%') and (SR.TEMPLATEID is null or 
            (SR.TEMPLATEID not in ('HLCDECHG','HLCDECHTUI','HLCDECHSSO') and SR.TEMPLATEID not like 'HLCDEO%' )))">
      <attributes>
        <attribute name="hlagpluspcustomer" type="varchar" required="false" query="ref:pluspcustomer"/>
        <attribute name="hlagaffectedperson" type="varchar" required="false" query="ref:affectedpersoncustom"/>
        <attribute name="hlagreportedby" type="varchar" required="false" query="ref:reportedbycustom"/>
      </attributes>
      <relationships>
        <relationship to="person" qualifier="affectedperson">
          <relationshipAttribute from="AFFECTEDPERSON" to="personid" primary="true"/>
        </relationship>
      </relationships>
      <connectorParameters>
        <connectorParameter key="dbtable" value="SR" />
        <connectorParameter key="integration_interface" value="MXISSR" />
        <connectorParameter key="mif_integration_interface" value="MXSW4SR" />
        <connectorParameter key="customconnector" value="softWrench.sW4.Data.Persistence.WS.Commons.HapagServiceRequestCrudConnector" />
        <connectorParameter key="mif_customconnector" value="" />
        <connectorParameter key="submitaction_customconnector" value="softWrench.sW4.Data.Persistence.WS.Commons.SubmitactionCrudConnector" />
        <connectorParameter key="crud_find_by_id_customconnector" value="softWrench.sW4.Data.Persistence.WS.Commons.MifFindByIdCrudConnector" />
      </connectorParameters>
    </entity>

    <!--Redeclring removing the TEMPLATEID restriction-->
    <entity name="srforchange" idAttribute="ticketid" parententity="SR" whereclause="(srforchange.classificationid is null or srforchange.classificationid not like '8151%')">
      <attributes>
        <attribute name="hlagchangesummary" type="varchar" required="false" query="!@description" />
        <attribute name="hlagchangeticketid" type="varchar" required="false" query="!@ticketid" />
        <attribute name="zeroedattr" type="varchar" query="'-666'"/>
      </attributes>
    </entity>

    <entity name="incident" idAttribute="ticketid">
      <attributes>
        <attribute name="hlagpluspcustomer" type="varchar" required="false" query="ref:pluspcustomer"/>
        <attribute name="numberdaysopen" type="varchar" required="false" query="ref:numberofdaysopen"/>
        <attribute name="hlagreportedby" type="varchar" required="false" query="ref:reportedbycustom"/>
        <attribute name="inouttime" type="varchar" required="false" query="CASE WHEN !@internalpriority=1 AND INT((CURRENT TIMESTAMP-!@REPORTDATE)/10000) &lt;=2 THEN 'INTIME' WHEN !@internalpriority=1 AND INT((CURRENT TIMESTAMP-!@REPORTDATE)/10000) >2 THEN 'OUTTIME' WHEN !@internalpriority=2 AND INT((CURRENT TIMESTAMP-!@REPORTDATE)/10000) &lt;=4  THEN 'INTIME' WHEN !@internalpriority=2 AND INT((CURRENT TIMESTAMP-!@REPORTDATE)/10000) >4 THEN 'OUTTIME' WHEN !@internalpriority=3 AND INT((CURRENT TIMESTAMP-!@REPORTDATE)/10000) &lt;=6  THEN 'INTIME' WHEN !@internalpriority=3 AND INT((CURRENT TIMESTAMP-!@REPORTDATE)/10000) >6 THEN 'OUTTIME' WHEN !@internalpriority=4 AND INT((CURRENT TIMESTAMP-!@REPORTDATE)/10000) &lt;=8  THEN 'INTIME' WHEN !@internalpriority=4 AND INT((CURRENT TIMESTAMP-!@REPORTDATE)/10000) >8 THEN 'OUTTIME' END" />
        <attribute name="closeddate" type="varchar" required="false" query="CASE WHEN !@status = 'CLOSED' then !@statusdate ELSE null END" />


      </attributes>
      <relationships>
        <relationship to="worklog" qualifier="lastworklog">
          <relationshipAttribute from="ticketid" to="recordkey" primary="true" />
          <relationshipAttribute from="siteid" to="siteid" />
        </relationship>
        <relationship to="person" qualifier="reporter">
          <relationshipAttribute from="reportedby" to="personid" primary="true"/>
        </relationship>
        <relationship to="commodities">
          <relationshipAttribute from="commodity" to="commodity" primary="true"/>
        </relationship>
        <relationship to="pluspcustomer">
          <relationshipAttribute from="pluspcustomer" to="customer" primary="true"/>
        </relationship>
        <relationship to="worklog" collection="true">
          <relationshipAttribute from="ticketid" to="recordkey" primary="true" />
          <relationshipAttribute to="class" literal="INCIDENT" quoteLiteral="true" />
        </relationship>
      </relationships>
      <connectorParameters>
        <connectorParameter key="dbtable" value="incident" />
        <connectorParameter key="integration_interface" value="MXISINCIDENT" />
        <connectorParameter key="customconnector" value="softWrench.sW4.Data.Persistence.WS.Commons.BaseIncidentCrudConnector" />
        <connectorParameter key="submitaction_customconnector" value="softWrench.sW4.Data.Persistence.WS.Commons.SubmitactionCrudConnector" />
        <connectorParameter key="crud_find_by_id_customconnector" value="softWrench.sW4.Data.Persistence.WS.Commons.MifFindByIdCrudConnector" />
      </connectorParameters>
    </entity>

    <entity name="asset" idAttribute="assetid" whereclause="asset.pluspcustomer != 'HLC-00' ">
      <attributes>

        <attribute name="noid" type="varchar" required="false" query="case when (!@parent is not null) then !@parent else '' end || ' ' || !@assetnum"/>
        <attribute name="computername" type="varchar" required="false" query="CASE WHEN LOCATE('//',!@Description) > 0 THEN LTRIM(RTRIM(SUBSTR(!@Description,1,LOCATE('//',!@Description)-1))) ELSE LTRIM(RTRIM(!@Description)) END"/>
        <attribute name="upper_computername" type="varchar" required="false" query="CASE WHEN LOCATE('//',!@Description) > 0 THEN UPPER(LTRIM(RTRIM(SUBSTR(!@Description,1,LOCATE('//',!@Description)-1)))) ELSE UPPER(LTRIM(RTRIM(!@Description))) END"/>
        <attribute name="hlagdescription" type="varchar" required="false" query="CASE WHEN LOCATE('//',!@Description) > 0 THEN LTRIM(RTRIM(SUBSTR(!@Description, LOCATE('//', !@Description)+3))) ELSE LTRIM(RTRIM(!@Description)) END" />
        <attribute name="hlagdescription2" type="varchar" required="false" query="'('||!@assetnum ||') ' || !@Description || case when !@serialnum is null then '' else ' // ' || !@serialnum end " />
        <attribute name="hlagpluspcustomer" type="varchar" required="false" query="ref:pluspcustomer"/>
        <attribute name="hlagswd" type="varchar" required="false" query="CASE WHEN assetloccommswd_.commodity = 'HLC-0007' THEN 'Yes' ELSE 'No' END"/>
        <attribute name="hlagscanclient" type="varchar" required="false" query="CASE WHEN assetloccommscanclient_.commodity = 'HLC-0006' THEN 'Yes' ELSE 'No' END"/>
        <attribute name="ownedby" type="varchar" required="false" query="@assetReportControlWhereClauseProvider.GetCommodityOwnedByWhere"/>


        <attribute name="assetcategory" type="varchar" query="COALESCE(classstructure_category_.description,'')" />
        <attribute name="assetregion" type="varchar" query="COALESCE(aucisnotowner_person_.department,'')" />
        <attribute name="assetarea" type="varchar" query="COALESCE(aucisnotowner_person_.displayname,'')" />

      </attributes>
      <relationships>
        <relationship to="AssetUserCust" qualifier="aucisnotowner">
          <relationshipAttribute from="assetnum" to="assetnum" primary="true"/>
          <relationshipAttribute query="(!@itdassetrole is null or !@itdassetrole !='Owner')" />
          <relationshipAttribute to="isuser" literal="1" quoteLiteral="false"/>
        </relationship>
        <relationship to="AssetUserCust" qualifier="aucisnotownerexternal">
          <relationshipAttribute from="assetnum" to="assetnum" primary="true"/>
          <relationshipAttribute query="(!@itdassetrole is null or !@itdassetrole !='Owner')" />
          <relationshipAttribute to="isuser" literal="1" quoteLiteral="false"/>
          <relationshipAttribute query="(!@personid not like '%@%')"/>
        </relationship>
        <relationship to="AssetUserCust" qualifier="aucisowner">
          <relationshipAttribute from="assetnum" to="assetnum" primary="true"/>
          <relationshipAttribute to="itdassetrole" literal="Owner" quoteLiteral="true"/>
          <relationshipAttribute to="isuser" literal="1" quoteLiteral="false"/>
        </relationship>
        <relationship to="assetspec" qualifier="assetspeceosdate">
          <relationshipAttribute from="assetnum" to="assetnum" primary="true"/>
          <relationshipAttribute from="siteid" to="siteid"/>
          <relationshipAttribute to="assetattrid" literal="SLA_EXTERNALHANDLE" quoteLiteral="true"/>
        </relationship>
        <relationship to="assetspec" qualifier="assetspeccomment">
          <relationshipAttribute from="assetnum" to="assetnum" primary="true"/>
          <relationshipAttribute from="siteid" to="siteid"/>
          <relationshipAttribute to="assetattrid" literal="COMMENT" quoteLiteral="true"/>
        </relationship>
        <relationship to="assetspec" qualifier="assetspecipaddress">
          <relationshipAttribute from="assetnum" to="assetnum" primary="true"/>
          <relationshipAttribute from="siteid" to="siteid"/>
          <relationshipAttribute to="assetattrid" literal="IPADDRESS_DOTNOTATION" quoteLiteral="true"/>
        </relationship>
        <relationship to="assetspec" qualifier="assetspecmacaddress">
          <relationshipAttribute from="assetnum" to="assetnum" primary="true"/>
          <relationshipAttribute from="siteid" to="siteid"/>
          <relationshipAttribute to="assetattrid" literal="COMPUTERSYSTEM_PRIMARYMACADDRESS" quoteLiteral="true"/>
        </relationship>
        <relationship to="assetloccomm" qualifier="assetloccommswd">
          <relationshipAttribute from="assetnum" to="assetnum" primary="true"/>
          <relationshipAttribute from="siteid" to="siteid" />
          <relationshipAttribute to="commodity" literal="HLC-0007" quoteLiteral="true"/>
        </relationship>
        <relationship to="assetloccomm" qualifier="assetloccommscanclient">
          <relationshipAttribute from="assetnum" to="assetnum" primary="true"/>
          <relationshipAttribute from="siteid" to="siteid" />
          <relationshipAttribute to="commodity" literal="HLC-0006" quoteLiteral="true"/>
        </relationship>
        <relationship to="assetloccomm" qualifier="alclistreport">
          <relationshipAttribute from="assetnum" to="assetnum" primary="true"/>
          <relationshipAttribute from="siteid" to="siteid" />
          <relationshipAttribute to="commodity" query="@assetReportControlWhereClauseProvider.GetCommodityOwnedByJoin"/>
        </relationship>
        <relationship to="ticket" collection="true">
          <relationshipAttribute from="assetnum" to="assetnum" primary="true"/>
          <relationshipAttribute from="siteid" to="siteid"/>
          <relationshipAttribute query="(!@classificationid is null or !@classificationid not like '8151%')"/>
        </relationship>

        <relationship to="imac" collection="true">
          <relationshipAttribute from="assetnum" to="assetnum" primary="true"/>
          <relationshipAttribute from="siteid" to="siteid"/>
        </relationship>
      </relationships>
      <connectorParameters>
        <connectorParameter key="saveremarks_customconnector" value="softWrench.sW4.Data.Persistence.WS.Commons.SaveRemarkCrudConnector" />
      </connectorParameters>
    </entity>

    <entity name="location" idAttribute="locationsid">
      <attributes>
        <attribute name="floor" type="varchar" required="false" query="CASE WHEN (!@description is not null and LOCATE('/FL:',!@description) > 0 ) then SUBSTR(!@description,LOCATE('/FL:',!@description)+4,(LOCATE('/',REPLACE(!@description,'/FL:','')) - LOCATE('/',!@description) ))  else '' end" />
        <attribute name="room" type="varchar" required="false" query="CASE WHEN (!@description is not null and LOCATE('RO:',!@description) > 0 ) then SUBSTR(!@description,LOCATE('RO:',!@description)+3,(LOCATE('/',!@description) - LOCATE('RO:',!@description)-3 ))  else '' end" />
      </attributes>
    </entity>

    <entity name="assetloccomm" idAttribute="assetloccommid">
      <relationships>
        <relationship to="commodities" qualifier="commoditiesownedby">
          <relationshipAttribute from="commodity" to="commodity" primary="true"/>
          <relationshipAttribute from="itemsetid" to="itemsetid" />
          <relationshipAttribute query="(!@description like 'Asset owened by%')" />
        </relationship>
      </relationships>
    </entity>

    <entity name="imac" idAttribute="ticketid">
      <attributes>
        <attribute name="hlagpluspcustomer" type="varchar" required="false" query="ref:pluspcustomer"/>
        <attribute name="service" type="varchar" required="false" query="SUBSTR(classstructure_.description, LOCATE('\', classstructure_.description) + 1)"/>
        <attribute name="hlagsummary" type="varchar" required="false" query="CASE WHEN LOCATE('//',!@Description) > 0 THEN LTRIM(RTRIM(SUBSTR(!@Description,1,LOCATE('//',!@Description)-1))) ELSE LTRIM(RTRIM(!@Description)) END"/>
        <attribute name="hlagimacstatus" type="varchar" required="false" query="case when (select count(*) from maximo.WOACTIVITY wo where wo.origrecordid = !@ticketid and wo.origrecordclass = 'SR') > 0 
          and (!@status != 'CANCELLED' and !@status != 'CLOSED' and !@status != 'RESOLVED' )
          then !@status || ' ' || 
          (select case when count(*) = 0 then '1' else count(*) end from maximo.WOACTIVITY wo where wo.origrecordid = !@ticketid and wo.status in ('CAN','CLOSED','COMP') and wo.origrecordclass = 'SR') || '/' || 
          (select count(*) from maximo.WOACTIVITY wo where wo.origrecordid = !@ticketid and wo.origrecordclass = 'SR')
          else !@status end "/>
        <attribute name="hlagaffectedperson" type="varchar" required="false" query="ref:affectedpersoncustom"/>
        <attribute name="hlagreportedby" type="varchar" required="false" query="ref:reportedbycustom"/>
        <attribute name="hlagservice" type="varchar" required="false"
						   query="case   
									when !@classificationid = '81515000' then 'Install'
									when !@classificationid = '81515100' then 'Move'
									when !@classificationid = '81515300' then 'Update Asset Data'
									when !@classificationid = '81515200' then 'Add Subcomponent'
									when !@classificationid = '81515400' then 'Remove'
									when !@classificationid = '81515500' then 'Replace'
									when !@classificationid = '81515700' then 'Decommission'
								  end"/>
      </attributes>
      <relationships>
        <relationship to="pluspcustomer">
          <relationshipAttribute from="pluspcustomer" to="customer" primary="true"/>
        </relationship>
        <relationship to="woactivity" collection="true">
          <relationshipAttribute from="ticketid" to="origrecordid" primary="true"/>
          <relationshipAttribute to="origrecordclass" literal="SR"/>
        </relationship>
        <relationship to="asset" qualifier="childasset">
          <relationshipAttribute from="assetnum" to="assetnum" primary="true"/>
          <relationshipAttribute from="siteid" to="siteid" />
          <relationshipAttribute from="parent" to="assetnum" />
        </relationship>
        <relationship to="asset" qualifier="movedasset">
          <relationshipAttribute from="assetnum" to="assetnum" primary="true"/>
          <relationshipAttribute from="siteid" to="siteid" />
        </relationship>
        <relationship to="asset" qualifier="newasset">
          <relationshipAttribute from="assetnum" to="assetnum" primary="true"/>
          <relationshipAttribute from="siteid" to="siteid" />
        </relationship>
        <relationship to="asset" qualifier="newchildasset">
          <relationshipAttribute from="assetnum" to="assetnum" primary="true"/>
          <relationshipAttribute from="siteid" to="siteid" />
          <relationshipAttribute from="parent" to="assetnum" />
        </relationship>
        <relationship to="assetspec">
          <relationshipAttribute from="assetnum" to="assetnum" primary="true"/>
          <relationshipAttribute from="siteid" to="siteid" />
        </relationship>
        <relationship to="chartofaccounts" qualifier="assetglaccount">
          <relationshipAttribute from="glaccount" to="glaccount" primary="true"/>
        </relationship>
      </relationships>
    </entity>

    <entity name="chartofaccounts" idAttribute="chartofaccountsid">
      <attributes>
        <attribute name="displaycostcenter" type="varchar" required="false" query="COALESCE(glcomp02,'') || ' // ' || COALESCE(accountname,'')"/>
      </attributes>
    </entity>

    <entity name="AssetUserCust" idAttribute="assetlocusercustid" whereclause="AssetUserCust.personid like '%@%'">
      <attributes>
        <attribute name="hlagdisplayname" type="varchar" required="false" query="ref:personidcustom"/>
      </attributes>
    </entity>

    <entity name="person" idAttribute="personuid">
      <attributes>
        <attribute name="hlagdisplayname" type="varchar" required="false" query="ref:displaynamecustom"/>
        <attribute name="hlagpluspcustomer" type="varchar" required="false" query="ref:pluspcustomer"/>
      </attributes>
      <relationships>
        <relationship to="chartofaccounts" qualifier="personglaccount">
          <relationshipAttribute from="itdcomment" to="glcomp02" primary="true"/>
        </relationship>
      </relationships>
    </entity>

    <entity name="persongroup" idAttribute="persongroupid">
      <attributes>
        <attribute name="hlagcostcenter" type="varchar" required="false" query="CASE WHEN LOCATE('/',description) > 0 THEN SUBSTR(description, LOCATE('/',description)-4, LENGTH(description) - LOCATE('/',description) + 5) ELSE '' END"/>
      </attributes>
    </entity>

    <entity name="persongroupview" idAttribute="persongroupteamid" whereclause="persongroupview.persongroup like 'C-HLC-%'">
      <attributes>
        <attribute name="regiongroupdefault" type="varchar" required="false" query="(select region.groupdefault from maximo.persongroupview region inner join maximo.persongroup regionpg on region.persongroup = regionpg.persongroup where region.personid = persongroupview.personid and REPLACE(regionpg.description,' ','') = SUBSTR(persongroup_.description,1,LOCATE('-',persongroup_.description,LOCATE('-',persongroup_.description)+1)-1))"/>
        <attribute name="areagroupdefault" type="varchar" required="false" query="(select area.groupdefault from maximo.persongroupview area inner join maximo.persongroup areapg on area.persongroup = areapg.persongroup where area.personid = persongroupview.personid and REPLACE(areapg.description,' ','') = SUBSTR(persongroup_.description,1,LOCATE('-',persongroup_.description)-1))"/>
        <attribute name="costcenterdescription" type="varchar" required="false" query="(select cc.accountname from maximo.chartofaccounts cc where cc.glcomp02 = SUBSTR(persongroup_.description,LOCATE('/',persongroup_.description) - 4))"/>
        <attribute name="locationcostcenterdescription" type="varchar" required="false" query="(select cc.accountname from maximo.chartofaccounts cc where cc.glcomp02 = SUBSTR(locationpersongroup_.description,LOCATE('/',locationpersongroup_.description) - 4))"/>
        <attribute name="hlagresppartygroup" type="varchar" required="false" query="ref:resppartygroupcustom"/>


      </attributes>
      <relationships>
        <relationship to="persongroup" qualifier="locationpersongroup">
          <relationshipAttribute query="REPLACE(persongroup_.description,' ','') = REPLACE(SUBSTR(locationpersongroup_.description,1,LOCATE('-',locationpersongroup_.description,LOCATE('-',locationpersongroup_.description)+1)-1),' ','') or REPLACE(persongroup_.description,' ','') = REPLACE(SUBSTR(locationpersongroup_.description,1,LOCATE('-',locationpersongroup_.description)-1),' ','')" primary="true"/>
          <!--<relationshipAttribute query="locationpersongroup_.persongroup like 'C-HLC-%' and (REPLACE(persongroup_.description,' ','') = REPLACE(SUBSTR(locationpersongroup_.description,1,LOCATE('-',locationpersongroup_.description,LOCATE('-',locationpersongroup_.description)+1)-1),' ','') or REPLACE(persongroup_.description,' ','') = REPLACE(SUBSTR(locationpersongroup_.description,1,LOCATE('-',locationpersongroup_.description)-1),' ',''))" primary="true"/>-->
        </relationship>
      </relationships>
    </entity>

    <entity name="problem" idAttribute="ticketid">
      <attributes>
        <attribute name="hlagpluspcustomer" type="varchar" required="false" query="ref:pluspcustomer"/>
        <attribute name="hlagreportedby" type="varchar" required="false" query="ref:reportedbycustom"/>
      </attributes>
      <relationships>
        <relationship to="longdescription" >
          <relationshipAttribute from="ticketuid" to="ldkey" primary="true"/>
          <relationshipAttribute to="ldownertable" literal="TICKET" quoteLiteral="true" />
          <relationshipAttribute to="ldownercol" literal="DESCRIPTION" quoteLiteral="true" />
        </relationship>
        <relationship to="location">
          <relationshipAttribute from="location" to="location" primary="true"/>
        </relationship>
        <relationship to="relatedrecord" collection="true">
          <relationshipAttribute from="ticketid" to="recordkey" primary="true"/>
          <relationshipAttribute to="class" literal="PROBLEM" quoteLiteral="true"/>
        </relationship>

      </relationships>
      <connectorParameters>
        <connectorParameter key="integration_interface" value="MXISPROBLEM" />
        <connectorParameter key="crud_find_by_id_customconnector" value="softWrench.sW4.Data.Persistence.WS.Commons.MifFindByIdCrudConnector" />
      </connectorParameters>
    </entity>

    <entity name="pmchgotherapprovers" idAttribute="pmchgotherapproversid">
    </entity>

    <entity name="wochange" idAttribute="wonum">
      <attributes>
        <attribute name="hlagchangesummary" type="varchar" required="false" query="!@description" />
        <attribute name="hlagchangeticketid" type="varchar" required="false" query="CASE WHEN sr_.ticketid IS NOT NULL THEN sr_.ticketid ELSE relatedsr_.relatedreckey END" />
        <attribute name="hlagpluspcustomer" type="varchar" required="false" query="ref:pluspcustomer"/>
        <attribute name="hlagsrid" type="varchar" required="false" query="CASE WHEN !@ORIGRECORDCLASS IS NOT NULL AND !@ORIGRECORDCLASS = 'SR' THEN !@ORIGRECORDID ELSE '' END"/>
        <attribute name="hlagreportedby" type="varchar" required="false" query="ref:reportedbycustom"/>
      </attributes>
      <relationships>
        <relationship to="sr">
          <relationshipAttribute from="origrecordid" to="ticketid" primary="true"/>
          <relationshipAttribute from="origrecordclass" literal="SR" quoteLiteral="true"/>
          <relationshipAttribute from="woclass" literal="CHANGE" quoteLiteral="true"/>
        </relationship>
        <relationship to="relatedrecord" qualifier="relatedsr" collection="true">
          <relationshipAttribute from="wonum" to="recordkey" primary="true"/>
          <relationshipAttribute to="relatedrecclass" literal="SR" quoteLiteral="true"/>
          <relationshipAttribute to="class" literal="CHANGE" quoteLiteral="true"/>
        </relationship>
        <relationship to="longdescription">
          <relationshipAttribute from="workorderid" to="ldkey" primary="true"/>
          <relationshipAttribute to="ldownertable" literal="WORKORDER" quoteLiteral="true" />
          <relationshipAttribute to="ldownercol" literal="DESCRIPTION" quoteLiteral="true" />
        </relationship>
        <relationship to="longdescription" qualifier="reasonforchange">
          <relationshipAttribute from="workorderid"  to="ldkey" primary="true"/>
          <relationshipAttribute to="ldownertable" literal="WORKORDER" quoteLiteral="true" />
          <relationshipAttribute to="ldownercol" literal="REASONFORCHANGE" quoteLiteral="true" />
        </relationship>
        <relationship to="longdescription" qualifier="backoutplan">
          <relationshipAttribute from="workorderid" to="ldkey" primary="true"/>
          <relationshipAttribute to="ldownertable" literal="WORKORDER" quoteLiteral="true" />
          <relationshipAttribute to="ldownercol" literal="BACKOUTPLAN" quoteLiteral="true" />
        </relationship>
        <relationship to="longdescription" qualifier="pretestdetail">
          <relationshipAttribute from="workorderid" to="ldkey" primary="true"/>
          <relationshipAttribute to="ldownertable" literal="WORKORDER" quoteLiteral="true" />
          <relationshipAttribute to="ldownercol" literal="ITDCHGPRETSTDTL" quoteLiteral="true" />
        </relationship>
        <relationship to="longdescription" qualifier="exceptionreason">
          <relationshipAttribute from="workorderid" to="ldkey" primary="true"/>
          <relationshipAttribute to="ldownertable" literal="WORKORDER" quoteLiteral="true" />
          <relationshipAttribute to="ldownercol" literal="EXCEPTIONREASON" quoteLiteral="true" />
        </relationship>
        <relationship to="workorder" collection="true">
          <relationshipAttribute from="wonum" to="parent" primary="true"/>
        </relationship>
        <relationship to="pmchgotherapprovers" qualifier="approvals" collection="true">
          <relationshipAttribute from="wonum" to="wonum" primary="true" />
        </relationship>
        <relationship to="pmchgotherapprovers" qualifier="dashapprovals" collection="true">
          <relationshipAttribute from="wonum" to="wonum" primary="true" />
          <relationshipAttribute from="pmchgapprovallevel" to="approvallevel" primary="true" />
          <relationshipAttribute query="@changeWhereClauseProvider.GetPersonGroupsForQuery"/>
        </relationship>
        <relationship to="woactivity" collection="true">
          <relationshipAttribute from="wonum" to="parent" primary="true" />
        </relationship>
        <relationship to="worklog" collection="true">
          <relationshipAttribute from="wonum" to="recordkey" primary="true" />
          <relationshipAttribute to="class" literal="CHANGE" quoteLiteral="true" />
        </relationship>
        <relationship to="DOCLINKS" qualifier="attachment" collection="true">
          <relationshipAttribute from="workorderid" to="ownerid" primary="true"/>
          <relationshipAttribute to="ownertable" literal="WOCHANGE" quoteLiteral="true"/>
        </relationship>
        <relationship to="WFTRANSACTION" qualifier="apprwftransaction" collection="true">
          <relationshipAttribute from="workorderid" to="ownerid" primary="true"/>
          <relationshipAttribute to="ownertable" literal="WOCHANGE" quoteLiteral="true"/>
        </relationship>
        <relationship to="WFASSIGNMENT" qualifier="wfassignment" collection="true">
          <relationshipAttribute from="workorderid" to="ownerid" primary="true"/>
          <relationshipAttribute to="ownertable" literal="WOCHANGE" quoteLiteral="true"/>
          <relationshipAttribute query="!@assignstatus in (select value from synonymdomain where domainid='WFASGNSTATUS' and maxvalue='ACTIVE')"/>
          <relationshipAttribute query="!@description like 'Other approvers for Approval Level%'"/>
        </relationship>
      </relationships>
      <connectorParameters>
        <connectorParameter key="integration_interface" value="MXISWOCHANGE2" />
        <connectorParameter key="crud_find_by_id_customconnector" value="softWrench.sW4.Data.Persistence.WS.Commons.MifFindByIdCrudConnector" />
      </connectorParameters>
    </entity>

    <entity name="newchange" idAttribute="ticketid" parententity="SR">
      <attributes>
        <attribute name="hlagaffectedperson" type="varchar" required="false" query="ref:affectedpersoncustom"/>
      </attributes>
      <relationships>
        <relationship to="ci">
          <relationshipAttribute from="cinum" to="cinum" primary="true"/>
          <relationshipAttribute query="!@status not in ('ARCHIVED','DECOMMISSIONED')"/>
        </relationship>
      </relationships>
    </entity>

    <entity name="workorder" idAttribute="workorderid">
      <relationships>
        <relationship to="worktype" qualifier="changecategory">
          <relationshipAttribute from="worktype" to="worktype" primary="true"/>
          <relationshipAttribute from="orgid" to="orgid" />
          <relationshipAttribute to="woclass" literal="CHANGE" quoteLiteral="true" />
        </relationship>
        <relationship to="longdescription" qualifier="reasonforchange">
          <relationshipAttribute from="workorderid" to="ldkey" primary="true"/>
          <relationshipAttribute to="ldownertable" literal="WORKORDER" quoteLiteral="true" />
          <relationshipAttribute to="ldownercol" literal="REASONFORCHANGE" quoteLiteral="true" />
        </relationship>
        <relationship to="longdescription" qualifier="exceptionreason">
          <relationshipAttribute from="workorderid" to="ldkey" primary="true"/>
          <relationshipAttribute to="ldownertable" literal="WORKORDER" quoteLiteral="true" />
          <relationshipAttribute to="ldownercol" literal="EXCEPTIONREASON" quoteLiteral="true" />
        </relationship>
      </relationships>
    </entity>

    <entity name="worklog" idAttribute="worklogid" >
      <attributes>
        <attribute name="hlagcreateby" type="varchar" required="false" query="ref:createbycustom"/>
        <attribute name="itdcreatedate" type="timestamp" required="false" />
      </attributes>
    </entity>

    <entity name="commodities" idAttribute="commoditiesid">
      <relationships>
        <relationship to="assetloccomm" qualifier="selectedcommodities">
          <relationshipAttribute from="commodity" to="commodity" primary="true"/>
          <relationshipAttribute from="itemsetid" to="itemsetid" />
          <relationshipAttribute to="assetnum" literal=":commodityassetnum" quoteLiteral="false" />
        </relationship>
      </relationships>
    </entity>

    <entity name="ticket" idAttribute="ticketid">
      <attributes>
        <attribute name="hlagowner" type="varchar" required="false" query="ref:ownercustom"/>
        <attribute name="hlagreportedby" type="varchar" required="false" query="ref:reportedbycustom"/>
      </attributes>
    </entity>

    <entity name="relatedrecord" idAttribute="relatedrecordid">
      <relationships>
        <relationship to="sr">
          <relationshipAttribute from="relatedreckey" to="ticketid" primary="true"/>
        </relationship>
      </relationships>
    </entity>

    <entity name="ci" idAttribute="ciid" whereclause="pluspcustomer like 'HLC%'">
    </entity>
  </entities>

  <applications>

    <application entity="incident" name="incident" title="Incident">
      <components>
        <componentdisplayable id="R017RequiredFields">
          <field attribute="asset_.assetnum" hidden="true"/>
          <field attribute="affectedperson_.personid" hidden="true"/>
          <field attribute="affectedperson_personglaccount_.glaccount" hidden="true"/>
          <field attribute="asset_assetglaccount_.glaccount" hidden="true"/>
        </componentdisplayable>
        <componentdisplayable id="Location">
          <optionfield label="Location" attribute="pluspcustomer" providerattribute="hlagUserLocations">
            <renderer type="combodropdown" />
            <filter operation="contains"/>
            <option label="HLC-00" value="HLC-00" />
          </optionfield>
        </componentdisplayable>
        <componentdisplayable id="Status" >
          <optionfield label="Status" attribute="status" providerattribute="incidentStatus">
            <renderer type="combodropdown"/>
            <filter operation="eq"/>
            <option label="CANCELLED" value="CANCELLED"/>
            <option label="CLOSED" value="CLOSED" />
            <option label="HISTEDIT" value="HISTEDIT"/>
            <option label="INPROG" value="INPROG"/>
            <option label="NEW" value="NEW"/>
            <option label="PENDING" value="PENDING"/>
            <option label="REJECTED" value="REJECTED"/>
            <option label="SLAHOLD" value="SLAHOLD"/>
            <option label="QUEUED" value="QUEUED"/>
            <option label="RESOLVCONF" value="RESOLVCONF"/>
            <option label="RESOLVED" value="RESOLVED"/>
          </optionfield>
        </componentdisplayable>
        <componentdisplayable id="Severity">
          <optionfield label="Severity" attribute="internalpriority" default="1">
            <renderer type="combodropdown"/>
            <filter operation="eq"/>
            <option label="1" value="1"/>
            <option label="2" value="2"/>
            <option label="3" value="3"/>
            <option label="4" value="4"/>
          </optionfield>
        </componentdisplayable>
      </components>
      <schemas>
        <list title="Incident Grid">
          <field attribute="ticketid" label="Request#">
            <renderer type="default" params="minwidth=80px;maxwidth=80px" />
          </field>
          <reference id="R017RequiredFields"/>
          <field attribute="description" label="Summary">
            <renderer type="default" params="minwidth=111px;maxwidth=111px;excelwidth=50" />
          </field>
          <field attribute="asset_.description" label="Asset">
            <renderer type="default" params="minwidth=100px;maxwidth=100px;excelwidth=30" />
          </field>
          <field attribute="targetfinish" label="Target Finish Date">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm;minwidth=100px;maxwidth=100px;showtime=true" />
          </field>
          <field attribute="internalpriority" label="Severity">
            <renderer type="default" params="minwidth=50px;maxwidth=50px;excelwidth=15" />
          </field>
          <field attribute="reportdate" label="Reported Date &amp; Time">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm;minwidth=100px;maxwidth=100px;showtime=true;exporttoexcel=false" />
          </field>
          <field attribute="#2reportdate" label="Reported Date" hidden="true">
            <renderer type="datetime" params="format=dd/MM/yyyy;showtime=false;exporttoexcel=true" />
          </field>
          <field attribute="#3reportdate" label="Reported Time" hidden="true">
            <renderer type="datetime" params="format=HH:mm;showtime=false;exporttoexcel=true" />
          </field>
          <field attribute="hlagpluspcustomer" label="Site Id">
            <renderer type="default" params="minwidth=60px;maxwidth=60px" />
          </field>
          <field attribute="ownergroup" label="Owner Group">
            <renderer type="default" params="minwidth=80px;maxwidth=80px" />
          </field>
          <field attribute="status" label="Status">
            <renderer type="default" params="minwidth=100px;maxwidth=100px" />
          </field>
          <field attribute="#color" label="">
            <renderer type="color" params="grid=incident;column=status"/>
          </field>

        </list>

        <detail id="detail" mode="output" title="Incident Details">
          <reference id="R017RequiredFields"/>
          <field attribute="ticketid" label="Incident Id"/>
          <field attribute="ticketuid" label="Incident Id" hidden="true"/>
          <field attribute="description" label="Summary"/>
          <field label="Details" attribute="longdescription_.ldtext">
            <renderer type="textarea"/>
          </field>
          <field label="Asset" attribute="asset_.description" />
          <field label="Serial Number" attribute="asset_.serialnum" />
          <field attribute="internalpriority" label="Severity" />
          <field label="Site Id" attribute="hlagpluspcustomer" />
          <field label="Location" attribute="location_.description" />
          <field label="Reported By" attribute="hlagreportedby" />
          <field label="Affected Person" attribute="affectedperson_.hlagdisplayname" />
          <field label="Status" attribute="status" />
          <section id ="Actionentry" resourcepath="/Content/Templates/hapag/Actionentry.html" showexpression="@status=='RESOLVED'">
            <header label="Action"/>
          </section>
          <field label="Impact" attribute="impact" />
          <field label="Urgency" attribute="urgency" />
          <field label="Reported Date" attribute="reportdate" >
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
          </field>
          <field label="Target Finish Date" attribute="targetfinish" >
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
          </field>
          <field attribute="statusdate" hidden="true" />
          <field label="Closed Date" attribute="closeddate">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
          </field>
          <field attribute="ownergroup" label="Owner Group"/>
          <field attribute="owner" hidden="true"/>
          <composition relationship="relatedrecord" label="Related Records" inline="true" >
            <renderer type="custom" params="resourcepath=/Content/Templates/hapag/commaseparatedcomposition.html;attributeToDisplay=relatedreckey;onClickService=relatedrecordservice.opendetail;showaslink=true" />
          </composition>
          <composition relationship="worklog" label="Work Log" printschema="printschema">
            <collectionproperties allowcreation="@status!='CLOSED' &amp;&amp; @status!='CAN'" prefilterfunction="AppendRelatedRecordWCToWorklog"/>
          </composition>
          <tab label="Solution" id="solution">
            <field attribute="problemcode_.ldtext" label="Symptom:" >
              <renderer type="textarea"/>
            </field>
            <field attribute="fr1code_.ldtext" label="Cause:" >
              <renderer type="textarea"/>
            </field>
            <field attribute="fr2code_.ldtext" label="Resolution:" >
              <renderer type="textarea"/>
            </field>
          </tab>
          <composition relationship="attachment" label="Attachments" printschema="detailPrint">
            <collectionproperties allowcreation="@status!='CLOSED' &amp;&amp; @status!='CAN'"/>
          </composition>
          <commands>
            <!--fixing order of commands-->
            <command id="submitaction" label="Submit Action" method="submitaction" service="ticketservice" parameters="datamap,schema" showexpression="@status=='RESOLVED' &amp;&amp; tabId=='main'" defaultposition="right"/>
          </commands>
        </detail>

        <schema id="dashboardList" stereotype="list">
          <field attribute="reportdate" label="Creation Date &amp; Time">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
          </field>
          <field attribute="ticketid" label="Request #"/>
          <field attribute="description" label="Summary"/>
          <field attribute="affectedperson_.personid" hidden="true"/>
          <field attribute="affectedperson_personglaccount_.glaccount" hidden="true"/>
          <field attribute="asset_assetglaccount_.glaccount" hidden="true"/>
          <properties>
            <property key="list.click.mode" value="output"/>
            <property key="list.click.popup" value="browserwindow"/>
          </properties>
        </schema>

        <schema id="tapebackupreport" stereotype="list" title="Tape BackUp Report">
          <field label="Incident Number" attribute="ticketid">
            <renderer type="default" params="minwidth=110px;manwidth=110px" />
          </field>
          <field label="Location" attribute="hlagpluspcustomer">
            <renderer type="default" params="minwidth=110px;manwidth=110px" />
          </field>
          <field label="Status" attribute="status">
            <renderer type="default" params="minwidth=110px;manwidth=110px" />
          </field>
          <field label="Open Date" attribute="affecteddate">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm;minwidth=110px;manwidth=110px"/>
          </field>
          <field label="Last-Action Date" attribute="lastworklog_.itdcreatedate">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm;minwidth=110px;manwidth=110px"/>
          </field>
          <field label="Last-Action Worklog" attribute="lastworklog_.description"/>
          <field label="Owner Group" attribute="ownergroup" hidden="true">
            <renderer type="default" params="exporttoexcel=true;minwidth=110px;manwidth=110px"/>
          </field>
          <field label="Days Open" attribute="numberdaysopen">
            <renderer type="default" params="minwidth=110px;manwidth=110px" />
          </field>
          <field label="CommoditiesDescription" attribute="commodities_.description" hidden="true"/>
          <reference id="R017RequiredFields"/>
        </schema>

        <schema id="incidentperlocationreportfilters" stereotype="detail" title="Incident Per Location/SCIM Report">
          <properties>
            <property key="report.reportName" value="IncidentPerLocationSCIMReport"/>
            <property key="nextschema.schemaid" value="incidentperlocation"/>
          </properties>
          <field attribute="commodities_.description" hidden="true">
            <filter operation="contains"/>
          </field>
          <field label="Start Date" attribute="reportdate___start">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
            <filter operation="btw" default="@MIN_DATE"/>
          </field>
          <field label="End Date" attribute="reportdate___end">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
            <filter operation="btw" default="@CURR_DATE" />
          </field>
          <reference id="Location"/>
          <reference id="Status"/>
          <reference id ="Severity"/>
          <association label ="System" target="system" labelfield="1commodities_.description" >
            <dataprovider postfilterfunction="ParseCommoditiesList"/>
          </association>
          <association label ="Component" target="component" labelfield="2commodities_.description" dependantfields="system">
            <dataprovider prefilterfunction="FilterComponent" postfilterfunction="ParseCommoditiesList"/>
          </association>
          <association label ="Item" target="item" labelfield="4commodities_.description" dependantfields="component">
            <dataprovider prefilterfunction="FilterItem" postfilterfunction="ParseCommoditiesList"/>
          </association>
          <association label ="Module" target="module" labelfield="3commodities_.description" dependantfields="item">
            <dataprovider prefilterfunction="FilterModule" postfilterfunction="ParseCommoditiesList" />
          </association>
          <commands removeundeclared="true">
            <command id="viewReport" label="View Report" method="viewIncidentReport" service="reportservice" parameters="datamap,schema" />
          </commands>
        </schema>

        <schema id="incidentperlocation" stereotype="list" title="Incident Per Location/SCIM">
          <field attribute="#currentdatetime" hidden="true" />
          <field label="Incident Number" attribute="ticketid" />
          <field label="Incident Summary" attribute="description" />
          <field label="status" attribute="status" />
          <field label="Affected Date and Time" attribute="reportdate">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
          </field>
          <field label="Severity" attribute="internalpriority" />
          <field label="Ownergroup" attribute="ownergroup" />
          <field label="Site ID" attribute="pluspcustomer" />
          <field label="Commodity Group" attribute="#commoditygroup" />
          <field label="Commodity" attribute="#commodity" />
          <field label="Last-Action Date" attribute="changedate">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
          </field>
          <field attribute="commodities_.description" hidden="true"/>
          <reference id="R017RequiredFields"/>
        </schema>

        <schema id="hardwarerepairreportfilters" stereotype="detail" title="Hardware Repair Report">
          <properties>
            <property key="report.reportName" value="HardwareRepairReport"/>
            <property key="nextschema.schemaid" value="hardwarerepair"/>
          </properties>
          <field label="Start Date" attribute="reportdate___start">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
            <filter operation="btw" default="@MIN_DATE"/>
          </field>
          <field label="End Date" attribute="reportdate___end">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
            <filter operation="btw" default="@CURR_DATE" />
          </field>
          <reference id="Location"/>
          <reference id="Status"/>
          <reference id ="Severity"/>
          <commands removeundeclared="true">
            <command id="viewhardwarereport" label="View Report" method="viewHardwareRepairReport" service="reportservice" parameters="datamap,schema"/>
          </commands>
        </schema>

        <schema id="hardwarerepair" stereotype="list" title="Hardware Repair Report">
          <field attribute="#currentdatetime" hidden="true" />
          <field label="Incident Number" attribute="ticketid">
            <renderer type="default" params="minwidth=84px" />
          </field>
          <field attribute="asset_.assetnum" hidden="true"/>
          <field attribute="commodities_.description" hidden="true"/>
          <field label="Location" attribute="asset_location_.description">
            <renderer type="default" params="minwidth=84px;maxwidth=84px" />
          </field>
          <field label="Component" attribute="#component">
            <renderer type="default" params="minwidth=84px;maxwidth=84px;excelwidth=15"/>
          </field>
          <field label="System" attribute="#system">
            <renderer type="default" params="minwidth=84px;maxwidth=84px;excelwidth=15"/>
          </field>
          <field label="Item" attribute="#item">
            <renderer type="default" params="minwidth=84px;maxwidth=84px;excelwidth=15"/>
          </field>
          <field label="Module" attribute="#module">
            <renderer type="default" params="minwidth=84px;maxwidth=84px;excelwidth=15"/>
          </field>
          <field label="Open Date" attribute="reportdate">
            <renderer type="datetime" params="format=MM/dd/yyyy;minwidth=84p;maxwidth=84pxx"/>
          </field>
          <field label="Last-Action Date" attribute="changedate">
            <renderer type="datetime" params="format=MM/dd/yyyy;minwidth=84px;maxwidth=84px"/>
          </field>
          <field label="Description" attribute="description">
            <renderer type="default" params="minwidth=84px;maxwidth=84px;excelwidth=15"/>
          </field>
          <reference id="R017RequiredFields"/>
        </schema>

        <schema id="escalationincident" stereotype="list" title="Escalation HLAG Incident Report">
          <field attribute="#currentdatetime" hidden="true" />
          <field label="Incident Number" attribute="ticketid">
            <renderer type="default" params="minwidth=84px;maxwidth=84px" />
          </field>
          <field label="Severity" attribute="internalpriority">
            <renderer type="default" params="minwidth=84px;maxwidth=84px" />
          </field>
          <field label="Status" attribute="status">
            <renderer type="default" params="minwidth=84px;maxwidth=84px" />
          </field>
          <field label="Open Date/Time" attribute="reportdate">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm;minwidth=84px;maxwidth=84p;"/>
          </field>
          <field label="Owner Group" attribute="ownergroup">
            <renderer type="default" params="minwidth=84px;maxwidth=84px" />
          </field>
          <field label="Last Action Date/Time" attribute="lastworklog_.itdcreatedate">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm;minwidth=84px;maxwidth=84px"/>
          </field>
          <field label="Hours Inactive" attribute="#hoursinactive">
            <renderer type="default" params="minwidth=84px;maxwidth=84px;excelwidth=15"/>
          </field>
          <field label="Problem Abstract" attribute="description">
            <renderer type="default" params="minwidth=84px;maxwidth=84px;" />
          </field>
          <field label="In Time / Out Time" attribute="inouttime">
            <renderer type="datetime" params="format=dd/MM/yyyy;minwidth=84px;maxwidth=84px"/>
          </field>
        </schema>

        <schema id="incidentdetailreportfilters" stereotype="detail" title="Incident Detail Report">
          <properties>
            <property key="report.reportName" value="IncidentPerLocationSCIMReport"/>
            <property key="nextschema.schemaid" value="incidentdetail"/>
          </properties>
          <field attribute="commodities_.description" hidden="true">
            <filter operation="contains"/>
          </field>

          <field label="Start Date" attribute="reportdate___start">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
            <filter operation="btw" default="@MIN_DATE"/>
          </field>
          <field label="End Date" attribute="reportdate___end">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
            <filter operation="btw" default="@CURR_DATE" />
          </field>
          <reference id="Location" showexpression="!ctx:InModule(['tui','sso'])"/>
          <reference id="Status"/>
          <reference id ="Severity"/>
          <association label ="System" target="system" labelfield="1commodities_.description" showexpression="!ctx:InModule(['tui','sso'])">
            <dataprovider postfilterfunction="ParseCommoditiesList"/>
          </association>
          <association label ="Component" target="component" labelfield="2commodities_.description" dependantfields="system" showexpression="!ctx:InModule(['tui','sso'])">
            <dataprovider prefilterfunction="FilterComponent" postfilterfunction="ParseCommoditiesList"/>
          </association>
          <association label ="Item" target ="item" labelfield="4commodities_.description" dependantfields="component" showexpression="!ctx:InModule(['tui','sso'])">
            <dataprovider prefilterfunction="FilterItem" postfilterfunction="ParseCommoditiesList"/>
          </association>
          <association label ="Module" target="module" labelfield="3commodities_.description" dependantfields="item" showexpression="!ctx:InModule(['tui','sso'])">
            <dataprovider prefilterfunction="FilterModule" postfilterfunction="ParseCommoditiesList" />
          </association>
          <commands removeundeclared="true">
            <command id="viewincidentdetailreport" label="View Report" method="viewIncidentReport" service="reportservice" parameters="datamap,schema"/>
          </commands>
        </schema>

        <schema id="incidentdetail" stereotype="list" title="Incident Detail Report">
          <properties>
            <property key="command.select" value ="true"/>
            <property key="list.print.schema" value="detail"/>
          </properties>
          <optionfield attribute ="ticketid">
            <renderer type="checkbox" params="minwidth=20px;maxwidth=20px" />
            <option label="" value="checking"/>
          </optionfield>
          <field label="Incident Number" attribute="ticketid">
            <renderer type="default" params="minwidth=80px;maxwidth=80px" />
          </field>
          <field label="Commodity Description" attribute="commodities_.description" hidden="false">
            <renderer type="default" params="minwidth=100px;maxwidth=100px" />
          </field>
          <field label="Incident Summary" attribute="description">
            <renderer type="default" params="minwidth=80px;maxwidth=220px" />
          </field>
          <field label="Severity" attribute="internalpriority">
            <renderer type="default" params="minwidth=55px;maxwidth=55px" />
          </field>
          <field label="Site ID" attribute="pluspcustomer">
            <renderer type="default" params="minwidth=70px;maxwidth=70px" />
          </field>
          <field label="Affected Date and Time" attribute="reportdate">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm;minwidth=90px;maxwidth=90px"/>
          </field>
          <field label="Ownergroup" attribute="ownergroup">
            <renderer type="default" params="minwidth=80px;maxwidth=80px" />
          </field>
          <field label="Status" attribute="status">
            <renderer type="default" params="minwidth=100px;maxwidth=100px" />
          </field>
          <reference id="R017RequiredFields"/>
          <commands>
            <command id="print" label="Print" stereotype="print" service="reportservice" method="printSelected" parameters="schema,datamap,searchSort" enableexpression="$scope:shouldCommandBeEnabled"/>
            <command id="cancel" label="Close" stereotype="cancel" service="srsummaryService" method="redirectToHapagHome" />
            <command id="selectAll" label="Select All" method="selectAll" service="reportservice" parameters="schema,datamap" />
            <command id="deselectAll" label="Deselct All" method="deselectAll" service="reportservice" parameters="schema,datamap"/>
          </commands>
        </schema>
      </schemas>
    </application>

    <application entity="srforchange" name="srforchange" title="Service Request">
      <schemas>
        <schema id="changeunionschema" stereotype="list">
          <field attribute="#null" hidden="true"/>
          <field attribute="#null2" hidden="true"/>
          <field attribute="#null3" hidden="true"/>
          <field attribute="#null4" hidden="true"/>

          <field attribute="zeroedattr" hidden="true"/>
          <field attribute="hlagchangesummary" hidden="true"/>
          <field attribute="ticketid" hidden="true"/>
          <field attribute="asset_.description" hidden="true"/>
          <field attribute="#null5" hidden="true"/>
          <field attribute="#null6" hidden="true"/>
          <field attribute="hlagpluspcustomer" hidden="true"/>
          <field attribute="hlagreportedby" hidden="true"/>
          <field attribute="status" hidden="true"/>
        </schema>
      </schemas>
    </application>

    <application entity="offering" name="offering" title="Offering">

      <components>
        <componentdisplayable id="servicelabel">
          <field attribute="#service" label="Service" default="@prop:servicename" readonly="true" qualifier="nodescription">
            <renderer type="label" />
          </field>
        </componentdisplayable>
      </components>
      <schemas>
        <list>
          <field attribute="ticketid" label="Request#">
            <renderer type="default" params="minwidth=80px;maxwidth=80px" />
          </field>
          <field attribute="description" label="Summary">
            <renderer type="default" params="minwidth=151px;maxwidth=151px;excelwidth=50" />
          </field>
          <field attribute="asset_.description" label="Asset">
            <renderer type="default" params="minwidth=160px;maxwidth=160px;excelwidth=25" />
          </field>
          <field attribute="reportdate" label="Reported Date &amp; Time">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm;minwidth=100px;maxwidth=100px;showtime=true;exporttoexcel=false" />
          </field>
          <field attribute="#2reportdate" label="Reported Date" hidden="true">
            <renderer type="datetime" params="format=dd/MM/yyyy;showtime=false;exporttoexcel=true;excelwidth=20" />
          </field>
          <field attribute="#3reportdate" label="Reported Time" hidden="true">
            <renderer type="datetime" params="format=HH:mm;showtime=false;exporttoexcel=true;excelwidth=20" />
          </field>
          <field attribute="hlagpluspcustomer" label="Site Id">
            <renderer type="default" params="minwidth=80px;maxwidth=80px;excelwidth=15" />
          </field>
          <field attribute="hlagaffectedperson" label="Affected Person">
            <renderer type="default" params="minwidth=110px;maxwidth=110px;excelwidth=20" />
          </field>
          <field attribute="status" label="Status">
            <renderer type="default" params="minwidth=100px;maxwidth=100px;excelwidth=15" />
          </field>
          <field attribute="#color" label="">
            <renderer type="color" params="grid=servicerequest;column=status"/>
          </field>
          <properties>
            <property key="list.click.service" value="oferringservice.openDetail"/>
          </properties>
        </list>

        <schema abstract="true" id="server" stereotype="detail" title="New OFFERING REQUEST - Server">
          <properties>
            <property key="nextschema.schemaid" value="creationSummary"/>
            <property key="addassociationlabels" value="true"/>
            <property key="popup.window.headertitle" value="New OFFERING REQUEST - Server"/>
            <property key="optionfield.donotusefirstoptionasdefault" value="true"/>
          </properties>

          <section id="requestdetails" parameters="detaildescription=">

            <reference id="servicelabel"/>

            <field label="Gewünschter Produktionstermin" attribute="startdate" required="true"
                   tooltip="Tragen Sie hier den gewünschten Produktionsstart des Systems ein. Bitte beachten Sie dass für den Aufbau 3 Werktage benötigt werden.">
              <renderer type="datetime" params="format=dd/MM/yyyy HH:mm;mindateexpression=@minstartdate;language=de"/>
            </field>
            <field label="Geplantes Produktionsende" attribute="enddate" tooltip="Sofern der Server nur temporär betrieben werden soll können Sie hier bereits das Produktionsende festlegen.">
              <renderer type="datetime" params="format=dd/MM/yyyy HH:mm;mindateexpression=@startdate;language=de"/>
            </field>
            <optionfield label="Betriebsart / LPAR-Typ" attribute="lpartype" tooltip="Wählen Sie hier, ob es sich um ein produktives System (7x24 oder 5x12) oder ein Testsystem (5x12) handelt." required="true">
              <option label="Produktion 7x24" value="prod247"/>
              <option label="Produktion 5x12" value="prod125"/>
              <option label="Test 5x12" value="test125"/>
            </optionfield>

            <optionfield label="CPU" attribute="cpu" tooltip="Wählen Sie hier die gewünschte Anzahl vCPUs aus." required="true">
              <renderer type="COMBO" params="append=vCPU"/>
              <option label="1" value="1"/>
              <option label="2" value="2"/>
              <option label="3" value="3"/>
              <option label="4" value="4"/>
              <option label="5" value="5"/>
              <option label="6" value="6"/>
              <option label="7" value="7"/>
              <option label="8" value="8"/>
            </optionfield>

            <optionfield label="Memory" attribute="memory" tooltip="Wie viel Speicherplatz wird voraussichtlich für Applikationen auf Partition C benötigt werden?Standardgröße für Disk C ist: XXX GB. Der hier angegebenen Speicher wird zusätzlich dazu bereitgestellt." required="true">
              <renderer type="COMBO" params="append=GB"/>
              <option label="1" value="1"/>
              <option label="2" value="2"/>
              <option label="3" value="3"/>
              <option label="4" value="4"/>
              <option label="5" value="5"/>
              <option label="6" value="6"/>
              <option label="7" value="7"/>
              <option label="8" value="8"/>
              <option label="9" value="9"/>
              <option label="10" value="10"/>
              <option label="11" value="11"/>
              <option label="12" value="12"/>
              <option label="13" value="13"/>
              <option label="14" value="14"/>
              <option label="15" value="15"/>
              <option label="16" value="16"/>
            </optionfield>

            <section id="diskdata"></section>

            <field label="Host Name" attribute="hostname" required="true" tooltip="Tragen Sie hier den gewünschten Names für den Server KFDC**** ein (ohne KFDC). Hierfür stehen Ihnen 4 Zeichen zur Verfügung.  Die ersten beiden sollte Buchstaben sein welche den Zweck des Servers beschreiben (Beispielsweise LY für Lync, BI für Business Intelligence etc.) darauf sollten 2 Zahlen folgen.">
              <renderer type="default" params="prepend=KFDC;maxlength=4"/>
            </field>


            <section id="specificdata"/>
            <optionfield label="K-Fall Kategorie" required="true" attribute="kfallcat" tooltip="Falls es sich um ein Produktivsystem handelt (Betriebsart / LPAR-Typ: Produktion) wählen Sie hier eine K-Fall Kategorie aus.">
              <option label="Testsystem - nicht K-Fall relevant" value="none"/>
              <option label="2" value="2"/>
              <option label="3" value="3"/>
              <option label="4" value="4"/>
            </optionfield>
          </section>


          <section orientation="vertical" id="networklocationdata">
            <header label="Platzierung im Netzwerk"/>
            <optionfield label="Soll der Server aus dem Internet erreichbar sein?" attribute="hasinternet" required="true">
              <renderer type="RADIO" />
              <option label="Ja" value="Ja"/>
              <option label="Nein" value="Nein"/>
            </optionfield>

            <section resourcepath="/Content/templates/hapag/embeddedofferingpdf.html" showexpression="@hasinternet!=null"/>
            <field attribute="networkvlan" label="Netzwerkplatzierung (VLAN):" showexpression="@hasinternet!=null" required="true"/>

            <field attribute="comments" label="Weitere Anmerkungen:" tooltip="Platz für zusätzliche Angaben / Wünsche.Bitte beachten Sie: Sonderwünsche sind nicht Teil des Factory-Ansatzen und können möglicherweise nicht im vereinarten Zeitraum umgesetzt werden." showexpression="@hasinternet!=null">
              <renderer type="textarea"/>
            </field>

            <field attribute="explanation" label="Information: Folgende Leistungen sind im Factory-Ansatz enthalten:"  showexpression="@hasinternet!=null" readonly="true" qualifier="nodescription">
              <renderer type="textarea" params="color=red"/>
            </field>

          </section>


        </schema>


        <schema id="serverwindows" parentschema="server" stereotype="detail" title="Windows">
          <properties>
            <property key="servicename" value="Windows"/>
          </properties>
          <section id="diskdata">
            <field label="Disk Size für Applikationen (zusätzlich zur Grundinstallation auf Partition C)" attribute="disksizec" required="true" tooltip="Bitte definieren Sie die gewünschte Größe der Partition E">
              <renderer type="default" params="append=GB"/>
            </field>
            <field label="Disk (E:)" attribute="disksizee" required="true" tooltip="Bitte definieren Sie die gewünschte Größe der Partition E">
              <renderer type="default" params="append=GB"/>
            </field>
          </section>
          <section id="specificdata">
            <optionfield label="OS" attribute="os" tooltip="Wählen Sie hier das gewünschte Betriebssystem." required="true">
              <option label="Windows Server 2008 Standard Edition" value="2008se"/>
              <option label="Windows Server 2008 Enterprise Edition" value="2008ee"/>
              <option label="Windows Server 2012 Standard Edition" value="2012se"/>
            </optionfield>
            <optionfield label="IIS" attribute="iis" tooltip="Wählen Sie hier ob die Microsoft IIS Serverrolle installiert werden soll." required="true">
              <option label="Yes" value="yes"/>
              <option label="No" value="no"/>
            </optionfield>
          </section>

        </schema>
        <schema id="serverlinux" parentschema="server" stereotype="detail" title="Linux">
          <properties>
            <property key="servicename" value="Linux"/>
          </properties>
          <section id="diskdata">
            <field label="Disk Size für 
Applikationen (zusätzlich zur Grundinstallation)" attribute="disksizec" required="true" tooltip="Bitte definieren Sie wie viel Disk Size Sie zusätzlich zur Grundinstallation benötigen.">
              <renderer type="default" params="append=GB"/>
            </field>

          </section>
          <section id="specificdata">
            <optionfield label="OS" attribute="os" tooltip="Wählen Sie hier das gewünschte Betriebssystem.">
              <option label="SUSE Linux Enterprise Server 11" value="suse11"/>
            </optionfield>
          </section>
        </schema>


        <schema id="creationSummary" mode="output" stereotype="detail" title="Change Request Detail">
          <field attribute="ticketuid" hidden="true"/>
          <field label="Request#:" attribute="ticketid"/>
          <field label="Date and Time:" attribute="reportdate">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
          </field>
          <field label="Details:" attribute="longdescription_.ldtext">
            <renderer type="textarea"/>
          </field>
          <commands>
            <command id="print" label="Print" stereotype="print" service="crudextraService" method="printDetail" parameters="schema,datamap"/>
            <command id="cancel" label="Close" stereotype="cancel" service="srsummaryService" method="redirectToHapagHome" />
          </commands>
          <properties>
            <property key="detail.cancel.lbl" value="Close"/>
          </properties>
        </schema>

        <schema id="dashboardList" stereotype="list">
          <field attribute="reportdate" label="Creation Date &amp; Time">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
          </field>
          <field attribute="ticketid" label="Request #"/>
          <field attribute="description" label="Summary"/>
          <field attribute="affectedperson_.personid" hidden="true"/>
          <field attribute="affectedperson_personglaccount_.glaccount" hidden="true"/>
          <field attribute="asset_assetglaccount_.glaccount" hidden="true"/>
          <properties>
            <property key="list.click.mode" value="output"/>
            <property key="list.click.popup" value="browserwindow"/>
          </properties>
        </schema>


      </schemas>
    </application>

    <application entity="SR" name="servicerequest" title="Service Request">
      <components>
        <componentdisplayable id="remarks">
          <field label="@prop:remarks.title" attribute="longdescription_.ldtext" required="true">
            <renderer type="textarea" params="maxlength=8000" />
          </field>
        </componentdisplayable>


        <componentdisplayable id="generaloutlookassetsection">
          <!--TODO: make header accept showexpression-->
          <section>
            <header label="User-Personal Asset" params="fieldset=true" displacement="ontop" showexpression="@isitcortom==true"/>
            <association label="Asset:" target="assetnum" labelfield="asset_.hlagdescription2"
												 extraprojectionvalues="location, location_.description, pluspcustomer, assetid" >
              <renderer type="autocompleteclient" params="minLength=3;opendetails=true;idtopendetails=asset_.assetid"/>
              <dataprovider prefilterfunction="FilterAssets"/>
              <event type="afterchange" service="srservice" method="afterUserAssetChange"/>
            </association>
            <field hidden="true" attribute="asset_.pluspcustomer"></field>
          </section>

          <section showexpression="@isitcortom==true">
            <header label="ITC-Responsible Asset" params="fieldset=true" displacement="ontop"/>
            <optionfield providerattribute="hlagUserLocations" attribute="itcassetlocation" label="Location" >
              <renderer type="autocompleteclient"/>
            </optionfield>
            <association label="Asset:" target="itcassetnum" labelfield="2asset_.hlagdescription2"
                         extraprojectionvalues="location, location_.description, pluspcustomer, assetid" dependantfields="itcassetlocation">
              <renderer type="autocompleteclient" params="minLength=3;opendetails=true;idtopendetails=2asset_.assetid"/>
              <dataprovider prefilterfunction="FilterAssetsByItcLocation" />
              <event type="afterchange" service="srservice" method="afterITCAssetChange" />
            </association>
            <field hidden="true" attribute="2asset_.pluspcustomer"></field>
          </section>

          <field showexpression="@isitcortom==true &amp;&amp; !nullOrEmpty(@assetnum)" attribute="asset_.location_.description" readonly="true" label="Asset Location">
            <renderer type="label" />
          </field>

          <field showexpression="@isitcortom==true &amp;&amp; !nullOrEmpty(@itcassetnum)" attribute="2asset_.location_.description" readonly="true" label="Asset Location" >
            <renderer type="label" />
          </field>

        </componentdisplayable>


      </components>

      <schemas>
        <schema title="Service Request Grid" abstract="true" id="baselist" stereotype="list">
          <field attribute="ticketid" label="Request#">
            <renderer type="default" params="minwidth=80px;maxwidth=80px" />
          </field>
          <field attribute="description" label="Summary">
            <renderer type="default" params="minwidth=151px;maxwidth=151px;excelwidth=50" />
          </field>
          <field attribute="asset_.description" label="Asset">
            <renderer type="default" params="minwidth=160px;maxwidth=160px;excelwidth=25" />
          </field>
          <field attribute="reportdate" label="Reported Date &amp; Time">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm;minwidth=100px;maxwidth=100px;showtime=true;exporttoexcel=false" />
          </field>
          <field attribute="#2reportdate" label="Reported Date" hidden="true">
            <renderer type="datetime" params="format=dd/MM/yyyy;showtime=false;exporttoexcel=true;excelwidth=20" />
          </field>
          <field attribute="#3reportdate" label="Reported Time" hidden="true">
            <renderer type="datetime" params="format=HH:mm;showtime=false;exporttoexcel=true;excelwidth=20" />
          </field>
          <field attribute="hlagpluspcustomer" label="Site Id">
            <renderer type="default" params="minwidth=80px;maxwidth=80px;excelwidth=15" />
          </field>
          <field attribute="hlagaffectedperson" label="Affected Person">
            <renderer type="default" params="minwidth=110px;maxwidth=110px;excelwidth=20" />
          </field>
          <field attribute="status" label="Status">
            <renderer type="default" params="minwidth=100px;maxwidth=100px;excelwidth=15" />
          </field>
          <field attribute="#color" label="">
            <renderer type="color" params="grid=servicerequest;column=status"/>
          </field>
          <section id="abstractsection"/>
          <properties>
            <property key="list.advancedfilter.allowtoggle" value="false"/>
            <property key="list.advancedfilter.showsearchicon" value="false"/>
          </properties>
        </schema>

        <list title="Service Request Grid" parentschema="baselist">
          <section id="abstractsection">
            <!--This is declared just to add an inner join to person-->
            <field attribute="affectedperson_.personid" hidden="true"/>
            <field attribute="affectedperson_personglaccount_.glaccount" hidden="true"/>
            <field attribute="asset_assetglaccount_.glaccount" hidden="true"/>

          </section>
        </list>

        <schema id="excellist" parentschema="list" title="Service Request Grid">

        </schema>

        <detail id="detail" mode="output" title="Request Details">
          <field attribute="ticketid" label="Request#" />
          <field attribute="ticketuid" label="Request#" hidden="true"/>
          <field attribute="class" label="" hidden="true"/>
          <field attribute="actlabcost" hidden="true" />
          <field attribute="actlabhrs" hidden="true"/>
          <field attribute="orgid" hidden="true"/>
          <field attribute="owner" hidden="true"/>
          <field attribute="ownergroup" hidden="true"/>
          <field attribute="cinum" hidden="true"/>
          <field attribute="templateid" hidden="true"/>
          <field attribute="affectedperson_personglaccount_.glcomp02" hidden="true"/>

          <field attribute="createby" hidden="true"/>
          <field attribute="description" label="Summary"/>
          <field label="Details" attribute="longdescription_.ldtext" >
            <renderer type="textarea"/>
          </field>
          <field label="Target Finish Date" attribute="targetfinish" />
          <field label="Asset" attribute="asset_.description" />
          <field label="Serial Number" attribute="asset_.serialnum" />
          <field label="Site Id" attribute="hlagpluspcustomer" />
          <field label="Location" attribute="location_.description" />
          <field label="Status" attribute="status" />
          <!--This field is added for resolved tickets in service request details -->
          <section id ="Actionentry" resourcepath="/Content/Templates/hapag/Actionentry.html" showexpression="@status=='RESOLVED'">
            <header label="Action"/>
          </section>
          <field label="Reported By" attribute="hlagreportedby" />
          <field label="Affected Person" attribute="hlagaffectedperson" />
          <field label="Affected Date" attribute="affecteddate" >
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
          </field>
          <field label="Reported Date &amp; Time" attribute="reportdate" >
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
          </field>
          <field attribute="statusdate" hidden="true" />
          <field label="Closed Date" attribute="#closeddate">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
          </field>
          <field label="Owner Group" attribute="ownergroup" />
          <!--This field is mapped as a composition because the framework only allows joins on compositions-->
          <composition relationship="relatedrecord" label="Related Records" inline="true" >
            <renderer type="custom" params="resourcepath=/Content/Templates/hapag/commaseparatedcomposition.html;attributeToDisplay=relatedreckey;onClickService=relatedrecordservice.opendetail;showaslink=true" />
          </composition>
          <composition relationship="worklog" label="Work Log" printschema="printschema">
            <collectionproperties allowcreation="@status!='CLOSED' &amp;&amp; @status!='CAN'" prefilterfunction="AppendRelatedRecordWCToWorklog"/>
          </composition>
          <composition relationship="attachment" label="Attachment" printschema="detailPrint">
            <collectionproperties allowcreation="@status!='CLOSED' &amp;&amp; @status!='CAN'"/>
          </composition>
          <commands>
            <!--fixing order of commands-->
            <command id="submitaction" label="Submit Action" method="submitaction" service="ticketservice" parameters="datamap,schema" showexpression="@status=='RESOLVED' &amp;&amp; tabId=='main'" defaultposition="right"/>
          </commands>
        </detail>

        <schema id="changedetail" mode="output" parentschema="detail"/>
        
        <schema id="AnewSR" abstract="true" stereotype="detail" mode="input" title="Service Request">
          <properties>
            <property key="nextschema.schemaid" value="creationSummary"/>
            <property key="addassociationlabels" value="true"/>
            <property key="associationstoprefetch" value="hlagUserLocations"/>
            <property key="remarks.title" value="General Remarks:"/>
          </properties>

          <section id="usefulFaqLinks" attribute="usefulFaqLinks" resourcepath="/Content/Templates/usefulFaqLinks.html" />

          <field label="Reported By:" attribute="hlagreportedby" default="@username" readonly="true" tooltip="Owner" />
          <!--wip-->
          <field label="CallBack Number:" attribute="callbacknum" default="@user.phone" />
          <association label="Affected Person:" target="affectedperson" labelfield="person_.hlagdisplayname" default="@personid" extraprojectionvalues="pluspcustomer">
            <renderer type="autocompleteserver"/>
            <dataprovider prefilterfunction="FilterAffectedPerson" />
            <event type="afterchange" service="srservice" method="afterChangeaffectedperson"/>
          </association>

          <field hidden="true" attribute="person_.pluspcustomer"/>

          <association label="Affected Location:" target="pluspcustomer" labelfield="pluspcustomer_.hlagpluspcustomer"/>

          <!--used for querying and saving, but wont appear on screen, will be splitted-->
          <field attribute="affecteddate" default="@currentdatetime" hidden="true"/>

          <section id="affectedDate" resourcepath="/Content/Templates/samelinepickers.html" parameters="joinattribute=affecteddate;default=@currentdatetime;dateformat=dd/MM/yyyy">
            <header label="Affected Date:" displacement="sameline"/>
          </section>

          <section id="abstractSection"/>

          <field label="Summary:" attribute="description" required="true">
            <renderer type="default" params="maxlength=95" />
          </field>
          <reference id="remarks"/>
          <!--wip-->
          <field label="Attachment:" attribute="newattachment" >
            <renderer type="upload"/>
          </field>

          <field label="ScreenShot:" attribute="newscreenshot">
            <renderer type="screenshot"/>
          </field>
        </schema>

        <schema id="general" title="New Service Request - General" parentschema="AnewSR">
          <section id="abstractSection">
            <reference id="generaloutlookassetsection"/>
          </section>
        </schema>

        <schema id="iam" title="User Access or Authorization-Problem" parentschema="AnewSR">
          <properties>
            <property key="remarks.title" value="Problem Description:"/>
          </properties>
          <section id="abstractSection">
            <optionfield attribute="problemaffect" label="Does this Problem Affect:">
              <option label="---Select One---" value=""/>
              <option label="Login Problem (server offline or password problem)" value="login"/>
              <option label="Authorization Problem" value="authorization"/>
              <option label="Other" value="other"/>
            </optionfield>
          </section>
        </schema>

        <schema id="printer" title="New Service Request - Printer" parentschema="AnewSR">
          <properties>
            <property key="usefulfaqlinks" value="5;4"/>
          </properties>
          <section id="abstractSection">

            <association label="Printer Location:" target="printerpluspcustomer" labelfield="2pluspcustomer_.hlagpluspcustomer"/>

            <field attribute="asset_.assetid" hidden="true" />
            <association label="Affected Printer:" target="assetnum" labelfield="asset_.description"
                         extraprojectionvalues="location,assetid,pluspcustomer" dependantfields="printerpluspcustomer">
              <renderer type="autocompleteclient" params="minLength=3;opendetails=true;idtopendetails=asset_.assetid"/>
              <dataprovider prefilterfunction="FilterAssets"/>
              <!--<renderer type="autocompleteclient" params="opendetails=true;idtopendetails=asset_.assetid"/>-->
            </association>
            <field hidden="true" attribute="asset_.pluspcustomer"></field>

            <optionfield label="Printer Connection:" attribute="printerconnection" >
              <option label="Network" value="Network"/>
              <option label="Local" value="Local"/>
              <option label="HOD" value="Hod"/>
            </optionfield>
            <optionfield label="Application:" attribute="application">
              <renderer type="checkbox" />
              <option label="Windows" value="Windows"/>
              <option label="FIS" value="FIS"/>
              <option label="SAP" value="SAP"/>
              <option label="Other" value="Other"/>
            </optionfield>
            <field label="Error message on Printer / Screen?:" attribute="printererrormessage" >

            </field>
            <!--Primary Checks:-->
            <optionfield label="Power cable checked:" attribute="powercablechecked">
              <renderer type="radio" />
              <option label="Yes" value="Yes"/>
              <option label="No" value="No"/>
              <option label="Not necessary" value="Not necessary"/>
            </optionfield>
            <optionfield label="Network cable checked:" attribute="networkcablechecked" >
              <renderer type="radio" />
              <option label="Yes" value="Yes"/>
              <option label="No" value="No"/>
              <option label="Not necessary" value="Not necessary"/>
            </optionfield>
            <optionfield label="Checked for paper jam:" attribute="checkedforpaperjam">
              <renderer type="radio" />
              <option label="Yes" value="Yes"/>
              <option label="No" value="No"/>
              <option label="Not necessary" value="Not necessary"/>
            </optionfield>
            <optionfield label="Checked for empty paper tray:" attribute="checkedforemptytray">
              <renderer type="radio" />
              <option label="Yes" value="Yes"/>
              <option label="No" value="No"/>
              <option label="Not necessary" value="Not necessary"/>
            </optionfield>
            <optionfield label="Printing from other PC possible:" attribute="printingfromotherpc">
              <renderer type="radio" />
              <option label="Yes" value="Yes"/>
              <option label="No" value="No"/>
              <option label="Not necessary" value="Not necessary"/>
            </optionfield>
            <optionfield label="Printing using another application possible:" attribute="printingfromotherapp">
              <renderer type="radio" />
              <option label="Yes" value="Yes"/>
              <option label="No" value="No"/>
              <option label="Not necessary" value="Not necessary"/>
            </optionfield>
          </section>
        </schema>

        <schema id="outlook" title="New Service Request - Outlook" parentschema="AnewSR">
          <properties>
            <property key="usefulfaqlinks" value="6;2;3"/>
          </properties>
          <section id="abstractSection">
            <reference id="generaloutlookassetsection"/>
            <optionfield label="Does this problem affect:" attribute="problemaffect">
              <option label="Select One" value=""  />
              <option label="Your own outlook mailbox/calendar/address book" value="Your own outlook mailbox/calendar/address book"/>
              <option label="A mailbox or folder of a colleague, that you have mapped to your outlook directory" value="A mailbox or folder of a colleague, that you have mapped to your outlook directory" />
              <option label="A group mailbox, that you are directly logged on to (using the team mailbox ID and PWD)" value="A group mailbox, that you are directly logged on to (using the team mailbox ID and PWD)" />
              <option label="A group mailbox, that you have mapped to your personal outlook directory" value="A group mailbox, that you have mapped to your personal outlook directory" />
              <option label="A public folder (please also tell us the path to the folder)" value="A public folder (please also tell us the path to the folder)" />
              <option label="Other" value="Other"/>
            </optionfield>
            <optionfield label="What issue do you observe:" attribute="observedissue">
              <option label="Select One" value="" />
              <option label="You do not receive mails" value="Outlook does not receive mails"/>
              <option label="You cannot send mails" value="You cannot send mails"/>
              <option label="You miss mails" value="You miss mails"/>
              <option label="You get countless mail from a single user/mail address" value="You get countless mail from a single user/mail address"/>
              <option label="Other" value="Other"/>
            </optionfield>
          </section>
        </schema>

        <schema id="phone" stereotype="detail" title="New Service Request - Phone" parentschema="AnewSR">
          <section id="abstractSection">

            <optionfield label="Affected Device:" attribute="affectedDevice">
              <option label="Select One" value="" />
              <option label="Cisco-IP-Phone" value="Cisco-IP-Phone"/>
              <option label="Cucilync (IP Office Integration)" value="Cucilync"/>
              <option label="Dect-Phone" value="Dect-Phone"/>
              <option label="Fax" value="Fax"/>
              <option label="Softphone" value="Softphone"/>
              <option label="Voicemail" value="Voicemail"/>
              <option label="Other (please describe)" value="Other"/>
              <event service="srservice" method="afterPhoneAffectedDeviceChange" type="afterchange" />
            </optionfield>

            <association label="Phone Location:" target="phonepluspcustomer" labelfield="2pluspcustomer_.hlagpluspcustomer"
															 enableexpression="@affectedDevice == 'Cisco-IP-Phone'"/>

            <association label="Affected Phone:" target="assetnum" labelfield="asset_.description"
                         dependantfields="phonepluspcustomer" extraprojectionvalues="pluspcustomer, assetid" enableexpression="@affectedDevice == 'Cisco-IP-Phone'">
              <renderer type="autocompleteclient" params="minLength=3;opendetails=true;idtopendetails=asset_.assetid"/>
              <dataprovider prefilterfunction="FilterAssets"/>
            </association>
            <field hidden="true" attribute="asset_.pluspcustomer"></field>

            <optionfield label="Who has this problem:" attribute="whohasproblem">
              <option label="Select One" value="" />
              <option label="Single Phone" value="Single Phone"/>
              <option label="Multiple Phones (enter extensions into remarks)" value="Multiple Phones"/>
              <option label="All Phones" value="All Phones"/>
            </optionfield>
            <optionfield label="Symptom Description:" attribute="symptomdesc">
              <option label="Select One" value="" />
              <option label="Bad Voice Quality" value="Bad Voice Quality"/>
              <option label="Call Drops" value="Call Drops"/>
              <option label="Call forwarding" value="Call forwarding"/>
              <option label="Conferencing" value="Conferencing"/>
              <option label="'Dead' extension" value="Dead"/>
              <option label="Echo" value="Echo"/>
              <option label="No Call Possible" value="No Call Possible"/>
              <option label="Noise" value="Noise"/>
              <option label="Other" value="Other"/>
            </optionfield>
            <optionfield label="Call Direction:" attribute="calldirection">
              <option label="Select One" value="" />
              <option label="in-bound" value="in-bound"/>
              <option label="out-bound" value="out-bound"/>
              <option label="both" value="both"/>
            </optionfield>
            <optionfield label="Call Type:" attribute="calltype">
              <option label="Select One" value="" />
              <option label="All Calls" value="All Calls"/>
              <option label="Internal" value="Internal"/>
              <option label="International Calls" value="International Calls"/>
              <option label="Local Calls" value="Local Calls"/>
              <option label="National" value="National"/>
              <option label="Special Numbers (e.g. 0800####)" value="Special Numbers"/>
              <option label="Other" value="Other"/>
            </optionfield>
            <optionfield label="Problem Behavior:" attribute="problembehavior">
              <option label="Select One" value="" />
              <option label="Constant" value="Constant"/>
              <option label="Sporadic" value="Sporadic"/>
              <option label="One time" value="One Time"/>
            </optionfield>
            <field label="Problem Details:" attribute="example" >
              <renderer type="textarea" params="maxlength=8000" />
            </field>
            <optionfield label="Call Routing:" attribute="callrouting">
              <option label="Select One" value="" />
              <option label="on-net" value="on-net"/>
              <option label="off-net" value="off-net"/>
            </optionfield>
          </section>
        </schema>

        <schema id="network" stereotype="detail" title="New Service Request - Network" parentschema="AnewSR">
          <properties>
            <property key="oncrudloadevent.detail" value="srnetworkservice.onload"/>
          </properties>

          <section id="abstractSection">
            <reference id="generaloutlookassetsection"/>
            <field attribute="#crosstestresult" label="Crosstest result (if applicable):">
              <renderer type="textarea"/>
            </field>

            <field attribute="#slowresponse" label="Do you face slow response? If yes, please define which applications:">
              <renderer type="textarea"/>
            </field>

            <section id="network_wan">
              <header displacement="ontop" params="fieldset=true" label="WAN issue"/>
              <field label="In case of Internet issues answer the following:" attribute="#network_wan_label" readonly="true">
                <renderer type="label" params="overflow=true"/>
              </field>
              <field label="Is the internet access slow or down? (time loading specific URL)" attribute="#internetslowdown">
                <renderer type="textarea"/>
              </field>
              <optionfield label="Does the problem affect a single internet page or all pages?" attribute="affectedpages">
                <renderer type="COMBO" params="setdefaultvalue=false"/>
                <option label="Single" value="single"/>
                <option label="All" value="all"/>
              </optionfield>
              <field label="Target address (URL):" attribute="#targeturl"/>
              <field label="Used proxy ('ping proxy' on the user\'s PC will show this):" attribute="#usedproxy"/>
              <field label="Do you receive any error messages? If so please provide an example:" attribute="#errormessages"/>
            </section>

            <section id="network_lan">
              <header displacement="ontop" label="LAN issue" params="fieldset=true"/>
              <field label="One or more clients do not have connection to the network: " attribute="#network_lan_label" readonly="true">
                <renderer type="label" params="overflow=true"/>
              </field>
              <field label="How many clients are affected?" attribute="#clientsaffected">
                <renderer type="numericinput"/>
              </field>
              <optionfield label="Connection of the client:" attribute="clientconnection">
                <renderer type="COMBO" params="setdefaultvalue=false"/>
                <option label="LAN" value="lan"/>
                <option label="WLAN" value="wlan"/>
                <option label="LAN/WLAN" value="lan/wlan"/>
              </optionfield>
              <optionfield label="Do the clients have an IP address?" attribute="isaddressavailable">
                <renderer type="COMBO" params="setdefaultvalue=false"/>
                <option label="YES" value="YES"/>
                <option label="NO" value="NO"/>
              </optionfield>
              <field label="Please give some examples:" attribute="#clientipaddress" showexpression="@isaddressavailable == 'YES'"/>
            </section>


            <section id="network_vpn">
              <header displacement="ontop" label="VPN issue" params="fieldset=true"/>
              <field label="Did the user try to connect via VPN: " attribute="#network_vpn_label" readonly="true">
                <renderer type="label" params="overflow=true"/>
              </field>
              <optionfield label="Are you getting the authorisation page?" attribute="authpageseen">
                <renderer type="COMBO" params="setdefaultvalue=false"/>
                <option label="YES" value="YES"/>
                <option label="NO" value="NO"/>
              </optionfield>
              <optionfield label="Is the login successful?" attribute="loginsuccess">
                <renderer type="COMBO" params="setdefaultvalue=false"/>
                <option label="YES" value="YES"/>
                <option label="NO" value="NO"/>
              </optionfield>
              <field label="Do you receive any error messages? If so please provide an example:" enableexpression="@loginsuccess == 'YES'" attribute="#vpnerrormessage"/>
            </section>
          </section>
        </schema>


        <schema id="creationSummary" mode="output" stereotype="detail" title="Service Request Detail">
          <field attribute="ticketuid" hidden="true"/>
          <field label="SR Number:" attribute="ticketid"/>
          <field label="Asset:" attribute="asset_.description" />
          <field label="Location:" attribute="pluspcustomer_.hlagpluspcustomer" />
          <field label="Affected Person" attribute="affectedperson_.hlagdisplayname" />
          <field label="Affected Date:" attribute="affecteddate" >
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
          </field>
          <field label="Summary:" attribute="description"/>
          <field label="Details:" attribute="longdescription_.ldtext">
            <renderer type="textarea"/>
          </field>
          <composition relationship="attachment" label="Attachments" hidden="true" fetchtype="eager"/>
          <field label="Attachment:" attribute="#attachmentsummary" />

          <commands>
            <command id="print" label="Print" stereotype="print" service="crudextraService" method="printDetail" parameters="schema,datamap"/>
            <command id="cancel" label="Close" stereotype="cancel" service="srsummaryService" method="redirectToHapagHome" />
          </commands>
          <properties>
            <property key="detail.cancel.lbl" value="Close"/>
          </properties>
        </schema>

        <schema id="dashboardList" stereotype="list">
          <field attribute="reportdate" label="Creation Date &amp; Time">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
          </field>
          <field attribute="ticketid" label="Request #"/>
          <field attribute="description" label="Summary"/>
          <field attribute="affectedperson_.personid" hidden="true"/>
          <field attribute="affectedperson_personglaccount_.glaccount" hidden="true"/>
          <field attribute="asset_assetglaccount_.glaccount" hidden="true"/>
          <properties>
            <property key="list.click.mode" value="output"/>
            <property key="list.click.popup" value="browserwindow"/>
          </properties>
        </schema>

      </schemas>
    </application>

    <application name="change" entity="wochange"  title="Change">
      <schemas>

        <schema abstract="true" id="parentgrid">
          <field attribute="workorderid" hidden="true" />
          <field attribute="sr_.ticketid" hidden="true" />
          <field attribute="relatedsr_.recordkey" hidden="true" />
          <field attribute="relatedsr_sr_.ticketid" hidden="true" />

          <field attribute="wonum" label="Change ID">
            <renderer type="default" params="minwidth=80px;maxwidth=80px" />
          </field>
          <section id="srId"/>
          <field attribute="ci_.ciname" label="Asset">
            <renderer type="default" params="minwidth=100px;maxwidth=100px;excelwidth=30" />
          </field>
          <field attribute="wopriority" label="Priority">
            <renderer type="default" params="minwidth=60px;maxwidth=60px" />
          </field>
          <field attribute="schedstart" label="Scheduled Start">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm;minwidth=100px;maxwidth=100px;showtime=true" />
          </field>
          <field attribute="hlagpluspcustomer" label="Site ID">
            <renderer type="default" params="minwidth=80px;maxwidth=80px" />
          </field>

          <section id="reportedby"/>

          <field attribute="status" label="Status">
            <renderer type="default" params="minwidth=100px;width=100px" />
          </field>
          <field attribute="#color" label="">
            <renderer type="color" params="grid=change;column=status"/>
          </field>
          <section id="extrafields"/>

        </schema>

        <!--Used for viewAll of change tasks click from Dashboard no SR union-->
        <schema id="gridwithoutsr" stereotype="list" parentschema="parentgrid">
          <section id="srId">
            <field attribute="hlagchangesummary" label="Summary">
              <renderer type="default" params="minwidth=130px;excelwidth=50;wordwrap=break-word" />
            </field>
            <field attribute="hlagchangeticketid" label="SR ID">
              <renderer type="default" params="width=75px;wordwrap=break-word" />
            </field>
          </section>
          <section id="reportedby">
            <field attribute="hlagreportedby" label="Reported By">
              <renderer type="default" params="minwidth=100px;maxwidth=100px" />
            </field>
          </section>
        </schema>

        <!--used on view all of approvals-->
        <schema id="gridwithoutsrwithapprovals" stereotype="list" parentschema="parentgrid">
          <section id="srId">
            <field attribute="hlagchangesummary" label="Summary">
              <renderer type="default" params="minwidth=169px;maxwidth=169px;excelwidth=50" />
            </field>
            <field attribute="hlagchangeticketid" label="SR ID" hidden="true">
              <renderer type="default" params="minwidth=80px;maxwidth=80px" />
            </field>
          </section>

          <section id="reportedby">
            <field attribute="dashapprovals_.approvergroup" label="Approver Group">
              <renderer type="default" params="minwidth=100px;maxwidth=100px" />
            </field>
          </section>
          <section id="extrafields">
            <field attribute="dashapprovals_.wonum" hidden="true"/>
          </section>

          <properties>
            <property key="list.defaultorderby" value="schedstart asc"/>

          </properties>

        </schema>

        <!--Used for viewAll click from Dashboard with SR union-->
        <list title="Change Grid" unionschema="srforchange.changeunionschema" parentschema="parentgrid">
          <section id="srId">
            <field attribute="hlagchangesummary" label="Summary">
              <renderer type="default" params="minwidth=81px;maxwidth=81px;excelwidth=50;wordwrap=break-word" />
            </field>
            <field attribute="hlagchangeticketid" label="SR ID">
              <renderer type="default" params="minwidth=80px;maxwidth=80px" />
            </field>
          </section>
          <section id="reportedby">
            <field attribute="hlagreportedby" label="Reported By">
              <renderer type="default" params="minwidth=100px;maxwidth=100px" />
            </field>
          </section>
          <properties>
            <property key="list.click.service" value="changeservice.opendetail"/>
            <property key="list.querygeneratorservice" value="GenerateUnionQuery"/>
          </properties>
        </list>

        <schema id="changeApprovalsDashboardList" stereotype="list">
          <field attribute="workorderid" hidden="true" />
          <field attribute="wonum" label="Change ID">
            <renderer type="default" params="minwidth=80px;maxwidth=80px" />
          </field>
          <field attribute="description" label="Summary">
            <renderer type="default" params="minwidth=100px;maxwidth=100px;excelwidth=50" />
          </field>
          <field attribute="ci_.ciname" label="Asset">
            <renderer type="default" params="minwidth=120px;maxwidth=120px;excelwidth=30" />
          </field>
          <field attribute="wopriority" label="Priority">
            <renderer type="default" params="minwidth=60px;maxwidth=60px" />
          </field>
          <field attribute="schedstart" label="Scheduled Start">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm;minwidth=100px;maxwidth=100px;showtime=false" />
          </field>
          <field attribute="hlagpluspcustomer" label="Site ID">
            <renderer type="default" params="minwidth=80px;maxwidth=80px" />
          </field>
          <field attribute="dashapprovals_.approvergroup" label="Approver Group">
            <renderer type="default" params="minwidth=80px;maxwidth=80px" />
          </field>
          <!--<field attribute="dashapprovals_apprwo_.recordkey" hidden="true"/>-->
          <field attribute="status" label="Status">
            <renderer type="default" params="minwidth=100px;maxwidth=100px" />
          </field>

          <properties>
            <property key="list.click.mode" value="output"/>
            <property key="list.click.popup" value="browserwindow"/>
          </properties>
        </schema>

        <detail id="detail" mode="output" title="Change Details">
          <field attribute="workorderid" hidden="true" />
          <field attribute="wonum" label="Change Id"/>
          <field attribute="ownergroup" label="Owner Group"/>
          <field attribute="location" label="Location"/>
          <field attribute="pluspcustomer" hidden="true"/>
          <field attribute="hlagpluspcustomer" label="Site"/>
          <field attribute="description" label="Summary"/>
          <field attribute="hlagreportedby" label="Reported By"/>
          <field attribute="classstructureid" label="Classification"/>
          <field attribute="cinum" hidden="true"/>
          <field attribute="ci_.ciname" label="Asset"/>
          <field attribute="sr_asset_.serialnum" label="Serial Number"/>
          <field attribute="pmchgapprovallevel" hidden="true"/>
          <field attribute="worktype" label="Category"/>
          <field attribute="pmcomimpact" label="Impact"/>
          <field attribute="pmcomurgency" label="Urgency"/>
          <field attribute="reasonforchange" label="Reason"/>
          <field attribute="reasonforchange_.ldtext" label="Reason Details"/>
          <field attribute="itdchgbusimpct" label="Business Impact"/>
          <field attribute="verification" label="Verification"/>
          <field attribute="itdbckoutdur" label="Backout Duration">
            <renderer type="default" params="formatter=doubleToTime"/>
          </field>
          <field attribute="backoutplan" label="Back Out Plan"/>
          <field attribute="backoutplan_.ldtext" label="Back Out Plan Detail"/>
          <field attribute="itdchgpretstdtl" label="Pretest"/>
          <field attribute="pretestdetail_.ldtext" label="Pretest Details"/>
          <field attribute="schedstart" label="Scheduled Start Date">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
          </field>
          <field attribute="schedfinish" label="Scheduled Finish Date">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
          </field>
          <field attribute="targstartdate" label="Target Start Date">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
          </field>
          <field attribute="targcompdate" label="Target Finish Date">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
          </field>
          <field attribute="itdcreatedate" label="CR Activation Date/Time">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
          </field>
          <field attribute="statusdate" hidden="true"/>
          <field attribute="wopriority" label="Priority"/>
          <field attribute="status" label="Status"/>
          <field attribute="longdescription_.ldtext" label="Remarks"/>
          <field attribute="itdclosurecode" label="Implementation Result"/>

          <composition relationship="relatedrecord" label="Related Records" inline="true" >
            <renderer type="custom" params="resourcepath=/Content/Templates/hapag/commaseparatedcomposition.html;attributeToDisplay=relatedreckey;onClickService=relatedrecordservice.opendetail;showaslink=true" />
          </composition>

          <composition relationship="worklog" label="Work Log" printschema="printschema" >
            <collectionproperties allowcreation="true" prefilterfunction="AppendRelatedRecordWCToWorklog"/>
          </composition>
          <composition relationship="woactivity" label="Job Plan" detailschema="detail" printschema="printschema">
            <collectionproperties allowcreation="false" orderbyfield="wosequence asc, workorderid asc"/>
          </composition>
          <composition relationship="approvals" label="Approvals" detailschema="" printschema="printschema">
            <collectionproperties allowcreation="false"/>
          </composition>

          <!-- need to force query!-->
          <composition relationship="apprwftransaction" label="Approvals" hidden="true">
            <collectionproperties allowcreation="false" orderbyfield="transdate desc"/>
          </composition>
          <composition relationship="wfassignment" label="Approvals" hidden="true"/>
          <composition relationship="wostatus" label="WoStatus" hidden="true">
            <collectionproperties orderbyfield="changedate desc"/>
          </composition>

          <composition relationship="attachment" label="Attachments" printschema="detailPrint">
            <collectionproperties allowcreation="true"/>
          </composition>

          <commands>
            <command id="duplicate" label="Duplicate" method="duplicate" service="changeservice" parameters="schema,datamap" />
          </commands>
        </detail>
      </schemas>
    </application>

    <application entity="imac" name="imac" title="Imac" service="imacservice">
      <properties>
        <property key="oncrudsaveevent.action" value="Get"/>
        <!--<property key="oncrudsaveevent.controller" value="HapagHome"/>-->
        <property key="addassociationlabels" value="true"/>
        <property key="associationstoprefetch" value="#all"/>
      </properties>
      <components>
        <componentdisplayable id="usage">

          <optionfield attribute="usage" label="Usage" default="STANDARD" >
            <renderer type="combo" params="length=half"/>
            <option label="EDUCATION" value="EDUCATION"/>
            <option label="POOL" value="POOL"/>
            <option label="MEETING" value="MEETING"/>
            <option label="MOB MARITME" value="MOB MARITME"/>
            <option label="MOBILE HOME" value="MOBILE HOME"/>
            <option label="NON-STANDARD" value="NON-STANDARD"/>
            <option label="SPARE UNIT" value="SPARE UNIT"/>
            <option label="SPECIAL FUNC" value="SPECIAL FUNC"/>
            <option label="STANDARD" value="STANDARD"/>
            <option label="STAND ALONE" value="STAND ALONE"/>
            <option label="TEST" value="TEST"/>
            <option label="TRAINEE" value="TRAINEE"/>
            <event type="afterchange" service="imacservice" method="afterUsageChange"/>
          </optionfield>
          <field label="" attribute="" default="The corresponding User relation will be removed." readonly="true" qualifier="nodescription" showexpression="@usage != null &amp;&amp; @usage.equalsAny('EDUCATION','POOL', 'MEETING')">
            <renderer type="label" params="color=red"/>
          </field>


        </componentdisplayable>

        <componentdisplayable id="ibmtechnician">
          <optionfield attribute="ibmtechnician" label="IBM technician – Yes/No" default="no">
            <renderer type="combo" params="length=quarter"/>
            <option label="yes" value="yes"/>
            <option label="no" value="no"/>
          </optionfield>
        </componentdisplayable>

        <componentdisplayable id="installationdate">
          <field attribute="installationdate" label="Installation date">
            <renderer type="datetime" params="format=dd/MM/yyyy;showtime=false;allowpast=false"/>
          </field>
        </componentdisplayable>

        <componentdisplayable id="lantype">
          <optionfield attribute="lantype" label="LAN Type (printers only)" >
            <option label="Lan" value="lan"/>
            <option label="Lan/Host/Papyrus" value="lan/host/papyrus"/>
          </optionfield>
        </componentdisplayable>

        <componentdisplayable id="assetstatus">
          <optionfield attribute="" required="true" >
            <option label="150 Idle" value="150 Idle"/>
            <option label="320 Lost" value="320 Lost"/>
            <option label="360 Stolen" value="360 Stolen"/>
            <option label="400 Released" value="400 Released"/>
          </optionfield>
        </componentdisplayable>

        <componentdisplayable id="lanattributessectionreplaceremove">
          <section showexpression="@fromlocation!=null">
            <header displacement="sameline" label="Service Attributes"/>
            <field attribute="#subtitle" label="Attribute" default="Value" readonly="true" qualifier="nodescription">
              <renderer type="label" params="color=blue;"/>
            </field>
            <field attribute="titleoforder" label="Title of Order" qualifier="nodescription" required="true">
              <renderer type="default" params="maxlength=85" />
            </field>

            <reference id="lantype"/>
            <reference id="ibmtechnician"/>
            <field attribute="installationdate" label="Installation date">
              <renderer type="datetime" params="format=dd/MM/yyyy;showtime=false;allowpast=false"/>
            </field>

            <field attribute="remarks" label="Remarks">
              <renderer type="textarea"/>
            </field>
          </section>
        </componentdisplayable>

        <componentdisplayable id="lanattributessection">

          <section>
            <header displacement="sameline" label="Service Attributes"/>
            <field attribute="#subtitle" label="Attribute" default="Value" readonly="true" qualifier="nodescription">
              <renderer type="label" params="color=blue;"/>
            </field>
            <field attribute="titleoforder" label="Title of Order" qualifier="nodescription" required="true">
              <renderer type="default" params="maxlength=85" />
            </field>

            <optionfield attribute="paperformat" label="Paper Format">
              <option value="A0" label="A0"/>
              <option value="A1" label="A1"/>
              <option value="A2" label="A2"/>
              <option value="A3" label="A3"/>
              <option value="A4" label="A4"/>
              <option value="Other" label="Other"/>
            </optionfield>

            <reference id="lantype"/>

            <optionfield attribute="paperorientation" label="Paper Orientation">
              <option label="landscape" value="landscape"/>
              <option label="portrait" value="portrait"/>
            </optionfield>

            <reference id="ibmtechnician"/>

            <field attribute="dhcpaddress" label="DHCP Address"/>

            <reference id="installationdate"/>

            <field attribute="refprinter" label="Reference Printer"/>

            <field attribute="remarks" label="Remarks">
              <renderer type="textarea"/>
            </field>
            <reference id="usage"/>
          </section>
        </componentdisplayable>

        <componentdisplayable id="showremarktext">

          <field label="" attribute="" default="Please enter detailed Sub-Component information in the Remarks box." readonly="true" qualifier="nodescription">
            <renderer type="label"/>
          </field>
        </componentdisplayable>

        <componentdisplayable id="itccostcentersection">
            <section showexpression="@prop:showcostcenter=false">
              <reference id="itccostcenter"  showexpression="@toitc!=null" />
            </section>
        </componentdisplayable>
          
        <componentdisplayable id="baseattributesection">

          <section parameters="detaildescription=Service Attributes">
            <header displacement="sameline" label="Service Attributes"/>
            <field attribute="#subtitle" label="Attribute" default="Value" readonly="true" qualifier="nodescription">
              <renderer type="label" params="color=blue;"/>
            </field>
            <field attribute="titleoforder" label="Title of Order" qualifier="nodescription" required="true">
              <renderer type="default" params="maxlength=85" />
            </field>


            <reference id="ibmtechnician" showexpression="@prop:showibmtechnician=true"/>

            <reference id="installationdate" showexpression="@prop:showinstallationdate=true"/>

            <reference id="lantype" showexpression="@prop:showlantype=false"/>
            <reference id="showremarktext" showexpression="@prop:showremarktext=false"/>

            <field attribute="remarks" label="Remarks">
              <renderer type="textarea"/>
            </field>

            <reference id="usage" showexpression="@prop:showusage=true"/>
            <reference id="itccostcentersection" showexpression="@prop:showcostcenter=false"/>

            <reference id="macaddress" showexpression="@prop:showmacaddress=false"/>
            <reference id="macaddressOriginal" showexpression="@prop:macaddressOriginal=false"/>
          </section>

        </componentdisplayable>

        <componentdisplayable id="fromlocation">
          <optionfield label="Location" attribute="fromlocation" required="true" providerattribute="hlagUserLocations">
            <renderer type="autocompleteclient" params="length=half"/>
          </optionfield>
        </componentdisplayable>

        <componentdisplayable id="servicelabel">
          <field attribute="#service" label="Service" default="@prop:servicename" readonly="true" qualifier="nodescription">
            <renderer type="label" />
          </field>
        </componentdisplayable>

        <componentdisplayable id="costcenter">
          <optionfield label="Cost Center" attribute="costcenter" required="true" dependantfields="asset,fromlocation"
									providerattribute="costCentersByPrimaryUser" showexpression="@asset!=null" qualifier="costcenterOriginal_new" />
          <field hidden="true" attribute="costcenterOriginal" label="Cost Center"/>
        </componentdisplayable>

        <componentdisplayable id="itccostcenter">
          <optionfield label="Cost Center" attribute="costcenter" required="true" dependantfields="asset,toitc" 
                       providerattribute="costCentersByToItc" qualifier="costcenterOriginal_new"/>
        <field hidden="true" attribute="costcenterOriginal" label="Cost Center"/>
        </componentdisplayable>


        <componentdisplayable id="readonlycostcenter">
          <field label="Cost Center" attribute="costcenter" readonly="true" showexpression="@asset!=null" />
          <!--          <field label="Cost Center" attribute="asset_.assetglaccount_.displaycostcenter" readonly="true" showexpression="@asset!=null" />-->
        </componentdisplayable>

        <componentdisplayable id="updateasset">
          <association target="asset" dependantfields="fromlocation" label="Asset" labelfield="asset_.hlagdescription2" required="true"
								  extraprojectionvalues="primaryuser_.personid,primaryuser_person_.hlagdisplayname,aucisowner_person_.hlagdisplayname,aucisowner_person_.personid,
                  classification,location_.description,assetglaccount_.glaccount,assetglaccount_.displaycostcenter,status,assetid,description,serialnum,item_.description,
                  item_.itdmachtype,item_.itdmodel,installdate,assettag,assetnum,computername,location,assetspeccomment_.alnvalue,usage">
            <renderer type="autocompleteclient" params="minLength=3;opendetails=true;idtopendetails=asset_.assetid"/>
            <dataprovider prefilterfunction="FilterAssetByHlagLocation"/>
            <event type="afterchange" service="imacservice" method="afterChangeAsset"/>
            <event type="beforechange" service="imacservice" method="beforeChangeAsset"/>
          </association>
          <field hidden="true" attribute="asset_.status"/>
          <field hidden="true" attribute="asset_.location"/>
          <field hidden="true" attribute="asset_.aucisowner_.person_.personid"/>
        </componentdisplayable>

        <componentdisplayable id="mainasset">
          <association
                 target="asset" dependantfields="fromlocation" label="Asset" labelfield="asset_.hlagdescription2" required="true"
                                      extraprojectionvalues="assetspecmacaddress_.alnvalue, usage, assetid, primaryuser_.personid, primaryuser_.hlagdisplayname, primaryuser_person_.displayname,primaryuser_person_.hlagdisplayname
                     ,classstructureid,location,location_.description,aucisowner_person_.hlagdisplayname,aucisowner_person_.personid,pluspcustomer,assetglaccount_.displaycostcenter,assetglaccount_.glaccount,status">
            <renderer type="autocompleteclient" params="minLength=3;opendetails=true;idtopendetails=asset_.assetid"/>
            <event type="afterchange" service="imacservice" method="afterChangeAsset"/>
            <dataprovider prefilterfunction="FilterAssetByHlagLocation"/>
          </association>
          <field hidden="true" attribute="asset_.classstructureid"/>
          <field hidden="true" attribute="asset_.status"/>
          <field hidden="true" attribute="asset_.location"/>
          <field hidden="true" attribute="asset_.aucisowner_.person_.personid"/>
        </componentdisplayable>

        <componentdisplayable id="nchildasset">
          <association dependantfields="fromlocation,asset" label="Child Asset" labelfield="childasset_.hlagdescription2" target="childasset" extraprojectionvalues="pluspcustomer,location">
            <renderer type="combodropdown" params="showvaluesbelow=true;custombuttontext=Asset" />
            <dataprovider prefilterfunction="FilterAssetByHlagLocationAndParentAsset"/>
          </association>
        </componentdisplayable>

        <componentdisplayable id="childasset">
          <association dependantfields="fromlocation,asset" label="Child Asset" labelfield="childasset_.hlagdescription2" target="childasset"
													 extraprojectionvalues="pluspcustomer,location">
            <renderer type="autocompleteclient" params="minLength=3;"/>
            <dataprovider prefilterfunction="FilterAssetByHlagLocationAndParentAsset"/>
          </association>
        </componentdisplayable>

        <componentdisplayable id="inputaccel">
          <optionfield attribute="inputaccel" label="Input Accel - Yes/No">
            <!--HAP-672 Revised the order of yes/no-->
            <option label="no" value="no"/>
            <option label="yes" value="yes"/>
          </optionfield>
        </componentdisplayable>

        <componentdisplayable id="macaddress">
          <field attribute="macaddress" label="Mac Address" required="true" qualifier="macaddressOriginal_new">
            <renderer type="default" params="maxlength=85" />
          </field>
        </componentdisplayable>

        <componentdisplayable id="macaddressOriginal">
          <field hidden="true" attribute="macaddressOriginal" label="Mac Address"/>
        </componentdisplayable>

        <componentdisplayable id="defaultuserid">
          <association label="User ID" target="userid" labelfield="person_.hlagdisplayname"
                       showexpression="@asset!=null &amp;&amp; @usage != null &amp;&amp; !@usage.equalsAny('EDUCATION','POOL', 'MEETING')"
                       required="@usage != null &amp;&amp; @usage.equalsAny('STANDARD','MOBILE HOME')">
            <dataprovider prefilterfunction="FilterUserId" />
            <renderer type="autocompleteserver"/>
          </association>

          <field attribute="#newuserid" label="" hidden="true" qualifier="userid_new"></field>

        </componentdisplayable>

        <componentdisplayable id="readonlyuserid">
          <field label="User ID" attribute="userid" readonly="true" showexpression="@asset!=null" />
        </componentdisplayable>

        <componentdisplayable id="currentitc">
          <field label="Current ITC" attribute="currentitc" readonly="true" showexpression="@asset!=null" />
        </componentdisplayable>

        <componentdisplayable id="specifylocationfrom">
          <section id="specifylocationfrom" showexpression="@asset!=null" parameters="detaildescription=Location">
            <header label="@prop:fromlocationlabel=Location" displacement="sameline"/>

            <field hidden="true" attribute="buildingOriginal" label="Building"/>
            <field hidden="true" attribute="floorOriginal" label="Floor"/>
            <field hidden="true" attribute="roomOriginal" label="Room"/>


            <optionfield label="Building" attribute="building" providerattribute="buildingFromLocation" dependantfields="fromlocation" qualifier="buildingOriginal_new"/>
            <optionfield label="Floor" attribute="floor" providerattribute="floorFromLocation" dependantfields="building" qualifier="floorOriginal_new"/>
            <optionfield label="Room" attribute="room" providerattribute="roomFromLocation" dependantfields="floor" qualifier="roomOriginal_new"/>
          </section>
        </componentdisplayable>

        <componentdisplayable id="specifylocationfrom2">
          <section id="specifylocationfrom2" showexpression="@asset!=null" parameters="detaildescription=Location">
            <header label="@prop:fromlocationlabel=Location" displacement="sameline"/>

            <field hidden="true" attribute="building2Original" label="Building"/>
            <field hidden="true" attribute="floor2Original" label="Floor"/>
            <field hidden="true" attribute="room2Original" label="Room"/>


            <optionfield label="Building" attribute="building2" providerattribute="2buildingFromLocation" dependantfields="fromlocation" qualifier="building2Original_new"/>
            <optionfield label="Floor" attribute="floor2" providerattribute="2floorFromLocation" dependantfields="building2" qualifier="floor2Original_new"/>
            <optionfield label="Room" attribute="room2" providerattribute="2roomFromLocation" dependantfields="floor2" qualifier="room2Original_new"/>
          </section>
        </componentdisplayable>

        <componentdisplayable id="specifylocationto">
          <section id="specifylocationto" showexpression="@asset!=null" parameters="detaildescription=Location">
            <header label="@prop:tolocationlabel=specify location" displacement="sameline"/>

            <field hidden="true" attribute="buildingOriginal" label="Building"/>
            <field hidden="true" attribute="floorOriginal" label="Floor"/>
            <field hidden="true" attribute="roomOriginal" label="Room"/>

            <optionfield label="Building" attribute="building" providerattribute="buildingToLocation" dependantfields="toitc" qualifier="buildingOriginal_new"/>
            <optionfield label="Floor" attribute="floor" providerattribute="floorToLocation" dependantfields="building" qualifier="floorOriginal_new"/>
            <optionfield label="Room" attribute="room" providerattribute="roomToLocation" dependantfields="floor" qualifier="roomOriginal_new"/>
          </section>
        </componentdisplayable>

        <componentdisplayable id="R017RequiredFields">
          <field attribute="asset_.assetnum" hidden="true"/>
          <field attribute="affectedperson_.personid" hidden="true"/>
          <field attribute="affectedperson_personglaccount_.glaccount" hidden="true"/>
          <field attribute="asset_assetglaccount_.glaccount" hidden="true"/>
        </componentdisplayable>
      </components>
      <schemas>

        <list title="IMAC Grid" id="list">
          <field attribute="ticketid" label="IMAC #">
            <renderer type="default" params="minwidth=80px;maxwidth=80px" />
          </field>
          <!-- for the search to work  -->
          <field attribute="description" hidden="true"/>
          <field attribute="hlagsummary" label="Title">
            <renderer type="default" params="excelwidth=50;minwidth=237px;maxwidth=237px" />
          </field>
          <field attribute="hlagservice" label="Service">
            <renderer type="default" params="minwidth=120px;maxwidth=120px;excelwidth=20" />
          </field>
          <field attribute="reportdate" label="Date &amp; Time">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm;minwidth=100px;maxwidth=100px;showtime=true" />
          </field>
          <field attribute="hlagpluspcustomer" label="Location">
            <renderer type="default" params="minwidth=80px;maxwidth=80px" />
          </field>
          <field attribute="hlagaffectedperson" label="Requester">
            <renderer type="default" params="minwidth=80px;maxwidth=80px" />
          </field>
          <field attribute="status" hidden="true" />
          <field attribute="hlagimacstatus" label="Status">
            <renderer type="default" params="minwidth=100px;maxwidth=100px;sortattribute=status" />
          </field>

          <field attribute="classstructure_.description" hidden="true"/>

          <reference id="R017RequiredFields"/>
          <field attribute="#color" label="">
            <renderer type="color" params="grid=woactivity;column=status"/>
          </field>

          <properties>
            <property key="list.advancedfilter.allowtoggle" value="false"/>
            <property key="list.advancedfilter.showsearchicon" value="false"/>
          </properties>
        </list>

        <detail id="detail" mode="output" title="Request Details">
          <field attribute="asset_assetglaccount_.glaccount" hidden="true"/>

          <field attribute="ticketuid" hidden="true"/>
          <field attribute="ticketid" label="IMAC #"/>
          <field attribute="hlagsummary" label="Description"/>
          <field attribute="description" hidden="true"/>
          <field attribute="hlagservice" label="Service" />
          <field label="Reported Date" attribute="reportdate" >
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
          </field>
          <field attribute="status" label="Status"/>
          <field attribute="classificationid" hidden="true"/>
          <field attribute="assetnum" hidden="true"/>
          <field attribute="asset_.description" hidden="true" />
          <field attribute="asset_.serialnum" hidden="true" />
          <field attribute="asset_.hlagdescription2" label="Asset"/>
          <field attribute="longdescription_.ldtext" label="Service Attributes"/>
          <field attribute="asset_location_.description" label="Location"/>
          <field attribute="asset_aucisowner_person_.hlagdisplayname" label="User ID"/>
          <field attribute="hlagaffectedperson" label="Reported By"/>
          <field attribute="hlagreportedby" label="On Behalf Of"/>
          <field attribute="asset_assetglaccount_.displaycostcenter" label="Cost Center"/>

          <field attribute="classstructure_.description" hidden="true"/>

          <composition relationship="worklog" label="Work Log" printschema="printschema" >
            <collectionproperties allowcreation="true" prefilterfunction="AppendRelatedRecordWCToWorklog"/>
          </composition>
          <composition relationship="attachment" label="Attachment" printschema="detailPrint">
            <collectionproperties allowcreation="@status!='CLOSED' &amp;&amp; @status!='CAN'"/>
          </composition>
          <composition relationship="woactivity" label="Job Plan" detailschema="detail" printschema="list">
            <collectionproperties allowcreation="false" orderbyfield="wosequence asc, workorderid asc"/>
          </composition>

          <properties>
            <property key="detail.cancel.lbl" value="Close Window"/>
          </properties>
        </detail>

        <schema id="add" title="IMAC - Add Subcomponent" stereotype="detail">

          <properties>
            <property key="showusage" value="false"/>
            <property key="showremarktext" value="true"/>
            <property key="nextschema.schemaid" value="creationSummary"/>
            <property key="popup.window.headertitle" value="New IMAC Request - Add Subcomponent"/>
          </properties>

          <section id="requestdetails" parameters="detaildescription=Request Details">
            <!--            <reference id="servicelabel" properties="servicename=Add Subcomponent"/>-->
            <reference id="fromlocation"/>
            <reference id="mainasset"/>
            <reference id="childasset" showexpression="@fromlocation!=null" />
          </section>

          <reference id="baseattributesection" showexpression="@fromlocation!=null"/>

          <section id="assetattributes" parameters="detaildescription=Asset Attributes">
            <association label="Asset Attributes" target="assetattributes" labelfield="assetspec_.assetattribute_.description" dependantfields="asset"
												 extraprojectionvalues="" showexpression="@asset!=null">
              <renderer type="custom" params="application=assetspec;schemaId=assetspecIMACAddList;resourcepath=/Content/Templates/crud/association_list_input.html"/>
              <dataprovider prefilterfunction="FilterAssetSpec"/>
            </association>
          </section>

          <section id="other" parameters="detaildescription= ">
            <field label="Location" attribute="assetlocation" readonly="true" showexpression="@asset!=null" />

            <field label="User ID" attribute="userid" readonly="true"/>
            <reference id="currentitc"/>
            <field label="Usage" attribute="assetusage" readonly="true" showexpression="@asset!=null" />
            <reference id="readonlycostcenter"/>
          </section>
        </schema>

        <schema id="install" abstract="true" stereotype="detail">
          <properties>
            <property key="nextschema.schemaid" value="creationSummary"/>
            <property key="popup.window.headertitle" value="New IMAC Request - Install"/>
          </properties>

          <section id="requestdetails" parameters="detaildescription=Request Details">
            <reference id="servicelabel"/>
            <reference id="fromlocation"/>
            <reference id="mainasset" />
            <reference id="nchildasset" showexpression="@fromlocation!=null" label="Workplace Asset"/>
          </section>

          <section id="attributes" showexpression="@fromlocation!=null"/>

          <field label="Current Location" attribute="asset_.location_.description" readonly="true" showexpression="@asset!=null" />

          <reference id="specifylocationfrom"/>

          <section id="other" parameters="detaildescription= ">
            <reference id="defaultuserid"/>
            <reference id="currentitc"/>
            <reference id="costcenter"/>
          </section>
        </schema>


        <schema id="installstd" parentschema="install" title="Standard Client">
          <section id="attributes">
            <reference id="baseattributesection" showexpression="@fromlocation!=null"/>
          </section>
          <properties>
            <property key="servicename" value="Standard Client"/>
            <property key="showmacaddress" value="true"/>
            <property key="macaddressOriginal" value="true"/>
          </properties>
        </schema>

        <schema id="installlan" parentschema="install" title="Lan Printer">
          <properties>
            <property key="servicename" value="Lan Printer"/>
          </properties>
          <section id="attributes">
            <reference id="lanattributessection" showexpression="@fromlocation!=null"/>
          </section>
        </schema>

        <schema id="installother" parentschema="install" title="Other">
          <section id="attributes">
            <reference id="baseattributesection" showexpression="@fromlocation!=null"/>
          </section>
          <properties>
            <property key="servicename" value="Other"/>
          </properties>
        </schema>

        <schema id="move" title="IMAC - Move" stereotype="detail">
          <properties>
            <property key="showlantype" value="@tolocation!=null &amp;&amp; @tolocation!=@fromlocation"/>
            <property key="showibmtechnician" value="@tolocation!=null &amp;&amp; @tolocation==@fromlocation"/>
            <property key="showusage" value="false"/>
            <property key="showcostcenter" value="true"/>
            <property key="nextschema.schemaid" value="creationSummary"/>
            <property key="popup.window.headertitle" value="New IMAC Request - Move"/>
          </properties>
          <!--          <reference id="servicelabel" properties="servicename=Move"/>-->
          <section id="requestdetails" parameters="detaildescription=Request Details">
            <reference id="fromlocation"/>

            <!--this list will be fetched on the dataset-->
            <reference id="mainasset"/>
            <reference id="nchildasset"/>
            <optionfield label="to Location" attribute="tolocation" required="true" providerattribute="hlagAllLocations" qualifier="fromlocation_new" >
              <renderer type="autocompleteclient"/>
            </optionfield>
            <optionfield label="to ITC" attribute="toitc" required="true" dependantfields="tolocation" providerattribute="selectableITCsToLocation">
              <renderer type="autocompleteclient"/>
              <event type="afterchange" service="imacservice" method="toitcchanged"/>
            </optionfield>
          </section>

          <reference id="baseattributesection" showexpression="@fromlocation!=null"/>

          <reference id="specifylocationTo" showexpression="@toitc!=null &amp;&amp; @asset!=null &amp;&amp; @asset_.primaryuser_.personid == @toitc"/>

          <section id="other" parameters="detaildescription= " showexpression="@toitc!=null &amp;&amp; @asset_.primaryuser_.personid == @toitc">


            <association label="User" target="userid" labelfield="person_.hlagdisplayname" showexpression="@asset!=null &amp;&amp; @usage != null &amp;&amp; !@usage.equalsAny('EDUCATION','POOL', 'MEETING')" required="@usage != null &amp;&amp; @usage.equalsAny('STANDARD','MOBILE HOME')">
              <dataprovider prefilterfunction="FilterUserId" />
              <renderer type="autocompleteserver"/>
            </association>
            <field attribute="#newuserid" label="" hidden="true" qualifier="userid_new"></field>
            <!--            <field label="User" attribute="asset_.primaryuser_.person_.hlagdisplayname" />-->
          </section>

        </schema>

        <schema id="remove" abstract="true" stereotype="detail">
          <properties>
            <property key="nextschema.schemaid" value="creationSummary"/>
            <property key="showusage" value="false"/>
            <property key="popup.window.headertitle" value="New IMAC Request - Remove"/>
          </properties>
          <section id="requestdetails" parameters="detaildescription=Request Details">
            <reference id="servicelabel"/>
            <reference id="fromlocation"/>
            <reference id="mainasset"/>
            <reference id="nchildasset" showexpression="@fromlocation!=null"/>
          </section>

          <section id="attributes" />

          <section id="assetdata" parameters="detaildescription=Asset Data">

            <reference id="assetstatus" attribute="parentassetstatus" label="Parent Asset Status" showexpression="@asset!=null"/>

            <reference id="specifylocationfrom" properties="fromlocationlabel=Parent Asset Location" showexpression="@asset!=null" />
          </section>
          <section id="childassetinfo" parameters="detaildescription=Child Asset Data" showexpression="@childasset!=null">
            <header displacement="ontop" params="color=blue;font-weight=bold;"
											label=" If more than one child asset is selected and status or destination are different, please use remark field for detailed explanations." />

            <reference id="assetstatus" attribute="childassetstatus" label="Child Asset Status" />

            <reference id="specifylocationfrom2" properties="fromlocationlabel=Child Asset Location" showexpression="@childasset!=null"/>

          </section>

          <section parameters="detaildescription= ">
            <reference id="currentitc"/>
            <reference id="readonlycostcenter"/>
          </section>

        </schema>

        <schema id="removestd" title="Standard Client" parentschema="remove">
          <properties>
            <property key="servicename" value="Standard Client"/>
          </properties>
          <section id="attributes">
            <reference id="baseattributesection" showexpression="@fromlocation!=null"/>
          </section>

        </schema>

        <schema id="removelan" parentschema="remove" title="Lan Printer">
          <properties>
            <property key="servicename" value="Lan Printer"/>
          </properties>

          <section id="attributes" parameters="detaildescription=Service Attributes">
            <reference id="lanattributessectionreplaceremove"/>
          </section>
        </schema>

        <schema id="removeother" title="Other" parentschema="remove">
          <properties>
            <property key="servicename" value="Other"/>
            <property key="showibmtechnician" value="false"/>
          </properties>
          <section id="attributes">
            <reference id="baseattributesection" showexpression="@fromlocation!=null"/>
          </section>
        </schema>



        <schema id="replace" abstract="true" stereotype="detail">
          <properties>
            <property key="nextschema.schemaid" value="creationSummary"/>
            <property key="popup.window.headertitle" value="New IMAC Request - Replace"/>
          </properties>
          <section id="requestdetails" parameters="detaildescription=Request Details">
            <reference id="servicelabel"/>
            <reference id="fromlocation"/>
            <reference id="mainasset"/>
            <association dependantfields="fromlocation,asset" label="Old Child Asset" labelfield="childasset_.hlagdescription2" target="childasset"
											   extraprojectionvalues="location">
              <renderer type="combodropdown" />
              <dataprovider prefilterfunction="FilterAssetByHlagLocationAndParentAsset"/>
            </association>

            <association dependantfields="fromlocation" label="New Asset" labelfield="2asset_.hlagdescription2" required="true" target="newasset"
																 extraprojectionvalues="assetid,location_.description">
              <renderer type="autocompleteclient" params="minLength=3;opendetails=true;idtopendetails=2asset_.assetid"/>
              <dataprovider prefilterfunction="FilterAssetByHlagLocation"/>
            </association>
            <association dependantfields="fromlocation,newasset" label="New Child Asset" labelfield="2childasset_.hlagdescription2" target="newchildasset">
              <renderer type="combodropdown" />
              <dataprovider prefilterfunction="FilterAssetByHlagLocation"/>
            </association>
          </section>

          <section id="attributes" showexpression="@fromlocation!=null"/>

          <section id="oldAsset" parameters="detaildescription=Old Asset Data">
            <reference id="assetstatus" attribute="parentassetstatus" label="Status of Old Asset"  showexpression="@asset!=null"/>
            <reference id="specifylocationfrom" properties="fromlocationlabel=Location of Old Asset" showexpression="@asset!=null"/>
          </section>

          <section id="childassetinfo" parameters="detaildescription=Old Child Asset Data">
            <header displacement="ontop" params="color=blue;font-weight=bold;"
							label=" If more than one child asset is selected and status or destination are different, please use remark field for detailed explanations." />
            <reference id="assetstatus" attribute="childassetstatus" label="Status of Old Child Asset"  showexpression="@childasset!=null"/>
            <reference id="specifylocationfrom2" properties="fromlocationlabel=Location of Child Asset" showexpression="@childasset!=null"/>
          </section>


          <field label="Location of New Asset" attribute="asset_.location_.description" readonly="true" showexpression="@newasset!=null" />

          <section id="other" parameters="detaildescription= ">
            <reference id="readonlyuserid"/>
            <reference id="currentitc"/>
            <reference id="readonlycostcenter"/>
          </section>

        </schema>

        <schema id="replacestd" parentschema="replace" title="Standard Client">
          <properties>
            <property key="servicename" value="Standard Client"/>
          </properties>
          <section id="attributes" parameters="detaildescription=Service Attributes">
            <reference id="baseattributesection" showexpression="@fromlocation!=null"/>
          </section>
        </schema>

        <schema id="replacelan" parentschema="replace" title="Lan Printer">
          <properties>
            <property key="servicename" value="Lan Printer"/>
          </properties>
          <section id="attributes" parameters="detaildescription=Service Attributes">
            <reference id="lanattributessectionreplaceremove"/>
          </section>
        </schema>

        <schema id="replaceother" parentschema="replace" title="Other">
          <properties>
            <property key="servicename" value="Other"/>
            <property key="showibmtechnician" value="false"/>
          </properties>

          <section id="service" parameters="servicename=Other"/>

          <section id="attributes" parameters="detaildescription=Service Attributes">
            <reference id="baseattributesection" showexpression="@fromlocation!=null"/>
          </section>
        </schema>



        <schema id="update" title="Update Asset Data" stereotype="detail">
          <properties>
            <property key="showinstallationdate" value="false"/>
            <property key="showibmtechnician" value="false"/>
            <property key="nextschema.schemaid" value="creationSummary"/>
            <property key="popup.window.headertitle" value="New IMAC Request - Update Asset Data"/>
            <property key="oncrudsaveevent.transformservice" value="imacservice.setcommodities"/>
          </properties>

          <section id="requestdetails" parameters="detaildescription=Request Details">
            <!--            <reference id="servicelabel" properties="servicename=Update Asset Data"/>-->
            <reference id="fromlocation"/>
            <reference id="updateasset"/>
            <optionfield label="Update Child Asset" attribute="updatechildasset" showexpression="@asset!=null">
              <renderer type="checkbox" />
              <option label="" value="update" />
            </optionfield>
          </section>

          <reference id="baseattributesection" showexpression="@fromlocation!=null"/>
          <reference id="specifylocationfrom" />

          <section id="other" parameters="detaildescription= ">
            <field attribute="originaluser"  hidden="true" label="User ID"/>
            <field attribute="#originaluser_label"  hidden="true" label="User ID" qualifier="nodescription"/>


            <association label="User ID:" target="userid" labelfield="person_.hlagdisplayname" 
                         showexpression="@asset!=null &amp;&amp; @usage != null &amp;&amp; !@usage.equalsAny('EDUCATION','POOL', 'MEETING')"
                         required="@usage != null &amp;&amp; @usage.equalsAny('STANDARD','MOBILE HOME')"
                         qualifier="originaluser_new">
              <dataprovider prefilterfunction="FilterUserId" />
              <renderer type="autocompleteserver"/>
            </association>
          </section>

          <field label="ITC" attribute="asset_.primaryuser_.personid" readonly="true" showexpression="@asset!=null" enableexpression="@buildingOriginal == null || @buildingOriginal == @building" />

          <field label="Status" attribute="asset_.status" showexpression="@asset != null &amp;&amp; @asset.status != '150 Idle'" readonly="true" >
            <renderer type="label" />
          </field>

          <reference id="assetstatus" label="Status" showexpression="@asset != null &amp;&amp; @asset.status == '150 Idle'"/>

          <section id="services" showexpression="@asset!=null" parameters="detaildescription=Services">

            <optionfield attribute="assetCommodities" label="Services" providerattribute="assetCommodities" dependantfields="asset">
              <renderer type="checkbox"/>
            </optionfield>

          </section>

          <section id="other" parameters="detaildescription= " showexpression="@asset!=null">
            <reference id="costcenter" enableexpression="@buildingOriginal == null || @buildingOriginal == @building" readonly="false"/>
          </section>
          <section id="specification" showexpression="@asset!=null" resourcepath="/Content/Templates/crud/update_section.html" parameters="detaildescription=Specifications">
            <header displacement="sameline" label="Specifications"/>
            <field attribute="asset_.computername" label="Computer Name"  readonly="true"/>
            <field attribute="asset_.serialnum" label="Serial Number" />
            <field attribute="asset_.item_.description" label="Product" />
            <field attribute="asset_.installdate" label="Install Date" />
            <field attribute="asset_.item_.itdmodel" label="Model" />
            <field attribute="asset_.item_.itdmachtype" label="Type" />
            <field attribute="asset_.assettag" label="HL Invent Number" />
            <field attribute="asset_.assetspeccomment_.alnvalue" label="Comment" readonly="true" />
          </section>


          <section id="assetattributes" parameters="detaildescription=Asset Attributes" showexpression="@asset!=null">
            <association label="Asset Attributes" target="assetattributes" labelfield="assetspec_.assetattribute_.description" dependantfields="asset"
												   extraprojectionvalues="">
              <renderer type="custom" params="application=assetspec;schemaId=assetspecIMACUpdateList;resourcepath=/Content/Templates/crud/association_list_input.html"/>
              <dataprovider prefilterfunction="FilterAssetSpec"/>
            </association>
          </section>
        </schema>


        <schema id="decommission" stereotype="detail">
          <properties>
            <property key="nextschema.schemaid" value="creationSummary"/>
            <property key="showusage" value="false"/>
            <property key="popup.window.headertitle" value="New IMAC Request - Decommission"/>
            <property key="servicename" value="Decommission"/>
            <property key="oncrudsaveevent.validationservice" value="imacservice.validatedecommission"/>
          </properties>

          <section id="requestdetails" parameters="detaildescription=Request Details">
            <reference id="servicelabel"/>
            <reference id="fromlocation"/>
            <reference id="mainasset"/>
          </section>

          <section parameters="detaildescription=Decommission Data">

            <field attribute="#decommissionreason" label="Reason for decommission" required="true">
              <renderer type="textarea"/>
            </field>

            <section id="decommissiondate" resourcepath="/Content/Templates/samelinepickers.html"
                     parameters="joinattribute=#decommissiondate;dateformat=dd/MM/yyyy;">
              <header label="Decommission Date:" displacement="sameline"/>
            </section>

            <field attribute="#decommissiondate" hidden="true" label="Decommission Date:"/>

            <section>
              <header displacement="ontop" params="color=red;" label="Please attach a disposal/resale certificate to prove that the disposal/resale has been performend in terms of HL ITC Guide paragraph &quot;Hardware Sale and Disposal&quot;."/>
              <field label="Attachment:" attribute="newattachment" required="true">
                <renderer type="upload"/>
              </field>
            </section>

          </section>


          <section parameters="detaildescription= ">
            <reference id="currentitc"/>
            <reference id="readonlycostcenter"/>
          </section>

          <section resourcepath="/Content/Templates/hapag/decomissionaccept.html" parameters="nodescription=true"/>

        </schema>





        <schema id="imacDashboardList" stereotype="list">
          <field attribute="ticketid" label="Request #" />
          <field attribute="description" label="Parent Title" />
          <field attribute="woactivity_.description" label="Summary" />
          <field attribute="" label="Owner" />
          <field attribute="woactivity_.status" label="Status" />
          <field attribute="ticketid" hidden="true" />

          <reference id="R017RequiredFields"/>

          <properties>
            <property key="list.click.mode" value="output"/>
            <property key="list.click.popup" value="browserwindow"/>
          </properties>
        </schema>

        <!--Creation Summary IMAC-->
        <schema id="creationSummary" mode="output" stereotype="detail" title="New IMAC Summary">
          <field attribute="ticketuid" hidden="true"/>
          <field label="IMAC # :" attribute="ticketid"/>
          <field label="Title :" attribute="hlagsummary" />
          <field label="Service:" attribute="hlagservice" />
          <field label="Date &amp; Time:" attribute="reportdate" >
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
          </field>
          <field label="Location :" attribute="hlagpluspcustomer" />
          <field label="Requester :" attribute="hlagaffectedperson"/>
          <field label="Details:" attribute="longdescription_.ldtext">
            <renderer type="textarea"/>
          </field>
          <field label="Status :" attribute="hlagimacstatus"/>

          <field attribute="classstructure_.description" hidden="true"/>

          <reference id="R017RequiredFields"/>
          <commands removeundeclared="true">
            <!--TODO: Redirect to IMAC Grid-->
            <command id="cancel" label="Close" stereotype="cancel" service="imacservice" method="goToImacGrid"/>
          </commands>
          <properties>
            <property key="detail.cancel.lbl" value="Close"/>
          </properties>
        </schema>

        <schema stereotype="compositionlist" id="asset_composition">
          <properties>
            <property key="detail.cancel.lbl" value="Close"/>
            <property key="expansible" value="false"/>
            <property key="list.click.service" value="imacservice.opendetail"/>
          </properties>
          <field label="TickedID" attribute="ticketid"/>
          <field label="Class" attribute="class"/>
          <field label="Description" attribute="description"/>
          <field label="Location" attribute="location"/>
          <field label="Asset" attribute="assetnum"/>
          <field label="Status" attribute="status"/>
          <field label="Date" attribute="reportdate">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm" />
          </field>
          <reference id="R017RequiredFields"/>
        </schema>

      </schemas>
    </application>

    <application entity="problem" name="problem" title="Problem">
      <schemas>
        <list>
          <field attribute="ticketuid" hidden="true"/>
          <field attribute="ticketid" label="Request#">
            <renderer type="default" params="width=80px" />
          </field>
          <field attribute="description" label="Summary">
            <renderer type="default" params="minwidth=80px;maxwidth=300px;excelwidth=50" />
          </field>
          <field attribute="asset_.description" label="Asset">
            <renderer type="default" params="minwidth=160px;excelwidth=30" />
          </field>
          <field attribute="reportdate" label="Reported Date &amp; Time">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm;minwidth=100px;showtime=true;exporttoexcel=false" />
          </field>
          <field attribute="#2reportdate" label="Reported Date" hidden="true">
            <renderer type="datetime" params="format=dd/MM/yyyy;showtime=false;exporttoexcel=true" />
          </field>
          <field attribute="#3reportdate" label="Reported Time" hidden="true">
            <renderer type="datetime" params="format=HH:mm;showtime=false;exporttoexcel=true" />
          </field>
          <field attribute="hlagpluspcustomer" label="Site Id">
            <renderer type="default" params="minwidth=80px" />
          </field>
          <field attribute="ownergroup" label="Owner Group">
            <renderer type="default" params="minwidth=80px" />
          </field>
          <field attribute="status" label="Status">
            <renderer type="default" params="minwidth=100px" />
          </field>
          <field attribute="#color" label="">
            <renderer type="color" params="grid=problem;column=status"/>
          </field>

        </list>

        <detail title="Problem Details" mode="output">
          <field attribute="ticketuid" hidden="true"/>
          <field attribute="ticketid" label="Problem Id" />
          <field attribute="description" label="Summary" />
          <field attribute="longdescription_.ldtext" label="Details" />
          <field attribute="assetnum" label="Asset" />
          <field attribute="asset_.serialnum" label="Serial Number" />
          <field attribute="hlagpluspcustomer" label="Site ID" />
          <field attribute="location_.description" label="Location" />
          <field attribute="hlagreportedby" label="Reported By" />
          <field attribute="person_.hlagdisplayname" label="Affected Person" />
          <field attribute="impact" label="Impact" />
          <field attribute="urgency" label="Urgency" />
          <field attribute="ownergroup" label="Owner Group" />
          <field attribute="status" label="Status" />
          <field attribute="reportdate" label="Reported Date">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm" />
          </field>
          <field attribute="targetfinish" label="Target Finish Date">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm" />
          </field>
          <field attribute="#closeddate" label="Closed Date">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
          </field>
          <composition relationship="relatedrecord" label="Related Records" inline="true" >
            <renderer type="custom" params="resourcepath=/Content/Templates/hapag/commaseparatedcomposition.html;attributeToDisplay=relatedreckey;onClickService=relatedrecordservice.opendetail;showaslink=true" />
          </composition>
          <composition relationship="worklog" label="Work Log" printschema="printschema">
            <collectionproperties allowcreation="@status!='CLOSED' &amp;&amp; @status!='CAN'" prefilterfunction="AppendRelatedRecordWCToWorklog"/>
          </composition>
          <tab label="Solution" id="solution">
            <field attribute="problemcode_.ldtext" label="Symptom:" >
              <renderer type="textarea"/>
            </field>
            <field attribute="fr1code_.ldtext" label="Cause:" >
              <renderer type="textarea"/>
            </field>
            <field attribute="fr2code_.ldtext" label="Resolution:" >
              <renderer type="textarea"/>
            </field>
          </tab>
          <composition relationship="attachment" label="Attachments" printschema="detailPrint">
            <collectionproperties allowcreation="@status!='CLOSED' &amp;&amp; @status!='CAN'"/>
          </composition>

        </detail>



      </schemas>
    </application>

    <application name="asset" title="Asset" entity="asset" id="00000000-0000-0000-0000-000000000001">
      <properties>
        <property key="mobile.fetchlimit" value="30"/>
        <property key="mobile.userInteractionEnabled" value="false"/>
      </properties>

      <schemas>
        <list platform="mobile">
          <field attribute="assetnum" label="Asset" qualifier="title"/>
          <field attribute="location" label="Location" qualifier="subtitle"/>
          <field attribute="vendor" label="Vendor"  qualifier="featured"/>
        </list>

        <list platform="web">
          <properties>
            <property key="list.defaultorderby" value="pluspcustomer,asset.assetnum desc"/>
          </properties>
          <field attribute="assetnum" label="" qualifier="title" hidden="true" />
          <field attribute="siteid" label="" qualifier="title" hidden="true">
            <renderer type="default"/>
          </field>
          <field label="Location Code" attribute="hlagpluspcustomer">
            <renderer type="default" params="minwidth=80px;maxwidth=80px;excelwidth=15"/>
          </field>
          <field label="User Id" attribute="aucisowner_.hlagdisplayname">
            <renderer type="default" params="minwidth=100px;maxwidth=100px;excelwidth=15"/>
          </field>
          <field label="Description" attribute="hlagdescription">
            <renderer type="default" params="minwidth=100px;maxwidth=100px;excelwidth=25"/>
          </field>
          <field label="Serial Number"  attribute="serialnum">
            <renderer type="default" params="minwidth=100px;maxwidth=100px;excelwidth=20"/>
          </field>
          <field label="Computer Name" attribute="computername">
            <renderer type="default" params="minwidth=150px;maxwidth=150px;excelwidth=20"/>
          </field>
          <field label="Usage" attribute="usage">
            <renderer type="default" params="minwidth=80px;maxwidth=80px;excelwidth=15"/>
          </field>
          <field label="Status" attribute="status">
            <renderer type="default" params="minwidth=100px;maxwidth=100px;excelwidth=15"/>
          </field>
        </list>

        <detail mode="output" title="Asset Details">

          <!-- hiddens-->
          <field attribute="parentasset_.assetid" hidden="true"/>
          <field attribute="parentasset_.hlagdescription2" hidden="true"/>
          <composition relationship="childassets" inline="true" label="" detailschema="asset_composition" hidden="true">
            <collectionproperties listschema="asset_composition" allowcreation="false" allowremoval="false" allowupdate="false"/>
          </composition>
          <field attribute="assetnum" label="" qualifier="title" hidden="true"/>
          <field attribute="siteid" label="" qualifier="title" hidden="true"/>
          <field attribute="hlagdescription2"  hidden="true"/>
          <field attribute="classstructureid"  hidden="true"/>
          <field attribute="itdextid"  hidden="true"/>
          <field attribute="pluspcustomer" hidden="true"/>

          <!-- main screen-->
          <field label="ITC" attribute="primaryuser_.hlagdisplayname"/>
          <field label="Location Information" attribute="hlagpluspcustomer" />
          <field label="Asset Details" attribute="description"/>
          <field label="Asset Status" attribute="status"/>
          <field label="Asset Serial Number" attribute="serialnum"/>
          <section id="assetremarks" resourcepath="/Content/Templates/hapag/assetremarks.html" showexpression="!ctx:InModule(['assetcontrol','assetramcontrol','purchase'])" >
            <header label="Asset Remarks" />
          </section>
          <field label="Purchase Order Number" attribute="assettrans_.ponum"/>
          <!-- ponumber -->
          <field label="Install Date" attribute="installdate">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm" />
          </field>
          <field label="Location" attribute="location_.description"/>
          <field label="Usage" attribute="usage"/>
          <composition relationship="assetloccomm" label="Services" inline="true">
            <renderer type="custom" params="resourcepath=/Content/Templates/hapag/commaseparatedcomposition.html;attributeToDisplay=commodities_.description" />
          </composition>
          <field label="Cost Center" attribute="assetglaccount_.displaycostcenter"/>
          <!-- "Parent and Children" tree view -->
          <field label="Parent and Children" attribute="#assettree">
            <renderer type="treeview" params="idField=assetid;"/>
          </field>

          <!--TODO: showexpression-->
          <section id="createoutof" resourcepath="/Content/Templates/hapag/createfromasset.html"
                   showexpression="!ctx:InModule(['assetcontrol','assetramcontrol','tom','itom','purchase']) 
                   &amp;&amp; @status != null &amp;&amp; @status.equalsAny('OPERATING','120 Active','150 Idle','010 Ordered')">
            <header label="Create New" />
          </section>


          <!-- compositions-->

          <tab label="Specification" id="specification">
            <field label="Asset" attribute="assetnum"/>
            <field label="Asset Description" attribute="description"/>
            <field label="Site" attribute="hlagpluspcustomer"/>
            <field label="Class Structure" attribute="classstructureid"/>
            <composition relationship="assetspec" inline="true" label="" detailschema="">
              <collectionproperties listschema="asset_composition" allowcreation="false" allowremoval="false" allowupdate="false"/>
            </composition>
          </tab>

          <composition relationship="assetcustodian" label="Assigned User &amp; Custodians" detailschema="" printschema="asset_composition" fetchtype="eager">
            <header displacement="ontop" label=""/>
            <collectionproperties listschema="asset_composition" allowcreation="false" allowremoval="false" allowupdate="false" />
          </composition>


          <tab label="Addresses" id="addresses">
            <section id="shipto" parameters="padding-left=80px;">
              <header label="Ship To Address" params="margin-left=-100px" displacement="ontop"/>
              <section id="shiptopaddress" orientation="horizontal">
                <header label="Address" displacement="sameline"/>
                <field label="" attribute="location_.shiptoaddresscode">
                  <renderer type="default" params="width=33%"/>
                </field>
                <field label="" attribute="location_shipto_.description">
                  <renderer type="default" params="width=67%"/>
                </field>
              </section>
              <field label="Street" attribute="location_shipto_.streetaddress"/>
              <section id="shiptopaddress2" orientation="horizontal">
                <header label="Postal Code / City" displacement="sameline"/>
                <field label="" attribute="location_shipto_.postalcode"/>
                <field label="" attribute="location_shipto_.city"/>
              </section>
              <field label="Country" attribute="location_shipto_.country"/>
            </section>

            <section id="billto" parameters="padding-left=80px;">
              <header label="Bill To Address" params="margin-left=-100px" displacement="ontop"/>
              <section id="billtoaddress" orientation="horizontal">
                <header label="Address" displacement="sameline"/>
                <field label="" attribute="location_.billtoaddresscode">
                  <renderer type="default" params="width=33%"/>
                </field>
                <field label="" attribute="location_billto_.description">
                  <renderer type="default" params="width=67%"/>
                </field>
              </section>
              <field label="Street" attribute="location_billto_.streetaddress"/>
              <section id="billtoaddress2" orientation="horizontal">
                <header label="Postal Code / City" displacement="sameline"/>
                <field label="" attribute="location_billto_.postalcode"/>
                <field label="" attribute="location_billto_.city"/>
              </section>
              <field label="Country" attribute="location_billto_.country"/>
            </section>

            <section id="serviceaddress" parameters="padding-left=80px;">
              <header label="Service Address" params="margin-left=-100px" displacement="ontop"/>
              <section id="serviceaddress2" orientation="horizontal">
                <header label="Address" displacement="sameline"/>
                <field label="" attribute="location_.serviceaddresscode">
                  <renderer type="default" params="width=33%"/>
                </field>
                <field label="" attribute="location_serv_.description">
                  <renderer type="default" params="width=67%"/>
                </field>
              </section>
              <field label="Street" attribute="location_serv_.streetaddress"/>
              <section id="serviceaddress3" orientation="horizontal">
                <header label="Postal Code / City" displacement="sameline"/>
                <field label="" attribute="location_serv_.postalcode"/>
                <field label="" attribute="location_serv_.city"/>
              </section>
              <field label="Country" attribute="location_serv_.country"/>
            </section>

          </tab>
          <tab label="History" id="history">
            <composition relationship="ticket" inline="true" label="" detailschema="" fetchtype="eager">
              <header label="Tickets" displacement="ontop"/>
              <collectionproperties listschema="asset_composition" allowcreation="false" allowremoval="false" allowupdate="false" prefilterfunction="AppendMultiLocciTicketHistoryQuery"/>
            </composition>
            <composition relationship="imac" inline="true" label="" detailschema="" fetchtype="eager">
              <header label="IMAC" displacement="ontop"/>
              <collectionproperties listschema="asset_composition" allowcreation="false" allowremoval="false" allowupdate="false" prefilterfunction="AppendImacMultiLocciTicketHistoryQuery"/>
            </composition>
          </tab>

        </detail>

        <schema id="RI101Export" stereotype="list">
          <field label="Computer Name" attribute="computername">
            <renderer type="default" params="minwidth=80px;excelwidth=50"/>
          </field>
          <field label="ITC_Name" attribute="primaryuser_.hlagdisplayname">
            <renderer type="default" params="minwidth=80px;excelwidth=20"/>
          </field>
          <field label="Person Id" attribute="aucisowner_.hlagdisplayname">
            <renderer type="default" params="minwidth=80px;excelwidth=20"/>
          </field>
          <field label="Sub Category" attribute="classstructure_.description">
            <renderer type="default" params="minwidth=80px;excelwidth=20"/>
          </field>
          <field label="Usage" attribute="usage">
            <renderer type="default" params="minwidth=80px;excelwidth=20"/>
          </field>

        </schema>

        <schema id="RI104Export" stereotype="list">
          <field label="Computer Name" attribute="computername">
            <renderer type="default" params="minwidth=80px;excelwidth=50"/>
          </field>
          <field label="ITC_Name" attribute="primaryuser_.hlagdisplayname">
            <renderer type="default" params="minwidth=80px;excelwidth=20"/>
          </field>
          <field label="Person Id" attribute="aucisowner_.hlagdisplayname">
            <renderer type="default" params="minwidth=80px;excelwidth=20"/>
          </field>
        </schema>


        <schema id="RI102Export" stereotype="list">
          <field label="Country" attribute="location_pluspservaddr_.country">
            <renderer type="default" params="minwidth=100px;excelwidth=15"/>
          </field>
          <field label="Loc Code" attribute="hlagpluspcustomer">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="Street Address" attribute="location_pluspservaddr_.streetaddress">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="Floor" attribute="location_.floor">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="Room" attribute="location_.room">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="Computer Name" attribute="computername">
            <renderer type="default" params="minwidth=80px;excelwidth=50"/>
          </field>
          <field label="New Location" attribute="#rI102newlocation">
            <renderer type="default" params="minwidth=80px;excelwidth=50"/>
          </field>
        </schema>

        <schema id="assetlistreport" stereotype="list">
          <field label="Region" attribute="aucisnotownerexternal_person_.department">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="Country" attribute="location_pluspservaddr_.country">
            <renderer type="default" params="minwidth=100px;excelwidth=15"/>
          </field>
          <field label="Area" attribute="aucisnotownerexternal_person_.displayname">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="Location Code" attribute="hlagpluspcustomer">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="Building" attribute="hlagpluspcustomer">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="Floor" attribute="location_.floor">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="Room" attribute="location_.room">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="Location Description" attribute="location_.description">
            <renderer type="default" params="minwidth=100px;excelwidth=40"/>
          </field>
          <field label="Department" attribute="assetglaccount_.displaycostcenter">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="ITC_Name" attribute="primaryuser_.hlagdisplayname">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="User Id" attribute="aucisowner_.hlagdisplayname">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="Computer Name" attribute="computername">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="Category" attribute="classstructure_category_.description">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="Sub Category" attribute="classstructure_.description">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="Manufacturer" attribute="item_invvendor_.manufacturer">
            <renderer type="default" params="minwidth=80px;excelwidth=20"/>
          </field>
          <field label="Product" attribute="hlagdescription">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="Model" attribute="item_.itdmodel">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="Type" attribute="itdmachtype">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="Serial Number"  attribute="serialnum">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="NO_ID" attribute="noid">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="IBM Asset Num" attribute="assetnum">
            <renderer type="default" params="minwidth=80px;excelwidth=20"/>
          </field>
          <field label="HL Invent Num" attribute="itdalttag">
            <renderer type="default" params="minwidth=80px;excelwidth=20"/>
          </field>
          <field label="Install Date" attribute="installdate">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="EOS_Date" attribute="assetspeceosdate_.alnvalue">
            <renderer type="default" params="minwidth=100px;excelwidth=15"/>
          </field>
          <field label="Billable" attribute="warrantyasset_warrantyview_.description">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>

          <field label="Owned by" attribute="alclistreport_.siteid" hidden="true"/>

          <field label="Owned by" attribute="ownedby">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="Usage" attribute="usage">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="Status" attribute="status">
            <renderer type="default" params="minwidth=100px;excelwidth=15"/>
          </field>
          <field label="SWD" attribute="hlagswd">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="Scan Client" attribute="hlagscanclient">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="Comment" attribute="assetspeccomment_.alnvalue">
            <renderer type="default" params="minwidth=100px;excelwidth=40"/>
          </field>
          <field label="IP Address" attribute="assetspecipaddress_.alnvalue">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>
          <field label="Mac Address" attribute="assetspecmacaddress_.alnvalue">
            <renderer type="default" params="minwidth=80px;excelwidth=15"/>
          </field>

          <field attribute="description" hidden="true" />
          <field attribute="location_.serviceaddresscode" hidden="true" />
          <field attribute="pluspcustomer" hidden="true" />
          <field attribute="glaccount" hidden="true" />
          <field attribute="assetglaccount_.accountname" hidden="true" />
          <field attribute="classstructure_.classificationid" hidden="true" />
          <field attribute="item_.itemnum" hidden="true"/>
          <field attribute="parent" hidden="true" />
          <field attribute="companies_.company" hidden="true" />
          <field attribute="assetloccommswd_.assetnum" hidden="true" />
          <field attribute="assetloccommscanclient_.assetnum" hidden="true" />

          <!--					<field attribute="assetloccommownedby_.assetnum" hidden="true" />-->
          <!--					<field attribute="assetloccommownedby_commodities_.description" hidden="true"/>-->

        </schema>

        <schema id="categories" stereotype="list">
          <field attribute="assetid" hidden="true"/>
          <field label="Status" attribute="status" />

          <field label="Category" attribute="assetcategory" />
          <field attribute="classstructure_category_.description" hidden="true" />

          <field label="Region" attribute="assetregion" />
          <field attribute="aucisnotowner_person_.department" hidden="true" />

          <field label="Area" attribute="assetarea" />
          <field attribute="aucisnotowner_person_.displayname" hidden="true" />
        </schema>

        <schema id="updateassetdata" stereotype="compositiondetail">
          <field attribute="assetnum" label="" qualifier="title" hidden="true"/>
          <field attribute="siteid" label="" qualifier="title" hidden="true"/>
          <field label="ITC" attribute="primaryuser_.personid"/>
          <field label="Location Information" attribute="hlagpluspcustomer" />
          <field label="Asset Details" attribute="description"/>
          <field label="Asset Status" attribute="status"/>
        </schema>
      </schemas>
    </application>

    <application name="parentasset" title="" entity="asset">
      <schemas>
        <schema stereotype="compositiondetail" id="asset_composition">
          <field label="Asset Num" attribute="assetnum"/>
          <field label="Description" attribute="description"/>
          <field label="Serial Number" attribute="serialnum"/>
          <field label="Parent" attribute="parent"/>
          <field hidden="true" attribute="hlagdescription2"/>
        </schema>
      </schemas>
    </application>

    <application name="childassets" title="" entity="asset">
      <schemas>
        <schema stereotype="compositionlist" id="asset_composition">
          <field label="Asset Num" attribute="assetnum"/>
          <field label="Description" attribute="description"/>
          <field label="Serial Number" attribute="serialnum"/>
          <field label="Parent" attribute="parent"/>
          <field label="Description2" attribute="hlagdescription2"/>
        </schema>
      </schemas>
    </application>

    <application name="assetspec" title="" entity="assetspec">
      <schemas>
        <schema stereotype="compositionlist" id="asset_composition">
          <properties>
            <property key="detail.cancel.lbl" value="Close"/>
            <property key="expansible" value="false"/>
          </properties>
          <field label="Attribute" attribute="assetattrid"/>
          <field label="Description" attribute="assetattribute_.description"/>
          <field label="Data Type" attribute="assetattribute_.datatype"/>
          <field label="AlphaNumeric Value" attribute="alnvalue"/>
          <field label="Numeric Value" attribute="numvalue"/>
          <field label="Measure of Unit" attribute="measureunitid"/>
          <field label="Section" attribute="section"/>
        </schema>

        <schema stereotype="compositionlist" id="assetspec_input">
          <field label="Attribute" attribute="assetattrid"/>
          <field label="Description" attribute="assetattribute_.description"/>
          <field label="Data Type" attribute="assetattribute_.datatype"/>
          <field label="AlphaNumeric Value" attribute="alnvalue"/>
          <field label="Numeric Value" attribute="numvalue"/>
        </schema>

        <schema id="assetspecIMACAddList" stereotype="list" mode="input">
          <field attribute="assetattrid" label="Attribute" readonly="true"/>
          <field attribute="assetattribute_.description" label="Description" readonly="true"/>
          <field attribute="value" label="Current Value" readonly="true"/>
          <field attribute="measureunitid" label="Unit" readonly="true"/>
          <field attribute="#newvalue" label="Changed Value"/>
          <field attribute="assetspecid" hidden="true"/>
          <field attribute="assetnum" hidden="true"/>
          <field attribute="siteid" hidden="true"/>
        </schema>

        <schema id="assetspecIMACUpdateList" stereotype="list" mode="input">
          <field attribute="assetattribute_.description" label="" readonly="true"/>
          <field attribute="value" label="Current Value" readonly="true"/>
          <field attribute="#newvalue" label="Changed Value"/>
          <field attribute="assetspecid" hidden="true"/>
          <field attribute="assetnum" hidden="true"/>
          <field attribute="siteid" hidden="true"/>
        </schema>
      </schemas>
    </application>

    <application name="assetcustodian" entity="AssetUserCust" title="Custodian">
      <schemas>
        <schema stereotype="compositionlist" id="asset_composition">
          <properties>
            <property key="detail.cancel.lbl" value="Close"/>
            <property key="expansible" value="false"/>
          </properties>
          <field label="Person" attribute="hlagdisplayname"/>
          <field attribute="personid" hidden="true"/>
          <field label="Name" attribute="person_.displayname"/>
          <field label="Primary" attribute="isprimary">
            <renderer type="default" params="formatter=numberToBoolean"/>
          </field>
          <field label="Custodian" attribute="willbecustodian">
            <renderer type="default" params="formatter=numberToBoolean"/>
          </field>
          <field label="User" attribute="isuser">
            <renderer type="default" params="formatter=numberToBoolean"/>
          </field>
        </schema>
      </schemas>
    </application>

    <application name="newchange" entity="newchange" title="New Change Request">
      <schemas>
        <schema id="newchange" title="New Change Request" stereotype="detail">
          <properties>
            <property key="nextschema.schemaid" value="creationSummary"/>
            <property key="addassociationlabels" value="true"/>
            <property key="popup.window.titlestrategy" value="schematitle"/>
            <property key="oncrudsaveevent.validationservice" value="changeservice.validateNewForm"/>
          </properties>

          <field attribute="templateid" hidden="true" default="HLCDECHG" />
          <field attribute="reportedby" hidden="true" default="@personid" />
          <field attribute="affectedperson" hidden="true" default="@personid" />

          <field attribute="description" label="Summary" required="true"/>
          <optionfield label="Category:" attribute="category" default ="" required="true">
            <!--<option label="Select One" value=""  />-->
            <option label="CRIT" value="CRIT"/>
            <option label="MAJ" value="MAJ"/>
            <option label="MED" value="MED"/>
            <option label="MIN" value="MIN"/>
            <option label="BAU" value="BAU"/>
          </optionfield>
          <optionfield label="Impact:" attribute="impact" default="" required="true">
            <!--<option label="Select One" value=""  />-->
            <option label="Critical" value="1"/>
            <option label="High" value="2"/>
            <option label="Medium" value="3"/>
            <option label="Low" value="4"/>
            <option label="Planning" value="5"/>
          </optionfield>
          <optionfield label="Urgency:" attribute="urgency" default="" required="true">
            <!--<option label="Select One" value=""  />-->
            <option label="Critical" value="1"/>
            <option label="High" value="2"/>
            <option label="Medium" value="3"/>
            <option label="Low" value="4"/>
            <option label="Planning" value="5"/>
          </optionfield>
          <field attribute="reasonforchange" label="Reason" required="true"/>
          <field label="Reason Details:" attribute="reasondetails" enableexpression="@reasonforchange!=null&amp;&amp;@reasonforchange!=''">
            <renderer type="textarea" params="maxlength=8000" />
          </field>
          <optionfield label="Priority:" attribute="priority" default="" required="true">
            <!--<option label="Select One" value=""  />-->
            <option label="1" value="1"/>
            <option label="2" value="2"/>
            <option label="3" value="3"/>
            <option label="4" value="4"/>
          </optionfield>
          <field attribute="exceptionreason" label="Exception Reason"/>
          <optionfield label="Exception Code:" attribute="exceptioncode" default="">
            <option label="Select One" value=""/>
            <option label="Customer" value="1"/>
            <option label="Emergency" value="2"/>
            <option label="Problem" value="3"/>
            <option label="Scheduling Conflict" value="4"/>
            <option label="Urgent" value="5"/>
          </optionfield>
          <field label="Exception Details:" attribute="exceptiondetails" enableexpression="@exceptioncode!=null &amp;&amp;@exceptioncode!='Select One'&amp;&amp;@exceptioncode!=''">
            <renderer type="textarea" params="maxlength=8000" />
          </field>
          <field attribute="targstartdate" default="@currentdatetime" hidden="true" />
          <section id="targStartDate" resourcepath="/Content/Templates/samelinepickers.html" parameters="joinattribute=targstartdate;default=@currentdatetime;dateformat=dd/MM/yyyy;">
            <header label="Target Start Date:" displacement="sameline"/>
          </section>
          <field attribute="targcompdate" default="@currentdatetime" hidden="true" />
          <section id="targCompDate" resourcepath="/Content/Templates/samelinepickers.html" parameters="joinattribute=targcompdate;default=@currentdatetime;dateformat=dd/MM/yyyy">
            <header label="Target Finish Date:" displacement="sameline"/>
          </section>
          <field label="Remarks:" attribute="remarks">
            <renderer type="textarea" params="maxlength=8000" />
          </field>

          <association label="Infrastructure Asset:" target="cinum" labelfield="ci_.ciname" required="true">
            <renderer type="autocompleteclient" params="minLength=3;"/>
          </association>

          <field label="Attachment:" attribute="newattachment" >
            <renderer type="upload"/>
          </field>
        </schema>

        <schema id="creationSummary" mode="output" stereotype="detail" title="Change Request Detail">
          <field attribute="ticketuid" hidden="true"/>
          <field label="Request#:" attribute="ticketid"/>
          <field label="Summary:" attribute="description"/>
          <field label="Date and Time:" attribute="reportdate">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
          </field>
          <field label="Requester:" attribute="hlagaffectedperson"/>
          <field label="Details:" attribute="longdescription_.ldtext">
            <renderer type="textarea"/>
          </field>
          <field label="Status:" attribute="status"/>
          <composition relationship="attachment" label="Attachments" hidden="true" fetchtype="eager"/>
          <field label="Attachment:" attribute="#attachmentsummary" />

          <commands>
            <command id="print" label="Print" stereotype="print" service="crudextraService" method="printDetail" parameters="schema,datamap"/>
            <command id="cancel" label="Close" stereotype="cancel" service="srsummaryService" method="redirectToHapagHome" />
          </commands>
          <properties>
            <property key="detail.cancel.lbl" value="Close"/>
          </properties>
        </schema>
      </schemas>
    </application>

    <application name="workorder" title="Workorder" entity="workorder">
      <schemas>
        <schema stereotype="compositionlist" id="asset_composition">
          <properties>
            <property key="detail.cancel.lbl" value="Close"/>
            <property key="expansible" value="false"/>
          </properties>
          <field label="Wonum" attribute="wonum"/>
          <field label="Class" attribute="woclass"/>
          <field label="Description" attribute="description"/>
          <field label="Location" attribute="location"/>
          <field label="Asset" attribute="assetnum"/>
          <field label="Status" attribute="status"/>
          <field label="Date" attribute="reportdate">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm" />
          </field>
        </schema>
      </schemas>
    </application>

    <application name="ticket" title="Ticket" entity="ticket">
      <schemas>
        <schema stereotype="compositionlist" id="asset_composition">
          <properties>
            <property key="detail.cancel.lbl" value="Close"/>
            <property key="expansible" value="false"/>
            <property key="list.click.service" value="ticketservice.opendetail"/>
          </properties>
          <field label="Ticket ID" attribute="ticketid"/>
          <field label="Class" attribute="class"/>
          <field label="Description" attribute="description"/>
          <field label="Reported By" attribute="hlagreportedby"/>
          <field label="Date" attribute="creationdate">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm" />
          </field>
          <field label="Affected Person" attribute="affectedperson_.hlagdisplayname"/>
          <field label="Status" attribute="status"/>
          <field label="Owner" attribute="hlagowner"/>
          <field label="Owner Group" attribute="ownergroup"/>
          <field label="History" attribute="history"/>
        </schema>
      </schemas>
    </application>

    <application name="location" title="Location" entity="location" id="00000000-0000-0000-0000-000000000002">
      <properties>
        <property key="mobile.fetchlimit" value="16000"/>
        <property key="mobile.userInteractionEnabled" value="false"/>
      </properties>
      <schemas>
        <list >
          <field attribute="location" label="Location" qualifier="title"/>
          <field attribute="description" label="Description" qualifier="excerpt"/>
        </list>
        <detail>
          <field attribute="locationsid" label="ID"  required="true" />
          <field attribute="location" label="Location"  required="true" />
          <field attribute="description" label="Description"  required="true" />
          <field attribute="siteid"  required="true" readonly="true" hidden="true"/>
          <field attribute="type"  required="true" readonly="true" hidden="true"/>
        </detail>
      </schemas>
    </application>

    <application name="approvals" title="Approvals" entity="pmchgotherapprovers">
      <properties>
        <property key="pagination.disabled" value="True" />
      </properties>
      <schemas>
        <list stereotype="compositionlist">
          <commands>
            <command id="print" remove="true" label=""/>
          </commands>
          <properties>
            <property key="detail.cancel.lbl" value="Close"/>
            <property key="expansible" value="false"/>
          </properties>
          <field attribute="pmchgotherapproversid" hidden="true"/>
          <field  attribute="approver" label="Approver Person" />
          <field  attribute="approvergroup" label="Approver Group" />
          <field  attribute="#changeby" label="Changed By" />
          <field attribute="#changedate" label="Change Date">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm" />
          </field>
          <field attribute="approvallevel" hidden="true"/>
          <field  attribute="#status" label="Status" />
          <section resourcepath="/Content/Templates/hapag/jobplancompleteaction.html">
            <header label="Action"/>
            <renderer type="default" params="minwidth=80px"/>
          </section>
        </list>

        <schema id="printschema">
          <commands>
            <command id="print" remove="true" label=""/>
          </commands>
          <properties>
            <property key="detail.cancel.lbl" value="Close"/>
          </properties>
          <field attribute="pmchgotherapproversid" hidden="true"/>
          <field  attribute="approver" label="Approver Person" />
          <field  attribute="approvergroup" label="Approver Group" />
          <field  attribute="#changeby" label="Changed By" />
          <field attribute="#changedate" label="Change Date">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm" />
          </field>
          <field attribute="approvallevel" hidden="true"/>
          <field  attribute="#status" label="Status" />
        </schema>
      </schemas>
    </application>

    <!--    Record Key Class Created By Created Date Log Type Summary-->
    <application name="worklog" title="Work Log" entity="worklog" id="00000000-0000-0000-0000-000000000008" >
      <schemas>
        <list stereotype="compositionlist">
          <commands>
            <command id="print" remove="true" label=""/>
          </commands>
          <properties>
            <property key="detail.cancel.lbl" value="Close"/>
            <property key="pagination.disabled" value="True" />
          </properties>
          <field attribute="worklogid" hidden="true"/>
          <field  attribute="recordkey" label="Record Key" />
          <field  attribute="class" label="Class" />
          <field  attribute="hlagcreateby" label="Created By" />
          <field  attribute="createby" label="Created By" hidden="true"/>
          <field attribute="itdcreatedate" label="Created Date">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm" />
          </field>
          <field  attribute="logtype" label="Log Type" />
          <field  attribute="description" label="Summary" />
          <field  attribute="longdescription_.ldtext" label="Details" hidden="true" />
        </list>
        <detail stereotype="compositiondetail">
          <field  attribute="description" label="Summary" required="true"/>
          <field  attribute="longdescription_.ldtext" label="Details" >
            <renderer type="textarea" params="formatter=descriptionDataHandler;format=dd/MM/yyyy HH:mm"/>
          </field>
          <properties>
            <!--            <property key="compositions.alwaysrefresh" value="true"/>-->
          </properties>
        </detail>

        <schema id="printschema" stereotype="compositiondetail">
          <field attribute="worklogid" hidden="true"/>
          <field  attribute="recordkey" label="Record Key" />
          <field  attribute="class" label="Class" />
          <field  attribute="hlagcreateby" label="Created By" />
          <field  attribute="createby" label="Created By" hidden="true"/>
          <field attribute="itdcreatedate" label="Created Date">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm" />
          </field>
          <field  attribute="logtype" label="Log Type" />
          <field  attribute="description" label="Summary" />
          <field  attribute="longdescription_.ldtext" label="Details"/>
        </schema>


      </schemas>
    </application>

    <application name="attachment" title="Attachment" entity="DOCLINKS">
      <properties>
        <property key="pagination.disabled" value="True" />
      </properties>
      <schemas>
        <list stereotype="compositionlist">
          <properties>
            <property key="detail.cancel.lbl" value="Close"/>
            <property key="expansible" value="false"/>
            <!--            <property key="compositions.alwaysrefresh" value="true"/>-->
          </properties>
          <commands>
            <command id="print" remove="true" label=""/>
          </commands>
          <field label="Id" hidden="true" attribute="docinfoid"/>
          <field hidden="true" attribute="doclinksid"/>
          <field label="Document" hidden="true" attribute="document"/>
          <field label="Document" hidden="true" attribute="docinfo_.urlname"/>
          <section id="document" attribute="urldescription" resourcepath="/Content/Templates/downloadattachment.html"
									  parameters="controller=Attachment;action=Download;idcolumn=docinfoid;mode=ws">
            <header label="Document" displacement="sameline"/>
          </section>
          <section id="createdate" attribute="createdate" resourcepath="/Content/Templates/downloadattachment.html"
                  parameters="controller=Attachment;action=Download;idcolumn=docinfoid;mode=ws;format=dd/MM/yyyy HH:mm">
            <header label="Created Date" displacement="sameline"/>
          </section>


          <!--          <field label="Created Date" attribute="createdate">-->
          <!--            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm" />-->
          <!--          </field>-->
        </list>



        <schema id="faqAttachments" stereotype="compositionlist">
          <field hidden="true" attribute="#path"/>
          <field hidden="true" attribute="document"/>
          <section attribute="document" resourcepath="/Content/Templates/downloadattachment.html" parameters="controller=Faq;action=Download;idcolumn=#path">
            <header label="Document" displacement="sameline"/>
          </section>
          <commands>
            <command id="print" remove="true" label=""/>
          </commands>
          <properties>
            <property key="expansible" value="false"/>
          </properties>
        </schema>

        <schema id="detailPrint" stereotype="compositiondetail" mode="output">
          <field label="Document" hidden="true" attribute="document"/>
          <field label="Document" hidden="true" attribute="docinfo_.urlname"/>
          <field label="Document" attribute="urldescription"/>
          <field label="Created Date" attribute="createdate">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm"/>
          </field>
          <field attribute="ownerid" hidden="true"/>
        </schema>

        <detail>
          <properties>
            <!--            <property key="compositions.alwaysrefresh" value="true"/>-->
            <property key="oncrudsaveevent.validationservice" value="attachmentservice.validateNewForm"/>
          </properties>

          <!--          <field label="Title:" attribute="document" />-->
          <field label="Attachment:" attribute="newattachment">
            <renderer type="upload"/>
          </field>
          <field label="ScreenShot:" attribute="newscreenshot">
            <renderer type="screenshot"/>
          </field>
        </detail>
      </schemas>
    </application>

    <application name="longdescription" title="Long Description" entity="longdescription" id="00000000-0000-0000-0000-000000000007">
      <properties>
        <property key="mobile.userInteractionEnabled" value="false"/>
        <property key="mobile.fetchlimit" value="30"/>
      </properties>
      <schemas>
        <detail>
          <field attribute="ldkey"  />
          <field attribute="ldownertable"  />
          <field attribute="ldownercol"  />
          <field attribute="ldtext"  />
          <field attribute="longdescriptionid"  />
        </detail>
      </schemas>
    </application>

    <application name="solution" title="FAQs" entity="SOLUTION">
      <schemas>
        <list>
          <field attribute="description" />
          <field attribute="solutionid" />
          <field attribute="solution" hidden="true" />
        </list>
        <detail title="FAQ" mode="output">
          <field attribute="solution" hidden="true" />
          <field attribute="symptom_.ldtext" label="Symptom:"  >
            <renderer type="textarea"/>
          </field>
          <field attribute="cause_.ldtext" label="Cause:" >
            <renderer type="textarea"/>
          </field>
          <field attribute="resolution_.ldtext" label="Resolution:" >
            <renderer type="textarea"/>
          </field>
          <section resourcepath="/Content/templates/hapag/embeddedpdf.html"/>
        </detail>
      </schemas>
    </application>

    <application name="relatedrecord" title="Related Records" entity="relatedrecord" id="00000000-0000-0000-0000-000000000008" >
      <schemas>
        <list stereotype="compositionlist">
          <field  attribute="relatedreckey" label="Related Record Key" />
          <field  attribute="relatedrecclass" label="Related Record Class" />
          <field  attribute="recordkey" label="" hidden="true" />
        </list>
        <detail stereotype="compositiondetail">
          <field  attribute="relatedreckey" label="Related Record Key" />
          <field  attribute="relatedrecclass" label="Related Record Class" />
          <field  attribute="recordkey" label="" hidden="true" />
        </detail>
      </schemas>
    </application>

    <application entity="pluspcustomer" name="pluspcustomer" title="Pluspcustomer">
      <schemas>
        <list>
          <field attribute="customer"/>
          <field attribute="hlagpluspcustomer" label="Customer"/>
        </list>
      </schemas>
    </application>

    <application entity="persongroupview" name="persongroupview" title="Persongroupview">
      <components>
        <componentdisplayable id="SitesAndCostCenters">
          <optionfield label="Site - Cost Center" required="true" attribute="persongroup_.description" providerattribute="hlagUserLocationAndCostCenter">
            <renderer type="combodropdown" />
            <filter operation="contains"/>
          </optionfield>
        </componentdisplayable>
      </components>
      <schemas>
        <schema id="groupreport" stereotype="list" title="Group Report">
          <field label="HLAG Group" attribute="persongroup">
            <renderer type="default" />
          </field>
          <field label="PersonID" attribute="respparty">
            <renderer type="default"/>
          </field>
          <field label="Person Name" attribute="displayname">
            <renderer type="default"/>
          </field>
          <properties>
            <property key="list.click.schema" value=""/>
          </properties>
        </schema>

        <schema id="itcreportfilters" stereotype="detail" title="ITC Report">
          <properties>
            <property key="report.reportName" value="ITCReport"/>
            <property key="nextschema.schemaid" value="itcreport"/>
          </properties>
          <reference id="SitesAndCostCenters"/>
          <field attribute="requestor" hidden="true"/>
          <commands removeundeclared="true">
            <command id="viewitcreport" label="View Report" method="viewITCReport" service="reportservice" parameters="datamap,schema"/>
          </commands>
        </schema>

        <schema id="baseitcreport" stereotype="list" title="ITC Report" abstract="true">
          <field label="PersonID" attribute="hlagresppartygroup" />
          <field label="Person Name" attribute="displayname" />
          <field attribute="persongroup_.description" hidden="true"/>
          <field attribute="groupdefault" hidden="true"/>
          <field attribute="persongroup" hidden="true"/>
          <field label="Site" attribute="hlagsite" />
          <field label="Cost Center" attribute="hlagcostcenter" />
          <field label="ITC Role" attribute="itcrole" />
          <section id="abstractsection" />
        </schema>

        <schema id="itcreport" stereotype="list" title="ITC Report" parentschema="baseitcreport">
          <section id="abstractsection">
            <field attribute="costcenterdescription" hidden="true"/>
          </section>
        </schema>

        <schema id="itcreportregionandarea" stereotype="list" title="ITC Report" parentschema="baseitcreport">
          <section id="abstractsection">
            <field attribute="locationcostcenterdescription" hidden="true"/>
            <field label="Location Person Group" attribute="locationpersongroup_.persongroup" />
            <field label="Location Person Group Description" attribute="locationpersongroup_.description" />
          </section>
        </schema>

      </schemas>
    </application>

    <application entity="woactivity" name="woactivity" title="WO Activity">
      <schemas>

        <list stereotype="compositionlist">
          <commands>
            <command id="print" remove="true" label=""/>
          </commands>
          <properties>
            <property key="detail.cancel.lbl" value="Close"/>
          </properties>
          <field attribute="workorderid" hidden="true"/>
          <field attribute="wonum" label="WO Number" />
          <field attribute="wosequence" label="Sequence" />
          <field attribute="ownergroup" label="Owner Group" >
            <renderer type="default" params="minwidth=160px;maxwidth=230px"/>
          </field>
          <field attribute="status" label="Status"/>
          <field attribute="schedstart" label="Schedule Start">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm" />
          </field>
          <field attribute="actfinish" label="Actual Finish">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm" />
          </field>
          <field attribute="description" label="Summary">
            <renderer type="default" params="minwidth=180px;maxwidth=200px"/>
          </field>
          <section resourcepath="/Content/Templates/hapag/jobplancompleteaction.html">
            <header label="Action"/>
            <renderer type="default" params="minwidth=80px"/>
          </section>
        </list>

        <schema id="changeTasksDashboardList" stereotype="list">
          <field attribute="wonum" label="WoNum">
            <renderer type="default" params="minwidth=95px;maxwidth=95px;wordwrap=break-word" />
          </field>
          <field attribute="ownergroup" label="Owner Group">
            <renderer type="default" params="minwidth=102px;maxwidth=102px;excelwidth=50;wordwrap=break-word" />
          </field>
          <field attribute="status" label="Status">
            <renderer type="default" params="width=100px;wordwrap=break-word" />
          </field>
          <field hidden="true" attribute="wochange_.wonum"/>
          <properties>
            <property key="list.click.mode" value="output"/>
            <property key="list.click.popup" value="browserwindow"/>
          </properties>
        </schema>

        <schema id="detail" stereotype="compositiondetail">
          <field label="Description" attribute="longdescription_.ldtext"/>
        </schema>

        <schema id="printschema" stereotype="compositiondetail">
          <field attribute="workorderid" hidden="true"/>
          <field attribute="wonum" label="WO Number" />
          <field attribute="wosequence" label="Sequence" />
          <field attribute="ownergroup" label="Owner Group" >
            <renderer type="default" params="minwidth=160px;maxwidth=230px"/>
          </field>
          <field attribute="status" label="Status"/>
          <field attribute="schedstart" label="Schedule Start">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm" />
          </field>
          <field attribute="actfinish" label="Actual Finish">
            <renderer type="datetime" params="format=dd/MM/yyyy HH:mm" />
          </field>
          <field attribute="description" label="Summary">
            <renderer type="default" params="minwidth=180px;maxwidth=200px"/>
          </field>
          <field label="Description" attribute="longdescription_.ldtext"/>
        </schema>

      </schemas>
    </application>

    <application name="assetloccomm" title="Services" entity="assetloccomm" >
      <schemas>
        <list stereotype="compositionlist">
          <field  attribute="commodities_.description" label="" />
        </list>
        <detail stereotype="compositiondetail">
          <field  attribute="commodities_.description" label="" />
        </detail>
      </schemas>
    </application>

    <application name="commodities" title="Commodities" entity="commodities" >
      <schemas>
        <detail>
          <field attribute="commodity" label="" />
          <field attribute="description" label="" />
          <field attribute="selectedcommodities_.assetnum" label="" />
        </detail>
      </schemas>
    </application>

    <application name="apprwftransaction" entity="WFTRANSACTION" title="WF Transactions">
      <schemas>
        <list stereotype="compositionlist">
          <field attribute="personid" hidden="true"/>
          <field attribute="transdate" hidden="true"/>
          <field attribute="transtype" hidden="true"/>
        </list>
      </schemas>
    </application>

    <application name="wfassignment" entity="WFASSIGNMENT" title="WF Assignment">
      <schemas>
        <list stereotype="compositionlist">
          <field attribute="wfid" hidden="true"/>
          <field attribute="roleid" hidden="true"/>
        </list>
      </schemas>
    </application>

    <application name="wostatus" entity="wostatus" title="WoStatus">
      <schemas>
        <list stereotype="compositionlist">
          <field attribute="wonum" hidden="true"/>
          <field attribute="status" hidden="true"/>
          <field attribute="changedate" hidden="true"/>
        </list>
      </schemas>
    </application>

  </applications>

</metadata>
