<?xml version="1.0" encoding="utf-8" ?>
<metadata xmlns="http://www.controltechnologysolutions.com/metadata">
  <!--kongsberg-->
  <templates>
    <template path="@person.xml"/>
    <template path="@worklogs.xml"/>
    <template path="@solution.xml"/>
    <template path="@commlogs.xml"/>
    <template path="@attachments.xml"/>
    <template path="@incident.xml"/>
    <template path="@asset.xml"/>
    <template path="@attachments.xml"/>
    <template path="@relatedrecords.xml"/>
    <template path="@workorder.xml"/>
  </templates>
  <entities>
    <entity name="SR" idAttribute="ticketuid" useridAttribute="ticketid">
      <attributes>
        <attribute name="accumulatedholdtime" type="float" required="false" />
        <attribute name="accumulateslaholdtime" type="smallint" required="false" query="(select COALESCE(slahold, 0) from slarecords sla inner join pluspservagree on sanum = sla.slanum where ownertable = 'TICKET' and ownerid = !@ticketuid)" />
        <attribute name="actlabcost" type="decimal" required="true" />
        <attribute name="actlabhrs" type="float" required="true" />
        <attribute name="actualcontactdate" type="datetime" required="false" />
        <attribute name="actualfinish" type="datetime" required="false" />
        <attribute name="actualstart" type="datetime" required="false" />
        <attribute name="adjustedtargetcontacttime" type="datetime" required="false" />
        <attribute name="adjustedtargetresolutiontime" type="datetime" required="false" />
        <attribute name="adjustedtargetresponsetime" type="datetime" required="false" />
        <attribute name="affecteddate" type="datetime" required="false" />
        <attribute name="affectedemail" type="varchar" required="false" />
        <attribute name="affectedperson" type="varchar" required="false" />
        <attribute name="affectedphone" type="varchar" required="false" />
        <attribute name="ageflag" type="varchar" required="false" />
        <attribute name="area" type="varchar" required="false" />
        <attribute name="assetnum" type="varchar" required="false" />
        <attribute name="assetorgid" type="varchar" required="false" />
        <attribute name="assetsiteid" type="varchar" required="false" />
        <attribute name="assignedownergroup" type="varchar" required="false" />
        <attribute name="calccalendar" type="varchar" required="false" />
        <attribute name="calcorgid" type="varchar" required="false" />
        <attribute name="calcshift" type="varchar" required="false" />
        <attribute name="changeby" type="varchar" required="true" />
        <attribute name="changedate" type="datetime" required="true" />
        <attribute name="cinum" type="varchar" required="false" />
        <attribute name="class" type="varchar" required="true" />
        <attribute name="classificationid" type="varchar" required="false" />
        <attribute name="classstructureid" type="varchar" required="false" />
        <attribute name="commodity" type="varchar" required="false" />
        <attribute name="commoditygroup" type="varchar" required="false" />
        <attribute name="correlationattrs" type="varchar" required="false" />
        <attribute name="createdby" type="varchar" required="false" />
        <attribute name="createwomulti" type="varchar" required="false" />
        <attribute name="creationdate" type="datetime" required="false" />
        <attribute name="description" type="varchar" required="false" />
        <attribute name="descsrvid" type="varchar" required="false" />
        <attribute name="developmentrequest" type="smallint" required="true" />
        <attribute name="externalrecid" type="varchar" required="false" />
        <attribute name="externalsystem" type="varchar" required="false" />
        <attribute name="externalsystem_ticketid" type="varchar" required="false" />
        <attribute name="failurecode" type="varchar" required="false" />
        <attribute name="feature_request" type="smallint" required="true" />
        <attribute name="fr1code" type="varchar" required="false" />
        <attribute name="fr2code" type="varchar" required="false" />
        <attribute name="glaccount" type="varchar" required="false" />
        <attribute name="globalticketclass" type="varchar" required="false" />
        <attribute name="globalticketid" type="varchar" required="false" />
        <attribute name="hasactivity" type="smallint" required="true" />
        <attribute name="hasld" type="smallint" required="true" />
        <attribute name="hassolution" type="smallint" required="true" />
        <attribute name="historyflag" type="smallint" required="true" />
        <attribute name="impact" type="int" required="false" />
        <attribute name="indicatedpriority" type="int" required="false" />
        <attribute name="inheritstatus" type="smallint" required="true" />
        <attribute name="internalpriority" type="int" required="false" />
        <attribute name="isglobal" type="smallint" required="true" />
        <attribute name="isknownerror" type="smallint" required="true" />
        <attribute name="isknownerrordate" type="datetime" required="false" />
        <attribute name="langcode" type="varchar" required="true" />
        <attribute name="location" type="varchar" required="false" />
        <attribute name="oncallautoassign" type="smallint" required="true" />
        <attribute name="oncallfirstrotassnperson" type="varchar" required="false" />
        <attribute name="oncallownergroup" type="varchar" required="false" />
        <attribute name="oncallreassigntime" type="datetime" required="false" />
        <attribute name="oncallstarttime" type="datetime" required="false" />
        <attribute name="orgid" type="varchar" required="false" />
        <attribute name="origrecordclass" type="varchar" required="false" />
        <attribute name="origrecordid" type="varchar" required="false" />
        <attribute name="origrecorgid" type="varchar" required="false" />
        <attribute name="origrecsiteid" type="varchar" required="false" />
        <attribute name="outageduration" type="float" required="false" />
        <attribute name="owner" type="varchar" required="false" />
        <attribute name="ownergroup" type="varchar" required="false" />
        <attribute name="pluspagreement" type="varchar" required="false" />
        <attribute name="pluspbblinenum" type="int" required="false" />
        <attribute name="pluspbillbatch" type="varchar" required="false" />
        <attribute name="pluspcalccalnum" type="varchar" required="false" />
        <attribute name="pluspcalcorgid" type="varchar" required="false" />
        <attribute name="pluspcalcshift" type="varchar" required="false" />
        <attribute name="pluspcostcenter" type="varchar" required="false" />
        <attribute name="pluspcustchacct" type="varchar" required="false" />
        <attribute name="pluspcustomer" type="varchar" required="false" />
        <attribute name="pluspcustponum" type="varchar" required="false" />
        <attribute name="pluspmaxprice" type="decimal" required="false" />
        <attribute name="pluspporeq" type="smallint" required="true" />
        <attribute name="plusppricesched" type="varchar" required="false" />
        <attribute name="pluspquotedprice" type="decimal" required="false" />
        <attribute name="pluspquotetype" type="varchar" required="false" />
        <attribute name="pluspresponseplan" type="varchar" required="false" />
        <attribute name="plusprevnum" type="int" required="false" />
        <attribute name="pmcomimpact" type="int" required="false" />
        <attribute name="pmcomresolution" type="varchar" required="false" />
        <attribute name="pmcomtype" type="varchar" required="false" />
        <attribute name="pmcomurgency" type="int" required="false" />
        <attribute name="pmcosolappliedby" type="varchar" required="false" />
        <attribute name="pmcosolapplieddate" type="datetime" required="false" />
        <attribute name="pmcosolfeedback" type="varchar" required="false" />
        <attribute name="pmcosolstatus" type="varchar" required="false" />
        <attribute name="pmsccrid" type="varchar" required="false" />
        <attribute name="pmsccurrency" type="varchar" required="false" />
        <attribute name="pmscinvalid" type="smallint" required="false" />
        <attribute name="pmscitemnum" type="varchar" required="false" />
        <attribute name="pmscitemsetid" type="varchar" required="false" />
        <attribute name="pmscoffsummary" type="varchar" required="false" />
        <attribute name="pmsconetimeprice" type="decimal" required="false" />
        <attribute name="pmscquantity" type="int" required="false" />
        <attribute name="pmscrecurringprice" type="decimal" required="false" />
        <attribute name="pmsctmplid" type="bigint" required="false" />
        <attribute name="pmsctotalonetimeprice" type="decimal" required="false" />
        <attribute name="pmsctotalrecurringprice" type="decimal" required="false" />
        <attribute name="proactive" type="smallint" required="true" />
        <attribute name="problemcode" type="varchar" required="false" />
        <attribute name="problemtype" type="varchar" required="false" />
        <attribute name="proposedversion" type="varchar" required="false" />
        <attribute name="region" type="varchar" required="false" />
        <attribute name="relatedtoglobal" type="smallint" required="true" />
        <attribute name="replacedowner" type="varchar" required="false" />
        <attribute name="reportdate" type="datetime" required="false" />
        <attribute name="reportedby" type="varchar" required="false" />
        <attribute name="reportedemail" type="varchar" required="false" />
        <attribute name="reportedphone" type="varchar" required="false" />
        <attribute name="reportedpriority" type="int" required="false" />
        <attribute name="reportedversion" type="varchar" required="false" />
        <attribute name="responseslo" type="smallint" required="true" />
        <attribute name="rigname" type="varchar" required="false" />
        <attribute name="rowstamp" type="timestamp" required="true" />
        <attribute name="selfservsolaccess" type="smallint" required="true" />
        <attribute name="servicecompanytype" type="varchar" required="false" />
        <attribute name="siteid" type="varchar" required="false" />
        <attribute name="sitevisit" type="smallint" required="true" />
        <attribute name="slaapplied" type="smallint" required="flase" query="(select Case COUNT(OWNERID) when 0 then 0 else 1 end from slarecords where slarecords.ownertable = 'TICKET' and slarecords.ownerid = !@ticketuid )" />
        <attribute name="slaapproachingindicator" type="varchar" required="false" />
        <attribute name="slamet" type="smallint" required="true" />
        <attribute name="solution" type="varchar" required="false" />
        <attribute name="source" type="varchar" required="false" />
        <attribute name="status" type="varchar" required="true" />
        <attribute name="statusdate" type="datetime" required="true" />
        <attribute name="supervisor" type="varchar" required="false" />
        <attribute name="targetcontactdate" type="datetime" required="false" />
        <attribute name="targetdesc" type="varchar" required="false" />
        <attribute name="targetfinish" type="datetime" required="false" />
        <attribute name="targetstart" type="datetime" required="false" />
        <attribute name="targetversion" type="varchar" required="false" />
        <attribute name="template" type="smallint" required="true" />
        <attribute name="templateid" type="varchar" required="false" />
        <attribute name="tfsnumber" type="varchar" required="false" />
        <attribute name="ticketid" type="varchar" required="true" />
        <attribute name="ticketuid" type="bigint" required="true" />
        <attribute name="urgency" type="int" required="false" />
        <attribute name="vendor" type="varchar" required="false" />
        <attribute name="virtualenv" type="smallint" required="false" />
        <attribute name="wellname" type="varchar" required="false" />
        <attribute name="attachments" type="int" query="(select count(*) from doclinks where ownertable = 'SR' and ownerid = !@ticketuid)" required="false"/>
      </attributes>
      <relationships>
        <relationship to="asset">
          <relationshipAttribute from="assetnum" to="assetnum" primary="true"/>
          <relationshipAttribute from="siteid" to="siteid" />
        </relationship>
        <relationship to ="alndomain" qualifier="area">
          <relationshipAttribute from="area" to="value" primary="true"/>
          <relationshipAttribute to ="domainid" literal="AREA" quoteLiteral="true"/>
        </relationship>
        <relationship to ="alndomain" qualifier="problemtype">
          <relationshipAttribute from="problemtype" to="value" primary="true"/>
          <relationshipAttribute to ="domainid" literal="PROBLEMTYPE" quoteLiteral="true"/>
        </relationship>
        <relationship to ="alndomain" qualifier="proposedversion">
          <relationshipAttribute from="proposedversion" to="value" primary="true"/>
          <relationshipAttribute to ="domainid" literal="PROPOSED VERSION" quoteLiteral="true"/>
        </relationship>
        <relationship to ="alndomain" qualifier="reportedversion">
          <relationshipAttribute from="reportedversion" to="value" primary="true"/>
          <relationshipAttribute to ="domainid" literal="REPORTED VERSION" quoteLiteral="true"/>
        </relationship>
        <relationship to ="alndomain" qualifier="targetversion">
          <relationshipAttribute from="targetversion" to="value" primary="true"/>
          <relationshipAttribute to ="domainid" literal="TARGETVERSION" quoteLiteral="true"/>
        </relationship>
        <relationship to="numericdomain" qualifier="internalpriority" cacheable="true">
          <relationshipAttribute from="internalpriority" to="value" primary="true"/>
          <relationshipAttribute to ="domainid" literal="TICKETPRIORITY" quoteLiteral="true"/>
        </relationship>
        <relationship to="numericdomain" qualifier="reportedpriority">
          <relationshipAttribute from="reportedpriority" to="value" primary="true"/>
          <relationshipAttribute to ="domainid" literal="TICKETPRIORITY" quoteLiteral="true"/>
        </relationship>
        <relationship to="site">
          <relationshipAttribute from="assetsiteid" to="siteid" primary="true"/>
        </relationship>
        <relationship to="location">
          <relationshipAttribute from="location" to="location" primary="true"/>
          <relationshipAttribute from="siteid" to="siteid" />
        </relationship>
        <relationship to="worklog" collection="true">
          <relationshipAttribute from="ticketid" to="recordkey" primary="true" />
          <relationshipAttribute from="siteid" to="siteid" />
          <relationshipAttribute to="class" literal="SR" quoteLiteral="true" />
        </relationship>
        <relationship to ="commlog" collection="true">
          <relationshipAttribute from="ticketuid" to="ownerid" primary="true" />
          <relationshipAttribute to="ownertable" literal="SR" quoteLiteral="true"/>
        </relationship>
        <relationship to="longdescription" >
          <relationshipAttribute from="ticketuid" to="ldkey" primary="true"/>
          <relationshipAttribute to="ldownertable" literal="TICKET" quoteLiteral="true" />
          <relationshipAttribute to="ldownercol" literal="DESCRIPTION" quoteLiteral="true" />
        </relationship>
        <relationship to="DOCLINKS" qualifier="attachment" collection="true">
          <relationshipAttribute from="ticketuid" to="ownerid" primary="true"/>
          <relationshipAttribute to="ownertable" literal="SR" quoteLiteral="true"/>
        </relationship>
        <relationship to="relatedrecord" collection="true">
          <relationshipAttribute from="ticketid" to="recordkey" primary="true"/>
          <relationshipAttribute to="class" literal="SR" quoteLiteral="true"/>
        </relationship>
        <relationship to="synonymdomain" qualifier="synstatus" cacheable="true">
          <relationshipAttribute from="status" to="value" primary="true"/>
          <relationshipAttribute to="domainid" literal="SRSTATUS" quoteLiteral="true" />
        </relationship>
        <relationship to="person">
          <relationshipAttribute from="affectedperson" to="personid" primary="true"/>
          <relationshipAttribute to="status" literal="ACTIVE" quoteLiteral="true" />
        </relationship>
        <relationship to="person" qualifier="reportedbyperson">
          <relationshipAttribute from="reportedby" to="personid" primary="true"/>
        </relationship>
        <relationship to="person" qualifier="ownerperson">
          <relationshipAttribute from="owner" to="personid" primary="true"/>
        </relationship>
        <relationship to ="solution" qualifier="solution" >
          <relationshipAttribute from="solution" to ="solution" primary="true"/>
          <relationshipAttribute to="status" literal="ACTIVE" quoteLiteral="true"/>
        </relationship>
        <relationship to="longdescription" qualifier="symptom">
          <relationshipAttribute from="ticketuid" to="ldkey" primary="true"/>
          <relationshipAttribute to="ldownertable" literal="TICKET" quoteLiteral="true" />
          <relationshipAttribute to="ldownercol" literal="PROBLEMCODE" quoteLiteral="true" />
        </relationship>
        <relationship to="longdescription" qualifier="cause">
          <relationshipAttribute from="ticketuid" to="ldkey" primary="true"/>
          <relationshipAttribute to="ldownertable" literal="TICKET" quoteLiteral="true" />
          <relationshipAttribute to="ldownercol" literal="FR1CODE" quoteLiteral="true" />
        </relationship>
        <relationship to="longdescription" qualifier="resolution">
          <relationshipAttribute from="ticketuid" to="ldkey" primary="true"/>
          <relationshipAttribute to="ldownertable" literal="TICKET" quoteLiteral="true" />
          <relationshipAttribute to="ldownercol" literal="FR2CODE" quoteLiteral="true" />
        </relationship>
        <relationship to ="persongroup">
          <relationshipAttribute from ="ownergroup" to ="persongroup" primary="true"/>
        </relationship>
        <relationship to="classification" qualifier="classification">
          <relationshipAttribute from="classificationid" to ="classificationid" primary="true"/>
        </relationship>
        <!--relationship to="srclassifications" qualifier="srclassifications">
          <relationshipAttribute from="classificationid" to="classificationid" primary="true"/>
        </relationship-->
        <relationship to="commodities" qualifier="commoditygroup">
          <relationshipAttribute from="commoditygroup" to="commodity" primary="true" />
           <relationshipAttribute query="parent IS NULL"/>
        </relationship>		
      
        <relationship to="commodities" qualifier="commodity">
          <relationshipAttribute from="commodity" to="commodity" primary="true" />
           <relationshipAttribute query="parent IS NOT NULL"/>
        </relationship>		
        
        <relationship to="alndomain" qualifier="servicecompanytype">
          <relationshipAttribute from="servicecompanytype" to="value" primary="true" />
          <relationshipAttribute to ="domainid" literal="SERVCOMPTYPE" quoteLiteral="true"/>        
        </relationship>		
      </relationships>
      <connectorParameters>
        <connectorParameter key="dbtable" value="sr" />
        <connectorParameter key="integration_interface" value="SWSR" />
        <connectorParameter key="customconnector" value="softwrench.sw4.kongsberg.classes.com.cts.kongsberg.connector.KongsbergServiceRequestCrudConnector" />
        <connectorParameter key="dispatchincident_customconnector" value="softWrench.sW4.Data.Persistence.Dataset.Commons.Ticket.ServiceRequest.DispatchOperationHandler" />
      </connectorParameters>
    </entity>
    
    <entity name="alndomain" idAttribute="alndomainid">
      <attributes>
        <attribute name="domainid" type="varchar" required="true" />
        <attribute name="value" type="varchar" required="true" />
        <attribute name="description" type="varchar" required="false" />
        <attribute name="siteid" type="varchar" required="false" />
        <attribute name="orgid" type="varchar" required="false" />
        <attribute name="alndomainid" type="bigint" required="true" />
        <attribute name="valueid" type="varchar" required="true" />
        <attribute name="rowstamp" type="timestamp" required="true" />
        <attribute name="pluspcustomer" type="varchar" required="false" />
      </attributes>
      <connectorParameters>
        <connectorParameter key="dbtable" value="alndomain" />
      </connectorParameters>
    </entity>

    <entity name="classstructure"  idAttribute="classstructureid" >
      <relationships>
        <relationship to ="classusewith" qualifier="incidentclassstructures">
          <relationshipAttribute from="classstructureid" to="classstructureid" primary="true"/>
          <relationshipAttribute to="objectvalue" literal="INCIDENT" quoteLiteral="true"/>
        </relationship>
        <relationship to ="classusewith" qualifier="srclassstructures">
          <relationshipAttribute from="classstructureid" to="classstructureid" primary="true"/>
          <relationshipAttribute to="objectvalue" literal="SR" quoteLiteral="true"/>
        </relationship>
        <relationship to="ticketspec">
          <relationshipAttribute from="classstructureid" to="classstructureid" primary="true"/>
          <relationshipAttribute from="orgid" to="orgid"/>
          <relationshipAttribute from="siteid" to="siteid"/>
        </relationship>
      </relationships>
    </entity>

   
    <entity name="incidentclassifications" parententity="classstructure" idAttribute="classstructureid">
      <attributes>
        <attribute name="classstructureid" type="varchar" query="CASE WHEN ((incidentclassifications.classstructureid = classusewith.classstructureid) and (classusewith.objectvalue='INCIDENT')) THEN incidentclassifications.classstructureid end "/>

      </attributes>
    </entity>

    <entity name="incident" idAttribute="ticketuid" useridAttribute="ticketid">
      <attributes>
        <attribute name="accumulatedholdtime" type="float" required="false" />
        <attribute name="accumulateslaholdtime" type="smallint" required="false" query="(select COALESCE(slahold, 0) from slarecords sla inner join pluspservagree on sanum = sla.slanum where ownertable = 'TICKET' and ownerid = !@ticketuid)" />
        <attribute name="actlabcost" type="double" required="true" />
        <attribute name="actlabhrs" type="float" required="true" />
        <attribute name="adjustedtargetcontacttime" type="datetime" required="false" />
        <attribute name="adjustedtargetresolutiontime" type="datetime" required="false" />
        <attribute name="adjustedtargetresponsetime" type="datetime" required="false" />
        <attribute name="ageflag" type="varchar" required="false" />
        <attribute name="area" type="varchar" required="false" />
        <attribute name="classificationid" type="varchar" required="false" />
        <attribute name="correlationattrs" type="varchar" required="false" />
        <attribute name="createdby" type="varchar" required="false" />
        <attribute name="creationdate" type="datetime" required="false" />
        <attribute name="descsrvid" type="varchar" required="false" />
        <attribute name="developmentrequest" type="smallint" required="true" />
        <attribute name="externalsystem" type="varchar" required="false" />
        <attribute name="externalsystem_ticketid" type="varchar" required="false" />
        <attribute name="feature_request" type="smallint" required="true" />
        <attribute name="indicatedpriority" type="int" required="false" />
        <attribute name="oncallautoassign" type="smallint" required="true" />
        <attribute name="oncallfirstrotassnperson" type="varchar" required="false" />
        <attribute name="oncallownergroup" type="varchar" required="false" />
        <attribute name="oncallreassigntime" type="datetime" required="false" />
        <attribute name="oncallstarttime" type="datetime" required="false" />
        <attribute name="outageduration" type="float" required="false" />
        <attribute name="pluspagreement" type="varchar" required="false" />
        <attribute name="pluspbblinenum" type="int" required="false" />
        <attribute name="pluspbillbatch" type="varchar" required="false" />
        <attribute name="pluspcalccalnum" type="varchar" required="false" />
        <attribute name="pluspcalcorgid" type="varchar" required="false" />
        <attribute name="pluspcalcshift" type="varchar" required="false" />
        <attribute name="pluspcostcenter" type="varchar" required="false" />
        <attribute name="pluspcustchacct" type="varchar" required="false" />
        <attribute name="pluspcustomer" type="varchar" required="false" />
        <attribute name="pluspcustponum" type="varchar" required="false" />
        <attribute name="pluspmaxprice" type="decimal" required="false" />
        <attribute name="pluspporeq" type="smallint" required="true" />
        <attribute name="plusppricesched" type="varchar" required="false" />
        <attribute name="pluspquotedprice" type="decimal" required="false" />
        <attribute name="pluspquotetype" type="varchar" required="false" />
        <attribute name="pluspresponseplan" type="varchar" required="false" />
        <attribute name="plusprevnum" type="int" required="false" />
        <attribute name="pmcomimpact" type="int" required="false" />
        <attribute name="pmcomresolution" type="varchar" required="false" />
        <attribute name="pmcomtype" type="varchar" required="false" />
        <attribute name="pmcomurgency" type="int" required="false" />
        <attribute name="pmcosolappliedby" type="varchar" required="false" />
        <attribute name="pmcosolapplieddate" type="datetime" required="false" />
        <attribute name="pmcosolfeedback" type="varchar" required="false" />
        <attribute name="pmcosolstatus" type="varchar" required="false" />
        <attribute name="pmsccrid" type="varchar" required="false" />
        <attribute name="pmsccurrency" type="varchar" required="false" />
        <attribute name="pmscinvalid" type="smallint" required="false" />
        <attribute name="pmscitemnum" type="varchar" required="false" />
        <attribute name="pmscitemsetid" type="varchar" required="false" />
        <attribute name="pmscoffsummary" type="varchar" required="false" />
        <attribute name="pmsconetimeprice" type="decimal" required="false" />
        <attribute name="pmscquantity" type="int" required="false" />
        <attribute name="pmscrecurringprice" type="decimal" required="false" />
        <attribute name="pmsctmplid" type="bigint" required="false" />
        <attribute name="pmsctotalonetimeprice" type="decimal" required="false" />
        <attribute name="pmsctotalrecurringprice" type="decimal" required="false" />
        <attribute name="proactive" type="smallint" required="true" />
        <attribute name="problemtype" type="varchar" required="false" />
        <attribute name="proposedversion" type="varchar" required="false" />
        <attribute name="region" type="varchar" required="false" />
        <attribute name="replacedowner" type="varchar" required="false" />
        <attribute name="reportedversion" type="varchar" required="false" />
        <attribute name="responseslo" type="smallint" required="true" />
        <attribute name="rigname " type="varchar" required="false" />
        <attribute name="servicecompanytype" type="varchar" required="false" />
        <attribute name="slaapplied" type="smallint" required="flase" query="(select Case COUNT(OWNERID) when 0 then 0 else 1 end from slarecords where slarecords.ownertable = 'TICKET' and slarecords.ownerid = !@ticketuid )" />
        <attribute name="slaapproachingindicator" type="varchar" required="false" />
        <attribute name="slamet" type="smallint" required="true" />
        <attribute name="targetversion" type="varchar" required="false" />
        <attribute name="tfsnumber" type="varchar" required="false" />
        <attribute name="virtualenv" type="smallint" required="false" />
        <attribute name="wellname" type="varchar" required="false" />
        <attribute name="accumulateslaholdtime" type="smallint" required="false" query="(select COALESCE(slahold, 0) from slarecords sla inner join pluspservagree on sanum = sla.slanum where ownertable = 'TICKET' and ownerid = !@ticketuid)" />
        <attribute name="slaapplied" type="smallint" required="flase" query="(select Case COUNT(OWNERID) when 0 then 0 else 1 end from slarecords where slarecords.ownertable = 'TICKET' and slarecords.ownerid = !@ticketuid )" />
        <attribute name="attachmentcounter" type="int" query="(select count(*) from doclinks where ownertable = 'INCIDENT' and ownerid = !@ticketuid)" required="false"/>
      </attributes>
      <relationships>
        <relationship to="asset">
          <relationshipAttribute from="assetnum" to="assetnum" primary="true"/>
          <relationshipAttribute from="siteid" to="siteid" />
        </relationship>
        <relationship to="longdescription" >
          <relationshipAttribute from="ticketuid" to="ldkey" primary="true"/>
          <relationshipAttribute to="ldownertable" literal="TICKET" quoteLiteral="true" />
          <relationshipAttribute to="ldownercol" literal="DESCRIPTION" quoteLiteral="true" />
        </relationship>
        <relationship to ="alndomain" qualifier="area">
          <relationshipAttribute from="area" to="value" primary="true"/>
          <relationshipAttribute to ="domainid" literal="AREA" quoteLiteral="true"/>
        </relationship>
        <relationship to ="alndomain" qualifier="problemtype">
          <relationshipAttribute from="problemtype" to="value" primary="true"/>
          <relationshipAttribute to ="domainid" literal="PROBLEMTYPE" quoteLiteral="true"/>
        </relationship>
        <relationship to ="alndomain" qualifier="proposedversion">
          <relationshipAttribute from="proposedversion" to="value" primary="true"/>
          <relationshipAttribute to ="domainid" literal="PROPOSED VERSION" quoteLiteral="true"/>
        </relationship>
        <relationship to ="alndomain" qualifier="reportedversion">
          <relationshipAttribute from="reportedversion" to="value" primary="true"/>
          <relationshipAttribute to ="domainid" literal="REPORTED VERSION" quoteLiteral="true"/>
        </relationship>
        <relationship to ="alndomain" qualifier="targetversion">
          <relationshipAttribute from="targetversion" to="value" primary="true"/>
          <relationshipAttribute to ="domainid" literal="TARGETVERSION" quoteLiteral="true"/>
        </relationship>
     
        <relationship to="location">
          <relationshipAttribute from="location" to="location" primary="true"/>
          <relationshipAttribute from="siteid" to="siteid" />
        </relationship>
        <relationship to="relatedrecord" collection="true">
          <relationshipAttribute from="ticketid" to="recordkey" primary="true"/>
          <relationshipAttribute to="class" literal="INCIDENT" quoteLiteral="true"/>
        </relationship>
        <relationship to="worklog" collection="true">
          <relationshipAttribute from="ticketid" to="recordkey" primary="true" />
          <relationshipAttribute from="siteid" to="siteid" />
          <relationshipAttribute to="class" literal="INCIDENT" quoteLiteral="true" />
        </relationship>
        
        <relationship to="DOCLINKS" qualifier="attachment" collection="true">
          <relationshipAttribute from="ticketuid" to="ownerid" primary="true"/>
          <relationshipAttribute to="ownertable" literal="INCIDENT" quoteLiteral="true"/>
        </relationship>
      
        <relationship to="person" qualifier="affectedperson">
          <relationshipAttribute from="affectedperson" to="personid" primary="true"/>
        </relationship>
        <relationship to="numericdomain" qualifier="internalpriority" cacheable="true">
          <relationshipAttribute from="internalpriority" to="value" primary="true"/>
          <relationshipAttribute to ="domainid" literal="TICKETPRIORITY" quoteLiteral="true"/>
        </relationship>
        <relationship to="numericdomain" qualifier="reportedpriority" cacheable="true">
          <relationshipAttribute from="reportedpriority" to="value" primary="true"/>
          <relationshipAttribute to ="domainid" literal="TICKETPRIORITY" quoteLiteral="true"/>
        </relationship>
        <relationship to ="classusewith" qualifier="incidentclassstructures">
          <relationshipAttribute from="classstructureid" to="classstructureid" primary="true"/>
          <relationshipAttribute to="objectvalue" literal="INCIDENT" quoteLiteral="true"/>
        </relationship>
        <relationship to="incidentclassifications" qualifier="incidentclassifications">
          <relationshipAttribute from="classificationid" to="classificationid" primary="true"/>
        </relationship>
        <relationship to ="site">
          <relationshipAttribute from="siteid" to="siteid" primary="true"/>
        </relationship>
        <relationship to ="solution" qualifier="solution" >
          <relationshipAttribute from="solution" to ="solution" primary="true"/>
          <relationshipAttribute to="status" literal="active" quoteLiteral="true"/>
        </relationship>
        <relationship to="commodities" qualifier="commoditygroup">
          <relationshipAttribute from="commoditygroup" to="commodity" primary="true" />
          <relationshipAttribute query="parent IS NULL"/>
        </relationship>

        <relationship to="commodities" qualifier="commodity">
          <relationshipAttribute from="commodity" to="commodity" primary="true" />
          <relationshipAttribute query="parent IS NOT NULL"/>
        </relationship>

        <relationship to="alndomain" qualifier="servicecompanytype">
          <relationshipAttribute from="servicecompanytype" to="value" primary="true" />
          <relationshipAttribute to ="domainid" literal="SERVCOMPTYPE" quoteLiteral="true"/>
        </relationship>
      </relationships>
     <connectorParameters>
        <connectorParameter key="dbtable" value="incident" />
        <connectorParameter key="integration_interface" value="SWINCIDENT" />
        <connectorParameter key="customconnector" value="softwrench.sw4.kongsberg.classes.com.cts.kongsberg.connector.KongsbergIncidentCrudConnector" />
      </connectorParameters>
    </entity>

    <entity name="wochange" idAttribute="workorderid">
      <attributes>
        <attribute name="workorderid" type="integer" required="true" />

      </attributes>
      <relationships>
        <relationship to="longdescription">
          <relationshipAttribute from="workorderid" to="ldkey" primary="true"/>
          <relationshipAttribute to="ldownertable" literal="WORKORDER" quoteLiteral="true" />
          <relationshipAttribute to="ldownercol" literal="DESCRIPTION" quoteLiteral="true" />
        </relationship>
        <relationship to="longdescription" qualifier="reasonforchange">
          <relationshipAttribute from="workorderid"  to="ldkey" primary="true"/>
          <relationshipAttribute to="ldownertable" literal="WORKORDER" quoteLiteral="true" />
          <relationshipAttribute to="ldownercol" literal="REASONFORCHANGE" quoteLiteral="true" />
        </relationship>
        <relationship to="longdescription" qualifier="backoutplan">
          <relationshipAttribute from="workorderid" to="ldkey" primary="true"/>
          <relationshipAttribute to="ldownertable" literal="WORKORDER" quoteLiteral="true" />
          <relationshipAttribute to="ldownercol" literal="BACKOUTPLAN" quoteLiteral="true" />
        </relationship>
        <relationship to="longdescription" qualifier="pretestdetail">
          <relationshipAttribute from="workorderid" to="ldkey" primary="true"/>
          <relationshipAttribute to="ldownertable" literal="WORKORDER" quoteLiteral="true" />
          <relationshipAttribute to="ldownercol" literal="ITDCHGPRETSTDTL" quoteLiteral="true" />
        </relationship>
        <relationship to="longdescription" qualifier="exceptionreason">
          <relationshipAttribute from="workorderid" to="ldkey" primary="true"/>
          <relationshipAttribute to="ldownertable" literal="WORKORDER" quoteLiteral="true" />
          <relationshipAttribute to="ldownercol" literal="EXCEPTIONREASON" quoteLiteral="true" />
        </relationship>
        <relationship to="workorder">
          <relationshipAttribute from="wonum" to="parent" primary="true"/>
          <relationshipAttribute from="siteid" to="siteid" />
        </relationship>
        <relationship to="pmchgotherapprovers" qualifier="approvalsdashboard">
          <relationshipAttribute from="wonum" to="wonum" primary="true" />
          <relationshipAttribute from="siteid" to="siteid" />
        </relationship>
        <relationship to="woactivity" qualifier="woactivitydashboard">
          <relationshipAttribute from="wonum" to="parent" primary="true" />
          <relationshipAttribute from="siteid" to="siteid" />
        </relationship>
        <relationship to="worklog">
          <relationshipAttribute from="wonum" to="recordkey" primary="true" />
          <relationshipAttribute from="siteid" to="siteid" />
          <relationshipAttribute to="class" literal="CHANGE" quoteLiteral="true" />
        </relationship>
      </relationships>
      <connectorParameters>
        <connectorParameter key="integration_interface" value="SWCH" />
        <connectorParameter key="customconnector" value="softWrench.sW4.Data.Persistence.WS.Commons.BaseChangeRequestCrudConnector" />
      </connectorParameters>
    </entity>

    <entity name="solution" idAttribute="solutionid" useridAttribute="solution">
      <attributes>
        <attribute name="allkeywords" type="varchar" required="false" query="(SELECT keyworddesc + ',' AS 'data()' FROM solnkeyword INNER JOIN keyword ON solnkeyword.keyword = keyword.keyword WHERE solnkeyword.solution = !@solution FOR XML PATH(''))" />
        <attribute name="pluspinsertcustomer" type="varchar" required="false" />
        <attribute name="assignedownergroup" type="varchar" required="false" />
        <attribute name="expdate" type="datetime" required="false" />
        <attribute name="solnauthor" type="varchar" required="false" />
        <attribute name="extsolnid" type="varchar" required="false" />
        <attribute name="lastviewdate" type="datetime" required="false" />
        <attribute name="keywords" type="varchar" required="false" />
        <attribute name="numtimesapplied" type="int" required="false" />
        <attribute name="numtimesappliedss" type="int" required="false" />
        <attribute name="avgranking" type="int" required="false" />
        <attribute name="cinum" type="varchar" required="false" />
        <attribute name="assetnum" type="varchar" required="false" />
        <attribute name="assetsiteid" type="varchar" required="false" />
        <attribute name="rtsymptom" type="varchar" required="false" />
        <attribute name="rtcause" type="varchar" required="false" />
        <attribute name="rtresoln" type="varchar" required="false" />
        <attribute name="rtsymptomlbl" type="varchar" required="false" />
        <attribute name="rtcauselbl" type="varchar" required="false" />
        <attribute name="rtresolnlbl" type="varchar" required="false" />
        <attribute name="owner" type="varchar" required="false" />
        <attribute name="ownergroup" type="varchar" required="false" />
        <attribute name="pmsoleffscore" type="int" required="false" />
        <attribute name="pmsolsuccessbysd" type="int" required="false" />
        <attribute name="pmsolpriority" type="int" required="false" />
        <attribute name="siteid" type="varchar" required="false" />
      </attributes>
      <relationships>
        <relationship to="site">
          <relationshipAttribute from="siteid" to ="siteid" primary="true"/>
          <relationshipAttribute to="active" literal="1" quoteLiteral="true"/>
        </relationship>
        <relationship to="classstructure">
          <relationshipAttribute from="classstructureid" to="classstructureid" primary="true"/>
        </relationship>
        <relationship to="asset">
          <relationshipAttribute from="assetnum" to="assetnum" primary="true" />
        </relationship>
        <relationship to="synonymdomain" qualifier="synstatus" cacheable="true">
          <relationshipAttribute from="status" to="value" primary="true"/>
          <relationshipAttribute to="domainid" literal="SOLUTIONSTATUS" quoteLiteral="true" />
        </relationship>
      </relationships>
    </entity>

    <entity name="worklog" idAttribute="worklogid" >
      <attributes>
        <attribute name="worklogid" type="bigint" required="true" />
        <attribute name="logtype" type="varchar" required="true" />
        <attribute name="createby" type="varchar" required="true" />
        <attribute name="createdate" type="datetime" required="true" />
        <attribute name="clientviewable" type="smallint" required="true" />
        <attribute name="description" type="varchar" required="false" />
        <attribute name="siteid" type="varchar" required="false" />
        <attribute name="orgid" type="varchar" required="false" />
        <attribute name="modifyby" type="varchar" required="true" />
        <attribute name="modifydate" type="datetime" required="true" />
        <attribute name="recordkey" type="varchar" required="true" />
        <attribute name="class" type="varchar" required="true" />
        <attribute name="langcode" type="varchar" required="true" />
        <attribute name="hasld" type="smallint" required="true" />
        <attribute name="rowstamp" type="timestamp" required="true" />
        <attribute name="assignmentid" type="bigint" required="false" />
      </attributes>
      <relationships>
        <relationship to="longdescription" qualifier="worklogdesc" >
          <relationshipAttribute from="worklogid" to="ldkey" primary="true"/>
          <relationshipAttribute to="ldownertable" literal="WORKLOG" quoteLiteral="true" />
          <relationshipAttribute to="ldownercol" literal="DESCRIPTION" quoteLiteral="true" />
        </relationship>
        <relationship to="synonymdomain" >
          <relationshipAttribute from="logtype" to="value" primary="true"/>
          <relationshipAttribute to="domainid" literal="LOGTYPE" quoteLiteral="true"/>
          <relationshipAttribute to="defaults" literal="1" quoteLiteral="true"/>
        </relationship>
        <relationship to="person" qualifier="createdbyperson" >
          <relationshipAttribute from="createby" to="personid" primary="true"/>
        </relationship>
        <relationship to="DOCLINKS" qualifier="attachment" collection="false">
          <relationshipAttribute from="worklogid" to="ownerid" primary="true"/>
          <relationshipAttribute to="ownertable" literal="WORKLOG" quoteLiteral="true"/>
        </relationship>
      </relationships>
      <connectorParameters>
        <connectorParameter key="mea_integration_interface" value="ISW_WL" />
      </connectorParameters>
    </entity>

    <entity name="commlog" idAttribute="commloguid">
      <attributes>
        <attribute name="ccflag" query="CASE WHEN !@cc is not null THEN 'true' ELSE 'false' end " type="bool"/>
      </attributes>
    </entity>

   <entity name="projectrequest" parententity="SR" idAttribute="ticketuid" useridAttribute="ticketid" whereclause="(projectrequest.classificationid = 'PROJECT REQUEST')">
      <relationships>
        <relationship to="ticketspec" collection="true">
          <relationshipAttribute from="ticketid" to="ticketid" primary="true"/>
          <relationshipAttribute from="orgid" to="orgid"/>
          <relationshipAttribute from="siteid" to="siteid"/>
        </relationship>
        <relationship to="alndomain" qualifier="servicecompany" ignoreprimary="true">
          <relationshipAttribute from="servcomp" to="value"/>
          <relationshipAttribute to="domainid" literal="SERVICECOMPANY" quoteLiteral="true" primary="true"/>
        </relationship>
        <relationship to="synonymdomain" qualifier="timezones" ignoreprimary="true" cacheable="true">
          <relationshipAttribute from="wellsitetimezone" to="value"/>
          <relationshipAttribute to="domainid" literal="TIMEZONE" quoteLiteral="true" primary="true"/>
        </relationship>
      </relationships>
      <connectorParameters>
        <connectorParameter key="customconnector" value="softwrench.sw4.kongsberg.classes.com.cts.kongsberg.connector.KongsbergProjectRequestCrudConnector" />
      </connectorParameters>
    </entity>

  </entities>

  <applications>
    <application entity="SR" name="servicerequest" title="Service Request">
      <properties>
        <property key="mobile.disabled" value="true"/>
      </properties>

      <components>
        <componentdisplayable id="srhiddens">
          <field attribute="ticketid" label="Reference ID:" readonly="true" hidden="true"/>
          <field attribute="ticketuid" label="Unique ID:" hidden="true"/>
          <field attribute="class" label="" hidden="true"/>
          <field attribute="actlabcost" hidden="true" />
          <field attribute="actlabhrs" hidden="true"/>
          <field attribute="siteid" hidden="true" />
          <field attribute="orgid" hidden="true"/>
          <field attribute="createby" hidden="true"/>
          <field attribute="changeby" default="@username" hidden="true"/>
          <!-- hiddens for communication template -->
          <field attribute="changedate" hidden="true"/>
          <field attribute="classificationid" hidden="true"/>
          <field attribute="reportedemail" hidden="true"/>
          <field attribute="affectedemail" hidden="true"/>
          <field attribute="ownerperson_.displayname" hidden="true"/>
        </componentdisplayable>
      </components>

      <filters>
        <optionfilter attribute="status" provider="synstatus_.description" displaycode="true"/>
        <!--            <optionfilter attribute="classificationid" provider="@FilterClassifications" displaycode="true"/>-->

        <optionfilter attribute="problemtype" provider="problemtype_.description" displaycode="true" allowblank="true"/>
        <optionfilter attribute="area" provider="area_.description" displaycode="true" allowblank="true"/>
        <optionfilter attribute="internalpriority" provider="internalpriority_.description" displaycode="true" allowblank="true"/>


        <optionfilter attribute="owner" provider="ownerperson_.displayname" allowblank="true">
          <option xmlns="http://www.controltechnologysolutions.com/filters" label="Current User" value="@username"/>
        </optionfilter>

        <optionfilter attribute="ownergroup" provider="persongroup_.description" allowblank="true" displaycode="true"/>

        <optionfilter attribute="reportedby" provider="reportedbyperson_.displayname" allowblank="true">
          <option xmlns="http://www.controltechnologysolutions.com/filters" label="Current User" value="@username"/>
        </optionfilter>
      
        <optionfilter attribute="statusicons" displaycode="true">
          <option xmlns="http://www.controltechnologysolutions.com/filters" label="Attachments" value="attachments" />
        </optionfilter>
      </filters>

      <schemas>
        <list title="Service Request Grid">
          <field attribute="ticketid" label="SR#">
            <renderer type="default" params="width=6%" />
          </field>
          <field attribute="description" label="Summary">
            <renderer type="default" params="excelwidth=50" />
          </field>
          <field attribute="classificationid" label="Proj. Description">
            <renderer type="default" params="width=10%;excelwidth=50"/>
          </field>
          <field attribute="area" label="Area">
            <renderer type="default" params="width=13%;excelwidth=50" />
          </field>
          <field attribute="problemtype" label="Prob. Type">
            <renderer type="default" params="excelwidth=50"/>
          </field>
          <field attribute="reportedby" label="Reported By"/>
          <field attribute="internalpriority" label="Int. Priority"/>
          <field attribute="owner" label="Owner"/>
          <field attribute="ownergroup" label="Owner Group"/>
          <field attribute="changedate" label="Changed Date">
             <renderer type="datetime" params="format=MM/dd/yyyy HH:mm:ss;width=10%;showtime=false"/>
          </field>
          <field attribute="status" label="Status">
            <renderer type="statuscolor" params="width=10%;grid=servicerequest;column=status" />
          </field>
         <field attribute="attachments" tooltip="Attachments" hidden="true">
            <renderer type="icon" params="hideValueOnTooltip=true;icon=fa-paperclip;autoloadcomposition=attachment_"/>
          </field>
          <field attribute="statusicons" tooltip="Status Icons">
            <renderer type="statusicons" params="width=9%;iconcolumns=attachments;icon=fa-tachometer;headericon=true;showsort=false"/>
          </field>
          <properties>
            <property key="list.click.schema" value="editdetail"/>
            <property key="list.width.min" value="1600px"/>
          </properties>
        </list>

        <schema id="supportlist" stereotype="list">
          <field attribute="ticketid" label="Service Request">
            <renderer type="default"  params="width=9%" />
          </field>
          <field attribute="classificationid" label="Project">
            <renderer type="default" params="width=9%;excelwidth=50"/>
          </field>
          <field attribute="description" label="Summary">
            <renderer type="default" params="excelwidth=50" />
          </field>
          <field attribute="reportdate" label="Report Date">
            <renderer type="datetime"/>
          </field>
          <field attribute="reportedby" label="Reported By">
            <renderer type="default" params="width=9%" />
          </field>
          <field attribute="status" label="Status">
            <renderer type="default" params="width=9%" />
          </field>
          <field attribute="owner" label="Owner">
            <renderer type="default" params="width=9%" />
          </field>
          <field attribute="ownergroup" label="Ass. Owner Group"></field>
          <field attribute="changedate" label="Changed Date">
            <renderer type="datetime" params="width=9%;showtime=false"/>
          </field>
          <field attribute="attachments" tooltip="Attachments">
            <renderer type="icon" params="width=3%;expression={'#default':'fa-paperclip','0':''};autoloadcomposition=attachment_"/>
          </field>
          <properties>
            <property key="list.click.schema" value="editdetail"/>
            <property key="list.defaultorderby" value="sr.classificationid, sr.changedate"/>
          </properties>
        </schema>

        <schema id="ledaflowlist" stereotype="list">
          <field attribute="classificationid" label="Project">
            <renderer type="default" params="width=9%;excelwidth=50"/>
          </field>
          <field attribute="ticketid" label="Service Request">
            <renderer type="default"  params="width=9%" />
          </field>
          <field attribute="description" label="Summary">
            <renderer type="default" params="excelwidth=50" />
          </field>
          <field attribute="reportdate" label="Report Date">
            <renderer type="datetime"/>
          </field>
          <field attribute="reportedby" label="Reported By">
            <renderer type="default" params="width=9%" />
          </field>
          <field attribute="status" label="Status">
            <renderer type="default" params="width=9%" />
          </field>
          <field attribute="problemtype_.description" label="Prob. Type"></field>
          <field attribute="area" label="Area">
            <renderer type="default" params="width=9%;excelwidth=50"/>
          </field>
          <field attribute="owner" label="Owner">
            <renderer type="default" params="width=9%" />
          </field>
          <field attribute="attachments" tooltip="Attachments">
            <renderer type="icon" params="width=3%;expression={'#default':'fa-paperclip','0':''};autoloadcomposition=attachment_"/>
          </field>
          <properties>
            <property key="list.click.schema" value="editdetail"/>
            <property key="list.defaultorderby" value="sr.classificationid, sr.changedate"/>
          </properties>
        </schema>

        <schema id="closelist" stereotype="list">
          <field attribute="ticketid" label="Service Request">
            <renderer type="default"  params="width=9%" />
          </field>
          <field attribute="classificationid" label="Project">
            <renderer type="default" params="width=9%;excelwidth=50"/>
          </field>
          <field attribute="description" label="Summary">
            <renderer type="default" params="excelwidth=50" />
          </field>
          <field attribute="reportdate" label="Report Date">
            <renderer type="datetime"/>
          </field>
          <field attribute="reportedby" label="Reported By">
            <renderer type="default" params="width=9%" />
          </field>
          <field attribute="status" label="Status">
            <renderer type="default" params="width=9%" />
          </field>
          <field attribute="owner" label="Owner">
            <renderer type="default" params="width=9%" />
          </field>
          <field attribute="ownergroup" label="Ass. Owner Group"></field>
          <field attribute="changedate" label="Changed Date">
            <renderer type="datetime" params="width=9%;showtime=false"/>
          </field>
          <field attribute="attachments" tooltip="Attachments">
            <renderer type="icon" params="width=3%;expression={'#default':'fa-paperclip','0':''};autoloadcomposition=attachment_"/>
          </field>
          <properties>
            <property key="list.click.schema" value="editdetail"/>
            <property key="list.defaultorderby" value="sr.classificationid, sr.changedate"/>
          </properties>
        </schema>

        <schema id="adetail" title="Request Details" abstract="true" stereotype="detail">
          <properties>
            <property key="detail.showtitle" value="true"/>
          </properties>

          <reference id="srhiddens"/>

          <section orientation="horizontal">
            <renderer type="default"/>
            <section id="srsection" />
            <association label="Owner:"  target="owner" labelfield="ownerperson_.displayname" requiredexpression="true" hideDescription="false">
              <renderer type="lookup" />
              <event type="afterchange" service="generalsrService" method="afterchangeowner"/>
            </association>
            <association label="Owner Group:" target="ownergroup" labelfield="persongroup_.description" requiredexpression="true" hideDescription="false">
              <dataprovider prefilterfunction="FilterByPersonGroup"/>
              <renderer type="lookup" />
              <event type="afterchange" service="generalsrService" method="afterchangeownergroup"/>
            </association>
          </section>

          <section>
            <header displacement="ontop" label="User Information" params="fieldset=true"/>
            <renderer type="default" params="childinputsize=medium" />
            <association label="Reported By:" target="reportedby" labelfield="reportedbyperson_.displayname" default="@username" orderbyfield="personid asc">
              <renderer type="lookup" params="columnlabel=Name" />
            </association>
            <association label="Affected By:" target="affectedperson" labelfield="person_.displayname" default="@username" orderbyfield="personid asc">
              <renderer type="lookup" params="columnlabel=Name" />
            </association>
          </section>

          <section>
            <header displacement="ontop" label="Service Request Details" params="fieldset=true"/>
            <field attribute="description" label="Summary:" requiredexpression="true">
              <renderer type="default" params="maxlength=100"/>
            </field>
            <field label="Details:" attribute="longdescription_.ldtext">
              <renderer type="richtext" />
            </field>
          </section>


          <section>
            <header displacement="ontop" label="Project Details" params="fieldset=true"/>
            <optionfield attribute="classstructureid" label="Classification:" providerattribute="_SRClassStructureType" default="@classstructureid" requiredexpression="true">
              <renderer type="autocompleteclient" />
            </optionfield>

            <section orientation="horizontal">
              <renderer type="default" params="childinputsize=small" />
              <association label="Site:" target="siteid" labelfield="site_.description" requiredexpression="true">
                <renderer type="combo" />
              </association>
              <field label="TFS#:" attribute="tfsnumber" />
              <association label="Area:" target="area" labelfield="area_.description" requiredexpression="true" orderbyfield="value asc">
                <renderer type="lookup" />
              </association>
              <association label ="Internal Priority:" target="internalpriority" labelfield="internalpriority_.description">
                <renderer type="lookup" />
              </association>
              <association label ="Reported Version:" target="reportedversion" labelfield="reportedversion_.description" requiredexpression="@feature_request == 1">
                <renderer type="lookup" />
              </association>
              <association label="Problem Type:" target="problemtype" labelfield="problemtype_.description" requiredexpression="true" orderbyfield="value asc">
                <renderer type="lookup" />
              </association>
              <association label ="Reported Priority:" target="reportedpriority" labelfield="reportedpriority_.description">
                <renderer type="lookup" />
              </association>
              <association label ="Proposed Version:" target="proposedversion" labelfield="proposedversion_.description">
                <renderer type="lookup" />
              </association>
              <field label="Region:" attribute="region" />
              <association label ="Service Group:" target="commoditygroup" labelfield="commoditygroup_.description">
                <renderer type="lookup" />
              </association>
              <association label ="Target Version:" target="targetversion" labelfield="targetversion_.description">
                <renderer type="lookup" />
              </association>
              <field label="Rig Name:" attribute="rigname" />
              <association label ="Service:" target="commodity" labelfield="commodity_.description">
                <renderer type="lookup" />
              </association>
              <field label="Feature Request?" attribute="feature_request">
                <renderer type="checkbox" />
              </field>
              <field label="Well Name:" attribute="wellname" />
              <association label ="Service Company Type:" target="servicecompanytype" labelfield="servicecompanytype_.description">
                <renderer type="lookup" />
              </association>
            </section>
          </section>

          <section>
            <header displacement="ontop" label="Key Dates" params="fieldset=true"/>
            <section>
              <field label="Reported Date:" attribute="reportdate" readonly="true" default="@currentdatetime">
                <renderer type="datetime"  params="inputsize=small" />
              </field>
            </section>
            <section orientation="horizontal">
              <renderer type="default" params="childinputsize=medium" />
              <field label="Target Start:" attribute="targetstart" readonly="true">
                <renderer type="datetime" />
              </field>
              <field label="SLA Applied?" attribute="slaapplied" enableexpression="false">
                <renderer type="checkbox" />
              </field>
              <field label="Adjusted Start:" attribute="adjustedtargetresponsetime" readonly="true">
                <renderer type="datetime" />
              </field>
              <field label="Target Finish:" attribute="targetfinish" readonly="true">
                <renderer type="datetime" />
              </field>
              <field label="SLA Hold Enabled?" attribute="accumulateslaholdtime" enableexpression="false">
                <renderer type="checkbox" />
              </field>
              <field label="Adjusted Finish:" attribute="adjustedtargetresolutiontime" readonly="true">
                <renderer type="datetime" />
              </field>
              <field label="Actual Start Date:" attribute="actualstart" readonly="true">
                <renderer type="datetime" />
              </field>
              <field label="SLA Met?" attribute="slamet" enableexpression="false">
                <renderer type="checkbox" />
              </field>
              <field label="Accumulated Hold Time(HH:MM):" attribute="accumulatedholdtime" readonly="true">
                <renderer type="default" params="formatter=doubleToTime"/>
              </field>
              <field label="Actual End Date:" attribute="actualfinish" readonly="true">
                <renderer type="datetime" />
              </field>
              <field label="Response SLO?" attribute="responseslo" enableexpression="false">
                <renderer type="checkbox" />
              </field>
              <field label="Proactive?" attribute="proactive">
                <renderer type="checkbox" />
              </field>
            </section>
          </section>
          <section id="attachmentsection" />
          <section id="compositions"/>
        </schema>

        <schema parentschema="adetail" title="New Service Request" id="newdetail" stereotype="detailnew">
          <section id="srsection">
            <field attribute="ticketid" label="SR#" hidden="true" />
            <field label="Status:" attribute="status" readonly="true" default="NEW" hidden="true" />
          </section>
          <!--SSWEB 173-->
          <section id="attachmentsection">
            <field label="Attachment:" attribute="newattachment" >
              <renderer type="dndupload"/>
            </field>
          </section>
        </schema>
        <schema parentschema="adetail" id="editdetail" title="Service Request Detail">
          <section id="srsection">
            <field attribute="ticketid" label="SR#" readonly="true" requiredexpression="true" />
            <optionfield label="Status:" attribute="status">
              <renderer type="combo" />
              <option label="Duplicate" value="DUPLICATE"/>
              <option label="Closed" value="CLOSED"/>
              <option label="Edited in History" value="HISTEDIT"/>
              <option label="In Progress" value="INPROG"/>
              <option label="New" value="NEW"/>
              <option label="Pending" value="PENDING"/>
              <option label="Queued" value="QUEUED"/>
              <option label="Resolved" value="RESOLVED"/>
              <option label="SLA Hold" value="SLAHOLD"/>
              <option label="Spam" value="SPAM"/>
            </optionfield>
          </section>
          <section id="compositions">
            <tab label="Solution" id="solution" icon="fa fa-book">
              <field attribute="solution" hidden="true"/>
              <association label="Solution:" target="solution" labelfield="solution_.description" extraprojectionvalues="symptom_.ldtext,cause_.ldtext,resolution_.ldtext">
                <renderer type="lookup"/>
                <event type="afterchange" service="solutionService" method="setsolutiondata"/>
              </association>
              <optionfield attribute="pmcosolstatus" label="Solution Status:">
                <renderer type="combo" params="inputsize=medium;optionfield.donotusefirstoptionasdefault=true" />
                <option label="Under Consideration" value="CONSIDER" />
                <option label="Solution Failed" value="FAIL" />
                <option label="Solution Successful" value="SUCCESS" />
              </optionfield>
              <field attribute="selfservsolaccess" label="Self-Service Access?">
                <renderer type="checkbox" params="inputsize=medium" />
              </field>
              <field attribute="solution_.description" label="Description:" readonly="true" hidden="true"/>
              <field attribute="symptom_.ldtext" label="Symptom:">
                <renderer type="richtext"/>
              </field>
              <field attribute="cause_.ldtext" label="Cause:" >
                <renderer type="richtext"/>
              </field>
              <field attribute="resolution_.ldtext" label="Resolution:" >
                <renderer type ="richtext"/>
              </field>
            </tab>
            <composition relationship="worklog" label="Work Logs">
              <collectionproperties allowcreation="@status!='CLOSED'" allowupdate="true" orderbyfield="modifydate desc"/>
            </composition>
            <composition relationship="commlog" label="Communications">
              <collectionproperties allowcreation="@status!='CLOSED'" allowupdate="false" orderbyfield="createdate desc"/>
              <event type="onviewdetail" service="commlogService" method="updatereadflag"/>
            </composition>
            <composition relationship="attachment" label="Attachments">
              <collectionproperties allowcreation="@status!='CLOSED'" allowupdate="false" prefilterfunction="BuildRelatedAttachmentsWhereClause"/>
            </composition>
            <composition relationship="relatedrecord" label="Related Records">
              <collectionproperties allowupdate="false" />
            </composition>
          </section>

          <event type="beforesubmit.prevalidation" service="genericTicketService" method="validateCloseStatus"/>
          <commandbars>
             <commandgroup position="actions">
              <!--<container label="Actions" id="actioncontainer" icon="fa-bolt">-->
                <command id="dispatchincident" icon="fa-warning" label="Create Incident" permissionexpression="@maximoVersionEvaluator.IsSCCD"
                          parameters="schema,datamap" service="dispatchService" method="dispatchIncident" cssclasses="large-button" enableexpression="$scope:enableSave"/>
                
                <!--<command id="crud_delete" label="Delete" service="crudextraService" method="deletefn" parameters="schema,datamap"
                      showexpression="@status=='NEW' &amp;&amp; @reportedby==@username" successmessage="SR deleted"/>-->

                <!-- Create new SR as Related Record -->
                <command id="createrelated"
                         service="srService" method="startRelatedSRCreation" parameters="schema,datamap"
                         label="Create Request" icon="fa-ticket" cssclasses="large-button" enableexpression="$scope:enableSave"/>

              <!--</container>-->
            </commandgroup>
          </commandbars>
        </schema>
      </schemas>
    </application>

    <!--    ToString="asset + @description"-->

    <application name="incident" title="Incident" entity="incident">

      <filters>
        <optionfilter attribute="status" provider="synstatus_.description" displaycode="true"/>
        <!--            <optionfilter attribute="classificationid" provider="@FilterClassifications" displaycode="true"/>-->
        <optionfilter attribute="internalpriority" provider="internalpriority_.description" displaycode="true" allowblank="true"/>
        <optionfilter attribute="reportedpriority" provider="reportedpriority_.description" displaycode="true" allowblank="true"/>


        <optionfilter attribute="owner" provider="ownerperson_.displayname" allowblank="true">
          <option xmlns="http://www.controltechnologysolutions.com/filters" label="Current User" value="@username"/>
        </optionfilter>

        <optionfilter attribute="ownergroup" provider="persongroup_.description" allowblank="true" displaycode="true"/>

        <optionfilter attribute="reportedby" provider="reportedbyperson_.displayname" allowblank="true">
          <option xmlns="http://www.controltechnologysolutions.com/filters" label="Current User" value="@username"/>
        </optionfilter>
      </filters>


      <schemas>
        <list title="Incident Grid" redeclaring="false">
          <customization position="description">
            <field attribute="description" label="Summary">
              <renderer type="default" params="excelwidth=50"/>
            </field>
          </customization>

          <customization position="asset_.description">
          </customization>

          <customization position="targetfinish">
          </customization>

          <customization position="reportdate">
          </customization>

          <customization position="ownergroup">
            <field attribute="classificationid" label="Project Description">
              <renderer type="default" params="excelwidth=50"/>
            </field>

            <field attribute="reportedby" label="Reported By"/>
            <field attribute="internalpriority" label="Internal Priority"/>
            <field attribute="reportedpriority" label="Reported Priority"/>
            <field attribute="owner" label="Owner"/>
            <field attribute="ownergroup" label="Owner Group"/>
          </customization>

          <customization position="status">
            <field attribute="status" label="Status">
              <renderer type="statuscolor" params="grid=incident;column=status"/>
            </field>
          </customization>

          <customization position="internalpriority">
          </customization>

          <properties>
            <property key="list.click.schema" value="editdetail"/>
            <property key="list.width.min" value="1600px"/>
          </properties>
        </list>
        <schema id="adetail" abstract="true" stereotype="detail" title="Incident Details">
          <properties>
            <property key="detail.showtitle" value="true"/>
          </properties>

          <field attribute="actlabcost" default="0" hidden="true" />
          <field attribute="actlabhrs" default="0" hidden="true" />
          <field attribute="ticketuid" label="Incident Id:" hidden="true" />
          <field attribute="orgid" hidden="true" />
          <field attribute="class" hidden="true" />
          <section id="ticketsection" />
          <association label="Owner:" target="owner" labelfield="ownerperson_.displayname" requiredexpression="true" hideDescription="false">
            <renderer type="lookup" params="inputsize=medium" />
            <event type="afterchange" service="generalsrService" method="afterchangeowner" />
          </association>
          <association label="Owner Group:" target="ownergroup" labelfield="persongroup_.description" requiredexpression="true" hideDescription="false">
            <dataprovider prefilterfunction="FilterByPersonGroup" />
            <renderer type="lookup" params="inputsize=medium" />
          </association>
          <section>
            <header displacement="ontop" label="User Information" params="fieldset=true" />

            <association label="Reported By:" target="reportedby" labelfield="reportedbyperson_.displayname" default="@username" orderbyfield="personid asc" hideDescription="false">
              <renderer type="lookup" params="columnlabel=Name;inputsize=medium"/>
            </association>

            <association label="Affected By:" target="affectedperson" labelfield="person_.displayname" default="@username" hideDescription="false">
              <renderer type="lookup" params="inputsize=medium" />
            </association>
          </section>
          <section>
            <header displacement="ontop" label="Incident Details" params="fieldset=true" />
            <field attribute="statusdate" hidden="true" />
            <field attribute="description" label="Summary:" requiredexpression="true">
              <renderer type="default" params="maxlength=100"/>
            </field>
            <field label="Details:" attribute="longdescription_.ldtext">
              <renderer type="richtext" />
            </field>
          </section>
          <section>
            <section>
              <header displacement="ontop" label="Project Details" params="fieldset=true" />
              <optionfield attribute="classstructureid" label="Classification:" providerattribute="_IncidentClassStructureType" default="@classstructureid" requiredexpression="true">
                <renderer type="autocompleteclient" />
              </optionfield>
            </section>

            <section orientation="horizontal">
              <renderer type="default" params="childinputsize=small" />

              <association label="Site:" target="siteid" labelfield="site_.description" requiredexpression="true">
                <renderer type="combo" />
              </association>
              <field label="TFS#:" attribute="tfsnumber">
                <renderer type="default" />
              </field>
              <association label="Area:" target="area" labelfield="area_.description" requiredexpression="true">
                <renderer type="lookup" />
              </association>
              <association label="Internal Priority:" target="internalpriority" labelfield="internalpriority_.description">
                <renderer type="lookup" />
              </association>
              <association label="Reported Version:" target="reportedversion" labelfield="reportedversion_.description" requiredexpression="@feature_request == 1">
                <renderer type="lookup" />
              </association>
              <association label="Problem Type:" target="problemtype" labelfield="problemtype_.description" requiredexpression="true">
                <renderer type="lookup" />
              </association>
              <association label="Reported Priority:" target="reportedpriority" labelfield="reportedpriority_.description">
                <renderer type="lookup" />
              </association>
              <association label="Proposed Version:" target="proposedversion" labelfield="proposedversion_.description">
                <renderer type="lookup" />
              </association>
              <field label="Region:" attribute="region">
                <renderer type="default" />
              </field>
              <association label ="Service Group:" target="commoditygroup" labelfield="commoditygroup_.description">
                <renderer type="lookup" />
              </association>
              <association label="Target Version:" target="targetversion" labelfield="targetversion_.description">
                <renderer type="lookup" />
              </association>
              <field label="Rig Name:" attribute="rigname">
                <renderer type="default" />
              </field>
              <association label ="Service:" target="commodity" labelfield="commodity_.description">
                <renderer type="lookup" />
              </association>
              <field label="Feature Request:" attribute="feature_request">
                <renderer type="checkbox" />
              </field>
              <field label="Well Name:" attribute="wellname">
                <renderer type="default" />
              </field>
              <association label ="Service Company Type:" target="servicecompanytype" labelfield="servicecompanytype_.description">
                <renderer type="lookup" />
              </association>
            </section>
          </section>

          <section>
            <header displacement="ontop" label="Key Dates" params="fieldset=true" />
            <field label="Reported Date:" attribute="reportdate" readonly="true" default="@currentdatetime">
              <renderer type="datetime" params="inputsize=small" />
            </field>
          </section>
          <section>
            <renderer type="default" params="childinputsize=medium" />
            <field label="Target Start Date:" attribute="targetstart" readonly="true">
              <renderer type="datetime" />
            </field>
            <field label="SLA Applied?" attribute="slaapplied" enableexpression="false">
              <renderer type="checkbox" />
            </field>
            <field label="Adjusted Start:" attribute="adjustedtargetresponsetime" readonly="true">
              <renderer type="datetime" />
            </field>
            <field label="Target Finish:" attribute="targetfinish" readonly="true">
              <renderer type="datetime" />
            </field>
            <field label="SLA Hold Enabled?" attribute="accumulateslaholdtime" enableexpression="false">
              <renderer type="checkbox" />
            </field>
            <field label="Adjusted Finish:" attribute="adjustedtargetresolutiontime" readonly="true">
              <renderer type="datetime" />
            </field>
            <field label="Actual Start Date:" attribute="actualstart" readonly="true">
              <renderer type="datetime" />
            </field>
            <field label="SLA Met?" attribute="slamet" enableexpression="false">
              <renderer type="checkbox" />
            </field>
            <field label="Accumulated Hold Time(HH:MM):" attribute="accumulatedholdtime" readonly="true">
              <renderer type="default" params="format=MM/dd/yyyy HH:mm;formatter=doubleToTime" />
            </field>
            <field label="Actual End Date:" attribute="actualfinish" readonly="true">
              <renderer type="datetime" />
            </field>
            <field label="Response SLO?" attribute="responseslo" enableexpression="false">
              <renderer type="checkbox" />
            </field>
            <field label="Proactive?" attribute="proactive">
              <renderer type="checkbox" />
            </field>
          </section>
          <section id="attachmentsection" />
          <section id="compositions" />
          <event type="beforesubmit.postvalidation" service="genericTicketService" method="handleStatusChange"/>
        </schema>
        <schema id="newdetail" parentschema="adetail" title="New Incident" stereotype="detailnew">
          <section id="ticketsection">
            <field attribute="ticketid" label="Incident#" hidden="true" />
            <field label="Status:" attribute="status" readonly="true" default="NEW" hidden="true" />
          </section>
          <section id="attachmentsection">
            <field label="Attachment:" attribute="newattachment">
              <renderer type="dndupload" />
            </field>
          </section>
        </schema>
        <schema id="editdetail" parentschema="adetail" title="Incident Details">
          <section id="ticketsection">
            <field attribute="ticketid" label="Incident#" readonly="true">
              <renderer type="default" params="inputsize=medium" />
            </field>
            <optionfield attribute="status" label="Status" requiredexpression="true" default="NEW">
              <renderer type="combo" params="inputsize=medium" />
              <option label="Closed" value="CLOSED" />
              <option label="In Progress" value="INPROG" />
              <option label="New" value="NEW" />
              <option label="Pending" value="PENDING" />
              <option label="Queued" value="QUEUED" />
              <option label="Resolved" value="RESOLVED" />
              <option label="SLA Hold" value="SLAHOLD" />
            </optionfield>
          </section>
          <section id="compositions">
            <tab label="Solution" id="solution" icon="fa fa-book">
              <field attribute="solution" hidden="true" />
              <association label="Solution:" target="solution" labelfield="solution_.description" extraprojectionvalues="symptom_.ldtext,cause_.ldtext,resolution_.ldtext">
                <renderer type="lookup" />
                <event type="afterchange" service="solutionService" method="setsolutiondata" />
              </association>
              <field attribute="solution_.description" label="Description:" readonly="true" hidden="true" />
              <field attribute="symptom_.ldtext" label="Symptom:">
                <renderer type="richtext" />
              </field>
              <field attribute="cause_.ldtext" label="Cause:">
                <renderer type="richtext" />
              </field>
              <field attribute="resolution_.ldtext" label="Resolution:">
                <renderer type="richtext" />
              </field>
            </tab>
            <composition relationship="worklog" label="Work Logs">
              <collectionproperties allowcreation="@status!='CLOSED' &amp;&amp; @status!='CAN'" allowupdate="true" orderbyfield="modifydate desc"/>
            </composition>
          
            
             <composition relationship="commlog" label="Communications">
              <collectionproperties allowcreation="@status!='CLOSED'" allowupdate="false" orderbyfield="createdate desc"/>
              <event type="onviewdetail" service="commlogService" method="updatereadflag"/>
            </composition>
  
            
            <composition relationship="attachment" label="Attachments">
              <collectionproperties allowcreation="@status!='CLOSED' &amp;&amp; @status!='CAN'" prefilterfunction="BuildRelatedAttachmentsWhereClause" />
            </composition>
            <composition relationship="relatedrecord" label="Related Records">
              <collectionproperties allowupdate="false" />
            </composition>
            <event type="beforesubmit.prevalidation" service="genericTicketService" method="validateCloseStatus" />
          </section>
        </schema>
      </schemas>
    </application>

    <application entity="wochange" name="change" title="Change">
      <schemas>
        <list title="Change Grid">
          <field attribute="workorderid" hidden="true">

          </field>
          <field attribute="wonum" label="Change#">
            <renderer type="default" params="width=16%" />
          </field>
          <field attribute="description" label="Summary">
            <renderer type="default" params="excelwidth=50" />
          </field>
          <field attribute="status" label="Status" >
            <renderer type="default" params="width=16%" />
          </field>
          <field label="Reported Date" attribute="reportdate">
            <renderer type ="datetime" params="width=16%"/>
          </field>
          <field attribute="schedstart" label="Scheduled Start Date">
            <renderer type ="default" params="width=16%"/>
          </field>
          <field attribute="pmchgtype" label="Type" >
            <renderer type="default" params="width=16%" />
          </field>
          <field attribute="priority" label="Priority" >
            <renderer type="default" params="width=16%" />
          </field>
          <field attribute="risk" label="Risk" >
            <renderer type="default" params="width=16%" />
          </field>
          <field attribute="#color" label="">
            <renderer type="color" params="width=4%;grid=change;column=status"/>
          </field>


          <properties>
            <property key="list.click.schema" value="editdetail"/>
          </properties>
        </list>

        <schema id="editdetail" title="Change Details" abstract="true" stereotype="detail" platform="web">
          <field attribute="workorderid" hidden="true" />
          <field attribute="workorder_.wonum" hidden="true" />
          <field attribute="workorder_.status" hidden="true" />


          <field attribute="wonum" label="Change#" requiredexpression="true"/>
          <field attribute="ownergroup" label="Owner Group:"/>
          <!--<field attribute="location" label="Location:"/>-->

          <field attribute="description" label="Summary:">
            <renderer type="default" params="maxlength=100"/>
          </field>
          <field attribute="reportedby" label="Reported By:"/>
          <field attribute="classstructureid" label="Classification:"/>

          <field attribute="worktype" label="Category:"/>
          <!--field attribute="pmcomimpact" label="Impact"/>
          <field attribute="pmcomurgency" label="Urgency"/-->
          <field attribute="reasonforchange" label="Reason:"/>
          <field attribute="reasonforchange_.ldtext" label="Reason Details:"/>
          <!--field attribute="itdchgbusimpct" label="Business Impact"/-->
          <field attribute="verification" label="Verification:"/>
          <!--field attribute="itdbckoutdur" label="Backout Duration"/-->
          <field attribute="backoutplan" label="Back Out Plan:"/>
          <field attribute="backoutplan_.ldtext" label="Back Out Plan Detail:"/>
          <!--field attribute="itdchgpretstdtl" label="Pretest"/-->
          <field attribute="pretestdetail_.ldtext" label="Pretest Details:"/>
          <field attribute="schedstart" label="Scheduled Start Date:"/>
          <field attribute="schedfinish" label="Scheduled Finish Date:"/>
          <field attribute="targstartdate" label="Target Start Date:"/>
          <field attribute="targcompdate" label="Target Finish Date:"/>
          <!--field attribute="itdcreatedate" label="CR Activation Date"/-->
          <field attribute="wopriority" label="Priority:"/>
          <field attribute="status" label="Status:" requiredexpression="true"/>
          <field attribute="longdescription_.ldtext" label="Remarks:"/>
          <!--field attribute="itdclosurecode" label="Implementation Result"/-->
          <section id="compositions">
            <!--composition relationship="worklog" label="Work Log" >
              <collectionproperties allowcreation="true"/>
            </composition>
            <composition relationship="woactivity" label="Job Plan" >
              <collectionproperties allowcreation="false"/>
            </composition>
            <composition relationship="approvals" label="Approvals" >
              <collectionproperties allowcreation="false"/>
            </composition>
            <composition relationship="attachment" label="Attachments">
              <collectionproperties allowcreation="true"/>
            </composition-->
          </section>
        </schema>

        <schema id="newdetail" title="New Change" abstract="true" stereotype="detailnew" platform="web">
          <field attribute="wonum" label="Change#" requiredexpression="true"/>
          <field attribute="ownergroup" label="Owner Group:"/>
          <!--<field attribute="location" label="Location:"/>-->
          <field attribute="estdur"            default="0" hidden="true"/>
          <field attribute="estlabhrs"         default="0" hidden="true"/>
          <field attribute="estmatcost"        hidden="true" default="0"/>
          <field attribute="estintlabhrs"      hidden="true" default="0"/>
          <field attribute="estintlabcost"     hidden="true" default="0"/>
          <field attribute="estatapprlabhrs"   hidden="true" default="0"/>
          <field attribute="estatapprmatcost"  hidden="true" default="0"/>
          <field attribute="estatapprlabcost"  hidden="true" default="0"/>
          <field attribute="estatapprtoolcost" hidden="true" default="0"/>
          <field attribute="estatapprservcost" hidden="true" default="0"/>
          <field attribute="estapprlabhrs"     hidden="true" default="0"/>
          <field attribute="estapprmatcost"    hidden="true" default="0"/>
          <field attribute="estapprlabcost"    hidden="true" default="0"/>
          <field attribute="estlabcost"        hidden="true" default="0"/>
          <field attribute="esttoolcost"       hidden="true" default="0"/>
          <field attribute="estservcost"       hidden="true" default="0"/>
          <field attribute="actlabhrs"         hidden="true" default="0"/>
          <field attribute="actlabcost"        hidden="true" default="0"/>
          <field attribute="actservcost"       hidden="true" default="0"/>
          <field attribute="actmatcost"        hidden="true" default="0"/>
          <field attribute="acttoolcost"       hidden="true" default="0"/>
          <field attribute="outlabcost"        hidden="true" default="0"/>
          <field attribute="outmatcost"        hidden="true" default="0"/>
          <field attribute="outtoolcost"       hidden="true" default="0"/>
          <field attribute="outservcost"       hidden="true" default="0"/>

          <field attribute="description" label="Summary:">
            <renderer type="default" params="maxlength=100"/>
          </field>
          <field attribute="reportedby" label="Reported By:"/>
          <field attribute="classstructureid" label="Classification:"/>

          <field attribute="worktype" label="Category:"/>
          <!--field attribute="pmcomimpact" label="Impact"/>
          <field attribute="pmcomurgency" label="Urgency"/-->
          <field attribute="reasonforchange" label="Reason:"/>
          <field attribute="reasonforchange_.ldtext" label="Reason Details:"/>
          <!--field attribute="itdchgbusimpct" label="Business Impact"/-->
          <field attribute="verification" label="Verification:"/>
          <!--field attribute="itdbckoutdur" label="Backout Duration"/-->
          <field attribute="backoutplan" label="Back Out Plan:"/>
          <field attribute="backoutplan_.ldtext" label="Back Out Plan Detail:"/>
          <!--field attribute="itdchgpretstdtl" label="Pretest"/-->
          <field attribute="pretestdetail_.ldtext" label="Pretest Details:"/>
          <field attribute="schedstart" label="Scheduled Start Date:"/>
          <field attribute="schedfinish" label="Scheduled Finish Date:"/>
          <field attribute="targstartdate" label="Target Start Date:"/>
          <field attribute="targcompdate" label="Target Finish Date:"/>
          <!--field attribute="itdcreatedate" label="CR Activation Date"/-->
          <field attribute="wopriority" label="Priority:"/>
          <field attribute="status" label="Status:" readonly="true" default="WAPPR" requiredexpression="true"/>
          <field attribute="statusdate" hidden="true" default="@currentdatetime"/>
          <field attribute="longdescription_.ldtext" label="Remarks:"/>
          <!--field attribute="itdclosurecode" label="Implementation Result"/-->
          <section id="compositions">
            <!--composition relationship="worklog" label="Work Log" >
              <collectionproperties allowcreation="true"/>
            </composition>
            <composition relationship="woactivity" label="Job Plan" >
              <collectionproperties allowcreation="false"/>
            </composition>
            <composition relationship="approvals" label="Approvals" >
              <collectionproperties allowcreation="false"/>
            </composition>
            <composition relationship="attachment" label="Attachments">
              <collectionproperties allowcreation="true"/>
            </composition-->
          </section>

        </schema>

      </schemas>
    </application>

    <application name="longdescription" title="Long Description" entity="longdescription" id="00000000-0000-0000-0000-000000000007">
      <properties>
        <property key="mobile.userInteractionEnabled" value="false"/>
        <property key="mobile.fetchlimit" value="30"/>
      </properties>
      <schemas>
        <detail>
          <field attribute="ldkey"  />
          <field attribute="ldownertable"  />
          <field attribute="ldownercol"  />
          <field attribute="ldtext"  />
          <field attribute="longdescriptionid"  />
        </detail>
      </schemas>
    </application>

    <application name="attachment" title="Attachment" entity="DOCLINKS">
      <properties>
        <property key="mobile.fetchlimit" value="300"/>
        <property key ="icon.composition.tab" value="fa fa-paperclip"/>
      </properties>
      <schemas>
        <list stereotype="compositionlist" platform="mobile" redeclaring="false">
          <customization position="ownerid">
          </customization>
          <customization position="createdate">
            <field label="Created Date" attribute="createdate" qualifier="subtitle">
              <renderer type="datetime" params="format=MM/dd/yyyy;showtime=false"/>
            </field>
          </customization>
        </list>

        <list stereotype="compositionlist" platform="web" redeclaring="false">
          <customization position="ownertable">
            <field attribute="ownertable" >
              <renderer type="icon" params="expression={'COMMLOG':'fa-envelope','SR':''};width=3%;"/>
            </field>
          </customization>
        </list>

        <schema id="faqAttachments" stereotype="compositionlist" platform="web">
          <field label="Id" hidden="true" attribute="docinfoid"/>
          <field hidden="true" attribute="doclinksid"/>
          <field label="Document" hidden="true" attribute="document"/>
          <section label="Document" attribute="document" resourcepath="/Content/Templates/downloadattachment.html" parameters="controller=Faq;action=Download;idcolumn=docinfoid"/>
        </schema>

        <schema id="detail" title="Attachments" redeclaring="false" platform="web">
          <customization position="docinfo_.description">
          </customization>
          <commandbars>
            <commandgroup position="detail.primary"  >
              <command id="crud_delete" label="Delete" service="crudextraService" method="deletefn" parameters="schema,datamap"
                       showexpression="@status=='NEW'" successmessage="Attachment deleted"/>
            </commandgroup>
          </commandbars>
        </schema>

      </schemas>
    </application>

    <application entity="woactivity" name="woactivity" title="WO Activity">
      <properties>
        <property key ="icon.composition.tab" value="fa fa-tasks"/>
      </properties>
      <schemas>
        <list stereotype="compositionlist">

          <commands>
            <command id="print" remove="true" label=""/>
          </commands>
          <properties>
            <property key="detail.cancel.lbl" value="Close"/>
          </properties>
          <field attribute="wonum" hidden="true"/>
          <field attribute="wosequence" label="Sequence" />
          <field attribute="taskid" label="Task" />
          <field attribute="description" label="Summary"/>
          <field attribute="estdur" label="Estimated Duration" />

          <field attribute="status" label="Status"/>
          <field attribute="owner" label="Owner" />
          <field attribute="ownergroup" label="Owner Group" />
          <field attribute="reportdate" label="Reported Date"/>
        </list>

        <detail stereotype="compositiondetail">
          <field attribute="description" label="Summary:" requiredexpression="true">
            <renderer type="default" params="maxlength=100"/>
          </field>
          <field attribute="longdescription_.ldtext" label="Details:" >
            <renderer type="textarea"/>
          </field>
        </detail>

      </schemas>
    </application>

    <application name="solution" title="solution" entity="solution">
       <filters>
        <booleanfilter attribute="selfservaccess"/>
        <optionfilter attribute="status" provider="synstatus_.description" displaycode="true"/>     
      </filters>
      
      <properties>
        <property key ="icon.composition.tab" value="fa fa-book"/>
      </properties>
      <schemas>
        <list title="Solution Grid" platform="web" redeclaring="false">
          <customization position="solution">
            <field attribute="solution" label="Solution#" >
              <renderer type="default"/>
            </field>
          </customization>
          <customization position="description">
            <field attribute="description" label="Description">
              <renderer type="default"/>
            </field>
            <field attribute="selfservaccess" label="Self-Service">
              <renderer type="checkbox" params="filteronly=true;formatter=numberToBoolean"/>
            </field>
            <field attribute="assetnum" label="Asset">
              <renderer type="default"/>
            </field>
            <field attribute="classstructure_.classificationid" label="Classification">
              <renderer type="default"/>
            </field>
          </customization>
          <customization position="status">
            <field attribute="status" label="Status">
              <renderer type="statuscolor" params="grid=solution;column=status" />
            </field>
          </customization>

          <properties>
            <property key="list.click.schema" value="editdetail"/>
            <!--<property key="list.defaultorderby" value="workorder.statusdate desc"/>-->
          </properties>
        </list>

        <schema id="complist" stereotype="compositionlist" >
          <field attribute="solution" label="Solution#"/>
          <field attribute="description" label="Description"/>
        </schema>

        <detail stereotype="compositiondetail">
          <field attribute="solution" label="Solution#" readonly="true" />
          <field attribute="problemcode" label="Symptom:" />
          <field attribute="fr1code" label="Cause:" />
          <field attribute="fr2code" label="Resolution:" />
        </detail>
        <schema id="adetail" abstract="true" stereotype="detail" title="Solution Details">
          <properties>
            <property key="detail.showtitle" value="true"/>
          </properties>

          <section id="idsection" />
          <field attribute="description" label="Description" requiredexpression="true">
            <renderer type="default" params="inputsize=medium" />
          </field>
          <section id="statussection" />
          <field label="Self-Service Center?" attribute="selfservaccess">
            <renderer type="checkbox" params="inputsize=medium" />
          </field>
          <section>
            <field label="% Effectiveness Score" attribute="pmsoleffscore" readonly="true">
              <renderer type="default" params="inputsize=small" />
            </field>
          </section>
          <section>
            <header displacement="ontop" label="Solution Details" params="fieldset=true" />
            <renderer type="default" params="childinputsize=medium" />
            <!--<association label="Site" target="siteid" labelfield="site_.description">
              <renderer type="lookup" />
            </association>-->
            <association label="Asset" target="assetnum" labelfield="asset_.description">
              <renderer type="lookup" />
            </association>
            <optionfield attribute="classstructureid" label="Classification:" providerattribute="_SlnClassStructureType">
              <renderer type="autocompleteclient" />
            </optionfield>
            <field label="Keywords" attribute="allkeywords" readonly="true">
              <renderer type="default" />
            </field>
          </section>

          <field attribute="symptom_.ldtext" label="Symptom:">
            <renderer type="richtext" />
          </field>
          <field attribute="cause_.ldtext" label="Cause:">
            <renderer type="richtext" />
          </field>
          <field attribute="resolution_.ldtext" label="Resolution:">
            <renderer type="richtext" />
          </field>
        </schema>
        <schema id="newdetail" parentschema="adetail" title="New Solution" stereotype="detailnew">
        </schema>
        <schema id="editdetail" parentschema="adetail" title="Solution Details">
          <section id="idsection">
            <field attribute="solution" label="Solution#" readonly="true">
              <renderer type="default" params="inputsize=medium" />
            </field>
          </section>
          <section id="statussection">
            <optionfield attribute="status" label="Status" requiredexpression="true">
              <renderer type="combo" params="inputsize=medium" />
              <option label="DRAFT" value="DRAFT" />
              <option label="ACTIVE" value="ACTIVE" />
              <option label="INACTIVE" value="INACTIVE" />
            </optionfield>
          </section>
        </schema>
      </schemas>
    </application>

    <application name="worklog" entity="worklog" title="worklogs">
      <schemas>
        <detail stereotype="compositiondetail" redeclaring="false" platform="web">
          <customization position="+position_attachment">
            <!-- image attachment -->
            <section orientation="horizontal">
              <!-- upload image -->
              <field attribute="newattachment" label="Attachments" showexpression="!@worklogid">
                <renderer type="dndupload"
                          params="acceptedFileExtensions=pdf,zip,txt,doc,docx,dwg,gif,jpg,csv,xls,xlsx,pptx,ppt,xml,xsl,bmp,html,las,avi,jpeg,mp3,mp4,z7,rar,AVI,eml,emz,evt,evtx,mp4,log,LAS,MDB,PNG,JPEG,config,dat,lic,ora,eml,png,js,exe;
                                  multiple=true" />
              </field>
              <!-- display image preview -->
              <field attribute="attachment_url" label="Image" readonly="true" showexpression="!!@worklogid &amp;&amp; !!@attachment_url">
                <renderer type="imagepreview"/>
              </field>
              <!-- or display file link -->
              <field attribute="attachment_url" label="Attachments" showexpression="!!@worklogid &amp;&amp; !!@attachment_url &amp;&amp; (!@attachment_is_image || @attachment_is_image === 'false')">
                <renderer type="link" params="linkUrlField=url;linkNameField=name"/>
              </field>

            </section>
          </customization>
        </detail>
      </schemas>
    </application>

    <application entity="commlog" name="commlog" title="Communications Tab">
      <schemas>
        <schema id="detail" stereotype="compositiondetail" redeclaring="false">
          <customization position="sendfrom">
            <field attribute="sendfrom" label="From:" requiredexpression="true" default="support@kogtsupport24.com">
              <renderer type="email" params="valtype=email;valmessage=invalid email format;"/>
            </field>
          </customization>
          <customization position="subject">
            <field attribute="subject" label="Subject:" requiredexpression="true" defaultexpression="service:kongsbergCommunicationService.getSubjectDefaultExpression"/>
          </customization>
        </schema>
      </schemas>
    </application>

      
    <application name="projectrequest" title="Project Request" entity="projectrequest">
      <filters>
        <optionfilter attribute="status" provider="synstatus_.description" displaycode="true"/>       
      </filters>

      <schemas>
        <schema id="list" stereotype="list" title="Project Request Grid">
          <field attribute="ticketid" label="Project Request"/>
          <field attribute="reportdate" label="Report Date">
            <renderer type="datetime" params="format=MM/dd/yyyy HH:mm:ss;"/>
          </field>
          <field attribute="reportedby" label="Reported By"/>
          <field attribute="status" label="Status"/>
          <field attribute="changedate" label="Changed Date">
            <renderer type="datetime" params="format=MM/dd/yyyy HH:mm:ss;width=9%;showtime=false"/>
          </field>
          <properties>
            <property key="list.click.schema" value="editdetail"/>
          </properties>
        </schema>
        <schema id="adetail" stereotype="detail" abstract="true" title="Real-Time Job Request">
          <section id="hiddenfields">
            <section id="statussection"/>
            <field attribute="classstructureid" label="Class Structure ID" hidden="true"/>
            <field attribute="orgid" label="Org ID" showexpression="false" default="KOGT"/>
            <field attribute="ticketuid" label="Ticket U ID" hidden="true"/>
            <field attribute="changeby" defaultexpression="@username" hidden="true"/>
            <field attribute="changedate" defaultexpression="@now" hidden="true"/>
            <field attribute="owner" showexpression="false"/>
            <field attribute="ownergroup" showexpression="false"/>
          </section>
          <section orientation="horizontal" id="srfields">
            <field attribute="ticketid" label="Ticket ID" showexpression="true" enableexpression="false"/>
            <field attribute="siteid" label="Site ID" showexpression="true" enableexpression="false" default="SUPPORT24"/>
            <field attribute="status" label="Status" default="NEW" enableexpression="false"/>
          </section>
          <section orientation="vertical">
            <header displacement="ontop" label="Customer Representative" params="fieldset=true"/>
            <section orientation="horizontal">
              <field attribute="custrepfullname" label="Full Name"/>
              <field attribute="custrepemail" label="Email"/>
            </section>
            <section orientation="horizontal">
              <field attribute="custrepphone" label="Phone"/>
              <field attribute="custrepaltphone" label="Alt Phone"/>
            </section>
          </section>
          <section orientation="vertical">
            <header displacement="ontop" label="Rigsite Representative" params="fieldset=true"/>
            <section orientation="horizontal">
              <field attribute="rigsiterepfullname" label="Full Name"/>
              <field attribute="rigsiterepemail" label="Email"/>
            </section>
            <section orientation="horizontal">
              <field attribute="rigsiterepphone" label="Phone"/>
              <field attribute="rigsiterepaltphone" label="Alt Phone"/>
            </section>
          </section>
          <section orientation="vertical">
            <header displacement="ontop" label="Job Information" params="fieldset=true"/>
            <section orientation="horizontal">
              <field attribute="projnum" label="Project Number"/>
              <field attribute="prodservline" label="Product Service Line"/>
            </section>
            <section orientation="horizontal">
              <association target="servcomp" label="Service Company" labelfield="servicecompany_.description" valuefield="value">
                <renderer type="lookup"/>
              </association>
              <field attribute="servcomprep" label="Service Company Representative"/>
            </section>
            <section orientation="horizontal">
              <field attribute="servcomprepemail" label="Service Company Representative Email">
                <renderer type="email" params="valtype=email;valmessage=invalid email format;"/>
              </field>
              <field attribute="wellname" label="Well Name"/>
            </section>
            <section orientation="horizontal">
              <field attribute="rigname" label="Rig Name"/>
              <field attribute="prlocation" label="Location"/>
            </section>
            <section orientation="horizontal">
              <field label="Submitted Date/Time" attribute="reportdate" readonly="true" default="@currentdatetime">
                <renderer type="datetime" params="format=MM/dd/yyyy HH:mm"/>
              </field>
              <field attribute="reportedby" label="Job Request Submitted By" default="@username" enableexpression="false"/>
            </section>
            <section orientation="horizontal">
              <field attribute="anticipatestartdate" label="Anticipated Start Date/Time">
                <renderer type="datetime"/>
              </field>
              <field attribute="jobduration" label="Job Duration"/>
            </section>
            <section orientation="horizontal">
              <association target="wellsitetimezone" label="Time Zone of Well Site" labelfield="timezones_.description" valuefield="value">
                <renderer type="lookup"/>
              </association>
              <field attribute="contactphone" label="24 Hour Contact Phone Number"/>
            </section>
          </section>
          <section orientation="vertical">
            <header displacement="ontop" label="General Information" params="fieldset=true"/>
            <section orientation="horizontal">
              <field attribute="servcompwitsmlversion" label="Service Company WITSML Version"/>
              <field attribute="unitset" label="Unitset"/>
            </section>
            <section orientation="horizontal">
              <field attribute="servcompwitsversion" label="Service Company WITS Version">
                <renderer type="default" params="inputsize=large"/>
              </field>
            </section>
          </section>
          <section orientation="vertical">
            <header displacement="ontop" label="Drilling Services and Tools Needed for this Job" params="fieldset=true"/>
            <section orientation="horizontal">
              <field attribute="mlwdservprov" label="M/LWD Service Provider"/>
              <field attribute="surfacedatalogservprov" label="Surface Date Logging Service Provider"/>
            </section>
            <section orientation="horizontal">
              <field attribute="ddservprov" label="Directional Drilling Service Provider">
                <renderer type="default" params="inputsize=large"/>
              </field>
            </section>
          </section>
        </schema>

        <schema id="newdetail" parentschema="adetail" stereotype="detailnew" title="New Real-Time Request">
          <properties>
            <property key="nextschema.schemaid" value="editdetail"/>
          </properties>
        </schema>

        <schema id="editdetail" parentschema="adetail" stereotype="detail" title="Real-Time Request">
        </schema>
      </schemas>
    </application>
  
  </applications>
</metadata>
