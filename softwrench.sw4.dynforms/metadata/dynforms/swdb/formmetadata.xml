<?xml version="1.0" encoding="utf-8" ?>
<metadata xmlns="http://www.controltechnologysolutions.com/metadata">



  <applications>
    <application entity="FormMetadata" name="FormMetadata" title="Form">
      <schemas>
        <schema id="list" stereotype="list" title="Forms">
          <field attribute="name" label="Name"/>
          <field attribute="formtitle" label="Alias"/>
          <field attribute="description" label="Description"/>
          <field attribute="formstatus" label="Status"/>
        </schema >

        <schema id="detail" stereotype="detail.redirecttolist" title="Form Details">
          <field attribute="name" label="Identifier" requiredexpression="true" tooltip="The identifier of the form. Spaces are not allowed" helpicon="right" enableexpression="@rowstamp == null" showexpression="!false"/>

          <field attribute="formtitle" label="Alias" tooltip="An alias in which this form would be later referred to. The identifier is usually not visible" helpicon="right" requiredexpression="true"/>
          <!--          <field attribute="entity" label="Entity" tooltip="An optional field to be used in order to allow multiple forms to point to the same dataset. If not filled, the identier will be used" helpicon="right"/>-->
          <field attribute="description" label="Description" tooltip="To provider further information about the form" helpicon="right" requiredexpression="true">
            <renderer type="textarea"/>
          </field>
          <field attribute="formstatus" label="Status" defaultexpression="Draft" default="Draft" readonly="true"/>

          <!--          <field attribute="listdefinition" label="List Schema" showexpression="service:userService.isSysAdmin">-->
          <!--            <renderer type="textarea"/>-->
          <!--          </field>-->

          <field attribute="detaildefinition" label="Detail Schema" showexpression="service:userService.isSysAdmin">
            <renderer type="textarea"/>
          </field>

          <field hidden="true" attribute="changedate"/>


          <commandbars>
            <commandgroup position="detail.primary">
              <removecommand id="print"/>
            </commandgroup>

            <commandgroup position="actions">
              <command id="editdetail" label="Edit Form" icon="fa-edit" cssclasses="large-button" method="loadFormDetailEdition" service="dynFormService" />
              <command id="cloneform" label="Clone" icon="fa-clone" cssclasses="large-button" method="clone" service="dynFormService" />
              <command id="publish" label="Publish" icon="fa-feed" cssclasses="large-button" method="publish" service="dynFormService" showexpression="'DRAFT'.equalsIc(@formstatus)" tooltip="Set the status to publish allowing this form to be used as a checklist"/>
              <command id="remove" label="Remove" icon="fa-times" cssclasses="large-button" method="remove" service="dynFormService" showexpression="'DRAFT'.equalsIc(@formstatus)" />
              <!--              <command id="editlist" label="Edit Grid" icon="fa-table" cssclasses="large-button" method="loadFormGridEdition" service="dynFormService"/>-->
            </commandgroup>
          </commandbars>

        </schema>

        <schema id="listselection" stereotype="list.modal.readonly" title="New Checklist">
          <field attribute="name" hidden="true"/>
          <field attribute="formtitle" label="Form"/>
          <field attribute="description" label="Description"/>
          <properties>
            <property key="schema.security.overridenrole" value="formselection"/>
            <property key="list.quicksearch.auto" value="true"/>
            <property key="list.preventnoresultsnew" value="true"/>
            <property key="list.click.service" value="dynFormService.redirectToForm"/>
          </properties>
        </schema>

        <schema id="newformbuilder" stereotype="detail.noprint" title="New Form">
          <properties>
            <property key="dynforms.editionallowed" value="true"/>
          </properties>
        </schema>

        <schema id="fieldEditModal" stereotype="detail.noprint" title="Field Selection">
          <section orientation="horizontal" showexpression="@showposition">
            <optionfield attribute="refposition" label="Position">
              <option value="top" label="Top (of)"/>
              <option value="down" label="Bottom (of)"/>
              <option value="left" label="Left (of)"/>
              <option value="right" label="Right (of)"/>

            </optionfield>

            <field attribute="reffield" label="Field"></field>
          </section>

          <optionfield label="Type" attribute="fieldtype" >
            <option label="Please Select..." value="pleaseselect"/>
            <option label="Free Text" value="ApplicationFieldDefinition"/>
            <option label="Checkbox" value="ApplicationFieldDefinition#checkbox" help="A yes/no checkbox"/>
            <option label="Label" value="ApplicationFieldDefinition#label"/>
            <option label="Options" value="OptionField"/>
            <option label="Section" value="ApplicationSection"/>
            <option label="Checklist Table" value="checklisttable"/>
            <option label="Numbered List" value="numberedlist"/>
            <event type="afterchange" service="dynFormService" method="afterChangeType" />
          </optionfield>

          <section showexpression="@fieldtype !== 'pleaseselect'">
            <field attribute="flabel" label="Field Text" requiredexpression="true">
              <event type="blur" service="dynFormService" method="labelInput"/>
            </field>
            <field attribute="fattribute" label="Field (Database Name)" requiredexpression="true" helpicon="right" tooltip="Used to identifiy uniquely this field at the database. No spaces allowed" showexpression="@fieldtype !== 'ApplicationSection'"/>
          </section>

          <section showexpression="@fieldtype == 'ApplicationSection'">
            <optionfield label="Orientation" attribute="sectionorientation" default="vertical">
              <option label="Vertical" value="vertical"/>
              <option label="Horizontal" value="horizontal"/>
            </optionfield>
          </section>

          <section showexpression="@fieldtype == 'ApplicationFieldDefinition'">
            <section orientation="horizontal">
              <field attribute="frequired" label="Required">
                <renderer type="checkbox"/>
              </field>
              <field attribute="freadonly" label="Read Only">
                <renderer type="checkbox"/>
              </field>

              <optionfield attribute="flabelposition" label="Label Position" default="top">
                <option label="Top" value="top"/>
                <option label="Left" value="left"/>
                <!--                <option label="Right" value="right"/>-->
              </optionfield>

              <field attribute="fmaxlength" label="Max Length">
                <renderer type="numericinput" />
              </field>
            </section>
          </section>

          <section showexpression="@fieldtype == 'OptionField'">
            <optionfield attribute="fprovider" label="Provider" providerattribute="availableOptions">
              <renderer type="combo"/>
            </optionfield>

            <!--            <section orientation="horizontal">-->
            <optionfield attribute="ofrenderer" label="Renderer" defaultexpression="'combo'">
              <option value="combo" label="Drop Down"/>
              <option value="lookup" label="Look Up"/>
              <option value="radio" label="Radio"/>
              <option value="checkbox" label="Check Box"/>
              <option value="combodropdown" label="Multiple" help="Allows selection of multiple items at once"/>
            </optionfield>

            <field attribute="frequired" label="Required">
              <renderer type="checkbox"/>
            </field>

            <!--            </section>-->
          </section>

          <section showexpression="@fieldtype == 'ApplicationFieldDefinition#checkbox'">
            <section orientation="horizontal">
              <field attribute="frequired" label="Required">
                <renderer type="checkbox"/>
              </field>
              <field attribute="fcheckontop" label="Label on Top?" >
                <renderer type="checkbox"/>
              </field>
            </section>
          </section>


          <section showexpression="@fieldtype == 'numberedlist'">
            <header label="Advanced" params="fieldset=true" displacement="ontop"/>
            <field attribute="startIndex" label="Start Index" defaultexpression="1"  helpicon="right" tooltip="Specify at which index should the numbered list begin. Useful when there are multiple lists on the screen and one should continue from a certain point">
              <renderer type="numericinput" params="inputsize=small"/>
            </field>
            <optionfield attribute="treeTemplate" label="Template">
              <option label="Basic Checklist (default)" value="checklist"/>
              <option label="Input Checklist" value="inputchecklist"/>
            </optionfield>
            <optionfield attribute="extraHeaderStyle" label="Extra Header" helpicon="right" tooltip="if true an extra header line will be placed before the list start. It can be fully customized" default="none">
              <option label="None" value="none"/>
              <option label="Label" value="label"/>
              <option label="Input" value="input"/>
            </optionfield>
            <field attribute="extraHeaderLabel" label="Extra Header Label" showexpression="@extraHeaderStyle !== 'none'"/>

          </section>


          <section showexpression="@fieldtype !== 'pleaseselect'">
            <header label="Style" params="fieldset=true" displacement="ontop"/>
            <section orientation="horizontal">
              <field attribute="ffontsize" label="Font Size" default="13">
                <renderer type="numericinput" params="min=8;max=50"/>
              </field>
              <section resourcepath="/Content/Shared/dynforms/htmls/bolditalicunderline.html" />
              <field attribute="fcolor" label="Font Color" >
                <renderer type="color" />
              </field>
            </section>
          </section>


          <section showexpression="@fieldtype == 'checklisttable'">
            <field attribute="yesLabel" label="Yes Label" requiredexpression="true" defaultexpression="'yes'"/>
            <field attribute="noLabel" label="No Label" requiredexpression="true" defaultexpression="'N/A'"/>
            <field attribute="optionsLabel" label="Options Label" requiredexpression="true" />
            <section resourcepath="/Content/Shared/dynforms/htmls/checklisttablerowbuilder.html"/>
          </section>






          <event type="beforesubmit.prevalidation" service="dynFormService" method="validateEditModal"/>
          <!--          <event type="beforesubmit.postvalidation" service="dynFormService" method="applyPostValidationRules"/>-->

        </schema>

        <schema id="sectionenclosingmodal" stereotype="detail.noprint" title="Section Creation">
          <field label="Label" attribute="headerlabel" requiredexpression="true"/>
          <optionfield label="Orientation" attribute="sectionorientation" default="vertical">
            <option label="Vertical" value="vertical"/>
            <option label="Horizontal" value="horizontal"/>
          </optionfield>
          <!--          <field attribute="freusable" label="share ?" tooltip="If true this section can be used on other forms later">-->
          <!--            <renderer type="checkbox"/>-->
          <!--          </field>-->
          <field label="Section Id" attribute="sectionid" showexpression="@freusable === true" requiredexpression="true"/>
        </schema>

        <schema id="stylebulkupdate" stereotype="detail.noprint" title="Style Update">
          <section showexpression="@fieldtype !== 'pleaseselect'">
            <header label="Style" params="fieldset=true" displacement="ontop"/>
            <section orientation="horizontal">
              <field attribute="ffontsize" label="Font Size" default="13">
                <renderer type="numericinput" params="min=8;max=50"/>
              </field>
              <field attribute="fontKeep" label="Keep Original" tooltip="if checked this value won´t be applied to the bulk update" helpicon="right" default="true">
                <renderer type="checkbox"/>
              </field>
            </section>

            <section orientation="horizontal">
              <section resourcepath="/Content/Shared/dynforms/htmls/bolditalicunderline.html" />
              <field attribute="boldKeep" label="Keep Original" tooltip="if checked this value won´t be applied to the bulk update" helpicon="right" default="true">
                <renderer type="checkbox"/>
              </field>
            </section>

            <section orientation="horizontal">

              <field attribute="fcolor" label="Font Color" >
                <renderer type="color" />
              </field>
              <field attribute="colorKeep" label="Keep Original" tooltip="if checked this value won´t be applied to the bulk update" helpicon="right" default="true">
                <renderer type="checkbox"/>
              </field>
            </section>


            <section orientation="horizontal">
              <field attribute="padding" label="Move (px)" >
                <renderer type="numericinput" />
              </field>
              <optionfield attribute="movedirection" label="" default="right">
                <option label="Left" value="left"/>
                <option label="Right" value="right"/>
              </optionfield>
              <field attribute="paddingKeep" label="Keep Original" tooltip="if checked this value won´t be applied to the bulk update" helpicon="right" default="true">
                <renderer type="checkbox"/>
              </field>
            </section>
          </section>
        </schema>

        <schema id="new" stereotype="detailnew.redirecttolist" parentschema="detail" title="Form Details">

        </schema>

      </schemas>
    </application>

  </applications>

</metadata>
